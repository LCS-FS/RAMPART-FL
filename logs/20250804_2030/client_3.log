2025-08-04 20:30:04,943 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:04,943 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:30:04,943 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:30:04,943 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:30:04,944 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:30:04,944 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:05,205 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:05,205 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:05,291 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:30:05,330 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:30:05,330 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:05,440 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:05,446 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:05,446 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:05,450 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:30:05,455 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:05,456 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:30:05,456 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:05,456 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:05,456 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:30:05,464 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:05,467 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:05,469 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:05,471 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:05,474 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:05,476 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:05,479 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:05,481 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:05,484 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:05,486 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:05,489 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:05,497 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:05,497 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:30:05,502 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:30:05,502 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:30:05,506 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:05,506 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:30:05,514 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:05,514 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:30:05,514 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:05,529 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:05,533 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:30:05,541 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:30:05,541 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:05,541 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:05,541 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:05,541 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:05,541 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:05,542 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:30:05,542 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:05,542 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:30:05,542 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:05,543 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:30:05,544 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:30:05,544 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:05,544 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:30:05,544 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:05,544 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:05,544 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:05,545 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:30:05,545 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:30:05,545 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:30:05,545 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:30:05,545 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:30:05,545 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:30:05,545 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:30:05,546 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:30:05,546 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:30:05,546 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:30:05,546 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:30:05,546 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:30:05,546 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:05,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:30:05,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:05,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:05,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:05,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:30:05,551 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:30:05,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:30:05,552 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:30:05,555 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:30:05,555 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:05,557 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:05,557 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:30:05,558 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:05,558 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:05,558 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:05,559 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:05,567 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3458, Threshold=0.3610, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:30:05,567 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3458
2025-08-04 20:30:19,846 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:19,847 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:30:19,847 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:30:19,847 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:30:19,847 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:30:19,847 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:20,093 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:20,093 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:20,176 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:30:20,202 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:30:20,202 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:20,298 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:20,304 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:20,304 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:20,310 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:30:20,321 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:20,322 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:30:20,322 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:20,322 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:20,322 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:30:20,331 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:20,334 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:20,336 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:20,338 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:20,341 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:20,343 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:20,346 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:20,349 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:20,352 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:20,353 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:20,356 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:20,366 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:20,366 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:30:20,371 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:30:20,371 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:30:20,376 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:20,376 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:30:20,386 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:20,387 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:30:20,387 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:20,402 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:20,407 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:30:20,411 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:30:20,411 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:20,411 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:20,412 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:20,412 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:20,412 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:20,412 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:30:20,413 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:20,413 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:30:20,413 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:20,414 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:30:20,414 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:30:20,415 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:20,415 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:30:20,415 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:20,415 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:20,415 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:20,415 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:30:20,416 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:30:20,416 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:30:20,416 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:30:20,416 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:30:20,416 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:30:20,416 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:30:20,416 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:30:20,417 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:30:20,417 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:30:20,417 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:30:20,417 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:30:20,418 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:20,418 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:30:20,418 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:20,418 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:20,419 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:20,422 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:30:20,422 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:30:20,423 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:30:20,423 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:30:20,427 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:30:20,427 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:20,429 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:20,429 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:30:20,430 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:20,430 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:20,430 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:20,431 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:20,440 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3359, Threshold=0.3507, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:30:20,441 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3359
2025-08-04 20:30:31,723 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:31,724 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:30:31,724 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:30:31,724 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:30:31,724 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:30:31,724 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:31,997 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:31,997 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:32,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:30:32,113 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:30:32,113 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:32,201 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:32,206 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:32,207 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:32,212 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:30:32,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:32,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:30:32,220 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:32,220 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:32,220 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:30:32,229 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:32,232 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:32,235 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:32,237 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:32,240 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:32,242 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:32,245 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:32,247 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:32,250 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:32,252 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:32,255 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:32,265 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:32,265 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:30:32,270 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:30:32,270 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:30:32,274 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:32,274 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:30:32,283 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:32,283 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:30:32,283 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:32,297 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:32,302 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:30:32,309 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:30:32,309 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:32,309 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:32,309 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:32,310 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:32,310 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:32,310 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:30:32,310 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:32,311 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:30:32,311 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:32,312 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:30:32,313 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:30:32,313 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:32,313 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:30:32,313 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:32,313 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:32,314 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:32,314 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:30:32,314 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:30:32,314 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:30:32,314 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:30:32,315 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:30:32,315 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:30:32,315 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:30:32,315 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:30:32,315 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:30:32,315 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:30:32,316 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:30:32,316 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:30:32,316 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:32,316 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:30:32,316 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:32,317 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:32,317 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:32,320 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:30:32,320 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:30:32,321 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:30:32,321 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:30:32,325 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:30:32,325 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:32,326 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:32,327 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:30:32,328 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:32,328 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:32,328 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:32,329 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:32,338 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3431, Threshold=0.3579, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:30:32,339 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3431
2025-08-04 20:30:46,609 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:46,609 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:30:46,609 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:30:46,609 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:30:46,609 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:30:46,609 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:46,842 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:46,842 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:46,922 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:30:46,946 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:30:46,947 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:47,031 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:47,037 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:47,037 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:47,041 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:30:47,047 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:47,047 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:30:47,047 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:47,047 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:47,048 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:30:47,056 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:47,058 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:47,061 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:47,063 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:47,065 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:47,068 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:47,070 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:47,073 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:47,076 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:47,078 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:47,080 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:47,088 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:47,088 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:30:47,093 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:30:47,093 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:30:47,098 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:47,099 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:30:47,109 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:47,109 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:30:47,109 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:47,123 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:47,128 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:30:47,133 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:30:47,133 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:47,133 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:47,133 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:47,134 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:47,134 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:47,134 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:30:47,135 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:47,135 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:30:47,135 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:47,137 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:30:47,137 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:30:47,137 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:47,137 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:30:47,138 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:47,138 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:47,138 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:47,138 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:30:47,138 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:30:47,138 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:30:47,141 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:30:47,141 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:30:47,141 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:30:47,141 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:30:47,141 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:30:47,141 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:30:47,142 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:30:47,142 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:30:47,142 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:30:47,142 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:47,143 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:30:47,143 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:47,143 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:47,144 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:47,147 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:30:47,147 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:30:47,148 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:30:47,148 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:30:47,151 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:30:47,151 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:47,153 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:47,153 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:30:47,154 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:47,154 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:47,154 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:47,155 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:47,163 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3343, Threshold=0.3487, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:30:47,163 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3343
2025-08-04 20:31:04,457 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:04,457 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:04,457 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:04,457 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:31:04,457 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:31:04,458 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:04,709 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:04,710 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:04,794 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:31:04,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:31:04,828 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:04,914 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:04,919 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:04,919 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:04,924 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:31:04,929 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:04,929 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:31:04,930 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:04,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:04,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:31:04,938 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:04,941 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:04,944 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:04,946 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:04,949 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:04,951 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:04,953 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:04,956 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:04,958 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:04,961 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:04,963 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:04,971 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:04,971 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:31:04,976 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:31:04,976 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:31:04,980 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:04,981 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:31:04,989 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:04,989 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:31:04,990 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:05,004 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:05,009 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:31:05,015 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:31:05,015 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:05,015 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:05,015 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:05,016 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:05,016 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:05,016 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:31:05,016 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:05,017 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:31:05,017 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:05,018 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:31:05,018 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:31:05,019 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:05,019 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:31:05,019 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:05,019 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:05,019 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:05,019 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:31:05,020 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:31:05,020 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:31:05,020 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:31:05,020 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:31:05,020 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:31:05,020 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:31:05,020 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:31:05,021 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:31:05,021 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:31:05,021 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:31:05,021 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:31:05,022 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:05,022 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:31:05,022 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:05,022 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:05,022 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:05,025 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:31:05,026 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:31:05,026 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:31:05,026 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:31:05,029 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:31:05,029 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:05,030 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:05,031 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:05,032 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:05,032 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:05,032 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:05,033 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:05,041 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3421, Threshold=0.3557, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:31:05,041 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3421
2025-08-04 20:31:22,339 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:22,339 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:22,339 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:22,339 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:31:22,340 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:31:22,340 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:22,670 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:22,670 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:22,756 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:31:22,780 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:31:22,781 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:22,873 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:22,879 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:22,879 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:22,885 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:31:22,891 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:22,891 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:31:22,891 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:22,891 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:22,892 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:31:22,900 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:22,903 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:22,906 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:22,908 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:22,911 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:22,913 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:22,916 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:22,918 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:22,921 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:22,923 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:22,925 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:22,937 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:22,937 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:31:22,942 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:31:22,942 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:31:22,947 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:22,947 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:31:22,957 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:22,958 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:31:22,958 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:22,974 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:22,979 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:31:22,983 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:31:22,983 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:22,983 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:22,984 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:22,984 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:22,984 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:22,984 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:31:22,984 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:22,985 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:31:22,985 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:22,986 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:31:22,986 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:31:22,987 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:22,987 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:31:22,987 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:22,987 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:22,987 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:22,987 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:31:22,988 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:31:22,988 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:31:22,988 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:31:22,988 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:31:22,988 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:31:22,989 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:31:22,989 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:31:22,989 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:31:22,989 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:31:22,990 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:31:22,990 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:31:22,990 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:22,990 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:31:22,990 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:22,991 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:22,991 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:22,991 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:31:22,991 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:31:22,991 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:31:22,992 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:31:22,995 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:31:22,996 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:22,997 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:22,997 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:22,998 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:22,999 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:22,999 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:22,999 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:23,008 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3443, Threshold=0.3581, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:31:23,008 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3443
2025-08-04 20:31:34,291 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:34,291 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:34,291 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:34,291 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:31:34,291 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:31:34,292 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:34,581 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:34,581 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:34,667 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:31:34,703 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:31:34,703 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:34,791 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:34,797 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:34,797 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:34,802 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:31:34,808 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:34,808 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:31:34,809 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:34,809 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:34,809 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:31:34,817 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:34,820 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:34,822 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:34,824 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:34,827 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:34,829 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:34,832 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:34,834 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:34,837 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:34,839 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:34,841 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:34,852 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:34,852 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:31:34,857 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:31:34,857 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:31:34,863 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:34,863 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:31:34,877 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:34,877 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:31:34,877 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:34,894 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:34,899 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:31:34,908 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:31:34,908 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:34,908 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:34,908 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:34,909 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:34,909 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:34,909 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:31:34,909 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:34,909 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:31:34,910 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:34,911 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:31:34,911 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:31:34,911 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:34,912 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:31:34,912 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:34,912 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:34,912 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:34,912 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:31:34,912 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:31:34,912 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:31:34,913 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:31:34,913 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:31:34,913 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:31:34,913 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:31:34,913 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:31:34,914 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:31:34,914 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:31:34,914 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:31:34,914 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:31:34,915 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:34,915 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:31:34,915 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:34,915 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:34,915 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:34,919 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:31:34,919 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:31:34,920 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:31:34,920 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:31:34,927 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:31:34,927 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:34,928 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:34,928 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:34,929 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:34,929 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:34,930 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:34,930 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:34,938 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3240, Threshold=0.3367, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:31:34,940 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3240
2025-08-04 20:31:46,218 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:46,218 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:46,218 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:46,218 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:31:46,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:31:46,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:46,523 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:46,523 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:46,606 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:31:46,629 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:31:46,629 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:46,722 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:46,728 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:46,728 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:46,734 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:31:46,741 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:46,741 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:31:46,741 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:46,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:46,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:31:46,751 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:46,757 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:46,759 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:46,761 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:46,764 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:46,766 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:46,769 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:46,771 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:46,774 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:46,776 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:46,779 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:46,788 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:46,789 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:31:46,794 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:31:46,794 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:31:46,800 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:46,800 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:31:46,812 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:46,812 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:31:46,813 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:46,826 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:46,831 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:31:46,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:31:46,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:46,836 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:46,836 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:46,836 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:46,836 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:46,836 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:31:46,837 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:46,837 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:31:46,837 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:46,838 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:31:46,838 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:31:46,839 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:46,839 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:31:46,839 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:46,839 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:46,839 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:46,840 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:31:46,840 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:31:46,840 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:31:46,840 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:31:46,840 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:31:46,840 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:31:46,841 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:31:46,841 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:31:46,841 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:31:46,841 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:31:46,841 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:31:46,842 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:31:46,842 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:46,842 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:31:46,842 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:46,842 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:46,843 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:46,846 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:31:46,846 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:31:46,847 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:31:46,847 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:31:46,850 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:31:46,850 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:46,851 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:46,852 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:46,853 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:46,853 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:46,853 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:46,854 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:46,862 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3440, Threshold=0.3588, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:31:46,862 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3440
2025-08-04 20:31:55,138 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:55,138 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:55,138 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:55,138 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:31:55,138 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:31:55,138 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:55,418 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:55,418 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:55,503 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:31:55,541 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:31:55,541 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:55,647 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:55,652 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:55,653 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:55,657 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:31:55,662 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:55,662 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:31:55,663 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:55,663 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:55,663 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:31:55,671 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:55,674 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:55,676 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:55,678 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:55,681 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:55,683 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:55,685 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:55,688 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:55,691 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:55,694 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:55,696 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:55,706 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:55,706 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:31:55,711 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:31:55,711 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:31:55,716 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:55,716 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:31:55,724 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:55,725 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:31:55,725 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:55,741 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:55,748 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:31:55,754 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:31:55,754 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:55,754 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:55,754 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:55,755 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:55,755 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:55,755 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:31:55,755 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:55,756 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:31:55,756 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:55,757 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:31:55,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:31:55,758 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:55,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:31:55,758 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:55,758 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:55,758 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:55,759 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:31:55,759 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:31:55,759 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:31:55,759 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:31:55,759 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:31:55,759 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:31:55,759 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:31:55,760 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:31:55,760 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:31:55,760 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:31:55,760 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:31:55,761 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:31:55,761 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:55,761 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:31:55,761 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:55,761 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:55,762 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:55,765 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:31:55,765 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:31:55,766 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:31:55,766 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:31:55,770 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:31:55,770 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:55,771 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:55,771 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:55,772 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 49/400.
2025-08-04 20:31:55,873 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:55,873 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:55,875 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 23 anomalous samples to GAN training data (target: 23).
2025-08-04 20:31:55,875 - ClientAppLogger [Client 3] - INFO - [Client] Round 49: Training GAN with 101 samples (78 normal, 23 anomalous).
2025-08-04 20:31:55,876 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:31:55,972 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0866, Avg D Loss: 0.8819
2025-08-04 20:31:55,973 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0866, Avg D Loss: 0.8819
2025-08-04 20:31:55,973 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:31:55,981 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3662, Threshold=0.3817, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:31:55,981 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.7917
2025-08-04 20:31:55,981 - ClientAppLogger [Client 3] - INFO - Fit completed for round 49. Duration: 0.21s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 49, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.086586877851203, 'd_loss': 0.8818677073658103, 'post_fit_local_f1': 0.7916666666666666, 'fit_time_seconds': 0.2087724208831787, 'cpu_percent_fit': 12.1875, 'ram_mb_fit': 2.9375, 'accumulated_train_samples_this_round': 101}
2025-08-04 20:31:55,981 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:32:04,250 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:04,250 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:04,250 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:04,250 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:32:04,251 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:32:04,251 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:04,517 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:04,518 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:04,607 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:32:04,657 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:32:04,657 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:04,784 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:04,792 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:04,792 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:04,804 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:32:04,818 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:04,818 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:32:04,819 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:04,819 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:04,819 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:32:04,828 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:04,831 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:04,834 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:04,837 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:04,840 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:04,842 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:04,845 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:04,848 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:04,852 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:04,854 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:04,856 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:04,866 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:04,866 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:32:04,871 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:32:04,871 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:32:04,876 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:04,876 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:32:04,886 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:04,887 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:32:04,887 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:04,904 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:04,908 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:32:04,914 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:32:04,914 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:04,914 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:04,914 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:04,914 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:04,915 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:04,915 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:32:04,915 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:04,915 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:32:04,915 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:04,917 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:32:04,917 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:32:04,917 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:04,917 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:32:04,917 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:04,918 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:04,918 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:04,918 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:32:04,918 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:32:04,918 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:32:04,918 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:32:04,918 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:32:04,919 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:32:04,919 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:32:04,919 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:32:04,919 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:32:04,919 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:32:04,920 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:32:04,920 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:32:04,920 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:04,920 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:32:04,921 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:04,921 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:04,921 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:04,925 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:32:04,925 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:32:04,925 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:32:04,925 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:32:04,932 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:32:04,933 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:04,934 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:04,934 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:04,936 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:04,936 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:04,936 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:04,936 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:04,945 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3486, Threshold=0.3684, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:32:04,945 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3486
2025-08-04 20:32:16,217 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:16,217 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:16,217 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:16,217 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:32:16,217 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:32:16,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:16,511 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:16,511 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:16,594 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:32:16,621 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:32:16,621 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:16,754 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:16,761 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:16,761 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:16,770 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:32:16,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:16,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:32:16,779 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:16,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:16,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:32:16,789 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:16,793 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:16,796 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:16,798 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:16,801 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:16,804 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:16,807 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:16,809 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:16,812 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:16,814 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:16,817 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:16,828 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:16,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:32:16,833 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:32:16,833 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:32:16,839 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:16,839 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:32:16,850 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:16,850 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:32:16,851 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:16,865 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:16,870 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:32:16,878 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:32:16,878 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:16,878 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:16,878 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:16,879 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:16,879 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:16,879 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:32:16,879 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:16,879 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:32:16,879 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:16,881 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:32:16,881 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:32:16,882 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:16,882 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:32:16,882 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:16,882 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:16,882 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:16,882 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:32:16,882 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:32:16,882 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:32:16,883 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:32:16,883 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:32:16,883 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:32:16,883 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:32:16,883 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:32:16,883 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:32:16,884 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:32:16,884 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:32:16,884 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:32:16,884 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:16,884 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:32:16,885 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:16,885 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:16,885 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:16,889 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:32:16,889 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:32:16,889 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:32:16,889 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:32:16,897 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:32:16,897 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:16,898 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:16,898 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:16,900 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:16,900 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:16,900 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:16,901 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:16,910 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3424, Threshold=0.3617, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:32:16,910 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3424
2025-08-04 20:32:28,170 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:28,170 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:28,170 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:28,170 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:32:28,170 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:32:28,170 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:28,494 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:28,494 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:28,580 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:32:28,620 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:32:28,620 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:28,735 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:28,740 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:28,740 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:28,745 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:32:28,750 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:28,750 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:32:28,751 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:28,751 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:28,751 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:32:28,759 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:28,762 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:28,764 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:28,766 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:28,768 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:28,771 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:28,774 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:28,777 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:28,780 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:28,781 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:28,784 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:28,794 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:28,794 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:32:28,799 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:32:28,799 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:32:28,804 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:28,804 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:32:28,813 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:28,814 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:32:28,814 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:28,830 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:28,834 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:32:28,841 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:32:28,842 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:28,842 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:28,842 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:28,842 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:28,846 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:28,846 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:32:28,846 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:28,846 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:32:28,847 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:28,848 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:32:28,848 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:32:28,849 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:28,849 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:32:28,849 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:28,849 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:28,849 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:28,849 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:32:28,850 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:32:28,850 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:32:28,850 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:32:28,850 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:32:28,850 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:32:28,850 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:32:28,851 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:32:28,851 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:32:28,851 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:32:28,851 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:32:28,851 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:32:28,852 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:28,852 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:32:28,852 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:28,852 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:28,853 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:28,853 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:32:28,853 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:32:28,853 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:32:28,853 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:32:28,857 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:32:28,857 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:28,858 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:28,859 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:28,860 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:28,860 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:28,860 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:28,861 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:28,868 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3492, Threshold=0.3706, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:32:28,869 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3492
2025-08-04 20:32:46,163 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:46,163 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:46,163 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:46,163 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:32:46,163 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:32:46,164 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:46,511 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:46,511 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:46,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:32:46,662 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:32:46,662 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:46,792 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:46,799 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:46,799 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:46,806 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:32:46,814 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:46,814 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:32:46,815 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:46,815 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:46,815 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:32:46,824 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:46,827 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:46,829 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:46,831 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:46,834 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:46,836 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:46,839 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:46,841 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:46,844 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:46,846 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:46,848 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:46,860 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:46,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:32:46,866 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:32:46,866 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:32:46,874 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:46,874 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:32:46,894 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:46,894 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:32:46,895 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:46,912 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:46,918 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:32:46,924 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:32:46,924 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:46,924 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:46,924 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:46,925 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:46,925 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:46,925 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:32:46,925 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:46,926 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:32:46,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:46,927 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:32:46,928 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:32:46,928 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:46,928 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:32:46,928 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:46,929 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:46,929 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:46,929 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:32:46,929 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:32:46,929 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:32:46,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:32:46,930 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:32:46,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:32:46,931 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:32:46,931 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:32:46,931 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:32:46,931 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:32:46,932 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:32:46,932 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:32:46,932 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:46,932 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:32:46,933 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:46,933 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:46,933 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:46,937 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:32:46,937 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:32:46,937 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:32:46,937 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:32:46,941 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:32:46,941 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:46,942 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:46,942 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:46,944 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:46,944 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:46,944 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:46,945 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:46,955 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3598, Threshold=0.3841, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:32:46,955 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3598
2025-08-04 20:32:55,218 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:55,218 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:55,218 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:55,219 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:32:55,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:32:55,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:55,529 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:55,529 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:55,610 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:32:55,636 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:32:55,636 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:55,735 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:55,741 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:55,741 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:55,747 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:32:55,756 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:55,756 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:32:55,757 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:55,757 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:55,757 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:32:55,767 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:55,771 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:55,774 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:55,777 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:55,782 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:55,785 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:55,788 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:55,792 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:55,795 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:55,797 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:55,801 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:55,811 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:55,811 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:32:55,815 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:32:55,816 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:32:55,821 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:55,821 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:32:55,831 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:55,831 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:32:55,831 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:55,847 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:55,852 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:32:55,856 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:32:55,857 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:55,857 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:55,857 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:55,857 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:55,858 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:55,858 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:32:55,858 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:55,858 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:32:55,858 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:55,860 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:32:55,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:32:55,860 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:55,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:32:55,861 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:55,861 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:55,861 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:55,861 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:32:55,861 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:32:55,861 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:32:55,862 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:32:55,862 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:32:55,862 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:32:55,862 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:32:55,862 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:32:55,863 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:32:55,863 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:32:55,863 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:32:55,863 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:32:55,863 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:55,864 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:32:55,864 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:55,864 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:55,864 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:55,868 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:32:55,868 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:32:55,868 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:32:55,868 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:32:55,871 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:32:55,872 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:55,873 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:55,873 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:55,875 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 53/400.
2025-08-04 20:32:55,976 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:55,977 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:55,978 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 24 anomalous samples to GAN training data (target: 24).
2025-08-04 20:32:55,979 - ClientAppLogger [Client 3] - INFO - [Client] Round 53: Training GAN with 107 samples (83 normal, 24 anomalous).
2025-08-04 20:32:55,979 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:32:56,083 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0858, Avg D Loss: 0.8758
2025-08-04 20:32:56,083 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0858, Avg D Loss: 0.8758
2025-08-04 20:32:56,087 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:32:56,096 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3731, Threshold=0.3980, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:32:56,096 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.7917
2025-08-04 20:32:56,097 - ClientAppLogger [Client 3] - INFO - Fit completed for round 53. Duration: 0.22s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 53, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0858255401950014, 'd_loss': 0.8758253494712795, 'post_fit_local_f1': 0.7916666666666666, 'fit_time_seconds': 0.22175812721252441, 'cpu_percent_fit': 12.475, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 107}
2025-08-04 20:32:56,097 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:33:04,384 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:04,384 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:04,384 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:04,384 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:33:04,384 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:33:04,385 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:04,682 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:04,682 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:04,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:33:04,821 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:33:04,822 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:04,939 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:04,945 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:04,945 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:04,950 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:33:04,956 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:04,956 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:33:04,956 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:04,956 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:04,956 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:33:04,964 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:04,967 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:04,969 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:04,971 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:04,974 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:04,976 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:04,978 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:04,981 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:04,984 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:04,986 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:04,988 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:04,996 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:04,997 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:33:05,001 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:33:05,001 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:33:05,006 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:05,006 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:33:05,014 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:05,014 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:33:05,014 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:05,029 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:05,033 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:33:05,039 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:33:05,039 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:05,039 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:05,039 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:05,040 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:05,040 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:05,040 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:33:05,040 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:05,041 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:33:05,041 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:05,042 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:33:05,043 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:33:05,043 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:05,043 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:33:05,043 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:05,043 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:05,043 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:05,044 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:33:05,044 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:33:05,044 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:33:05,044 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:33:05,044 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:33:05,044 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:33:05,045 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:33:05,045 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:33:05,045 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:33:05,045 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:33:05,046 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:33:05,046 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:33:05,046 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:05,046 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:33:05,046 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:05,046 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:05,047 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:05,050 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:33:05,050 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:33:05,050 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:33:05,050 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:33:05,054 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:33:05,054 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:05,055 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:05,055 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:33:05,057 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:05,057 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:05,057 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:05,058 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:05,066 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3622, Threshold=0.3893, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:33:05,068 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3622
2025-08-04 20:33:16,338 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:16,338 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:16,338 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:16,338 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:33:16,338 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:33:16,338 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:16,744 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:16,744 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:16,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:33:16,865 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:33:16,865 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:16,998 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:17,006 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:17,006 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:17,020 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:33:17,045 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:17,045 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:33:17,046 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:17,046 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:17,046 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:33:17,057 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:17,061 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:17,063 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:17,066 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:17,068 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:17,071 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:17,074 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:17,076 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:17,079 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:17,082 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:17,085 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:17,096 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:17,096 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:33:17,101 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:33:17,101 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:33:17,106 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:17,106 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:33:17,117 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:17,117 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:33:17,117 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:17,135 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:17,140 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:33:17,146 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:33:17,146 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:17,146 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:17,146 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:17,146 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:17,150 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:17,150 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:33:17,150 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:17,151 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:33:17,151 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:17,152 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:33:17,152 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:33:17,153 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:17,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:33:17,153 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:17,153 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:17,153 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:17,153 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:33:17,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:33:17,154 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:33:17,154 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:33:17,154 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:33:17,154 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:33:17,154 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:33:17,155 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:33:17,155 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:33:17,155 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:33:17,155 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:33:17,156 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:33:17,156 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:17,156 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:33:17,156 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:17,157 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:17,157 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:17,160 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:33:17,160 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:33:17,160 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:33:17,160 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:33:17,167 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:33:17,168 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:17,169 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:17,170 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:33:17,171 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:17,171 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:17,172 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:17,172 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:17,181 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3466, Threshold=0.3736, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:33:17,181 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3466
2025-08-04 20:33:31,461 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:31,462 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:31,462 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:31,462 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:33:31,462 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:33:31,462 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:31,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:31,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:31,935 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:33:31,989 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:33:31,989 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:32,135 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:32,144 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:32,145 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:32,151 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:33:32,159 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:32,159 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:33:32,160 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:32,160 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:32,160 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:33:32,169 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:32,172 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:32,176 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:32,178 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:32,182 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:32,184 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:32,187 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:32,194 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:32,198 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:32,201 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:32,204 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:32,214 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:32,214 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:33:32,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:33:32,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:33:32,224 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:32,224 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:33:32,235 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:32,235 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:33:32,235 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:32,254 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:32,260 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:33:32,269 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:33:32,270 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:32,270 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:32,270 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:32,270 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:32,270 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:32,271 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:33:32,271 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:32,271 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:33:32,271 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:32,273 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:33:32,274 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:33:32,274 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:32,275 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:33:32,275 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:32,275 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:32,275 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:32,275 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:33:32,276 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:33:32,276 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:33:32,276 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:33:32,276 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:33:32,277 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:33:32,277 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:33:32,277 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:33:32,277 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:33:32,277 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:33:32,278 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:33:32,278 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:33:32,278 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:32,278 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:33:32,278 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:32,279 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:32,279 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:32,282 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:33:32,282 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:33:32,282 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:33:32,282 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:33:32,287 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:33:32,287 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:32,288 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:32,288 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:33:32,290 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:32,291 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:32,291 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:32,291 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:32,300 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3254, Threshold=0.3466, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:33:32,300 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3254
2025-08-04 20:33:49,578 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:49,578 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:49,578 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:49,579 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:33:49,579 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:33:49,579 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:49,841 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:49,841 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:49,923 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:33:49,949 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:33:49,949 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:50,049 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:50,057 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:50,058 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:50,065 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:33:50,073 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:50,073 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:33:50,073 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:50,074 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:50,074 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:33:50,082 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:50,085 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:50,088 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:50,090 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:50,093 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:50,096 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:50,098 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:50,101 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:50,104 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:50,106 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:50,108 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:50,118 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:50,118 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:33:50,122 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:33:50,123 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:33:50,129 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:50,129 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:33:50,139 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:50,140 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:33:50,140 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:50,154 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:50,159 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:33:50,164 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:33:50,165 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:50,165 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:50,165 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:50,165 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:50,165 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:50,166 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:33:50,166 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:50,166 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:33:50,166 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:50,168 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:33:50,168 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:33:50,169 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:50,169 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:33:50,169 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:50,169 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:50,169 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:50,169 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:33:50,170 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:33:50,170 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:33:50,170 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:33:50,170 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:33:50,170 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:33:50,170 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:33:50,170 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:33:50,171 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:33:50,171 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:33:50,171 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:33:50,171 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:33:50,172 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:50,172 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:33:50,172 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:50,172 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:50,172 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:50,176 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:33:50,176 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:33:50,176 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:33:50,176 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:33:50,182 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:33:50,182 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:50,184 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:50,184 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:33:50,185 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:50,185 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:50,185 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:50,186 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:50,194 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3615, Threshold=0.3898, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:33:50,194 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3615
2025-08-04 20:34:01,468 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:01,468 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:34:01,468 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:34:01,468 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:34:01,468 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:34:01,469 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:01,766 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:01,767 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:01,853 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:34:01,882 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:34:01,882 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:01,978 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:01,987 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:01,987 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:01,996 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:34:02,006 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:02,006 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:34:02,007 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:02,007 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:02,007 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:34:02,017 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:02,020 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:02,022 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:02,024 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:02,027 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:02,029 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:02,032 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:02,034 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:02,037 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:02,039 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:02,041 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:02,051 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:02,051 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:34:02,056 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:34:02,056 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:34:02,061 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:02,061 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:34:02,070 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:02,070 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:34:02,070 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:02,085 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:02,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:34:02,095 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:34:02,095 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:02,095 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:02,095 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:02,095 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:02,096 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:02,096 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:34:02,096 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:02,096 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:34:02,096 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:02,098 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:34:02,098 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:34:02,098 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:02,098 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:34:02,098 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:02,098 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:02,099 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:02,099 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:34:02,099 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:34:02,099 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:34:02,099 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:34:02,099 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:34:02,099 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:34:02,099 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:34:02,099 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:34:02,100 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:34:02,100 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:34:02,100 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:34:02,100 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:34:02,100 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:02,100 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:34:02,101 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:02,101 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:02,101 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:02,104 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:34:02,104 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:34:02,105 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:34:02,105 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:34:02,109 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:34:02,109 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:02,110 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:02,110 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:02,112 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:02,112 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:02,112 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:02,113 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:02,121 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3571, Threshold=0.3841, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:34:02,121 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3571
2025-08-04 20:34:13,407 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:13,407 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:34:13,407 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:34:13,407 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:34:13,407 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:34:13,408 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:13,843 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:13,843 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:13,943 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:34:13,989 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:34:13,989 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:14,129 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:14,136 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:14,136 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:14,142 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:34:14,149 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:14,149 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:34:14,150 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:14,150 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:14,150 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:34:14,160 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:14,165 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:14,167 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:14,170 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:14,173 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:14,176 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:14,179 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:14,182 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:14,185 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:14,187 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:14,190 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:14,202 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:14,202 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:34:14,207 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:34:14,207 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:34:14,213 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:14,214 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:34:14,229 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:14,229 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:34:14,229 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:14,245 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:14,249 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:34:14,255 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:34:14,256 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:14,256 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:14,256 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:14,256 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:14,256 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:14,257 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:34:14,257 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:14,257 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:34:14,257 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:14,258 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:34:14,259 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:34:14,259 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:14,259 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:34:14,259 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:14,259 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:14,260 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:14,260 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:34:14,260 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:34:14,260 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:34:14,260 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:34:14,260 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:34:14,260 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:34:14,261 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:34:14,261 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:34:14,261 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:34:14,261 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:34:14,262 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:34:14,262 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:34:14,262 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:14,262 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:34:14,262 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:14,263 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:14,263 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:14,266 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:34:14,266 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:34:14,267 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:34:14,267 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:34:14,270 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:34:14,270 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:14,271 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:14,271 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:14,273 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:14,273 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:14,273 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:14,274 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:14,283 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3669, Threshold=0.3984, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:34:14,283 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3669
2025-08-04 20:34:28,572 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:28,572 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:34:28,572 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:34:28,573 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:34:28,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:34:28,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:28,925 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:28,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:29,021 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:34:29,072 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:34:29,073 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:29,197 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:29,205 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:29,205 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:29,213 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:34:29,220 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:29,220 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:34:29,221 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:29,221 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:29,221 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:34:29,230 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:29,232 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:29,235 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:29,237 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:29,240 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:29,242 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:29,244 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:29,247 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:29,249 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:29,251 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:29,254 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:29,264 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:29,265 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:34:29,270 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:34:29,270 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:34:29,276 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:29,277 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:34:29,294 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:29,294 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:34:29,294 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:29,314 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:29,320 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:34:29,329 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:34:29,329 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:29,329 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:29,329 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:29,330 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:29,330 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:29,330 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:34:29,330 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:29,331 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:34:29,331 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:29,332 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:34:29,332 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:34:29,333 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:29,333 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:34:29,333 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:29,333 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:29,333 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:29,333 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:34:29,333 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:34:29,334 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:34:29,334 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:34:29,334 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:34:29,334 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:34:29,334 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:34:29,334 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:34:29,335 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:34:29,335 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:34:29,335 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:34:29,336 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:34:29,336 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:29,336 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:34:29,336 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:29,337 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:29,337 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:29,340 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:34:29,340 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:34:29,341 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:34:29,341 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:34:29,345 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:34:29,345 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:29,346 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:29,346 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:29,348 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:29,349 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:29,349 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:29,349 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:29,359 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3636, Threshold=0.3968, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:34:29,359 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3636
2025-08-04 20:34:40,640 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:40,641 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:34:40,641 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:34:40,641 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:34:40,641 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:34:40,641 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:40,974 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:40,975 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:41,072 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:34:41,123 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:34:41,123 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:41,257 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:41,266 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:41,267 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:41,276 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:34:41,289 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:41,290 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:34:41,291 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:41,291 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:41,291 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:34:41,303 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:41,307 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:41,310 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:41,312 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:41,316 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:41,318 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:41,321 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:41,324 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:41,327 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:41,329 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:41,332 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:41,344 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:41,344 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:34:41,350 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:34:41,350 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:34:41,355 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:41,355 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:34:41,366 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:41,366 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:34:41,366 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:41,385 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:41,390 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:34:41,401 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:34:41,401 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:41,401 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:41,401 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:41,402 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:41,402 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:41,402 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:34:41,403 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:41,403 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:34:41,403 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:41,404 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:34:41,404 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:34:41,405 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:41,405 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:34:41,405 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:41,405 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:41,405 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:41,406 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:34:41,406 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:34:41,406 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:34:41,406 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:34:41,406 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:34:41,406 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:34:41,407 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:34:41,407 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:34:41,407 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:34:41,407 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:34:41,408 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:34:41,408 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:34:41,408 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:41,408 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:34:41,409 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:41,409 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:41,409 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:41,410 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:34:41,410 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:34:41,410 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:34:41,410 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:34:41,415 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:34:41,415 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:41,416 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:41,416 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:41,418 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:41,418 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:41,418 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:41,419 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:41,428 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3546, Threshold=0.3846, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:34:41,428 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3546
2025-08-04 20:34:52,717 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:52,717 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:34:52,718 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:34:52,718 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:34:52,718 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:34:52,718 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:53,172 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:53,172 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:53,271 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:34:53,321 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:34:53,321 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:53,499 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:53,507 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:53,507 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:53,514 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:34:53,523 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:53,523 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:34:53,524 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:53,524 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:53,525 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:34:53,534 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:53,537 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:53,540 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:53,543 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:53,546 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:53,548 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:53,551 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:53,553 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:53,556 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:53,559 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:53,561 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:53,573 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:53,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:34:53,578 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:34:53,578 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:34:53,584 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:53,584 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:34:53,598 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:53,599 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:34:53,599 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:53,615 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:53,620 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:34:53,628 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:34:53,628 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:53,628 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:53,629 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:53,629 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:53,629 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:53,629 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:34:53,630 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:53,630 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:34:53,630 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:53,631 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:34:53,631 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:34:53,632 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:53,632 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:34:53,632 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:53,632 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:53,632 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:53,633 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:34:53,633 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:34:53,633 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:34:53,633 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:34:53,633 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:34:53,633 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:34:53,634 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:34:53,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:34:53,634 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:34:53,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:34:53,635 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:34:53,635 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:34:53,635 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:53,635 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:34:53,635 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:53,635 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:53,636 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:53,636 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:34:53,636 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:34:53,636 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:34:53,636 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:34:53,641 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:34:53,641 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:53,643 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:53,643 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:53,644 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:53,644 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:53,644 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:53,645 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:53,653 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3600, Threshold=0.3890, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:34:53,654 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3600
2025-08-04 20:35:10,943 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:10,943 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:10,943 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:10,943 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:35:10,943 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:35:10,943 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:11,184 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:11,184 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:11,278 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:35:11,321 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:35:11,321 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:11,439 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:11,445 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:11,445 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:11,450 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:35:11,456 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:11,456 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:35:11,457 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:11,457 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:11,457 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:35:11,465 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:11,468 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:11,471 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:11,473 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:11,476 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:11,478 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:11,481 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:11,483 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:11,486 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:11,488 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:11,490 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:11,499 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:11,500 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:35:11,504 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:35:11,504 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:35:11,509 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:11,509 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:35:11,517 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:11,517 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:35:11,518 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:11,533 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:11,537 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:35:11,543 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:35:11,543 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:11,544 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:11,544 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:11,544 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:11,544 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:11,544 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:35:11,545 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:11,545 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:35:11,545 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:11,546 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:35:11,546 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:35:11,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:11,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:35:11,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:11,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:11,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:11,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:35:11,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:35:11,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:35:11,548 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:35:11,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:35:11,548 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:35:11,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:35:11,548 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:35:11,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:35:11,549 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:35:11,549 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:35:11,549 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:35:11,549 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:11,549 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:35:11,550 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:11,550 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:11,550 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:11,550 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:35:11,550 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:35:11,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:35:11,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:35:11,554 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:35:11,554 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:11,556 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:11,556 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:11,557 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:11,558 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:11,558 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:11,558 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:11,567 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3661, Threshold=0.4003, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:35:11,567 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3661
2025-08-04 20:35:22,840 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:22,840 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:22,840 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:22,840 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:35:22,840 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:35:22,840 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:23,112 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:23,112 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:23,204 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:35:23,251 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:35:23,251 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:23,373 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:23,382 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:23,382 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:23,390 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:35:23,408 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:23,408 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:35:23,409 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:23,409 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:23,409 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:35:23,418 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:23,421 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:23,423 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:23,426 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:23,428 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:23,431 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:23,433 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:23,436 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:23,438 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:23,440 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:23,442 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:23,452 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:23,452 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:35:23,457 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:35:23,457 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:35:23,462 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:23,463 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:35:23,476 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:23,476 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:35:23,476 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:23,491 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:23,497 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:35:23,504 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:35:23,504 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:23,504 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:23,504 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:23,505 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:23,505 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:23,505 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:35:23,505 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:23,506 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:35:23,506 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:23,507 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:35:23,507 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:35:23,508 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:23,508 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:35:23,508 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:23,508 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:23,508 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:23,509 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:35:23,509 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:35:23,509 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:35:23,509 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:35:23,509 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:35:23,509 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:35:23,510 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:35:23,510 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:35:23,510 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:35:23,510 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:35:23,511 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:35:23,511 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:35:23,511 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:23,511 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:35:23,512 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:23,512 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:23,512 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:23,512 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:35:23,513 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:35:23,513 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:35:23,513 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:35:23,521 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:35:23,521 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:23,522 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:23,523 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:23,524 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:23,524 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:23,524 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:23,525 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:23,533 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3823, Threshold=0.4167, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:35:23,533 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3823
2025-08-04 20:35:34,815 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:34,815 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:34,815 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:34,815 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:35:34,815 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:35:34,815 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:35,105 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:35,106 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:35,196 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:35:35,244 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:35:35,244 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:35,401 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:35,409 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:35,409 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:35,418 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:35:35,426 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:35,426 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:35:35,427 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:35,427 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:35,427 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:35:35,436 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:35,439 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:35,442 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:35,444 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:35,447 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:35,449 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:35,452 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:35,454 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:35,457 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:35,459 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:35,461 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:35,473 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:35,474 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:35:35,479 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:35:35,479 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:35:35,486 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:35,486 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:35:35,500 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:35,501 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:35:35,501 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:35,518 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:35,523 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:35:35,535 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:35:35,535 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:35,535 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:35,535 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:35,535 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:35,536 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:35,536 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:35:35,536 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:35,536 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:35:35,537 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:35,538 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:35:35,538 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:35:35,538 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:35,539 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:35:35,539 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:35,539 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:35,539 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:35,539 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:35:35,539 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:35:35,540 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:35:35,540 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:35:35,540 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:35:35,540 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:35:35,540 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:35:35,540 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:35:35,541 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:35:35,541 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:35:35,541 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:35:35,542 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:35:35,542 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:35,542 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:35:35,542 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:35,542 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:35,543 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:35,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:35:35,547 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:35:35,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:35:35,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:35:35,554 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:35:35,554 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:35,556 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:35,556 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:35,557 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:35,557 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:35,557 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:35,558 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:35,566 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3546, Threshold=0.3901, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:35:35,566 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3546
2025-08-04 20:35:46,846 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:46,846 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:46,846 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:46,846 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:35:46,846 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:35:46,846 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:47,136 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:47,137 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:47,222 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:35:47,268 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:35:47,269 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:47,415 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:47,424 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:47,424 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:47,439 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:35:47,449 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:47,449 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:35:47,450 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:47,450 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:47,450 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:35:47,461 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:47,464 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:47,467 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:47,469 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:47,472 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:47,475 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:47,478 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:47,480 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:47,483 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:47,485 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:47,487 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:47,499 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:47,499 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:35:47,504 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:35:47,505 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:35:47,510 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:47,510 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:35:47,526 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:47,526 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:35:47,526 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:47,544 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:47,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:35:47,566 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:35:47,566 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:47,567 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:47,567 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:47,567 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:47,567 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:47,568 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:35:47,568 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:47,568 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:35:47,569 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:47,570 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:35:47,570 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:35:47,571 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:47,571 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:35:47,571 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:47,571 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:47,571 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:47,572 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:35:47,572 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:35:47,572 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:35:47,572 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:35:47,573 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:35:47,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:35:47,573 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:35:47,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:35:47,573 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:35:47,574 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:35:47,574 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:35:47,575 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:35:47,575 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:47,575 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:35:47,575 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:47,576 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:47,577 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:47,580 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:35:47,580 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:35:47,580 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:35:47,580 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:35:47,588 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:35:47,589 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:47,591 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:47,591 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:47,593 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:47,593 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:47,593 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:47,594 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:47,604 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3690, Threshold=0.4094, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:35:47,604 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3690
2025-08-04 20:35:58,894 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:58,895 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:58,895 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:58,895 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:35:58,895 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:35:58,895 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:59,132 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:59,133 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:59,221 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:35:59,254 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:35:59,255 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:59,388 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:59,396 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:59,396 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:59,404 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:35:59,410 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:59,411 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:35:59,411 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:59,412 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:59,412 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:35:59,421 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:59,425 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:59,427 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:59,429 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:59,432 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:59,434 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:59,437 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:59,439 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:59,442 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:59,444 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:59,446 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:59,459 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:59,460 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:35:59,465 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:35:59,465 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:35:59,474 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:59,474 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:35:59,495 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:59,496 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:35:59,496 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:59,518 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:59,527 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:35:59,539 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:35:59,540 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:59,540 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:59,540 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:59,541 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:59,542 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:59,542 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:35:59,542 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:59,542 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:35:59,543 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:59,544 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:35:59,545 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:35:59,545 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:59,546 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:35:59,546 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:59,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:59,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:59,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:35:59,548 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:35:59,549 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:35:59,549 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:35:59,549 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:35:59,550 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:35:59,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:35:59,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:35:59,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:35:59,552 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:35:59,552 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:35:59,553 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:35:59,553 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:59,553 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:35:59,554 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:59,554 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:59,555 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:59,555 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:35:59,555 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:35:59,556 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:35:59,556 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:35:59,560 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:35:59,561 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:59,564 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:59,564 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:59,569 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:59,569 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:59,569 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:59,572 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:59,585 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3800, Threshold=0.4182, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:35:59,585 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3800
2025-08-04 20:36:04,834 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:04,834 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:04,834 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:04,835 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:36:04,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:36:04,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:05,072 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:05,072 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:05,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:36:05,176 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:36:05,176 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:05,266 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:05,272 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:05,272 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:05,277 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:36:05,284 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:05,284 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:36:05,285 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:05,285 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:05,285 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:36:05,293 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:05,296 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:05,298 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:05,300 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:05,303 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:05,305 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:05,308 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:05,310 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:05,313 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:05,315 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:05,317 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:05,326 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:05,326 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:36:05,330 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:36:05,330 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:36:05,335 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:05,335 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:36:05,345 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:05,346 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:36:05,346 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:05,362 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:05,367 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:36:05,371 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:36:05,371 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:05,371 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:05,372 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:05,372 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:05,372 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:05,373 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:36:05,373 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:05,373 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:36:05,373 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:05,375 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:36:05,375 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:36:05,375 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:05,376 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:36:05,376 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:05,376 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:05,376 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:05,376 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:36:05,377 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:36:05,377 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:36:05,377 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:36:05,377 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:36:05,377 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:36:05,377 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:36:05,378 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:36:05,378 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:36:05,378 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:36:05,378 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:36:05,378 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:36:05,379 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:05,379 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:36:05,379 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:05,379 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:05,380 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:05,380 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:36:05,380 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:36:05,380 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:36:05,380 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:36:05,384 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:36:05,384 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:05,385 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:05,386 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:05,387 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 67/400.
2025-08-04 20:36:05,488 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:05,488 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:05,489 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 33 anomalous samples to GAN training data (target: 33).
2025-08-04 20:36:05,490 - ClientAppLogger [Client 3] - INFO - [Client] Round 67: Training GAN with 143 samples (110 normal, 33 anomalous).
2025-08-04 20:36:05,490 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:05,608 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.8525
2025-08-04 20:36:05,608 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.8525
2025-08-04 20:36:05,608 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:05,616 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3922, Threshold=0.4289, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:36:05,616 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.7917
2025-08-04 20:36:05,617 - ClientAppLogger [Client 3] - INFO - Fit completed for round 67. Duration: 0.23s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 67, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0831696113506397, 'd_loss': 0.8524612087053018, 'post_fit_local_f1': 0.7916666666666666, 'fit_time_seconds': 0.22960519790649414, 'cpu_percent_fit': 12.60625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 143}
2025-08-04 20:36:05,617 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:36:16,893 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:16,893 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:16,893 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:16,893 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:36:16,893 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:36:16,894 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:17,133 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:17,134 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:17,221 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:36:17,260 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:36:17,261 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:17,381 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:17,387 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:17,387 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:17,393 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:36:17,399 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:17,400 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:36:17,400 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:17,401 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:17,401 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:36:17,410 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:17,413 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:17,416 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:17,418 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:17,422 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:17,424 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:17,426 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:17,429 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:17,432 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:17,433 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:17,436 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:17,447 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:17,447 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:36:17,451 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:36:17,452 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:36:17,456 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:17,457 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:36:17,465 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:17,466 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:36:17,466 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:17,483 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:17,488 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:36:17,494 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:36:17,494 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:17,494 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:17,494 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:17,495 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:17,495 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:17,495 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:36:17,495 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:17,495 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:36:17,496 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:17,497 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:36:17,497 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:36:17,498 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:17,498 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:36:17,498 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:17,498 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:17,499 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:17,499 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:36:17,499 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:36:17,499 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:36:17,499 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:36:17,499 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:36:17,499 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:36:17,500 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:36:17,500 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:36:17,500 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:36:17,500 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:36:17,501 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:36:17,501 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:36:17,501 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:17,501 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:36:17,502 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:17,502 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:17,502 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:17,506 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:36:17,506 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:36:17,506 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:36:17,506 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:36:17,510 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:36:17,510 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:17,511 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:17,511 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:17,513 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:17,513 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:17,513 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:17,513 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:17,522 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3653, Threshold=0.4002, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:36:17,522 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3653
2025-08-04 20:36:28,782 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:28,782 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:28,782 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:28,782 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:36:28,782 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:36:28,782 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:29,046 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:29,047 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:29,133 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:36:29,157 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:36:29,157 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:29,283 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:29,291 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:29,291 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:29,296 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:36:29,302 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:29,303 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:36:29,303 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:29,303 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:29,304 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:36:29,313 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:29,316 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:29,318 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:29,320 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:29,323 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:29,326 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:29,328 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:29,331 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:29,334 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:29,336 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:29,339 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:29,352 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:29,352 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:36:29,357 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:36:29,357 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:36:29,366 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:29,367 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:36:29,383 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:29,383 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:36:29,383 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:29,400 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:29,405 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:36:29,414 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:36:29,414 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:29,414 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:29,414 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:29,415 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:29,415 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:29,415 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:36:29,415 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:29,416 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:36:29,416 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:29,417 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:36:29,418 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:36:29,418 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:29,418 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:36:29,418 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:29,419 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:29,419 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:29,419 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:36:29,419 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:36:29,419 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:36:29,419 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:36:29,420 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:36:29,420 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:36:29,420 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:36:29,421 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:36:29,421 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:36:29,421 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:36:29,422 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:36:29,422 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:36:29,422 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:29,422 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:36:29,423 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:29,423 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:29,423 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:29,423 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:36:29,424 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:36:29,424 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:36:29,424 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:36:29,430 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:36:29,430 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:29,432 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:29,432 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:29,434 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:29,434 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:29,434 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:29,435 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:29,444 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3727, Threshold=0.4150, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:36:29,444 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3727
2025-08-04 20:36:34,694 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:34,694 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:34,694 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:34,695 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:36:34,695 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:36:34,695 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:34,950 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:34,950 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:35,031 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:36:35,054 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:36:35,054 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:35,136 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:35,140 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:35,141 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:35,147 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:36:35,154 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:35,154 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:36:35,154 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:35,155 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:35,155 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:36:35,163 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:35,166 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:35,168 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:35,170 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:35,172 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:35,175 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:35,177 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:35,179 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:35,182 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:35,184 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:35,186 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:35,195 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:35,195 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:36:35,200 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:36:35,200 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:36:35,205 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:35,205 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:36:35,213 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:35,213 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:36:35,213 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:35,227 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:35,231 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:36:35,236 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:36:35,236 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:35,236 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:35,236 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:35,236 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:35,236 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:35,237 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:36:35,237 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:35,237 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:36:35,237 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:35,238 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:36:35,238 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:36:35,239 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:35,239 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:36:35,239 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:35,239 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:35,239 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:35,239 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:36:35,239 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:36:35,240 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:36:35,240 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:36:35,240 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:36:35,240 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:36:35,240 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:36:35,240 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:36:35,241 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:36:35,241 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:36:35,241 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:36:35,241 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:36:35,241 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:35,241 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:36:35,242 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:35,242 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:35,242 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:35,242 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:36:35,242 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:36:35,242 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:36:35,243 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:36:35,247 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:36:35,247 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:35,248 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:35,248 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:35,249 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 69/400.
2025-08-04 20:36:35,350 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:35,350 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:35,355 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 34 anomalous samples to GAN training data (target: 34).
2025-08-04 20:36:35,355 - ClientAppLogger [Client 3] - INFO - [Client] Round 69: Training GAN with 148 samples (114 normal, 34 anomalous).
2025-08-04 20:36:35,356 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:35,481 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0825, Avg D Loss: 0.8461
2025-08-04 20:36:35,481 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0825, Avg D Loss: 0.8461
2025-08-04 20:36:35,481 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:35,489 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3865, Threshold=0.4275, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:36:35,489 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.7917
2025-08-04 20:36:35,489 - ClientAppLogger [Client 3] - INFO - Fit completed for round 69. Duration: 0.24s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 69, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0824889195931924, 'd_loss': 0.8461117622014639, 'post_fit_local_f1': 0.7916666666666666, 'fit_time_seconds': 0.23983263969421387, 'cpu_percent_fit': 11.65625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 148}
2025-08-04 20:36:35,490 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:36:46,739 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:46,739 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:46,739 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:46,740 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:36:46,740 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:36:46,740 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:47,002 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:47,002 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:47,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:36:47,129 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:36:47,129 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:47,256 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:47,263 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:47,264 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:47,270 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:36:47,276 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:47,276 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:36:47,277 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:47,277 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:47,277 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:36:47,286 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:47,289 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:47,291 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:47,293 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:47,296 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:47,298 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:47,301 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:47,304 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:47,306 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:47,308 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:47,311 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:47,321 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:47,322 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:36:47,327 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:36:47,327 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:36:47,333 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:47,333 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:36:47,346 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:47,347 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:36:47,347 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:47,364 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:47,370 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:36:47,377 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:36:47,377 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:47,377 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:47,377 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:47,377 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:47,378 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:47,378 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:36:47,378 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:47,378 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:36:47,378 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:47,380 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:36:47,380 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:36:47,381 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:47,381 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:36:47,381 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:47,381 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:47,381 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:47,382 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:36:47,382 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:36:47,382 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:36:47,382 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:36:47,382 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:36:47,382 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:36:47,383 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:36:47,383 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:36:47,383 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:36:47,383 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:36:47,384 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:36:47,384 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:36:47,384 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:47,384 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:36:47,385 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:47,385 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:47,385 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:47,389 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:36:47,389 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:36:47,389 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:36:47,389 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:36:47,393 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:36:47,393 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:47,395 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:47,395 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:47,396 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:47,397 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:47,397 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:47,397 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:47,405 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3915, Threshold=0.4368, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:36:47,405 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3915
2025-08-04 20:36:52,656 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:52,656 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:52,656 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:52,657 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:36:52,657 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:36:52,657 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:52,934 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:52,934 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:53,018 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:36:53,061 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:36:53,061 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:53,183 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:53,189 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:53,189 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:53,194 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:36:53,199 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:53,200 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:36:53,200 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:53,200 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:53,200 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:36:53,209 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:53,212 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:53,214 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:53,217 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:53,220 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:53,222 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:53,225 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:53,227 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:53,230 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:53,232 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:53,234 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:53,244 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:53,244 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:36:53,249 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:36:53,249 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:36:53,255 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:53,255 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:36:53,266 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:53,267 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:36:53,267 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:53,283 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:53,288 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:36:53,295 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:36:53,296 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:53,296 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:53,296 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:53,296 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:53,297 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:53,297 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:36:53,297 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:53,297 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:36:53,298 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:53,299 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:36:53,300 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:36:53,300 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:53,300 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:36:53,301 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:53,301 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:53,301 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:53,301 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:36:53,301 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:36:53,301 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:36:53,302 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:36:53,302 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:36:53,302 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:36:53,302 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:36:53,302 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:36:53,303 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:36:53,303 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:36:53,303 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:36:53,304 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:36:53,304 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:53,304 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:36:53,305 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:53,305 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:53,305 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:53,309 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:36:53,309 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:36:53,309 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:36:53,309 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:36:53,313 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:36:53,313 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:53,315 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:53,315 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:53,316 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 70/400.
2025-08-04 20:36:53,417 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:53,417 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:53,419 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 34 anomalous samples to GAN training data (target: 34).
2025-08-04 20:36:53,419 - ClientAppLogger [Client 3] - INFO - [Client] Round 70: Training GAN with 149 samples (115 normal, 34 anomalous).
2025-08-04 20:36:53,419 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:53,538 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0824, Avg D Loss: 0.8610
2025-08-04 20:36:53,538 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0824, Avg D Loss: 0.8610
2025-08-04 20:36:53,538 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:53,546 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3879, Threshold=0.4306, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:36:53,546 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.7917
2025-08-04 20:36:53,546 - ClientAppLogger [Client 3] - INFO - Fit completed for round 70. Duration: 0.23s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 70, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.082356849772818, 'd_loss': 0.8610270761403462, 'post_fit_local_f1': 0.7916666666666666, 'fit_time_seconds': 0.22994375228881836, 'cpu_percent_fit': 12.075, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 149}
2025-08-04 20:36:53,547 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:37:01,796 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:01,796 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:01,796 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:01,797 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:37:01,797 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:37:01,797 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:02,032 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:02,032 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:02,112 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:37:02,136 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:37:02,137 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:02,240 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:02,247 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:02,247 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:02,252 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:37:02,270 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:02,270 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:37:02,271 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:02,271 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:02,271 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:37:02,280 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:02,283 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:02,285 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:02,287 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:02,290 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:02,292 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:02,294 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:02,297 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:02,300 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:02,302 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:02,304 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:02,313 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:02,313 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:37:02,318 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:37:02,318 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:37:02,323 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:02,323 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:37:02,333 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:02,333 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:37:02,333 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:02,350 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:02,355 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:37:02,362 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:37:02,362 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:02,362 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:02,362 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:02,363 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:02,363 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:02,363 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:37:02,363 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:02,363 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:37:02,364 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:02,365 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:37:02,365 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:37:02,366 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:02,366 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:37:02,366 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:02,366 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:02,366 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:02,367 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:37:02,367 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:37:02,367 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:37:02,367 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:37:02,368 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:37:02,368 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:37:02,368 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:37:02,368 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:37:02,368 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:37:02,368 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:37:02,369 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:37:02,369 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:37:02,369 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:02,369 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:37:02,370 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:02,370 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:02,371 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:02,374 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:37:02,374 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:37:02,374 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:37:02,374 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:37:02,378 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:37:02,378 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:02,380 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:02,380 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:02,382 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:02,382 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:02,382 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:02,382 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:02,390 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3797, Threshold=0.4328, Accuracy=0.6970, F1=0.7917, Precision=0.9620, Recall=0.6726
2025-08-04 20:37:02,390 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.6970, F1: 0.7917, Prec: 0.9620, Rec: 0.6726, Avg Anomaly Score: 0.3797
2025-08-04 20:37:16,675 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:16,675 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:16,675 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:16,675 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:37:16,675 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:37:16,675 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:16,953 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:16,954 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:17,040 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:37:17,086 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:37:17,087 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:17,213 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:17,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:17,220 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:17,225 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:37:17,231 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:17,231 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:37:17,232 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:17,232 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:17,232 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:37:17,241 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:17,244 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:17,246 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:17,248 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:17,251 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:17,253 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:17,256 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:17,259 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:17,261 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:17,264 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:17,266 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:17,276 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:17,276 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:37:17,281 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:37:17,281 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:37:17,286 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:17,286 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:37:17,295 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:17,296 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:37:17,296 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:17,310 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:17,315 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:37:17,320 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:37:17,320 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:17,320 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:17,321 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:17,321 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:17,321 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:17,321 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:37:17,321 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:17,322 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:37:17,322 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:17,323 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:37:17,323 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:37:17,324 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:17,324 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:37:17,324 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:17,324 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:17,325 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:17,325 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:37:17,325 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:37:17,325 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:37:17,325 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:37:17,325 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:37:17,326 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:37:17,326 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:37:17,326 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:37:17,326 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:37:17,326 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:37:17,327 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:37:17,328 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:37:17,328 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:17,328 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:37:17,328 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:17,329 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:17,329 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:17,332 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:37:17,332 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:37:17,332 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:37:17,332 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:37:17,336 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:37:17,336 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:17,338 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:17,338 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:17,339 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:17,340 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:17,340 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:17,340 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:17,349 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3843, Threshold=0.4391, Accuracy=0.7121, F1=0.8021, Precision=0.9747, Recall=0.6814
2025-08-04 20:37:17,349 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7121, F1: 0.8021, Prec: 0.9747, Rec: 0.6814, Avg Anomaly Score: 0.3843
2025-08-04 20:37:28,616 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:28,617 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:28,617 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:28,617 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:37:28,617 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:37:28,617 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:28,869 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:28,870 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:28,952 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:37:28,976 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:37:28,977 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:29,066 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:29,073 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:29,073 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:29,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:37:29,137 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:29,137 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:37:29,138 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:29,138 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:29,138 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:37:29,147 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:29,150 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:29,153 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:29,155 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:29,158 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:29,160 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:29,163 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:29,165 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:29,168 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:29,170 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:29,172 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:29,182 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:29,182 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:37:29,187 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:37:29,187 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:37:29,192 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:29,192 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:37:29,201 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:29,202 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:37:29,202 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:29,216 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:29,221 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:37:29,227 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:37:29,227 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:29,227 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:29,227 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:29,228 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:29,228 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:29,228 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:37:29,228 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:29,229 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:37:29,229 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:29,231 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:37:29,231 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:37:29,231 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:29,231 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:37:29,231 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:29,232 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:29,232 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:29,232 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:37:29,232 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:37:29,232 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:37:29,233 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:37:29,233 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:37:29,233 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:37:29,233 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:37:29,233 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:37:29,233 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:37:29,234 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:37:29,234 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:37:29,234 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:37:29,234 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:29,234 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:37:29,235 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:29,235 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:29,235 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:29,239 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:37:29,239 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:37:29,239 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:37:29,240 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:37:29,245 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:37:29,245 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:29,246 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:29,247 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:29,248 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:29,248 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:29,248 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:29,249 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:29,259 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3601, Threshold=0.4155, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:37:29,259 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3601
2025-08-04 20:37:43,532 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:43,533 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:43,533 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:43,533 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:37:43,533 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:37:43,533 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:43,799 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:43,799 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:43,884 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:37:43,923 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:37:43,923 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:44,039 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:44,047 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:44,047 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:44,054 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:37:44,060 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:44,061 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:37:44,061 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:44,061 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:44,061 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:37:44,070 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:44,072 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:44,075 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:44,077 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:44,080 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:44,082 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:44,085 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:44,087 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:44,090 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:44,092 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:44,094 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:44,103 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:44,103 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:37:44,108 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:37:44,108 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:37:44,113 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:44,113 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:37:44,121 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:44,121 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:37:44,121 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:44,138 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:44,145 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:37:44,150 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:37:44,150 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:44,150 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:44,151 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:44,152 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:44,152 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:44,152 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:37:44,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:44,153 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:37:44,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:44,154 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:37:44,155 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:37:44,155 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:44,155 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:37:44,155 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:44,155 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:44,156 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:44,156 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:37:44,156 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:37:44,156 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:37:44,156 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:37:44,156 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:37:44,156 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:37:44,157 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:37:44,157 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:37:44,157 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:37:44,157 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:37:44,158 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:37:44,158 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:37:44,158 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:44,158 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:37:44,159 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:44,159 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:44,159 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:44,159 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:37:44,160 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:37:44,160 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:37:44,160 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:37:44,165 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:37:44,166 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:44,167 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:44,167 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:44,169 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:44,169 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:44,169 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:44,170 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:44,178 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3755, Threshold=0.4371, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:37:44,178 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3755
2025-08-04 20:37:55,467 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:55,467 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:55,467 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:55,467 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:37:55,467 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:37:55,468 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:55,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:55,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:55,822 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:37:55,848 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:37:55,848 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:55,947 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:55,956 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:55,957 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:55,963 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:37:55,980 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:55,980 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:37:55,981 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:55,981 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:55,981 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:37:55,991 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:55,994 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:55,996 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:55,998 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:56,001 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:56,003 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:56,006 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:56,008 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:56,011 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:56,013 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:56,015 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:56,025 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:56,025 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:37:56,030 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:37:56,030 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:37:56,035 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:56,035 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:37:56,046 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:56,046 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:37:56,047 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:56,063 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:56,069 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:37:56,075 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:37:56,075 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:56,075 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:56,076 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:56,076 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:56,076 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:56,077 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:37:56,077 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:56,077 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:37:56,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:56,079 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:37:56,079 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:37:56,079 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:56,079 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:37:56,080 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:56,080 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:56,080 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:56,080 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:37:56,080 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:37:56,080 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:37:56,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:37:56,081 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:37:56,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:37:56,081 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:37:56,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:37:56,081 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:37:56,082 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:37:56,082 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:37:56,082 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:37:56,082 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:56,083 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:37:56,083 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:56,083 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:56,083 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:56,083 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:37:56,084 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:37:56,084 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:37:56,084 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:37:56,088 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:37:56,089 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:56,090 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:56,090 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:56,091 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:56,092 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:56,092 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:56,092 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:56,101 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3812, Threshold=0.4430, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:37:56,101 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3812
2025-08-04 20:38:07,379 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:07,379 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:38:07,379 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:38:07,380 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:38:07,380 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:38:07,380 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:07,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:07,636 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:07,725 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:38:07,765 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:38:07,766 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:07,904 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:07,912 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:07,912 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:07,918 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:38:07,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:07,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:38:07,927 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:07,927 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:07,927 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:38:07,936 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:07,938 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:07,940 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:07,943 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:07,945 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:07,947 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:07,950 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:07,952 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:07,955 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:07,957 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:07,959 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:07,969 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:07,969 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:38:07,973 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:38:07,974 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:38:07,978 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:07,978 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:38:07,986 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:07,986 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:38:07,986 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:08,000 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:08,005 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:38:08,011 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:38:08,011 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:08,011 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:08,011 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:08,012 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:08,012 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:08,012 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:38:08,012 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:08,013 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:38:08,013 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:08,014 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:38:08,014 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:38:08,015 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:08,015 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:38:08,015 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:08,015 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:08,015 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:08,015 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:38:08,015 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:38:08,016 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:38:08,016 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:38:08,016 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:38:08,016 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:38:08,016 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:38:08,016 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:38:08,017 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:38:08,017 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:38:08,017 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:38:08,017 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:38:08,018 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:08,018 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:38:08,018 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:08,018 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:08,018 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:08,022 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:38:08,022 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:38:08,023 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:38:08,023 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:38:08,027 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:38:08,027 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:08,028 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:08,028 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:38:08,029 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:08,029 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:08,030 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:08,030 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:08,039 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3818, Threshold=0.4494, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:38:08,039 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3818
2025-08-04 20:38:22,335 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:22,335 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:38:22,335 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:38:22,335 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:38:22,336 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:38:22,336 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:22,627 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:22,627 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:22,723 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:38:22,754 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:38:22,755 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:22,863 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:22,869 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:22,869 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:22,876 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:38:22,885 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:22,885 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:38:22,886 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:22,886 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:22,886 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:38:22,895 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:22,898 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:22,900 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:22,903 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:22,905 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:22,907 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:22,910 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:22,912 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:22,915 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:22,917 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:22,919 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:22,928 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:22,928 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:38:22,933 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:38:22,933 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:38:22,938 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:22,938 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:38:22,947 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:22,947 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:38:22,947 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:22,963 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:22,968 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:38:22,973 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:38:22,973 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:22,973 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:22,973 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:22,974 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:22,974 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:22,974 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:38:22,974 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:22,974 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:38:22,975 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:22,976 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:38:22,976 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:38:22,976 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:22,976 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:38:22,976 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:22,977 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:22,977 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:22,977 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:38:22,977 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:38:22,977 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:38:22,977 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:38:22,977 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:38:22,977 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:38:22,978 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:38:22,978 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:38:22,978 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:38:22,980 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:38:22,980 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:38:22,981 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:38:22,981 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:22,981 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:38:22,981 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:22,981 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:22,982 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:22,982 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:38:22,982 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:38:22,982 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:38:22,983 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:38:22,988 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:38:22,988 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:22,989 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:22,989 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:38:22,990 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:22,990 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:22,991 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:22,991 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:22,999 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3792, Threshold=0.4488, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:38:22,999 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3792
2025-08-04 20:38:34,283 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:34,283 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:38:34,283 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:38:34,283 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:38:34,283 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:38:34,283 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:34,535 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:34,535 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:34,628 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:38:34,670 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:38:34,670 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:34,788 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:34,793 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:34,793 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:34,799 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:38:34,805 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:34,805 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:38:34,805 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:34,806 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:34,806 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:38:34,814 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:34,817 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:34,819 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:34,821 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:34,824 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:34,826 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:34,828 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:34,831 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:34,834 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:34,835 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:34,838 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:34,846 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:34,846 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:38:34,851 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:38:34,851 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:38:34,857 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:34,857 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:38:34,868 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:34,869 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:38:34,869 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:34,885 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:34,890 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:38:34,895 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:38:34,895 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:34,895 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:34,895 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:34,896 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:34,896 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:34,896 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:38:34,896 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:34,897 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:38:34,897 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:34,898 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:38:34,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:38:34,899 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:34,899 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:38:34,899 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:34,899 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:34,899 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:34,899 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:38:34,899 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:38:34,900 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:38:34,900 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:38:34,900 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:38:34,900 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:38:34,900 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:38:34,900 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:38:34,900 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:38:34,901 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:38:34,901 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:38:34,901 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:38:34,901 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:34,902 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:38:34,902 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:34,902 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:34,902 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:34,902 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:38:34,903 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:38:34,903 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:38:34,903 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:38:34,906 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:38:34,906 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:34,907 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:34,907 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:38:34,909 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:34,909 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:34,909 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:34,910 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:34,918 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3779, Threshold=0.4495, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:38:34,918 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3779
2025-08-04 20:38:46,182 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:46,182 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:38:46,182 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:38:46,182 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:38:46,183 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:38:46,183 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:46,430 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:46,431 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:46,514 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:38:46,543 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:38:46,543 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:46,665 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:46,672 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:46,673 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:46,679 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:38:46,696 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:46,696 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:38:46,696 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:46,697 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:46,697 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:38:46,705 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:46,708 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:46,710 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:46,712 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:46,715 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:46,717 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:46,719 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:46,722 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:46,724 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:46,726 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:46,729 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:46,738 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:46,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:38:46,743 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:38:46,743 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:38:46,748 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:46,748 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:38:46,757 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:46,757 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:38:46,757 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:46,772 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:46,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:38:46,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:38:46,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:46,781 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:46,781 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:46,782 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:46,782 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:46,782 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:38:46,782 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:46,783 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:38:46,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:46,784 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:38:46,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:38:46,785 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:46,785 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:38:46,785 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:46,785 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:46,785 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:46,785 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:38:46,785 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:38:46,786 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:38:46,786 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:38:46,786 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:38:46,786 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:38:46,786 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:38:46,786 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:38:46,787 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:38:46,787 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:38:46,787 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:38:46,787 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:38:46,787 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:46,787 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:38:46,788 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:46,788 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:46,788 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:46,788 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:38:46,789 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:38:46,789 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:38:46,789 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:38:46,794 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:38:46,794 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:46,795 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:46,796 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:38:46,797 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:46,797 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:46,797 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:46,798 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:46,806 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3787, Threshold=0.4516, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:38:46,807 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3787
2025-08-04 20:39:01,069 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:01,069 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:01,070 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:01,070 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:39:01,070 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:39:01,070 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:01,344 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:01,344 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:01,433 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:39:01,477 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:39:01,477 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:01,625 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:01,631 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:01,631 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:01,638 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:39:01,646 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:01,646 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:39:01,647 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:01,647 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:01,647 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:39:01,656 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:01,659 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:01,661 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:01,664 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:01,666 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:01,668 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:01,671 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:01,674 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:01,677 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:01,679 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:01,682 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:01,692 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:01,692 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:39:01,697 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:39:01,697 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:39:01,702 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:01,702 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:39:01,713 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:01,713 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:39:01,713 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:01,729 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:01,734 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:39:01,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:39:01,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:01,738 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:01,738 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:01,739 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:01,739 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:01,739 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:39:01,739 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:01,739 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:39:01,739 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:01,741 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:39:01,741 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:39:01,741 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:01,741 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:39:01,741 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:01,742 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:01,742 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:01,742 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:39:01,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:39:01,742 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:39:01,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:39:01,742 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:39:01,743 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:39:01,743 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:39:01,743 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:39:01,743 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:39:01,743 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:39:01,744 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:39:01,744 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:39:01,744 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:01,744 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:39:01,745 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:01,745 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:01,745 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:01,748 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:39:01,748 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:39:01,749 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:39:01,749 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:39:01,754 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:39:01,754 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:01,755 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:01,755 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:01,757 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:01,757 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:01,757 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:01,758 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:01,766 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3742, Threshold=0.4404, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:39:01,767 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3742
2025-08-04 20:39:07,026 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:07,026 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:07,026 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:07,026 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:39:07,026 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:39:07,026 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:07,300 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:07,300 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:07,382 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:39:07,407 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:39:07,407 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:07,503 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:07,508 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:07,508 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:07,513 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:39:07,521 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:07,521 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:39:07,522 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:07,522 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:07,522 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:39:07,532 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:07,535 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:07,537 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:07,539 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:07,542 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:07,544 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:07,547 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:07,549 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:07,552 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:07,554 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:07,556 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:07,566 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:07,566 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:39:07,571 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:39:07,571 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:39:07,577 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:07,577 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:39:07,585 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:07,586 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:39:07,586 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:07,600 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:07,605 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:39:07,609 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:39:07,609 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:07,610 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:07,610 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:07,610 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:07,610 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:07,610 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:39:07,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:07,611 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:39:07,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:07,612 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:39:07,612 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:39:07,613 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:07,613 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:39:07,613 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:07,613 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:07,613 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:07,613 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:39:07,613 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:39:07,614 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:39:07,614 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:39:07,614 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:39:07,614 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:39:07,614 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:39:07,614 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:39:07,615 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:39:07,615 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:39:07,615 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:39:07,615 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:39:07,615 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:07,615 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:39:07,616 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:07,616 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:07,616 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:07,619 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:39:07,620 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:39:07,620 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:39:07,620 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:39:07,623 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:39:07,623 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:07,625 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:07,625 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:07,626 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 80/400.
2025-08-04 20:39:07,727 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:07,727 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:07,728 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 39 anomalous samples to GAN training data (target: 39).
2025-08-04 20:39:07,729 - ClientAppLogger [Client 3] - INFO - [Client] Round 80: Training GAN with 169 samples (130 normal, 39 anomalous).
2025-08-04 20:39:07,729 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:07,872 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0830, Avg D Loss: 0.8460
2025-08-04 20:39:07,876 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0830, Avg D Loss: 0.8460
2025-08-04 20:39:07,876 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:07,884 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3966, Threshold=0.4671, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:39:07,884 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:39:07,885 - ClientAppLogger [Client 3] - INFO - Fit completed for round 80. Duration: 0.26s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 80, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.082990768675268, 'd_loss': 0.8459963291354432, 'post_fit_local_f1': 0.8125, 'fit_time_seconds': 0.25858497619628906, 'cpu_percent_fit': 12.2625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 169}
2025-08-04 20:39:07,885 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:39:16,152 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:16,152 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:16,152 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:16,152 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:39:16,152 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:39:16,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:16,490 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:16,490 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:16,593 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:39:16,639 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:39:16,639 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:16,762 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:16,770 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:16,770 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:16,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:39:16,790 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:16,791 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:39:16,791 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:16,792 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:16,792 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:39:16,802 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:16,805 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:16,808 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:16,811 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:16,814 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:16,816 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:16,818 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:16,821 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:16,824 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:16,826 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:16,828 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:16,838 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:16,838 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:39:16,843 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:39:16,843 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:39:16,848 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:16,848 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:39:16,857 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:16,858 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:39:16,858 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:16,874 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:16,879 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:39:16,886 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:39:16,886 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:16,887 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:16,887 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:16,887 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:16,888 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:16,888 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:39:16,888 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:16,888 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:39:16,888 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:16,890 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:39:16,890 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:39:16,890 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:16,890 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:39:16,891 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:16,891 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:16,891 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:16,891 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:39:16,891 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:39:16,891 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:39:16,892 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:39:16,892 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:39:16,892 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:39:16,892 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:39:16,892 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:39:16,892 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:39:16,893 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:39:16,893 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:39:16,893 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:39:16,893 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:16,893 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:39:16,894 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:16,894 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:16,894 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:16,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:39:16,898 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:39:16,898 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:39:16,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:39:16,905 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:39:16,905 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:16,906 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:16,910 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:16,912 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:16,912 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:16,912 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:16,913 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:16,923 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3992, Threshold=0.4676, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:39:16,923 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3992
2025-08-04 20:39:28,192 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:28,192 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:28,192 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:28,192 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:39:28,192 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:39:28,192 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:28,479 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:28,479 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:28,560 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:39:28,585 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:39:28,585 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:28,686 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:28,691 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:28,691 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:28,696 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:39:28,736 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:28,736 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:39:28,737 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:28,737 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:28,737 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:39:28,746 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:28,749 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:28,752 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:28,754 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:28,757 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:28,760 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:28,762 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:28,765 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:28,767 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:28,769 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:28,772 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:28,781 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:28,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:39:28,786 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:39:28,786 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:39:28,790 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:28,790 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:39:28,799 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:28,800 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:39:28,800 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:28,815 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:28,820 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:39:28,825 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:39:28,825 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:28,826 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:28,826 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:28,826 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:28,826 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:28,826 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:39:28,826 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:28,827 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:39:28,827 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:28,828 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:39:28,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:39:28,829 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:28,829 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:39:28,829 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:28,829 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:28,829 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:28,830 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:39:28,830 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:39:28,830 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:39:28,830 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:39:28,830 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:39:28,830 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:39:28,830 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:39:28,831 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:39:28,831 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:39:28,831 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:39:28,831 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:39:28,832 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:39:28,832 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:28,832 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:39:28,832 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:28,832 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:28,833 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:28,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:39:28,837 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:39:28,837 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:39:28,837 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:39:28,841 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:39:28,841 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:28,843 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:28,843 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:28,844 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:28,845 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:28,845 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:28,846 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:28,854 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3875, Threshold=0.4492, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:39:28,854 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3875
2025-08-04 20:39:40,127 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:40,127 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:40,127 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:40,128 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:39:40,128 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:39:40,128 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:40,401 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:40,401 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:40,488 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:39:40,530 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:39:40,530 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:40,647 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:40,654 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:40,654 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:40,660 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:39:40,665 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:40,665 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:39:40,666 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:40,666 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:40,666 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:39:40,674 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:40,677 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:40,679 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:40,681 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:40,684 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:40,686 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:40,689 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:40,691 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:40,694 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:40,696 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:40,698 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:40,707 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:40,707 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:39:40,712 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:39:40,712 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:39:40,716 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:40,716 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:39:40,727 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:40,727 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:39:40,728 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:40,745 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:40,750 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:39:40,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:39:40,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:40,758 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:40,758 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:40,759 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:40,759 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:40,760 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:39:40,760 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:40,760 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:39:40,760 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:40,762 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:39:40,762 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:39:40,762 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:40,762 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:39:40,763 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:40,763 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:40,763 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:40,763 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:39:40,763 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:39:40,763 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:39:40,763 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:39:40,764 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:39:40,764 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:39:40,764 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:39:40,765 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:39:40,765 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:39:40,765 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:39:40,765 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:39:40,766 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:39:40,766 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:40,766 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:39:40,766 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:40,766 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:40,767 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:40,771 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:39:40,771 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:39:40,771 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:39:40,771 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:39:40,774 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:39:40,775 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:40,776 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:40,776 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:40,778 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:40,778 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:40,778 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:40,779 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:40,787 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3763, Threshold=0.4312, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:39:40,787 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3763
2025-08-04 20:39:58,070 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:58,070 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:58,071 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:58,071 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:39:58,071 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:39:58,071 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:58,303 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:58,303 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:58,390 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:39:58,414 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:39:58,414 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:58,497 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:58,502 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:58,502 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:58,506 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:39:58,513 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:58,513 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:39:58,514 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:58,514 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:58,514 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:39:58,523 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:58,526 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:58,528 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:58,530 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:58,533 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:58,535 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:58,537 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:58,540 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:58,543 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:58,545 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:58,547 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:58,555 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:58,555 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:39:58,560 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:39:58,560 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:39:58,564 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:58,564 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:39:58,573 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:58,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:39:58,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:58,588 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:58,592 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:39:58,596 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:39:58,596 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:58,596 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:58,597 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:58,597 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:58,597 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:58,597 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:39:58,598 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:58,598 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:39:58,598 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:58,599 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:39:58,599 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:39:58,599 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:58,600 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:39:58,600 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:58,600 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:58,600 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:58,600 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:39:58,600 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:39:58,600 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:39:58,600 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:39:58,600 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:39:58,601 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:39:58,601 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:39:58,601 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:39:58,601 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:39:58,601 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:39:58,601 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:39:58,601 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:39:58,602 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:58,602 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:39:58,602 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:58,602 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:58,602 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:58,606 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:39:58,606 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:39:58,606 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:39:58,606 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:39:58,610 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:39:58,610 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:58,611 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:58,611 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:58,612 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:58,613 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:58,613 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:58,613 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:58,621 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4072, Threshold=0.4688, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:39:58,621 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4072
2025-08-04 20:40:03,898 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:03,898 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:03,898 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:03,898 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:40:03,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:40:03,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:04,161 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:04,161 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:04,248 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:40:04,286 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:40:04,286 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:04,398 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:04,404 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:04,404 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:04,410 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:40:04,415 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:04,415 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:40:04,416 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:04,416 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:04,416 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:40:04,425 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:04,428 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:04,430 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:04,433 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:04,435 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:04,438 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:04,440 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:04,443 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:04,445 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:04,447 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:04,450 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:04,458 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:04,458 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:40:04,464 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:40:04,464 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:40:04,468 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:04,468 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:40:04,476 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:04,477 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:40:04,477 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:04,491 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:04,496 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:40:04,501 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:40:04,501 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:04,501 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:04,502 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:04,502 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:04,502 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:04,502 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:40:04,503 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:04,503 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:40:04,503 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:04,505 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:40:04,505 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:40:04,505 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:04,505 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:40:04,506 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:04,506 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:04,506 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:04,506 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:40:04,506 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:40:04,506 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:40:04,506 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:40:04,507 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:40:04,507 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:40:04,507 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:40:04,507 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:40:04,507 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:40:04,508 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:40:04,508 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:40:04,508 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:40:04,508 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:04,508 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:40:04,509 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:04,509 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:04,509 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:04,509 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:40:04,509 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:40:04,510 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:40:04,510 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:40:04,513 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:40:04,514 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:04,515 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:04,515 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:04,517 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 84/400.
2025-08-04 20:40:04,618 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:04,618 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:04,619 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 40 anomalous samples to GAN training data (target: 40).
2025-08-04 20:40:04,620 - ClientAppLogger [Client 3] - INFO - [Client] Round 84: Training GAN with 174 samples (134 normal, 40 anomalous).
2025-08-04 20:40:04,620 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:04,762 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0818, Avg D Loss: 0.8322
2025-08-04 20:40:04,762 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0818, Avg D Loss: 0.8322
2025-08-04 20:40:04,762 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:04,770 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4001, Threshold=0.4676, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:40:04,770 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:40:04,771 - ClientAppLogger [Client 3] - INFO - Fit completed for round 84. Duration: 0.25s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 84, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.081844777896486, 'd_loss': 0.8322000611787554, 'post_fit_local_f1': 0.8125, 'fit_time_seconds': 0.2534935474395752, 'cpu_percent_fit': 12.25625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 174}
2025-08-04 20:40:04,771 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:40:13,056 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:13,056 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:13,056 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:13,057 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:40:13,057 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:40:13,057 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:13,314 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:13,315 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:13,397 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:40:13,420 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:40:13,421 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:13,512 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:13,518 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:13,518 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:13,524 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:40:13,531 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:13,531 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:40:13,532 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:13,532 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:13,532 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:40:13,541 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:13,544 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:13,546 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:13,548 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:13,550 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:13,552 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:13,555 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:13,557 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:13,560 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:13,562 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:13,564 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:13,574 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:13,574 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:40:13,579 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:40:13,579 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:40:13,584 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:13,584 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:40:13,597 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:13,597 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:40:13,597 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:13,614 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:13,619 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:40:13,624 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:40:13,624 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:13,624 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:13,624 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:13,624 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:13,625 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:13,625 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:40:13,625 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:13,625 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:40:13,625 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:13,626 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:40:13,627 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:40:13,627 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:13,627 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:40:13,627 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:13,627 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:13,627 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:13,627 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:40:13,628 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:40:13,628 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:40:13,628 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:40:13,628 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:40:13,628 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:40:13,628 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:40:13,628 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:40:13,629 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:40:13,629 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:40:13,629 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:40:13,630 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:40:13,630 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:13,630 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:40:13,630 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:13,630 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:13,631 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:13,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:40:13,634 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:40:13,634 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:40:13,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:40:13,638 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:40:13,638 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:13,640 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:13,640 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:13,641 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:13,641 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:13,641 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:13,642 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:13,650 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4095, Threshold=0.4717, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:40:13,650 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4095
2025-08-04 20:40:24,962 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:24,962 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:24,962 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:24,962 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:40:24,962 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:40:24,962 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:25,245 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:25,245 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:25,327 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:40:25,352 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:40:25,352 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:25,439 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:25,445 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:25,445 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:25,450 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:40:25,460 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:25,460 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:40:25,461 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:25,461 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:25,461 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:40:25,470 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:25,473 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:25,476 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:25,478 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:25,481 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:25,483 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:25,486 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:25,488 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:25,491 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:25,493 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:25,495 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:25,503 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:25,504 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:40:25,508 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:40:25,509 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:40:25,513 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:25,513 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:40:25,523 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:25,523 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:40:25,523 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:25,539 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:25,544 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:40:25,549 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:40:25,550 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:25,550 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:25,550 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:25,550 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:25,550 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:25,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:40:25,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:25,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:40:25,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:25,552 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:40:25,552 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:40:25,553 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:25,553 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:40:25,553 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:25,553 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:25,553 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:25,554 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:40:25,554 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:40:25,554 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:40:25,554 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:40:25,558 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:40:25,558 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:40:25,558 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:40:25,558 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:40:25,559 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:40:25,559 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:40:25,559 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:40:25,560 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:40:25,560 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:25,560 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:40:25,560 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:25,564 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:25,564 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:25,564 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:40:25,564 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:40:25,564 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:40:25,565 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:40:25,569 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:40:25,570 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:25,571 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:25,571 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:25,573 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:25,573 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:25,573 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:25,574 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:25,583 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3871, Threshold=0.4385, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:40:25,583 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3871
2025-08-04 20:40:39,948 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:39,949 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:39,950 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:39,950 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:40:39,950 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:40:39,950 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:40,331 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:40,331 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:40,450 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:40:40,505 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:40:40,505 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:40,618 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:40,623 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:40,623 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:40,628 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:40:40,633 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:40,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:40:40,634 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:40,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:40,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:40:40,643 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:40,646 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:40,648 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:40,650 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:40,653 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:40,655 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:40,657 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:40,660 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:40,663 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:40,665 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:40,667 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:40,676 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:40,676 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:40:40,681 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:40:40,681 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:40:40,685 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:40,686 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:40:40,694 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:40,694 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:40:40,694 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:40,709 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:40,713 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:40:40,718 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:40:40,718 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:40,718 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:40,719 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:40,719 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:40,719 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:40,719 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:40:40,719 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:40,720 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:40:40,720 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:40,721 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:40:40,721 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:40:40,721 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:40,722 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:40:40,722 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:40,722 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:40,722 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:40,722 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:40:40,722 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:40:40,722 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:40:40,722 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:40:40,722 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:40:40,723 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:40:40,723 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:40:40,723 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:40:40,723 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:40:40,723 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:40:40,724 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:40:40,724 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:40:40,724 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:40,724 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:40:40,725 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:40,725 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:40,725 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:40,725 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:40:40,725 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:40:40,726 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:40:40,726 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:40:40,729 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:40:40,729 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:40,731 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:40,731 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:40,732 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:40,732 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:40,732 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:40,733 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:40,741 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4189, Threshold=0.4853, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:40:40,741 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4189
2025-08-04 20:40:55,069 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:55,069 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:55,069 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:55,069 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:40:55,070 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:40:55,070 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:55,509 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:55,509 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:55,621 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:40:55,665 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:40:55,665 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:55,790 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:55,796 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:55,796 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:55,802 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:40:55,807 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:55,807 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:40:55,807 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:55,807 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:55,808 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:40:55,816 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:55,819 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:55,821 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:55,823 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:55,826 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:55,828 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:55,831 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:55,833 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:55,836 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:55,838 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:55,841 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:55,852 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:55,852 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:40:55,857 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:40:55,857 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:40:55,861 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:55,861 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:40:55,869 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:55,870 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:40:55,870 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:55,885 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:55,889 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:40:55,894 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:40:55,894 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:55,895 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:55,895 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:55,895 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:55,895 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:55,896 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:40:55,896 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:55,896 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:40:55,896 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:55,897 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:40:55,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:40:55,898 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:55,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:40:55,898 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:55,898 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:55,898 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:55,898 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:40:55,899 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:40:55,899 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:40:55,899 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:40:55,899 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:40:55,899 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:40:55,899 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:40:55,899 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:40:55,900 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:40:55,900 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:40:55,900 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:40:55,900 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:40:55,901 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:55,901 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:40:55,901 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:55,901 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:55,901 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:55,902 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:40:55,902 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:40:55,902 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:40:55,902 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:40:55,906 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:40:55,906 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:55,907 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:55,907 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:55,909 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:55,909 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:55,909 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:55,910 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:55,918 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4230, Threshold=0.4840, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:40:55,918 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4230
2025-08-04 20:41:10,199 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:10,200 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:10,200 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:10,200 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:41:10,200 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:41:10,200 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:10,538 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:10,539 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:10,638 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:41:10,669 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:41:10,669 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:10,781 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:10,787 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:10,787 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:10,792 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:41:10,800 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:10,803 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:41:10,803 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:10,803 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:10,803 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:41:10,813 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:10,816 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:10,819 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:10,821 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:10,823 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:10,825 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:10,828 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:10,830 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:10,833 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:10,835 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:10,837 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:10,847 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:10,847 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:41:10,852 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:41:10,852 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:41:10,857 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:10,857 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:41:10,866 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:10,866 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:41:10,867 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:10,881 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:10,885 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:41:10,892 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:41:10,894 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:10,894 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:10,894 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:10,895 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:10,895 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:10,895 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:41:10,896 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:10,896 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:41:10,896 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:10,898 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:41:10,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:41:10,899 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:10,900 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:41:10,900 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:10,900 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:10,900 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:10,900 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:41:10,901 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:41:10,901 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:41:10,901 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:41:10,901 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:41:10,901 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:41:10,902 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:41:10,902 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:41:10,902 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:41:10,902 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:41:10,903 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:41:10,903 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:41:10,903 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:10,903 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:41:10,904 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:10,904 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:10,904 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:10,904 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:41:10,904 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:41:10,905 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:41:10,905 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:41:10,908 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:41:10,908 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:10,909 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:10,910 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:10,911 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:10,911 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:10,911 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:10,912 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:10,921 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3914, Threshold=0.4395, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:41:10,921 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3914
2025-08-04 20:41:22,217 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:22,217 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:22,217 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:22,217 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:41:22,217 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:41:22,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:22,701 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:22,702 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:22,812 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:41:22,869 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:41:22,869 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:23,053 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:23,059 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:23,060 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:23,065 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:41:23,074 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:23,074 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:41:23,078 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:23,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:23,079 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:41:23,089 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:23,092 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:23,095 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:23,097 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:23,101 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:23,104 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:23,107 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:23,109 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:23,112 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:23,114 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:23,117 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:23,130 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:23,130 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:41:23,136 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:41:23,137 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:41:23,142 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:23,143 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:41:23,154 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:23,156 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:41:23,156 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:23,171 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:23,176 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:41:23,182 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:41:23,182 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:23,182 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:23,182 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:23,182 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:23,183 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:23,183 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:41:23,183 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:23,183 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:41:23,183 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:23,185 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:41:23,185 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:41:23,185 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:23,185 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:41:23,185 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:23,186 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:23,186 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:23,186 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:41:23,186 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:41:23,186 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:41:23,186 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:41:23,186 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:41:23,186 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:41:23,187 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:41:23,187 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:41:23,187 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:41:23,187 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:41:23,187 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:41:23,188 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:41:23,188 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:23,188 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:41:23,188 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:23,188 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:23,189 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:23,189 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:41:23,189 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:41:23,189 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:41:23,189 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:41:23,194 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:41:23,195 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:23,196 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:23,196 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:23,197 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:23,197 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:23,197 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:23,198 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:23,206 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3959, Threshold=0.4361, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:41:23,206 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3959
2025-08-04 20:41:34,485 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:34,485 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:34,485 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:34,485 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:41:34,485 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:41:34,486 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:35,025 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:35,025 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:35,120 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:41:35,179 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:41:35,180 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:35,344 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:35,355 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:35,355 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:35,363 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:41:35,374 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:35,375 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:41:35,376 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:35,376 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:35,376 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:41:35,389 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:35,393 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:35,395 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:35,398 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:35,401 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:35,404 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:35,407 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:35,409 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:35,412 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:35,415 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:35,417 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:35,430 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:35,430 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:41:35,436 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:41:35,436 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:41:35,442 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:35,442 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:41:35,453 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:35,453 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:41:35,453 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:35,470 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:35,477 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:41:35,486 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:41:35,487 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:35,487 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:35,487 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:35,488 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:35,488 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:35,488 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:41:35,488 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:35,489 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:41:35,489 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:35,491 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:41:35,492 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:41:35,492 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:35,492 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:41:35,492 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:35,493 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:35,493 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:35,493 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:41:35,493 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:41:35,493 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:41:35,493 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:41:35,494 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:41:35,494 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:41:35,494 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:41:35,495 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:41:35,495 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:41:35,495 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:41:35,496 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:41:35,496 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:41:35,496 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:35,496 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:41:35,497 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:35,497 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:35,498 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:35,498 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:41:35,498 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:41:35,498 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:41:35,499 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:41:35,505 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:41:35,506 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:35,508 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:35,508 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:35,510 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:35,510 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:35,510 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:35,511 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:35,521 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4392, Threshold=0.5024, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:41:35,522 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4392
2025-08-04 20:41:49,803 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:49,803 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:49,804 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:49,804 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:41:49,804 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:41:49,804 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:50,269 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:50,269 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:50,373 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:41:50,428 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:41:50,429 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:50,599 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:50,606 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:50,606 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:50,612 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:41:50,620 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:50,620 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:41:50,620 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:50,620 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:50,621 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:41:50,630 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:50,633 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:50,635 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:50,638 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:50,640 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:50,643 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:50,646 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:50,649 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:50,651 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:50,653 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:50,656 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:50,666 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:50,666 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:41:50,671 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:41:50,672 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:41:50,678 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:50,678 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:41:50,689 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:50,690 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:41:50,690 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:50,709 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:50,716 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:41:50,724 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:41:50,724 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:50,724 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:50,725 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:50,725 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:50,725 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:50,726 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:41:50,726 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:50,726 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:41:50,726 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:50,728 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:41:50,728 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:41:50,728 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:50,728 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:41:50,728 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:50,729 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:50,729 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:50,729 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:41:50,729 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:41:50,729 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:41:50,729 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:41:50,729 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:41:50,730 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:41:50,730 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:41:50,730 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:41:50,730 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:41:50,730 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:41:50,731 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:41:50,731 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:41:50,731 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:50,731 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:41:50,732 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:50,732 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:50,732 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:50,732 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:41:50,733 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:41:50,733 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:41:50,733 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:41:50,741 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:41:50,741 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:50,743 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:50,743 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:50,744 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:50,744 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:50,744 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:50,745 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:50,755 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4288, Threshold=0.4971, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:41:50,755 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4288
2025-08-04 20:42:02,010 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:02,010 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:42:02,010 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:42:02,010 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:42:02,010 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:42:02,010 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:02,289 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:02,289 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:02,373 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:42:02,411 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:42:02,411 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:02,532 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:02,539 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:02,539 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:02,545 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:42:02,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:02,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:42:02,551 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:02,552 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:02,552 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:42:02,560 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:02,563 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:02,565 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:02,567 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:02,570 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:02,572 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:02,574 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:02,577 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:02,580 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:02,581 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:02,584 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:02,595 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:02,595 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:42:02,600 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:42:02,600 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:42:02,606 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:02,606 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:42:02,618 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:02,618 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:42:02,619 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:02,635 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:02,641 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:42:02,647 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:42:02,648 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:02,648 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:02,648 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:02,648 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:02,648 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:02,649 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:42:02,649 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:02,649 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:42:02,649 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:02,650 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:42:02,651 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:42:02,651 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:02,651 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:42:02,651 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:02,651 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:02,651 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:02,652 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:42:02,652 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:42:02,652 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:42:02,652 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:42:02,652 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:42:02,652 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:42:02,653 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:42:02,653 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:42:02,653 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:42:02,654 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:42:02,654 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:42:02,654 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:42:02,654 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:02,655 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:42:02,655 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:02,655 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:02,656 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:02,656 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:42:02,656 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:42:02,656 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:42:02,656 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:42:02,660 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:42:02,661 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:02,662 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:02,662 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:42:02,664 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:02,664 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:02,664 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:02,665 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:02,673 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3935, Threshold=0.4465, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:42:02,673 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3935
2025-08-04 20:42:22,970 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:22,970 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:42:22,970 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:42:22,971 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:42:22,971 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:42:22,971 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:23,311 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:23,312 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:23,402 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:42:23,432 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:42:23,433 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:23,531 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:23,540 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:23,540 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:23,549 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:42:23,575 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:23,575 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:42:23,576 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:23,576 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:23,576 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:42:23,586 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:23,590 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:23,592 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:23,595 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:23,598 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:23,600 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:23,603 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:23,605 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:23,608 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:23,610 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:23,612 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:23,623 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:23,623 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:42:23,628 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:42:23,628 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:42:23,634 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:23,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:42:23,646 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:23,646 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:42:23,647 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:23,664 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:23,670 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:42:23,680 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:42:23,680 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:23,680 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:23,681 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:23,681 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:23,681 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:23,682 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:42:23,682 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:23,682 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:42:23,682 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:23,684 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:42:23,684 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:42:23,685 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:23,685 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:42:23,685 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:23,685 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:23,685 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:23,685 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:42:23,686 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:42:23,686 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:42:23,686 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:42:23,686 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:42:23,686 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:42:23,687 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:42:23,687 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:42:23,687 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:42:23,687 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:42:23,688 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:42:23,688 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:42:23,688 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:23,688 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:42:23,689 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:23,689 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:23,689 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:23,690 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:42:23,690 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:42:23,690 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:42:23,690 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:42:23,695 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:42:23,695 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:23,697 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:23,697 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:42:23,698 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:23,699 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:23,699 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:23,699 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:23,710 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4113, Threshold=0.4561, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:42:23,710 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4113
2025-08-04 20:42:38,003 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:38,003 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:42:38,003 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:42:38,003 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:42:38,003 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:42:38,003 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:38,490 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:38,490 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:38,583 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:42:38,613 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:42:38,613 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:38,751 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:38,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:38,759 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:38,767 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:42:38,782 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:38,782 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:42:38,783 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:38,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:38,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:42:38,793 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:38,796 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:38,799 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:38,801 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:38,804 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:38,807 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:38,810 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:38,812 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:38,815 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:38,818 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:38,821 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:38,833 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:38,833 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:42:38,838 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:42:38,838 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:42:38,845 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:38,845 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:42:38,857 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:38,858 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:42:38,858 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:38,875 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:38,882 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:42:38,890 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:42:38,890 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:38,890 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:38,890 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:38,891 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:38,891 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:38,891 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:42:38,891 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:38,892 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:42:38,892 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:38,893 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:42:38,894 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:42:38,894 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:38,894 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:42:38,894 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:38,895 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:38,895 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:38,895 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:42:38,895 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:42:38,895 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:42:38,895 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:42:38,896 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:42:38,896 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:42:38,897 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:42:38,897 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:42:38,897 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:42:38,897 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:42:38,898 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:42:38,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:42:38,898 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:38,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:42:38,919 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:38,919 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:38,919 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:38,919 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:42:38,920 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:42:38,920 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:42:38,920 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:42:38,928 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:42:38,929 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:38,936 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:38,936 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:42:38,940 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:38,940 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:38,941 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:38,942 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:38,955 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3878, Threshold=0.4249, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:42:38,955 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3878
2025-08-04 20:42:56,231 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:56,231 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:42:56,231 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:42:56,232 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:42:56,232 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:42:56,232 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:56,648 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:56,648 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:56,741 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:42:56,790 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:42:56,791 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:56,944 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:56,954 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:56,955 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:56,964 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:42:56,978 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:56,978 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:42:56,979 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:56,979 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:56,979 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:42:56,990 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:56,994 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:56,997 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:57,000 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:57,003 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:57,006 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:57,009 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:57,013 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:57,017 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:57,020 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:57,023 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:57,035 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:57,035 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:42:57,040 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:42:57,040 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:42:57,046 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:57,046 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:42:57,056 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:57,056 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:42:57,056 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:57,075 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:57,080 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:42:57,087 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:42:57,088 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:57,088 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:57,089 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:57,089 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:57,089 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:57,089 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:42:57,090 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:57,090 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:42:57,090 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:57,091 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:42:57,092 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:42:57,092 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:57,092 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:42:57,092 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:57,092 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:57,093 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:57,093 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:42:57,093 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:42:57,093 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:42:57,093 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:42:57,093 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:42:57,094 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:42:57,094 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:42:57,094 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:42:57,094 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:42:57,094 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:42:57,095 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:42:57,095 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:42:57,095 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:57,095 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:42:57,096 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:57,096 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:57,096 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:57,096 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:42:57,097 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:42:57,097 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:42:57,097 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:42:57,103 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:42:57,103 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:57,105 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:57,105 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:42:57,107 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:57,107 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:57,107 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:57,108 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:57,120 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4071, Threshold=0.4360, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:42:57,120 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4071
2025-08-04 20:43:08,386 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:08,386 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:08,386 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:08,386 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:43:08,386 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:43:08,387 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:08,775 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:08,775 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:08,871 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:43:08,914 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:43:08,914 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:09,053 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:09,061 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:09,061 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:09,071 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:43:09,079 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:09,079 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:43:09,080 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:09,080 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:09,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:43:09,093 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:09,096 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:09,101 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:09,105 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:09,109 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:09,113 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:09,116 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:09,119 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:09,122 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:09,125 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:09,128 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:09,141 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:09,141 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:43:09,148 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:43:09,148 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:43:09,155 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:09,155 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:43:09,170 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:09,171 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:43:09,171 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:09,191 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:09,198 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:43:09,207 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:43:09,207 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:09,207 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:09,208 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:09,208 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:09,208 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:09,208 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:43:09,209 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:09,209 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:43:09,209 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:09,210 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:43:09,210 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:43:09,211 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:09,211 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:43:09,211 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:09,211 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:09,211 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:09,211 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:43:09,211 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:43:09,212 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:43:09,212 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:43:09,212 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:43:09,212 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:43:09,213 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:43:09,213 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:43:09,213 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:43:09,213 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:43:09,213 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:43:09,214 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:43:09,214 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:09,214 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:43:09,214 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:09,214 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:09,215 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:09,215 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:43:09,215 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:43:09,215 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:43:09,215 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:43:09,219 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:43:09,219 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:09,221 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:09,221 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:09,223 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:09,223 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:09,223 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:09,224 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:09,233 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4409, Threshold=0.4769, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:43:09,233 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4409
2025-08-04 20:43:26,523 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:26,524 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:26,524 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:26,524 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:43:26,524 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:43:26,524 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:26,893 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:26,893 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:26,986 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:43:27,014 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:43:27,014 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:27,112 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:27,118 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:27,119 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:27,124 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:43:27,131 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:27,131 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:43:27,131 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:27,131 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:27,131 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:43:27,140 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:27,143 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:27,145 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:27,147 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:27,150 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:27,152 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:27,154 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:27,157 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:27,160 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:27,162 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:27,164 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:27,173 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:27,173 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:43:27,177 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:43:27,178 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:43:27,182 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:27,182 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:43:27,190 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:27,191 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:43:27,191 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:27,205 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:27,210 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:43:27,214 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:43:27,214 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:27,214 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:27,214 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:27,215 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:27,215 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:27,215 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:43:27,215 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:27,215 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:43:27,216 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:27,217 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:43:27,217 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:43:27,217 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:27,217 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:43:27,218 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:27,218 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:27,218 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:27,218 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:43:27,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:43:27,218 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:43:27,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:43:27,218 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:43:27,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:43:27,219 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:43:27,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:43:27,219 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:43:27,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:43:27,220 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:43:27,220 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:43:27,220 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:27,220 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:43:27,220 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:27,220 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:27,221 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:27,221 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:43:27,221 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:43:27,221 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:43:27,221 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:43:27,225 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:43:27,225 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:27,226 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:27,226 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:27,228 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:27,228 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:27,228 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:27,229 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:27,237 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4120, Threshold=0.4414, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:43:27,237 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4120
2025-08-04 20:43:44,518 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:44,518 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:44,518 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:44,518 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:43:44,518 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:43:44,518 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:44,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:44,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:44,878 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:43:44,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:43:44,926 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:45,059 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:45,066 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:45,066 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:45,071 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:43:45,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:45,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:43:45,078 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:45,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:45,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:43:45,087 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:45,090 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:45,092 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:45,094 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:45,097 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:45,099 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:45,102 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:45,104 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:45,107 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:45,109 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:45,111 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:45,122 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:45,122 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:43:45,127 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:43:45,127 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:43:45,132 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:45,133 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:43:45,145 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:45,145 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:43:45,146 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:45,160 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:45,164 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:43:45,169 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:43:45,170 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:45,170 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:45,170 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:45,170 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:45,170 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:45,170 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:43:45,171 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:45,171 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:43:45,171 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:45,172 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:43:45,172 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:43:45,173 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:45,173 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:43:45,173 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:45,173 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:45,173 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:45,173 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:43:45,173 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:43:45,174 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:43:45,174 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:43:45,174 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:43:45,174 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:43:45,174 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:43:45,174 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:43:45,174 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:43:45,175 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:43:45,175 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:43:45,175 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:43:45,175 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:45,175 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:43:45,176 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:45,176 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:45,176 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:45,176 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:43:45,176 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:43:45,177 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:43:45,177 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:43:45,180 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:43:45,180 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:45,182 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:45,182 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:45,183 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:45,183 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:45,184 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:45,184 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:45,192 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4490, Threshold=0.4764, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:43:45,193 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4490
2025-08-04 20:43:59,479 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:59,479 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:59,479 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:59,479 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:43:59,479 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:43:59,479 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:59,896 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:59,896 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:59,996 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:44:00,022 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:44:00,023 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:00,120 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:00,127 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:00,127 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:00,134 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:44:00,141 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:00,141 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:44:00,142 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:00,142 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:00,142 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:44:00,151 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:00,154 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:00,156 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:00,158 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:00,161 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:00,163 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:00,165 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:00,168 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:00,170 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:00,172 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:00,174 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:00,184 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:00,184 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:44:00,189 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:44:00,189 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:44:00,194 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:00,194 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:44:00,203 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:00,203 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:44:00,204 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:00,220 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:00,224 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:44:00,230 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:44:00,230 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:00,230 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:00,230 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:00,231 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:00,231 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:00,231 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:44:00,231 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:00,232 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:44:00,232 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:00,233 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:44:00,233 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:44:00,234 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:00,234 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:44:00,234 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:00,234 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:00,234 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:00,235 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:44:00,235 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:44:00,235 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:44:00,235 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:44:00,235 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:44:00,236 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:44:00,236 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:44:00,236 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:44:00,236 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:44:00,236 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:44:00,237 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:44:00,237 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:44:00,237 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:00,237 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:44:00,237 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:00,238 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:00,238 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:00,238 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:44:00,238 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:44:00,238 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:44:00,239 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:44:00,242 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:44:00,243 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:00,244 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:00,244 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:00,246 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:00,246 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:00,246 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:00,247 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:00,255 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.3859, Threshold=0.3947, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:44:00,255 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.3859
2025-08-04 20:44:11,557 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:11,558 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:44:11,558 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:44:11,558 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:44:11,558 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:44:11,558 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:12,025 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:12,026 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:12,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:44:12,198 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:44:12,198 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:12,332 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:12,339 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:12,339 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:12,346 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:44:12,352 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:12,353 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:44:12,353 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:12,353 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:12,354 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:44:12,362 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:12,365 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:12,368 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:12,370 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:12,373 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:12,375 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:12,378 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:12,380 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:12,383 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:12,385 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:12,387 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:12,399 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:12,399 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:44:12,404 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:44:12,404 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:44:12,410 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:12,410 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:44:12,421 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:12,421 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:44:12,421 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:12,439 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:12,445 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:44:12,452 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:44:12,452 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:12,452 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:12,453 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:12,453 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:12,453 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:12,453 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:44:12,453 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:12,454 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:44:12,454 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:12,455 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:44:12,455 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:44:12,456 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:12,456 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:44:12,456 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:12,456 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:12,456 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:12,457 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:44:12,457 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:44:12,457 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:44:12,457 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:44:12,457 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:44:12,457 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:44:12,457 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:44:12,458 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:44:12,458 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:44:12,458 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:44:12,458 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:44:12,458 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:44:12,459 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:12,459 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:44:12,459 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:12,459 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:12,460 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:12,460 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:44:12,460 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:44:12,460 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:44:12,460 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:44:12,464 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:44:12,464 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:12,465 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:12,465 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:12,466 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:12,466 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:12,466 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:12,467 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:12,476 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4080, Threshold=0.4214, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:44:12,476 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4080
2025-08-04 20:44:32,762 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:32,762 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:44:32,762 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:44:32,762 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:44:32,763 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:44:32,763 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:33,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:33,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:33,179 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:44:33,207 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:44:33,210 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:33,310 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:33,318 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:33,318 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:33,324 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:44:33,333 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:33,334 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:44:33,334 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:33,334 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:33,335 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:44:33,344 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:33,347 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:33,349 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:33,352 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:33,354 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:33,357 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:33,360 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:33,362 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:33,365 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:33,367 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:33,369 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:33,379 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:33,380 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:44:33,384 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:44:33,385 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:44:33,390 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:33,390 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:44:33,399 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:33,399 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:44:33,399 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:33,416 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:33,422 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:44:33,429 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:44:33,430 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:33,430 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:33,430 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:33,430 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:33,431 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:33,431 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:44:33,431 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:33,431 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:44:33,431 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:33,433 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:44:33,433 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:44:33,433 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:33,433 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:44:33,434 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:33,434 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:33,434 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:33,434 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:44:33,434 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:44:33,435 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:44:33,435 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:44:33,435 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:44:33,435 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:44:33,435 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:44:33,436 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:44:33,436 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:44:33,436 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:44:33,436 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:44:33,437 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:44:33,437 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:33,437 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:44:33,437 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:33,437 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:33,438 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:33,438 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:44:33,438 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:44:33,438 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:44:33,438 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:44:33,443 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:44:33,443 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:33,444 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:33,445 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:33,446 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:33,446 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:33,446 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:33,447 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:33,456 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4190, Threshold=0.4303, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:44:33,456 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4190
2025-08-04 20:44:50,741 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:50,741 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:44:50,741 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:44:50,741 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:44:50,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:44:50,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:51,144 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:51,145 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:51,261 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:44:51,310 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:44:51,310 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:51,450 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:51,460 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:51,460 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:51,466 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:44:51,473 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:51,473 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:44:51,474 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:51,474 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:51,474 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:44:51,485 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:51,488 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:51,490 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:51,493 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:51,496 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:51,498 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:51,501 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:51,503 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:51,506 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:51,508 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:51,511 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:51,522 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:51,522 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:44:51,527 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:44:51,527 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:44:51,533 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:51,533 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:44:51,543 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:51,544 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:44:51,544 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:51,560 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:51,565 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:44:51,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:44:51,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:51,573 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:51,574 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:51,574 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:51,575 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:51,575 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:44:51,575 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:51,576 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:44:51,576 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:51,577 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:44:51,577 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:44:51,578 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:51,578 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:44:51,578 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:51,578 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:51,578 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:51,579 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:44:51,579 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:44:51,579 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:44:51,579 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:44:51,579 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:44:51,580 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:44:51,580 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:44:51,580 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:44:51,580 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:44:51,580 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:44:51,581 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:44:51,581 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:44:51,581 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:51,581 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:44:51,582 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:51,582 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:51,582 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:51,582 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:44:51,582 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:44:51,583 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:44:51,583 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:44:51,587 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:44:51,588 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:51,589 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:51,589 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:51,591 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:51,591 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:51,591 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:51,592 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:51,602 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4402, Threshold=0.4625, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:44:51,602 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4402
2025-08-04 20:45:11,902 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:11,902 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:11,902 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:11,902 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:45:11,903 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:45:11,903 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:12,241 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:12,241 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:12,332 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:45:12,363 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:45:12,363 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:12,476 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:12,484 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:12,484 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:12,491 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:45:12,503 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:12,503 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:45:12,504 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:12,504 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:12,504 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:45:12,515 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:12,518 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:12,521 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:12,523 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:12,526 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:12,528 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:12,531 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:12,533 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:12,536 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:12,538 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:12,541 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:12,551 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:12,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:45:12,556 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:45:12,556 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:45:12,561 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:12,561 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:45:12,572 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:12,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:45:12,573 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:12,589 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:12,595 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:45:12,604 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:45:12,604 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:12,604 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:12,604 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:12,605 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:12,605 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:12,605 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:45:12,605 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:12,605 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:45:12,606 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:12,607 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:45:12,607 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:45:12,607 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:12,608 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:45:12,608 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:12,608 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:12,608 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:12,608 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:45:12,609 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:45:12,609 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:45:12,609 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:45:12,609 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:45:12,609 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:45:12,610 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:45:12,610 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:45:12,610 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:45:12,610 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:45:12,611 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:45:12,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:45:12,611 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:12,614 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:45:12,616 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:12,618 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:12,621 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:12,623 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:45:12,626 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:45:12,626 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:45:12,626 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:45:12,631 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:45:12,632 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:12,635 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:12,636 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:12,641 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:12,641 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:12,641 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:12,642 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:12,652 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4578, Threshold=0.4919, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:45:12,652 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4578
2025-08-04 20:45:20,915 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:20,916 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:20,916 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:20,916 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:45:20,916 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:45:20,916 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:21,149 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:21,149 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:21,238 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:45:21,280 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:45:21,280 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:21,390 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:21,397 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:21,397 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:21,402 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:45:21,408 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:21,408 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:45:21,408 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:21,409 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:21,409 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:45:21,417 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:21,420 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:21,422 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:21,424 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:21,427 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:21,430 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:21,432 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:21,435 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:21,438 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:21,440 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:21,442 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:21,451 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:21,451 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:45:21,455 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:45:21,456 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:45:21,460 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:21,460 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:45:21,468 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:21,468 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:45:21,468 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:21,484 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:21,489 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:45:21,493 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:45:21,494 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:21,494 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:21,494 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:21,494 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:21,495 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:21,495 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:45:21,495 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:21,495 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:45:21,495 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:21,497 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:45:21,497 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:45:21,497 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:21,497 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:45:21,498 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:21,498 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:21,498 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:21,498 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:45:21,498 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:45:21,498 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:45:21,499 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:45:21,499 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:45:21,499 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:45:21,499 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:45:21,499 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:45:21,499 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:45:21,499 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:45:21,500 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:45:21,500 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:45:21,500 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:21,500 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:45:21,501 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:21,501 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:21,501 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:21,501 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:45:21,501 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:45:21,502 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:45:21,502 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:45:21,505 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:45:21,505 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:21,506 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:21,507 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:21,508 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 104/400.
2025-08-04 20:45:21,609 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:21,609 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:21,611 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 48 anomalous samples to GAN training data (target: 48).
2025-08-04 20:45:21,611 - ClientAppLogger [Client 3] - INFO - [Client] Round 104: Training GAN with 211 samples (163 normal, 48 anomalous).
2025-08-04 20:45:21,611 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:21,780 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0836, Avg D Loss: 0.7871
2025-08-04 20:45:21,780 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0836, Avg D Loss: 0.7871
2025-08-04 20:45:21,780 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:21,788 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4979, Threshold=0.5493, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:45:21,788 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:45:21,789 - ClientAppLogger [Client 3] - INFO - Fit completed for round 104. Duration: 0.28s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 104, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0835751430683227, 'd_loss': 0.7870584911079768, 'post_fit_local_f1': 0.8125, 'fit_time_seconds': 0.28039121627807617, 'cpu_percent_fit': 12.18125, 'ram_mb_fit': 3.5703125, 'accumulated_train_samples_this_round': 211}
2025-08-04 20:45:21,789 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:45:33,057 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:33,057 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:33,057 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:33,058 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:45:33,058 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:45:33,058 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:33,400 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:33,400 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:33,489 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:45:33,519 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:45:33,519 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:33,667 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:33,675 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:33,675 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:33,683 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:45:33,696 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:33,697 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:45:33,697 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:33,697 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:33,698 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:45:33,709 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:33,712 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:33,714 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:33,717 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:33,720 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:33,722 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:33,725 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:33,728 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:33,730 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:33,733 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:33,736 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:33,746 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:33,746 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:45:33,751 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:45:33,751 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:45:33,757 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:33,757 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:45:33,769 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:33,770 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:45:33,770 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:33,787 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:33,792 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:45:33,796 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:45:33,796 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:33,797 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:33,797 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:33,797 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:33,797 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:33,797 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:45:33,798 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:33,798 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:45:33,798 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:33,799 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:45:33,799 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:45:33,799 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:33,800 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:45:33,800 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:33,800 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:33,800 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:33,800 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:45:33,800 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:45:33,800 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:45:33,800 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:45:33,800 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:45:33,801 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:45:33,801 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:45:33,801 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:45:33,801 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:45:33,801 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:45:33,801 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:45:33,802 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:45:33,802 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:33,802 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:45:33,802 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:33,802 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:33,803 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:33,803 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:45:33,803 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:45:33,803 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:45:33,803 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:45:33,809 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:45:33,809 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:33,811 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:33,811 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:33,812 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:33,812 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:33,812 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:33,813 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:33,821 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4898, Threshold=0.5294, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:45:33,821 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4898
2025-08-04 20:45:39,077 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:39,077 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:39,078 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:39,078 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:45:39,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:45:39,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:39,400 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:39,400 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:39,488 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:45:39,518 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:45:39,518 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:39,643 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:39,652 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:39,652 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:39,658 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:45:39,665 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:39,665 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:45:39,666 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:39,666 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:39,666 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:45:39,675 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:39,678 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:39,681 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:39,683 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:39,686 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:39,688 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:39,690 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:39,693 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:39,696 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:39,698 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:39,701 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:39,716 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:39,716 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:45:39,721 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:45:39,721 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:45:39,729 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:39,729 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:45:39,743 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:39,743 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:45:39,743 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:39,765 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:39,771 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:45:39,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:45:39,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:39,778 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:39,778 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:39,778 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:39,778 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:39,779 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:45:39,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:39,779 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:45:39,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:39,781 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:45:39,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:45:39,781 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:39,782 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:45:39,782 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:39,782 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:39,782 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:39,782 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:45:39,782 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:45:39,783 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:45:39,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:45:39,783 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:45:39,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:45:39,783 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:45:39,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:45:39,784 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:45:39,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:45:39,784 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:45:39,785 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:45:39,785 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:39,785 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:45:39,785 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:39,785 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:39,786 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:39,786 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:45:39,786 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:45:39,786 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:45:39,786 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:45:39,790 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:45:39,791 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:39,792 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:39,793 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:39,794 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 105/400.
2025-08-04 20:45:39,895 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:39,896 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:39,897 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 49 anomalous samples to GAN training data (target: 49).
2025-08-04 20:45:39,897 - ClientAppLogger [Client 3] - INFO - [Client] Round 105: Training GAN with 214 samples (165 normal, 49 anomalous).
2025-08-04 20:45:39,897 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:40,070 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.7854
2025-08-04 20:45:40,070 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.7854
2025-08-04 20:45:40,071 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:40,079 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5021, Threshold=0.5619, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:45:40,079 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:45:40,080 - ClientAppLogger [Client 3] - INFO - Fit completed for round 105. Duration: 0.29s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 105, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.083215250701548, 'd_loss': 0.7854199734246621, 'post_fit_local_f1': 0.8125, 'fit_time_seconds': 0.2852182388305664, 'cpu_percent_fit': 12.20625, 'ram_mb_fit': 0.140625, 'accumulated_train_samples_this_round': 214}
2025-08-04 20:45:40,080 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:45:45,333 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:45,334 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:45,334 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:45,334 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:45:45,334 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:45:45,334 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:45,637 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:45,637 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:45,727 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:45:45,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:45:45,759 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:45,895 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:45,905 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:45,905 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:45,915 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:45:45,945 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:45,946 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:45:45,946 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:45,946 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:45,947 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:45:45,956 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:45,960 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:45,962 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:45,964 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:45,967 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:45,969 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:45,972 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:45,975 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:45,978 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:45,980 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:45,982 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:45,997 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:45,997 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:45:46,003 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:45:46,003 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:45:46,024 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:46,024 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:45:46,043 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:46,044 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:45:46,044 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:46,065 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:46,071 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:45:46,080 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:45:46,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:46,081 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:46,081 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:46,081 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:46,082 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:46,082 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:45:46,082 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:46,083 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:45:46,083 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:46,085 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:45:46,085 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:45:46,086 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:46,086 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:45:46,086 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:46,086 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:46,086 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:46,086 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:45:46,087 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:45:46,087 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:45:46,087 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:45:46,087 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:45:46,087 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:45:46,088 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:45:46,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:45:46,089 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:45:46,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:45:46,090 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:45:46,091 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:45:46,091 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:46,091 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:45:46,092 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:46,092 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:46,092 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:46,093 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:45:46,093 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:45:46,093 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:45:46,093 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:45:46,104 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:45:46,104 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:46,107 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:46,107 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:46,109 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:46,109 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:46,110 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:46,111 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:46,122 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5017, Threshold=0.5661, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:45:46,123 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5017
2025-08-04 20:46:00,406 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:00,406 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:00,406 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:00,406 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:46:00,406 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:46:00,407 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:00,676 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:00,676 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:00,764 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:46:00,806 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:46:00,806 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:00,914 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:00,920 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:00,920 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:00,924 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:46:00,929 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:00,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:46:00,930 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:00,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:00,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:46:00,938 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:00,941 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:00,943 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:00,946 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:00,948 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:00,950 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:00,953 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:00,955 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:00,958 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:00,960 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:00,962 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:00,970 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:00,970 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:46:00,975 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:46:00,975 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:46:00,979 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:00,980 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:46:00,988 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:00,988 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:46:00,988 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:01,002 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:01,007 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:46:01,013 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:46:01,013 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:01,013 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:01,013 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:01,013 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:01,014 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:01,014 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:46:01,014 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:01,015 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:46:01,015 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:01,016 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:46:01,016 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:46:01,016 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:01,017 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:46:01,017 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:01,017 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:01,017 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:01,017 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:46:01,017 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:46:01,018 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:46:01,018 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:46:01,018 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:46:01,018 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:46:01,018 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:46:01,019 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:46:01,019 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:46:01,019 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:46:01,019 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:46:01,019 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:46:01,019 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:01,019 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:46:01,020 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:01,020 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:01,020 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:01,020 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:46:01,020 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:46:01,021 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:46:01,021 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:46:01,027 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:46:01,027 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:01,028 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:01,028 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:01,030 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:01,030 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:01,030 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:01,030 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:01,038 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4585, Threshold=0.5021, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:46:01,039 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4585
2025-08-04 20:46:15,321 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:15,321 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:15,321 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:15,321 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:46:15,321 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:46:15,322 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:15,527 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:15,527 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:15,613 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:46:15,639 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:46:15,639 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:15,730 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:15,735 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:15,735 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:15,739 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:46:15,745 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:15,745 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:46:15,746 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:15,746 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:15,746 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:46:15,755 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:15,758 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:15,760 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:15,763 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:15,765 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:15,768 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:15,770 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:15,772 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:15,775 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:15,777 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:15,780 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:15,788 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:15,788 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:46:15,793 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:46:15,793 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:46:15,797 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:15,798 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:46:15,806 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:15,807 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:46:15,807 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:15,821 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:15,825 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:46:15,830 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:46:15,830 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:15,830 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:15,831 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:15,831 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:15,832 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:15,832 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:46:15,832 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:15,832 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:46:15,832 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:15,834 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:46:15,834 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:46:15,834 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:15,834 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:46:15,835 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:15,835 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:15,835 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:15,835 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:46:15,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:46:15,835 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:46:15,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:46:15,836 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:46:15,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:46:15,836 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:46:15,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:46:15,836 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:46:15,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:46:15,837 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:46:15,837 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:46:15,837 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:15,837 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:46:15,837 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:15,838 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:15,838 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:15,838 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:46:15,838 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:46:15,838 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:46:15,838 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:46:15,842 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:46:15,843 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:15,844 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:15,844 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:15,845 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:15,845 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:15,845 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:15,846 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:15,854 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4638, Threshold=0.5085, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:46:15,854 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4638
2025-08-04 20:46:21,105 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:21,105 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:21,106 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:21,106 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:46:21,106 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:46:21,106 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:21,385 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:21,385 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:21,478 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:46:21,521 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:46:21,521 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:21,632 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:21,638 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:21,639 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:21,644 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:46:21,650 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:21,650 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:46:21,651 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:21,651 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:21,651 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:46:21,659 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:21,662 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:21,664 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:21,667 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:21,670 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:21,672 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:21,675 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:21,677 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:21,680 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:21,682 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:21,684 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:21,693 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:21,693 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:46:21,698 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:46:21,698 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:46:21,702 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:21,702 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:46:21,711 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:21,711 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:46:21,711 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:21,726 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:21,731 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:46:21,737 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:46:21,737 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:21,737 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:21,737 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:21,737 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:21,738 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:21,738 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:46:21,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:21,738 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:46:21,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:21,740 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:46:21,740 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:46:21,740 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:21,740 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:46:21,741 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:21,741 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:21,741 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:21,741 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:46:21,741 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:46:21,741 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:46:21,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:46:21,742 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:46:21,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:46:21,742 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:46:21,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:46:21,742 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:46:21,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:46:21,743 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:46:21,743 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:46:21,743 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:21,743 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:46:21,744 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:21,744 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:21,744 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:21,744 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:46:21,744 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:46:21,744 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:46:21,745 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:46:21,748 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:46:21,748 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:21,750 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:21,750 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:21,751 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 108/400.
2025-08-04 20:46:21,853 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:21,853 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:21,854 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 50 anomalous samples to GAN training data (target: 50).
2025-08-04 20:46:21,854 - ClientAppLogger [Client 3] - INFO - [Client] Round 108: Training GAN with 219 samples (169 normal, 50 anomalous).
2025-08-04 20:46:21,854 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:22,023 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0826, Avg D Loss: 0.7872
2025-08-04 20:46:22,023 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0826, Avg D Loss: 0.7872
2025-08-04 20:46:22,023 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:22,031 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5101, Threshold=0.5631, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:46:22,031 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:46:22,031 - ClientAppLogger [Client 3] - INFO - Fit completed for round 108. Duration: 0.28s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 108, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0825533675276526, 'd_loss': 0.7871662219909773, 'post_fit_local_f1': 0.8125, 'fit_time_seconds': 0.27991795539855957, 'cpu_percent_fit': 12.2375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 219}
2025-08-04 20:46:22,032 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:46:30,303 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:30,303 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:30,303 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:30,304 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:46:30,304 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:46:30,304 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:30,579 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:30,579 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:30,668 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:46:30,698 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:46:30,698 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:30,824 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:30,833 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:30,833 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:30,840 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:46:30,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:30,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:46:30,861 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:30,861 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:30,861 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:46:30,870 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:30,874 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:30,876 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:30,878 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:30,881 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:30,883 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:30,886 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:30,889 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:30,892 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:30,894 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:30,896 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:30,907 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:30,907 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:46:30,912 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:46:30,912 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:46:30,918 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:30,918 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:46:30,935 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:30,938 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:46:30,938 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:30,955 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:30,960 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:46:30,968 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:46:30,969 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:30,969 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:30,969 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:30,969 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:30,969 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:30,970 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:46:30,970 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:30,970 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:46:30,970 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:30,971 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:46:30,971 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:46:30,972 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:30,972 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:46:30,972 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:30,972 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:30,972 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:30,972 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:46:30,973 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:46:30,973 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:46:30,973 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:46:30,973 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:46:30,973 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:46:30,974 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:46:30,974 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:46:30,974 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:46:30,974 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:46:30,975 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:46:30,975 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:46:30,975 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:30,975 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:46:30,975 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:30,976 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:30,976 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:30,976 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:46:30,976 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:46:30,976 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:46:30,976 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:46:30,983 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:46:30,983 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:30,984 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:30,984 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:30,986 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:30,986 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:30,986 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:30,987 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:30,994 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4834, Threshold=0.5382, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:46:30,995 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4834
2025-08-04 20:46:45,263 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:45,263 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:45,263 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:45,263 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:46:45,264 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:46:45,264 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:45,543 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:45,543 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:45,630 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:46:45,671 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:46:45,671 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:45,811 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:45,819 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:45,819 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:45,825 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:46:45,832 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:45,832 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:46:45,832 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:45,833 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:45,833 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:46:45,841 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:45,844 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:45,847 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:45,849 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:45,851 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:45,854 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:45,856 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:45,859 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:45,862 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:45,864 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:45,866 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:45,878 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:45,879 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:46:45,883 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:46:45,884 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:46:45,890 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:45,890 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:46:45,906 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:45,907 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:46:45,907 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:45,923 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:45,928 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:46:45,936 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:46:45,936 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:45,936 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:45,936 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:45,937 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:45,937 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:45,937 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:46:45,937 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:45,938 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:46:45,938 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:45,939 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:46:45,939 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:46:45,940 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:45,940 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:46:45,940 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:45,940 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:45,940 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:45,940 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:46:45,941 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:46:45,941 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:46:45,941 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:46:45,941 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:46:45,941 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:46:45,942 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:46:45,942 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:46:45,942 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:46:45,942 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:46:45,943 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:46:45,943 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:46:45,943 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:45,943 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:46:45,944 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:45,944 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:45,944 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:45,944 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:46:45,944 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:46:45,945 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:46:45,945 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:46:45,950 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:46:45,950 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:45,951 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:45,952 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:45,954 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:45,954 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:45,954 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:45,955 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:45,963 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4663, Threshold=0.5131, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:46:45,963 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4663
2025-08-04 20:46:51,217 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:51,218 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:51,218 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:51,218 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:46:51,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:46:51,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:51,464 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:51,464 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:51,546 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:46:51,571 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:46:51,571 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:51,664 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:51,670 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:51,670 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:51,676 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:46:51,684 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:51,685 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:46:51,685 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:51,685 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:51,685 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:46:51,694 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:51,697 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:51,700 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:51,702 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:51,705 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:51,707 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:51,710 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:51,713 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:51,715 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:51,717 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:51,719 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:51,729 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:51,729 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:46:51,734 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:46:51,734 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:46:51,739 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:51,739 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:46:51,748 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:51,749 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:46:51,749 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:51,766 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:51,770 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:46:51,775 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:46:51,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:51,776 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:51,776 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:51,776 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:51,776 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:51,777 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:46:51,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:51,777 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:46:51,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:51,779 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:46:51,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:46:51,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:51,780 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:46:51,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:51,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:51,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:51,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:46:51,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:46:51,781 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:46:51,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:46:51,781 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:46:51,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:46:51,781 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:46:51,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:46:51,782 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:46:51,782 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:46:51,782 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:46:51,782 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:46:51,782 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:51,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:46:51,783 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:51,783 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:51,783 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:51,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:46:51,784 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:46:51,784 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:46:51,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:46:51,788 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:46:51,789 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:51,790 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:51,790 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:51,792 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 110/400.
2025-08-04 20:46:51,893 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:51,893 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:51,894 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 51 anomalous samples to GAN training data (target: 51).
2025-08-04 20:46:51,895 - ClientAppLogger [Client 3] - INFO - [Client] Round 110: Training GAN with 224 samples (173 normal, 51 anomalous).
2025-08-04 20:46:51,895 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:52,067 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.7870
2025-08-04 20:46:52,067 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.7870
2025-08-04 20:46:52,067 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:52,075 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4973, Threshold=0.5496, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:46:52,076 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:46:52,076 - ClientAppLogger [Client 3] - INFO - Fit completed for round 110. Duration: 0.28s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 110, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.083243611880711, 'd_loss': 0.787020079578672, 'post_fit_local_f1': 0.8125, 'fit_time_seconds': 0.284099817276001, 'cpu_percent_fit': 12.275, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 224}
2025-08-04 20:46:52,076 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:47:00,360 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:00,360 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:00,360 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:00,360 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:47:00,360 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:47:00,360 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:00,628 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:00,628 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:00,725 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:47:00,769 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:47:00,769 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:00,891 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:00,899 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:00,899 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:00,905 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:47:00,911 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:00,911 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:47:00,911 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:00,911 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:00,912 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:47:00,920 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:00,923 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:00,925 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:00,928 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:00,930 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:00,932 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:00,935 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:00,937 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:00,940 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:00,942 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:00,944 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:00,954 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:00,954 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:47:00,959 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:47:00,959 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:47:00,964 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:00,964 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:47:00,973 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:00,973 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:47:00,973 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:00,991 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:00,996 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:47:01,003 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:47:01,003 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:01,003 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:01,003 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:01,004 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:01,004 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:01,004 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:47:01,004 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:01,004 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:47:01,004 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:01,005 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:47:01,006 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:47:01,006 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:01,006 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:47:01,006 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:01,006 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:01,006 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:01,007 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:47:01,007 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:47:01,007 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:47:01,007 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:47:01,007 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:47:01,007 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:47:01,007 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:47:01,008 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:47:01,008 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:47:01,008 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:47:01,008 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:47:01,009 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:47:01,009 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:01,009 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:47:01,009 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:01,009 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:01,010 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:01,010 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:47:01,010 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:47:01,010 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:47:01,010 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:47:01,013 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:47:01,014 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:01,015 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:01,015 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:01,016 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:01,017 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:01,017 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:01,017 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:01,026 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5050, Threshold=0.5600, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:47:01,026 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5050
2025-08-04 20:47:15,326 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:15,326 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:15,326 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:15,326 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:47:15,327 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:47:15,327 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:15,593 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:15,593 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:15,683 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:47:15,712 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:47:15,712 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:15,814 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:15,822 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:15,822 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:15,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:47:15,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:15,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:47:15,837 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:15,837 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:15,837 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:47:15,846 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:15,850 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:15,852 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:15,854 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:15,856 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:15,859 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:15,861 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:15,864 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:15,866 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:15,868 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:15,870 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:15,880 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:15,880 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:47:15,885 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:47:15,885 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:47:15,890 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:15,891 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:47:15,899 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:15,900 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:47:15,900 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:15,916 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:15,921 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:47:15,928 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:47:15,928 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:15,928 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:15,928 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:15,929 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:15,929 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:15,929 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:47:15,929 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:15,930 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:47:15,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:15,931 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:47:15,931 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:47:15,932 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:15,932 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:47:15,932 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:15,932 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:15,933 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:15,933 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:47:15,933 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:47:15,933 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:47:15,933 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:47:15,933 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:47:15,933 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:47:15,934 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:47:15,934 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:47:15,934 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:47:15,934 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:47:15,935 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:47:15,935 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:47:15,935 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:15,935 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:47:15,936 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:15,936 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:15,937 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:15,937 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:47:15,937 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:47:15,937 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:47:15,937 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:47:15,942 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:47:15,942 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:15,943 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:15,943 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:15,945 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:15,945 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:15,945 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:15,946 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:15,955 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4757, Threshold=0.5265, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:47:15,955 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4757
2025-08-04 20:47:33,244 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:33,244 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:33,244 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:33,244 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:47:33,244 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:47:33,244 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:33,526 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:33,526 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:33,617 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:47:33,667 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:47:33,668 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:33,824 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:33,830 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:33,830 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:33,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:47:33,842 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:33,842 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:47:33,843 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:33,843 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:33,843 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:47:33,853 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:33,856 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:33,858 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:33,860 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:33,863 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:33,865 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:33,868 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:33,870 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:33,873 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:33,875 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:33,877 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:33,889 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:33,890 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:47:33,894 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:47:33,895 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:47:33,900 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:33,900 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:47:33,909 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:33,910 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:47:33,910 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:33,926 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:33,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:47:33,938 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:47:33,939 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:33,939 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:33,939 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:33,939 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:33,940 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:33,940 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:47:33,940 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:33,940 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:47:33,940 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:33,942 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:47:33,942 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:47:33,942 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:33,943 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:47:33,943 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:33,943 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:33,943 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:33,943 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:47:33,943 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:47:33,943 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:47:33,944 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:47:33,944 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:47:33,944 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:47:33,944 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:47:33,944 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:47:33,945 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:47:33,945 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:47:33,945 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:47:33,945 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:47:33,945 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:33,946 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:47:33,946 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:33,946 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:33,946 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:33,946 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:47:33,947 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:47:33,947 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:47:33,947 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:47:33,953 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:47:33,953 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:33,954 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:33,954 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:33,956 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:33,956 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:33,956 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:33,957 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:33,966 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4444, Threshold=0.4803, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:47:33,966 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4444
2025-08-04 20:47:45,242 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:45,242 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:45,242 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:45,242 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:47:45,242 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:47:45,243 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:45,509 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:45,510 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:45,604 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:47:45,638 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:47:45,638 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:45,750 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:45,757 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:45,757 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:45,762 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:47:45,768 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:45,768 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:47:45,769 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:45,769 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:45,769 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:47:45,778 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:45,781 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:45,783 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:45,785 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:45,788 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:45,790 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:45,793 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:45,795 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:45,798 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:45,800 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:45,802 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:45,813 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:45,813 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:47:45,818 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:47:45,818 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:47:45,824 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:45,824 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:47:45,837 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:45,838 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:47:45,838 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:45,855 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:45,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:47:45,869 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:47:45,869 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:45,870 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:45,870 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:45,870 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:45,871 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:45,871 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:47:45,871 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:45,871 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:47:45,872 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:45,873 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:47:45,873 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:47:45,874 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:45,874 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:47:45,874 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:45,875 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:45,875 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:45,875 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:47:45,875 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:47:45,875 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:47:45,875 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:47:45,876 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:47:45,876 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:47:45,876 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:47:45,876 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:47:45,876 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:47:45,876 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:47:45,877 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:47:45,877 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:47:45,877 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:45,878 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:47:45,878 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:45,878 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:45,879 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:45,879 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:47:45,879 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:47:45,879 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:47:45,879 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:47:45,885 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:47:45,888 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:45,890 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:45,890 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:45,891 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:45,892 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:45,892 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:45,893 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:45,902 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4870, Threshold=0.5487, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:47:45,902 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4870
2025-08-04 20:47:51,160 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:51,160 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:51,161 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:51,161 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:47:51,161 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:47:51,161 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:51,484 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:51,484 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:51,580 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:47:51,626 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:47:51,626 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:51,761 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:51,767 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:51,767 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:51,772 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:47:51,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:51,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:47:51,779 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:51,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:51,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:47:51,788 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:51,791 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:51,793 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:51,796 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:51,799 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:51,801 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:51,803 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:51,806 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:51,809 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:51,810 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:51,813 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:51,823 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:51,823 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:47:51,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:47:51,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:47:51,833 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:51,833 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:47:51,844 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:51,845 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:47:51,845 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:51,862 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:51,867 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:47:51,873 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:47:51,873 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:51,873 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:51,873 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:51,874 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:51,874 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:51,874 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:47:51,874 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:51,874 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:47:51,875 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:51,877 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:47:51,877 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:47:51,877 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:51,877 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:47:51,878 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:51,878 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:51,878 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:51,878 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:47:51,878 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:47:51,878 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:47:51,878 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:47:51,878 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:47:51,879 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:47:51,879 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:47:51,879 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:47:51,879 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:47:51,879 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:47:51,880 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:47:51,880 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:47:51,880 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:51,880 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:47:51,881 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:51,881 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:51,881 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:51,881 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:47:51,882 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:47:51,882 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:47:51,882 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:47:51,886 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:47:51,886 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:51,887 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:51,888 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:51,889 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 114/400.
2025-08-04 20:47:51,990 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:51,990 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:51,991 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 54 anomalous samples to GAN training data (target: 54).
2025-08-04 20:47:51,992 - ClientAppLogger [Client 3] - INFO - [Client] Round 114: Training GAN with 234 samples (180 normal, 54 anomalous).
2025-08-04 20:47:51,992 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:47:52,192 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0823, Avg D Loss: 0.7809
2025-08-04 20:47:52,193 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0823, Avg D Loss: 0.7809
2025-08-04 20:47:52,193 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:47:52,201 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5031, Threshold=0.5662, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:47:52,201 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:47:52,202 - ClientAppLogger [Client 3] - INFO - Fit completed for round 114. Duration: 0.31s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 114, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0823187402170946, 'd_loss': 0.7808681816626818, 'post_fit_local_f1': 0.8125, 'fit_time_seconds': 0.31241607666015625, 'cpu_percent_fit': 12.4, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 234}
2025-08-04 20:47:52,202 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:48:03,470 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:03,470 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:03,470 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:03,470 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:48:03,470 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:48:03,470 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:03,708 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:03,708 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:03,794 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:48:03,820 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:48:03,820 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:03,921 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:03,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:03,930 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:03,937 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:48:03,960 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:03,961 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:48:03,961 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:03,961 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:03,962 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:48:03,971 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:03,975 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:03,977 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:03,979 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:03,982 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:03,984 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:03,987 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:03,990 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:03,993 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:03,995 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:03,997 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:04,008 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:04,008 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:48:04,013 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:48:04,013 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:48:04,020 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:04,020 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:48:04,036 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:04,037 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:48:04,037 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:04,054 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:04,061 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:48:04,070 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:48:04,071 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:04,071 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:04,071 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:04,071 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:04,072 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:04,072 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:48:04,072 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:04,072 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:48:04,072 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:04,074 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:48:04,074 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:48:04,074 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:04,075 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:48:04,075 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:04,075 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:04,076 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:04,076 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:48:04,076 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:48:04,076 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:48:04,076 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:48:04,076 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:48:04,077 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:48:04,077 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:48:04,077 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:48:04,077 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:48:04,077 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:48:04,078 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:48:04,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:48:04,078 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:04,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:48:04,079 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:04,079 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:04,079 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:04,079 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:48:04,080 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:48:04,080 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:48:04,080 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:48:04,088 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:48:04,088 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:04,089 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:04,089 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:04,091 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:04,091 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:04,091 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:04,092 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:04,102 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5199, Threshold=0.5871, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:48:04,103 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5199
2025-08-04 20:48:15,372 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:15,372 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:15,372 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:15,372 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:48:15,373 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:48:15,373 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:15,625 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:15,625 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:15,714 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:48:15,761 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:48:15,761 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:15,898 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:15,906 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:15,906 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:15,913 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:48:15,924 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:15,925 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:48:15,926 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:15,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:15,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:48:15,936 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:15,940 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:15,942 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:15,944 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:15,947 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:15,950 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:15,952 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:15,955 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:15,958 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:15,960 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:15,962 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:15,975 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:15,975 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:48:15,980 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:48:15,980 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:48:15,985 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:15,985 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:48:15,995 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:15,996 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:48:15,996 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:16,012 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:16,016 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:48:16,025 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:48:16,025 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:16,025 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:16,025 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:16,026 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:16,026 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:16,026 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:48:16,027 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:16,027 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:48:16,027 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:16,028 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:48:16,029 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:48:16,029 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:16,029 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:48:16,029 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:16,029 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:16,030 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:16,030 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:48:16,030 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:48:16,030 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:48:16,030 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:48:16,030 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:48:16,031 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:48:16,031 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:48:16,031 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:48:16,031 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:48:16,031 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:48:16,032 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:48:16,032 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:48:16,033 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:16,033 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:48:16,033 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:16,033 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:16,034 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:16,034 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:48:16,034 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:48:16,034 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:48:16,034 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:48:16,039 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:48:16,039 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:16,041 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:16,041 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:16,043 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:16,043 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:16,043 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:16,044 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:16,053 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5536, Threshold=0.6227, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:48:16,053 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5536
2025-08-04 20:48:27,328 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:27,328 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:27,328 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:27,328 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:48:27,329 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:48:27,329 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:27,556 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:27,556 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:27,639 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:48:27,664 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:48:27,664 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:27,764 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:27,772 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:27,772 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:27,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:48:27,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:27,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:48:27,784 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:27,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:27,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:48:27,793 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:27,796 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:27,798 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:27,801 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:27,804 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:27,806 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:27,808 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:27,811 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:27,814 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:27,816 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:27,818 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:27,828 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:27,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:48:27,833 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:48:27,834 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:48:27,839 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:27,839 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:48:27,851 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:27,851 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:48:27,852 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:27,868 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:27,874 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:48:27,880 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:48:27,880 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:27,880 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:27,880 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:27,881 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:27,881 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:27,881 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:48:27,882 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:27,882 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:48:27,882 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:27,884 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:48:27,884 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:48:27,885 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:27,885 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:48:27,885 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:27,885 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:27,886 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:27,886 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:48:27,886 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:48:27,886 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:48:27,887 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:48:27,887 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:48:27,887 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:48:27,887 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:48:27,887 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:48:27,888 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:48:27,888 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:48:27,888 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:48:27,888 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:48:27,889 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:27,889 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:48:27,889 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:27,889 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:27,890 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:27,890 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:48:27,890 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:48:27,890 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:48:27,890 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:48:27,895 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:48:27,895 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:27,897 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:27,897 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:27,899 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:27,899 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:27,899 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:27,900 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:27,910 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4616, Threshold=0.5178, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:48:27,910 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4616
2025-08-04 20:48:42,205 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:42,205 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:42,205 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:42,205 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:48:42,205 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:48:42,205 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:42,470 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:42,471 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:42,554 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:48:42,594 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:48:42,594 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:42,711 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:42,717 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:42,717 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:42,723 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:48:42,729 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:42,729 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:48:42,729 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:42,730 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:42,730 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:48:42,739 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:42,742 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:42,744 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:42,747 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:42,749 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:42,752 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:42,754 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:42,757 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:42,760 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:42,761 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:42,764 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:42,774 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:42,774 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:48:42,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:48:42,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:48:42,784 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:42,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:48:42,794 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:42,794 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:48:42,795 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:42,811 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:42,815 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:48:42,820 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:48:42,820 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:42,820 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:42,821 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:42,821 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:42,821 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:42,821 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:48:42,822 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:42,822 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:48:42,822 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:42,823 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:48:42,824 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:48:42,824 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:42,824 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:48:42,824 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:42,824 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:42,825 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:42,825 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:48:42,825 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:48:42,825 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:48:42,825 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:48:42,826 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:48:42,826 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:48:42,826 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:48:42,826 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:48:42,826 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:48:42,826 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:48:42,827 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:48:42,827 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:48:42,827 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:42,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:48:42,828 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:42,828 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:42,828 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:42,829 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:48:42,829 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:48:42,829 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:48:42,829 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:48:42,833 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:48:42,833 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:42,834 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:42,834 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:42,836 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:42,836 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:42,836 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:42,837 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:42,845 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4829, Threshold=0.5370, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:48:42,845 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4829
2025-08-04 20:48:54,133 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:54,133 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:54,134 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:54,134 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:48:54,134 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:48:54,134 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:54,400 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:54,400 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:54,481 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:48:54,505 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:48:54,505 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:54,598 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:54,604 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:54,604 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:54,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:48:54,623 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:54,623 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:48:54,623 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:54,624 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:54,624 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:48:54,633 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:54,636 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:54,638 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:54,640 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:54,643 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:54,646 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:54,648 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:54,651 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:54,654 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:54,656 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:54,658 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:54,667 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:54,667 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:48:54,672 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:48:54,672 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:48:54,678 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:54,678 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:48:54,689 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:54,690 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:48:54,690 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:54,706 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:54,711 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:48:54,716 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:48:54,716 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:54,716 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:54,716 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:54,717 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:54,717 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:54,717 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:48:54,717 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:54,718 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:48:54,718 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:54,719 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:48:54,719 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:48:54,720 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:54,720 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:48:54,720 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:54,720 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:54,721 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:54,721 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:48:54,721 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:48:54,721 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:48:54,721 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:48:54,721 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:48:54,722 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:48:54,722 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:48:54,722 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:48:54,722 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:48:54,722 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:48:54,723 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:48:54,723 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:48:54,723 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:54,723 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:48:54,724 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:54,724 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:54,724 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:54,725 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:48:54,725 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:48:54,725 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:48:54,725 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:48:54,727 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:48:54,727 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:54,729 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:54,729 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:54,730 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:54,731 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:54,731 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:54,731 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:54,740 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5117, Threshold=0.5761, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:48:54,740 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5117
2025-08-04 20:49:06,016 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:06,016 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:06,016 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:06,016 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:49:06,017 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:49:06,017 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:06,310 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:06,310 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:06,395 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:49:06,438 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:49:06,439 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:06,551 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:06,556 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:06,557 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:06,562 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:49:06,567 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:06,567 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:49:06,568 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:06,568 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:06,568 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:49:06,576 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:06,579 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:06,582 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:06,584 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:06,586 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:06,588 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:06,591 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:06,593 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:06,596 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:06,598 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:06,600 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:06,609 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:06,610 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:49:06,614 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:49:06,614 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:49:06,619 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:06,619 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:49:06,628 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:06,629 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:49:06,629 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:06,644 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:06,649 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:49:06,654 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:49:06,654 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:06,654 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:06,654 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:06,655 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:06,655 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:06,655 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:49:06,656 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:06,656 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:49:06,656 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:06,658 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:49:06,658 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:49:06,658 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:06,658 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:49:06,658 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:06,658 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:06,658 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:06,659 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:49:06,659 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:49:06,659 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:49:06,659 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:49:06,659 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:49:06,659 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:49:06,659 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:49:06,660 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:49:06,660 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:49:06,660 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:49:06,660 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:49:06,660 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:49:06,661 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:06,661 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:49:06,661 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:06,661 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:06,661 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:06,661 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:49:06,662 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:49:06,662 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:49:06,662 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:49:06,666 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:49:06,666 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:06,668 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:06,668 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:06,670 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:06,670 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:06,670 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:06,671 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:06,681 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4923, Threshold=0.5521, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:49:06,681 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4923
2025-08-04 20:49:11,947 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:11,948 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:11,948 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:11,948 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:49:11,948 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:49:11,948 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:12,246 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:12,246 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:12,331 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:49:12,374 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:49:12,374 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:12,500 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:12,507 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:12,507 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:12,513 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:49:12,520 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:12,520 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:49:12,521 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:12,521 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:12,521 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:49:12,530 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:12,534 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:12,536 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:12,538 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:12,541 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:12,543 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:12,546 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:12,548 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:12,551 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:12,553 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:12,556 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:12,566 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:12,566 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:49:12,571 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:49:12,571 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:49:12,576 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:12,576 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:49:12,586 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:12,586 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:49:12,586 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:12,602 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:12,606 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:49:12,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:49:12,612 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:12,612 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:12,612 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:12,612 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:12,612 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:12,613 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:49:12,613 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:12,613 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:49:12,613 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:12,615 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:49:12,615 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:49:12,615 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:12,615 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:49:12,615 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:12,616 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:12,616 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:12,616 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:49:12,616 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:49:12,617 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:49:12,617 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:49:12,617 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:49:12,617 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:49:12,617 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:49:12,617 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:49:12,618 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:49:12,618 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:49:12,618 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:49:12,618 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:49:12,619 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:12,619 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:49:12,619 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:12,619 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:12,620 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:12,620 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:49:12,620 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:49:12,620 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:49:12,620 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:49:12,625 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:49:12,625 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:12,626 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:12,626 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:12,628 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 120/400.
2025-08-04 20:49:12,729 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:12,729 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:12,731 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 56 anomalous samples to GAN training data (target: 56).
2025-08-04 20:49:12,731 - ClientAppLogger [Client 3] - INFO - [Client] Round 120: Training GAN with 245 samples (189 normal, 56 anomalous).
2025-08-04 20:49:12,731 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:12,919 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0840, Avg D Loss: 0.7782
2025-08-04 20:49:12,919 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0840, Avg D Loss: 0.7782
2025-08-04 20:49:12,919 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:12,928 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4866, Threshold=0.5439, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:49:12,928 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:49:12,928 - ClientAppLogger [Client 3] - INFO - Fit completed for round 120. Duration: 0.30s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 120, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0839817054904244, 'd_loss': 0.7782024750174308, 'post_fit_local_f1': 0.8125, 'fit_time_seconds': 0.30025410652160645, 'cpu_percent_fit': 12.56875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 245}
2025-08-04 20:49:12,928 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:49:24,189 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:24,189 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:24,189 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:24,189 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:49:24,189 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:49:24,189 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:24,459 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:24,459 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:24,542 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:49:24,590 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:49:24,591 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:24,714 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:24,720 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:24,721 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:24,728 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:49:24,734 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:24,735 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:49:24,735 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:24,736 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:24,736 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:49:24,745 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:24,748 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:24,750 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:24,752 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:24,755 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:24,757 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:24,759 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:24,762 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:24,765 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:24,766 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:24,769 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:24,781 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:24,781 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:49:24,786 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:49:24,786 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:49:24,791 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:24,791 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:49:24,799 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:24,799 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:49:24,800 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:24,815 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:24,819 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:49:24,824 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:49:24,825 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:24,825 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:24,825 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:24,825 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:24,825 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:24,826 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:49:24,826 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:24,826 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:49:24,826 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:24,828 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:49:24,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:49:24,828 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:24,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:49:24,828 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:24,828 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:24,829 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:24,829 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:49:24,829 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:49:24,829 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:49:24,829 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:49:24,829 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:49:24,829 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:49:24,830 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:49:24,830 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:49:24,830 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:49:24,830 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:49:24,831 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:49:24,831 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:49:24,831 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:24,831 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:49:24,832 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:24,832 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:24,832 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:24,832 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:49:24,833 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:49:24,833 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:49:24,833 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:49:24,836 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:49:24,836 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:24,838 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:24,838 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:24,839 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:24,839 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:24,839 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:24,840 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:24,848 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5105, Threshold=0.5705, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:49:24,848 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5105
2025-08-04 20:49:36,123 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:36,123 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:36,123 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:36,123 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:49:36,123 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:49:36,123 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:36,351 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:36,351 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:36,439 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:49:36,484 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:49:36,485 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:36,602 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:36,610 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:36,610 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:36,617 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:49:36,624 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:36,624 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:49:36,625 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:36,625 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:36,625 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:49:36,633 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:36,636 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:36,639 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:36,641 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:36,644 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:36,646 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:36,649 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:36,651 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:36,654 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:36,656 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:36,658 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:36,667 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:36,667 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:49:36,672 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:49:36,672 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:49:36,676 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:36,677 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:49:36,685 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:36,685 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:49:36,685 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:36,701 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:36,705 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:49:36,713 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:49:36,713 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:36,713 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:36,714 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:36,714 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:36,714 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:36,715 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:49:36,715 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:36,715 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:49:36,715 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:36,717 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:49:36,717 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:49:36,717 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:36,717 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:49:36,718 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:36,718 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:36,718 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:36,718 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:49:36,718 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:49:36,718 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:49:36,718 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:49:36,718 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:49:36,719 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:49:36,719 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:49:36,719 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:49:36,719 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:49:36,719 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:49:36,720 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:49:36,720 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:49:36,720 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:36,720 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:49:36,721 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:36,721 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:36,721 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:36,721 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:49:36,722 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:49:36,722 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:49:36,722 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:49:36,727 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:49:36,727 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:36,728 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:36,729 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:36,730 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:36,730 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:36,730 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:36,731 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:36,740 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4506, Threshold=0.4901, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:49:36,740 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4506
2025-08-04 20:49:48,006 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:48,006 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:48,006 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:48,006 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:49:48,006 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:49:48,006 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:48,248 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:48,248 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:48,332 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:49:48,380 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:49:48,381 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:48,496 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:48,503 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:48,503 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:48,509 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:49:48,515 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:48,515 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:49:48,516 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:48,516 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:48,516 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:49:48,524 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:48,527 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:48,529 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:48,532 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:48,534 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:48,536 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:48,539 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:48,542 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:48,545 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:48,547 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:48,549 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:48,558 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:48,558 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:49:48,563 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:49:48,563 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:49:48,568 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:48,568 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:49:48,576 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:48,577 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:49:48,577 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:48,593 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:48,597 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:49:48,604 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:49:48,604 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:48,604 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:48,604 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:48,605 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:48,605 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:48,605 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:49:48,605 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:48,606 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:49:48,606 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:48,607 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:49:48,608 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:49:48,608 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:48,608 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:49:48,608 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:48,608 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:48,609 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:48,609 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:49:48,609 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:49:48,609 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:49:48,609 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:49:48,609 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:49:48,609 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:49:48,610 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:49:48,610 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:49:48,610 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:49:48,610 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:49:48,611 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:49:48,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:49:48,611 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:48,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:49:48,611 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:48,612 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:48,612 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:48,612 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:49:48,612 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:49:48,612 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:49:48,612 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:49:48,616 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:49:48,616 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:48,617 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:48,617 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:48,619 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:48,619 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:48,619 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:48,620 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:48,629 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5199, Threshold=0.5963, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:49:48,629 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5199
2025-08-04 20:50:02,899 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:02,899 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:02,899 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:02,899 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:50:02,899 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:50:02,899 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:03,158 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:03,158 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:03,243 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:50:03,269 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:50:03,269 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:03,376 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:03,383 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:03,383 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:03,388 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:50:03,396 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:03,396 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:50:03,397 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:03,397 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:03,397 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:50:03,406 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:03,409 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:03,411 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:03,413 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:03,416 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:03,419 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:03,421 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:03,424 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:03,427 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:03,429 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:03,431 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:03,442 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:03,443 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:50:03,448 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:50:03,448 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:50:03,453 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:03,453 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:50:03,465 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:03,465 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:50:03,466 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:03,486 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:03,492 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:50:03,498 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:50:03,498 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:03,499 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:03,499 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:03,499 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:03,500 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:03,500 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:50:03,500 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:03,500 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:50:03,500 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:03,502 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:50:03,502 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:50:03,502 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:03,502 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:50:03,502 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:03,503 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:03,503 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:03,503 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:50:03,503 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:50:03,503 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:50:03,503 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:50:03,504 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:50:03,504 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:50:03,504 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:50:03,504 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:50:03,504 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:50:03,504 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:50:03,505 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:50:03,505 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:50:03,505 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:03,505 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:50:03,506 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:03,506 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:03,506 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:03,506 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:50:03,507 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:50:03,507 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:50:03,507 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:50:03,512 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:50:03,512 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:03,514 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:03,514 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:03,516 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:03,516 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:03,516 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:03,517 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:03,526 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5377, Threshold=0.6141, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:50:03,526 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5377
2025-08-04 20:50:17,796 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:17,796 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:17,796 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:17,797 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:50:17,797 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:50:17,797 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:18,040 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:18,041 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:18,126 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:50:18,155 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:50:18,155 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:18,274 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:18,281 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:18,282 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:18,288 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:50:18,293 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:18,293 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:50:18,294 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:18,294 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:18,294 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:50:18,303 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:18,306 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:18,308 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:18,310 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:18,313 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:18,315 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:18,318 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:18,320 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:18,323 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:18,325 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:18,327 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:18,338 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:18,338 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:50:18,343 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:50:18,343 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:50:18,348 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:18,349 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:50:18,359 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:18,360 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:50:18,360 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:18,377 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:18,383 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:50:18,391 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:50:18,391 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:18,391 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:18,391 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:18,392 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:18,392 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:18,392 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:50:18,392 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:18,393 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:50:18,393 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:18,394 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:50:18,394 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:50:18,395 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:18,395 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:50:18,395 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:18,395 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:18,395 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:18,395 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:50:18,396 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:50:18,396 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:50:18,396 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:50:18,396 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:50:18,396 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:50:18,396 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:50:18,396 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:50:18,397 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:50:18,397 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:50:18,397 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:50:18,398 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:50:18,398 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:18,398 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:50:18,398 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:18,398 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:18,398 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:18,399 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:50:18,399 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:50:18,399 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:50:18,399 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:50:18,403 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:50:18,403 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:18,405 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:18,405 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:18,407 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:18,407 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:18,407 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:18,408 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:18,416 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5159, Threshold=0.5910, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:50:18,417 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5159
2025-08-04 20:50:35,713 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:35,713 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:35,713 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:35,714 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:50:35,714 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:50:35,714 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:36,005 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:36,005 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:36,097 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:50:36,139 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:50:36,139 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:36,261 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:36,268 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:36,268 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:36,273 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:50:36,280 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:36,280 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:50:36,280 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:36,281 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:36,281 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:50:36,289 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:36,292 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:36,294 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:36,297 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:36,299 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:36,302 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:36,304 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:36,307 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:36,310 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:36,312 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:36,314 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:36,324 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:36,324 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:50:36,329 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:50:36,329 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:50:36,336 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:36,336 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:50:36,351 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:36,352 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:50:36,352 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:36,369 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:36,374 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:50:36,383 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:50:36,383 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:36,383 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:36,383 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:36,384 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:36,384 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:36,384 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:50:36,384 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:36,385 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:50:36,385 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:36,386 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:50:36,386 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:50:36,387 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:36,387 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:50:36,387 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:36,387 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:36,387 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:36,388 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:50:36,388 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:50:36,388 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:50:36,388 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:50:36,388 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:50:36,388 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:50:36,388 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:50:36,389 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:50:36,389 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:50:36,389 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:50:36,389 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:50:36,389 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:50:36,390 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:36,390 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:50:36,390 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:36,390 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:36,390 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:36,391 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:50:36,391 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:50:36,391 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:50:36,391 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:50:36,398 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:50:36,398 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:36,400 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:36,400 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:36,401 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:36,402 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:36,402 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:36,402 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:36,411 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5234, Threshold=0.5919, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:50:36,411 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5234
2025-08-04 20:50:47,670 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:47,670 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:47,670 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:47,670 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:50:47,670 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:50:47,670 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:47,954 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:47,954 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:48,048 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:50:48,090 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:50:48,090 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:48,219 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:48,226 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:48,226 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:48,232 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:50:48,238 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:48,238 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:50:48,239 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:48,239 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:48,239 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:50:48,248 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:48,251 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:48,253 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:48,256 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:48,259 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:48,261 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:48,264 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:48,267 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:48,270 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:48,272 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:48,274 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:48,284 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:48,284 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:50:48,289 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:50:48,289 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:50:48,295 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:48,295 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:50:48,306 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:48,307 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:50:48,307 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:48,323 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:48,328 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:50:48,335 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:50:48,335 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:48,336 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:48,336 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:48,336 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:48,336 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:48,336 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:50:48,337 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:48,337 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:50:48,337 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:48,338 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:50:48,338 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:50:48,339 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:48,339 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:50:48,339 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:48,339 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:48,339 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:48,340 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:50:48,340 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:50:48,340 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:50:48,340 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:50:48,340 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:50:48,340 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:50:48,341 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:50:48,341 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:50:48,341 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:50:48,341 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:50:48,342 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:50:48,342 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:50:48,342 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:48,342 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:50:48,343 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:48,343 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:48,343 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:48,343 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:50:48,343 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:50:48,343 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:50:48,344 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:50:48,347 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:50:48,347 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:48,349 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:48,349 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:48,351 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:48,351 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:48,351 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:48,352 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:48,360 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5138, Threshold=0.5895, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:50:48,360 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5138
2025-08-04 20:51:05,650 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:05,651 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:51:05,651 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:51:05,651 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:51:05,651 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:51:05,651 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:05,970 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:05,970 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:06,057 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:51:06,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:51:06,090 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:06,293 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:06,302 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:06,302 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:06,309 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:51:06,317 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:06,317 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:51:06,318 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:06,318 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:06,318 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:51:06,328 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:06,331 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:06,335 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:06,337 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:06,341 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:06,344 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:06,348 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:06,352 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:06,356 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:06,358 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:06,361 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:06,373 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:06,373 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:51:06,378 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:51:06,378 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:51:06,384 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:06,385 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:51:06,395 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:06,395 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:51:06,396 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:06,414 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:06,419 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:51:06,425 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:51:06,425 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:06,425 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:06,425 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:06,426 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:06,426 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:06,426 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:51:06,426 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:06,426 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:51:06,427 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:06,428 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:51:06,428 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:51:06,428 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:06,428 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:51:06,429 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:06,429 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:06,429 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:06,429 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:51:06,429 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:51:06,429 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:51:06,429 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:51:06,430 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:51:06,430 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:51:06,430 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:51:06,430 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:51:06,430 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:51:06,431 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:51:06,431 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:51:06,431 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:51:06,431 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:06,431 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:51:06,432 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:06,432 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:06,432 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:06,432 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:51:06,433 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:51:06,433 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:51:06,433 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:51:06,440 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:51:06,441 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:06,442 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:06,442 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:51:06,444 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:06,444 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:06,444 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:06,445 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:06,454 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5163, Threshold=0.5919, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:51:06,454 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5163
2025-08-04 20:51:20,723 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:20,723 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:51:20,724 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:51:20,724 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:51:20,724 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:51:20,724 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:21,002 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:21,002 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:21,091 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:51:21,145 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:51:21,146 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:21,333 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:21,343 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:21,343 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:21,351 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:51:21,359 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:21,359 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:51:21,360 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:21,360 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:21,360 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:51:21,370 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:21,373 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:21,375 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:21,377 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:21,380 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:21,382 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:21,385 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:21,387 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:21,390 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:21,392 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:21,398 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:21,410 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:21,410 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:51:21,415 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:51:21,415 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:51:21,423 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:21,424 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:51:21,440 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:21,441 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:51:21,441 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:21,459 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:21,464 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:51:21,476 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:51:21,476 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:21,476 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:21,477 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:21,477 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:21,478 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:21,478 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:51:21,478 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:21,478 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:51:21,478 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:21,480 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:51:21,480 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:51:21,481 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:21,481 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:51:21,481 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:21,481 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:21,481 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:21,482 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:51:21,482 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:51:21,482 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:51:21,482 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:51:21,483 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:51:21,483 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:51:21,483 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:51:21,483 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:51:21,484 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:51:21,484 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:51:21,484 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:51:21,484 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:51:21,485 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:21,485 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:51:21,485 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:21,485 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:21,486 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:21,486 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:51:21,486 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:51:21,486 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:51:21,486 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:51:21,493 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:51:21,493 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:21,494 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:21,494 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:51:21,496 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:21,496 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:21,496 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:21,497 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:21,505 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5108, Threshold=0.5784, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:51:21,505 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5108
2025-08-04 20:51:38,771 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:38,771 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:51:38,771 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:51:38,771 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:51:38,771 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:51:38,771 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:39,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:39,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:39,170 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:51:39,221 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:51:39,221 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:39,378 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:39,388 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:39,388 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:39,399 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:51:39,410 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:39,410 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:51:39,411 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:39,411 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:39,411 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:51:39,423 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:39,426 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:39,429 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:39,431 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:39,435 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:39,438 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:39,442 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:39,446 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:39,450 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:39,453 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:39,456 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:39,473 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:39,477 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:51:39,484 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:51:39,484 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:51:39,493 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:39,493 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:51:39,509 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:39,510 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:51:39,510 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:39,531 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:39,537 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:51:39,545 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:51:39,545 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:39,546 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:39,546 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:39,546 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:39,547 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:39,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:51:39,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:39,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:51:39,548 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:39,549 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:51:39,550 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:51:39,550 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:39,550 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:51:39,550 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:39,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:39,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:39,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:51:39,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:51:39,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:51:39,552 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:51:39,552 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:51:39,552 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:51:39,552 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:51:39,553 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:51:39,553 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:51:39,553 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:51:39,553 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:51:39,554 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:51:39,554 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:39,554 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:51:39,554 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:39,555 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:39,555 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:39,555 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:51:39,555 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:51:39,555 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:51:39,556 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:51:39,562 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:51:39,562 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:39,564 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:39,564 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:51:39,566 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:39,566 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:39,566 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:39,567 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:39,575 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5105, Threshold=0.5825, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:51:39,575 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5105
2025-08-04 20:51:53,839 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:53,840 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:51:53,840 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:51:53,840 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:51:53,840 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:51:53,840 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:54,204 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:54,204 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:54,301 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:51:54,364 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:51:54,364 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:54,530 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:54,540 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:54,540 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:54,550 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:51:54,580 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:54,580 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:51:54,581 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:54,581 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:54,581 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:51:54,592 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:54,597 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:54,599 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:54,602 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:54,606 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:54,608 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:54,612 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:54,615 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:54,618 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:54,620 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:54,623 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:54,639 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:54,639 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:51:54,645 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:51:54,645 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:51:54,659 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:54,660 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:51:54,692 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:54,692 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:51:54,692 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:54,712 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:54,718 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:51:54,724 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:51:54,724 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:54,724 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:54,725 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:54,725 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:54,725 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:54,726 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:51:54,726 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:54,727 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:51:54,727 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:54,728 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:51:54,728 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:51:54,729 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:54,729 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:51:54,729 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:54,730 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:54,730 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:54,731 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:51:54,731 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:51:54,731 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:51:54,731 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:51:54,731 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:51:54,731 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:51:54,732 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:51:54,732 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:51:54,732 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:51:54,732 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:51:54,733 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:51:54,733 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:51:54,733 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:54,734 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:51:54,734 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:54,734 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:54,735 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:54,735 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:51:54,735 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:51:54,735 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:51:54,735 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:51:54,742 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:51:54,742 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:54,744 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:54,744 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:51:54,746 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:54,747 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:54,747 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:54,748 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:54,757 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4826, Threshold=0.5377, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:51:54,757 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4826
2025-08-04 20:52:06,025 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:06,025 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:06,026 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:06,026 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:52:06,026 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:52:06,026 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:06,418 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:06,418 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:06,521 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:52:06,569 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:52:06,570 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:06,740 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:06,752 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:06,753 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:06,764 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:52:06,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:06,783 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:52:06,784 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:06,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:06,784 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:52:06,796 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:06,799 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:06,802 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:06,805 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:06,808 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:06,810 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:06,813 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:06,818 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:06,822 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:06,825 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:06,828 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:06,839 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:06,839 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:52:06,845 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:52:06,845 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:52:06,853 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:06,853 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:52:06,868 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:06,869 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:52:06,869 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:06,891 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:06,897 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:52:06,908 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:52:06,909 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:06,909 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:06,909 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:06,909 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:06,910 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:06,910 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:52:06,910 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:06,910 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:52:06,910 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:06,912 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:52:06,912 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:52:06,913 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:06,913 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:52:06,913 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:06,913 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:06,913 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:06,913 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:52:06,914 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:52:06,914 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:52:06,914 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:52:06,914 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:52:06,914 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:52:06,915 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:52:06,915 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:52:06,915 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:52:06,915 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:52:06,916 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:52:06,916 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:52:06,916 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:06,916 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:52:06,917 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:06,917 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:06,917 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:06,917 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:52:06,917 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:52:06,918 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:52:06,918 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:52:06,925 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:52:06,925 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:06,927 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:06,928 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:06,930 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:06,933 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:06,933 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:06,934 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:06,945 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5085, Threshold=0.5757, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:52:06,945 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5085
2025-08-04 20:52:18,218 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:18,218 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:18,218 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:18,219 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:52:18,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:52:18,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:18,561 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:18,562 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:18,654 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:52:18,692 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:52:18,692 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:18,815 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:18,823 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:18,824 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:18,847 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:52:18,863 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:18,863 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:52:18,866 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:18,866 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:18,866 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:52:18,877 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:18,881 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:18,883 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:18,885 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:18,888 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:18,891 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:18,893 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:18,896 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:18,899 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:18,901 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:18,903 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:18,916 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:18,916 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:52:18,922 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:52:18,923 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:52:18,930 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:18,930 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:52:18,950 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:18,950 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:52:18,950 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:18,968 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:18,975 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:52:18,987 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:52:18,988 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:18,988 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:18,988 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:18,989 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:18,989 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:18,989 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:52:18,990 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:18,990 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:52:18,990 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:18,992 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:52:18,992 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:52:18,992 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:18,993 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:52:18,993 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:18,993 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:18,993 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:18,993 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:52:18,994 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:52:18,994 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:52:18,994 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:52:18,994 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:52:18,994 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:52:18,995 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:52:18,995 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:52:18,995 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:52:18,995 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:52:18,996 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:52:18,996 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:52:18,996 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:18,996 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:52:18,997 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:18,997 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:18,997 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:18,997 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:52:18,998 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:52:18,998 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:52:18,998 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:52:19,004 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:52:19,004 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:19,006 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:19,006 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:19,008 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:19,008 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:19,008 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:19,009 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:19,017 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5293, Threshold=0.5991, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:52:19,018 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5293
2025-08-04 20:52:36,303 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:36,303 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:36,303 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:36,303 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:52:36,303 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:52:36,303 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:36,587 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:36,587 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:36,681 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:52:36,729 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:52:36,729 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:36,887 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:36,894 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:36,894 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:36,903 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:52:36,911 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:36,911 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:52:36,912 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:36,912 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:36,912 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:52:36,922 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:36,926 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:36,928 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:36,930 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:36,933 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:36,935 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:36,938 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:36,941 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:36,944 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:36,946 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:36,948 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:36,960 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:36,960 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:52:36,965 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:52:36,965 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:52:36,971 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:36,971 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:52:36,984 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:36,985 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:52:36,985 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:37,002 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:37,008 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:52:37,015 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:52:37,015 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:37,015 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:37,015 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:37,016 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:37,016 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:37,016 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:52:37,016 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:37,017 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:52:37,017 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:37,018 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:52:37,018 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:52:37,018 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:37,019 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:52:37,019 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:37,019 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:37,019 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:37,020 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:52:37,020 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:52:37,020 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:52:37,020 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:52:37,020 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:52:37,020 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:52:37,021 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:52:37,021 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:52:37,021 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:52:37,021 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:52:37,022 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:52:37,022 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:52:37,022 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:37,022 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:52:37,022 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:37,023 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:37,023 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:37,023 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:52:37,023 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:52:37,024 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:52:37,024 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:52:37,029 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:52:37,029 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:37,030 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:37,030 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:37,032 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:37,032 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:37,032 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:37,033 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:37,042 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5669, Threshold=0.6443, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:52:37,042 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5669
2025-08-04 20:52:48,298 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:48,298 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:48,298 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:48,298 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:52:48,298 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:52:48,298 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:48,597 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:48,597 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:48,680 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:52:48,706 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:52:48,706 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:48,817 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:48,823 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:48,824 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:48,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:52:48,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:48,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:52:48,836 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:48,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:48,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:52:48,845 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:48,848 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:48,850 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:48,853 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:48,855 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:48,857 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:48,860 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:48,863 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:48,865 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:48,867 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:48,870 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:48,880 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:48,880 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:52:48,885 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:52:48,885 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:52:48,890 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:48,891 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:52:48,906 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:48,907 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:52:48,907 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:48,927 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:48,933 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:52:48,941 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:52:48,941 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:48,941 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:48,942 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:48,942 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:48,942 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:48,942 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:52:48,943 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:48,943 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:52:48,943 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:48,944 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:52:48,944 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:52:48,945 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:48,945 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:52:48,945 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:48,945 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:48,945 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:48,946 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:52:48,946 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:52:48,946 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:52:48,946 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:52:48,946 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:52:48,946 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:52:48,947 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:52:48,947 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:52:48,947 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:52:48,947 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:52:48,948 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:52:48,948 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:52:48,948 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:48,948 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:52:48,949 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:48,949 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:48,949 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:48,950 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:52:48,950 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:52:48,950 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:52:48,950 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:52:48,955 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:52:48,955 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:48,956 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:48,957 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:48,959 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:48,959 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:48,959 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:48,960 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:48,970 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5042, Threshold=0.5623, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:52:48,970 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5042
2025-08-04 20:53:03,251 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:03,251 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:03,251 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:03,251 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:53:03,251 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:53:03,251 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:03,542 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:03,542 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:03,624 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:53:03,664 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:53:03,664 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:03,770 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:03,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:03,777 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:03,782 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:53:03,787 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:03,787 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:53:03,787 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:03,787 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:03,787 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:53:03,796 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:03,799 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:03,802 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:03,804 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:03,806 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:03,809 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:03,812 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:03,814 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:03,817 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:03,819 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:03,822 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:03,830 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:03,830 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:53:03,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:53:03,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:53:03,839 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:03,840 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:53:03,847 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:03,848 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:53:03,848 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:03,862 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:03,867 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:53:03,872 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:53:03,872 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:03,872 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:03,872 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:03,872 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:03,872 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:03,873 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:53:03,873 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:03,873 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:53:03,873 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:03,874 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:53:03,875 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:53:03,875 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:03,875 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:53:03,875 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:03,875 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:03,876 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:03,876 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:53:03,876 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:53:03,876 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:53:03,876 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:53:03,876 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:53:03,876 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:53:03,877 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:53:03,877 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:53:03,877 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:53:03,877 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:53:03,877 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:53:03,877 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:53:03,877 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:03,878 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:53:03,878 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:03,878 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:03,878 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:03,878 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:53:03,879 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:53:03,879 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:53:03,879 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:53:03,882 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:53:03,882 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:03,884 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:03,884 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:03,885 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:03,885 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:03,886 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:03,886 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:03,895 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5100, Threshold=0.5825, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:53:03,895 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5100
2025-08-04 20:53:15,176 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:15,176 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:15,176 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:15,177 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:53:15,177 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:53:15,177 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:15,488 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:15,488 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:15,589 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:53:15,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:53:15,634 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:15,743 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:15,750 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:15,750 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:15,756 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:53:15,763 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:15,763 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:53:15,764 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:15,764 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:15,764 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:53:15,772 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:15,775 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:15,778 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:15,780 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:15,783 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:15,785 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:15,788 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:15,790 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:15,793 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:15,795 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:15,797 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:15,806 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:15,806 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:53:15,811 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:53:15,811 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:53:15,817 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:15,817 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:53:15,828 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:15,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:53:15,828 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:15,843 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:15,848 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:53:15,853 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:53:15,853 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:15,853 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:15,853 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:15,853 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:15,854 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:15,854 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:53:15,854 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:15,854 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:53:15,854 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:15,856 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:53:15,856 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:53:15,856 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:15,856 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:53:15,857 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:15,857 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:15,857 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:15,857 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:53:15,857 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:53:15,857 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:53:15,857 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:53:15,858 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:53:15,858 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:53:15,858 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:53:15,858 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:53:15,858 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:53:15,858 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:53:15,859 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:53:15,859 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:53:15,859 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:15,859 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:53:15,859 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:15,860 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:15,860 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:15,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:53:15,860 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:53:15,860 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:53:15,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:53:15,864 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:53:15,864 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:15,865 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:15,865 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:15,867 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:15,867 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:15,867 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:15,868 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:15,876 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5404, Threshold=0.6120, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:53:15,876 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5404
2025-08-04 20:53:36,171 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:36,171 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:36,171 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:36,171 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:53:36,171 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:53:36,171 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:36,435 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:36,435 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:36,522 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:53:36,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:53:36,552 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:36,647 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:36,653 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:36,653 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:36,658 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:53:36,666 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:36,666 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:53:36,666 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:36,667 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:36,667 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:53:36,675 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:36,678 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:36,681 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:36,683 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:36,686 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:36,688 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:36,691 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:36,694 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:36,697 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:36,699 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:36,702 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:36,711 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:36,711 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:53:36,716 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:53:36,716 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:53:36,720 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:36,721 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:53:36,729 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:36,729 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:53:36,729 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:36,745 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:36,749 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:53:36,754 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:53:36,754 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:36,754 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:36,754 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:36,755 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:36,755 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:36,755 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:53:36,755 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:36,755 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:53:36,756 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:36,757 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:53:36,757 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:53:36,757 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:36,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:53:36,758 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:36,758 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:36,758 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:36,758 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:53:36,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:53:36,758 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:53:36,759 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:53:36,759 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:53:36,759 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:53:36,759 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:53:36,759 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:53:36,759 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:53:36,759 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:53:36,760 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:53:36,760 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:53:36,760 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:36,760 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:53:36,760 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:36,760 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:36,761 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:36,761 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:53:36,761 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:53:36,761 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:53:36,761 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:53:36,765 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:53:36,765 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:36,767 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:36,767 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:36,768 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:36,768 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:36,768 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:36,769 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:36,777 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5391, Threshold=0.6056, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:53:36,777 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5391
2025-08-04 20:53:57,126 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:57,126 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:57,126 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:57,126 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:53:57,126 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:53:57,126 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:57,435 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:57,435 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:57,531 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:53:57,578 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:53:57,579 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:57,696 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:57,702 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:57,702 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:57,708 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:53:57,715 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:57,715 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:53:57,716 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:57,716 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:57,716 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:53:57,724 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:57,727 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:57,729 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:57,732 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:57,734 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:57,736 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:57,739 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:57,741 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:57,744 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:57,746 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:57,748 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:57,757 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:57,758 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:53:57,762 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:53:57,763 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:53:57,767 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:57,767 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:53:57,775 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:57,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:53:57,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:57,792 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:57,796 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:53:57,802 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:53:57,802 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:57,802 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:57,802 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:57,803 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:57,803 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:57,803 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:53:57,803 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:57,804 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:53:57,804 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:57,805 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:53:57,805 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:53:57,805 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:57,806 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:53:57,806 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:57,806 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:57,806 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:57,806 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:53:57,806 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:53:57,806 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:53:57,807 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:53:57,807 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:53:57,807 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:53:57,807 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:53:57,807 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:53:57,807 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:53:57,807 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:53:57,808 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:53:57,808 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:53:57,808 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:57,808 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:53:57,808 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:57,809 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:57,809 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:57,809 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:53:57,809 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:53:57,809 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:53:57,809 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:53:57,813 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:53:57,813 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:57,815 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:57,815 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:57,816 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:57,816 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:57,816 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:57,817 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:57,826 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5301, Threshold=0.6024, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:53:57,826 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5301
2025-08-04 20:54:15,176 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:15,176 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:15,177 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:15,177 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:54:15,177 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:54:15,177 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:15,649 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:15,649 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:15,756 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:54:15,789 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:54:15,790 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:15,917 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:15,924 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:15,925 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:15,931 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:54:15,970 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:15,970 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:54:15,971 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:15,971 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:15,971 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:54:15,981 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:15,984 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:15,989 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:15,991 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:15,994 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:15,996 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:15,999 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:16,002 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:16,005 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:16,007 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:16,010 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:16,021 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:16,021 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:54:16,027 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:54:16,027 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:54:16,034 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:16,034 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:54:16,047 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:16,048 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:54:16,048 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:16,064 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:16,068 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:54:16,074 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:54:16,074 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:16,074 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:16,074 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:16,075 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:16,075 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:16,075 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:54:16,075 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:16,075 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:54:16,076 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:16,077 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:54:16,077 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:54:16,078 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:16,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:54:16,078 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:16,078 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:16,078 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:16,078 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:54:16,078 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:54:16,078 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:54:16,079 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:54:16,079 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:54:16,079 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:54:16,079 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:54:16,079 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:54:16,080 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:54:16,080 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:54:16,080 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:54:16,080 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:54:16,080 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:16,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:54:16,081 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:16,081 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:16,081 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:16,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:54:16,082 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:54:16,082 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:54:16,082 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:54:16,091 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:54:16,091 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:16,092 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:16,092 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:16,093 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:16,094 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:16,094 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:16,095 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:16,102 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5667, Threshold=0.6483, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:54:16,103 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5667
2025-08-04 20:54:33,420 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:33,420 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:33,420 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:33,420 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:54:33,420 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:54:33,420 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:33,914 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:33,914 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:34,025 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:54:34,073 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:54:34,074 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:34,256 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:34,264 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:34,265 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:34,271 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:54:34,279 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:34,280 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:54:34,280 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:34,280 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:34,281 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:54:34,292 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:34,295 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:34,298 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:34,300 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:34,303 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:34,305 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:34,308 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:34,312 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:34,314 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:34,316 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:34,319 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:34,330 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:34,331 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:54:34,337 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:54:34,337 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:54:34,343 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:34,343 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:54:34,354 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:34,355 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:54:34,355 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:34,373 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:34,379 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:54:34,384 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:54:34,384 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:34,384 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:34,384 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:34,384 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:34,385 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:34,385 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:54:34,385 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:34,385 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:54:34,385 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:34,387 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:54:34,387 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:54:34,387 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:34,387 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:54:34,388 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:34,388 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:34,388 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:34,388 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:54:34,389 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:54:34,389 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:54:34,389 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:54:34,389 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:54:34,389 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:54:34,389 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:54:34,390 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:54:34,390 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:54:34,390 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:54:34,390 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:54:34,390 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:54:34,391 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:34,391 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:54:34,391 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:34,392 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:34,392 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:34,392 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:54:34,392 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:54:34,392 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:54:34,393 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:54:34,398 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:54:34,398 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:34,400 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:34,400 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:34,402 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:34,402 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:34,402 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:34,403 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:34,412 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5238, Threshold=0.5889, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:54:34,412 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5238
2025-08-04 20:54:54,741 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:54,741 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:54,741 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:54,742 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:54:54,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:54:54,742 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:55,183 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:55,183 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:55,285 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:54:55,311 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:54:55,312 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:55,413 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:55,418 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:55,419 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:55,425 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:54:55,442 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:55,442 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:54:55,442 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:55,443 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:55,443 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:54:55,452 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:55,455 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:55,458 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:55,460 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:55,463 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:55,465 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:55,468 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:55,470 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:55,473 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:55,476 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:55,478 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:55,490 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:55,490 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:54:55,494 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:54:55,495 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:54:55,500 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:55,500 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:54:55,513 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:55,513 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:54:55,513 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:55,531 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:55,536 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:54:55,543 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:54:55,543 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:55,543 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:55,543 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:55,543 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:55,544 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:55,544 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:54:55,544 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:55,544 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:54:55,545 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:55,546 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:54:55,546 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:54:55,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:55,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:54:55,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:55,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:55,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:55,547 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:54:55,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:54:55,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:54:55,548 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:54:55,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:54:55,548 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:54:55,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:54:55,548 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:54:55,548 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:54:55,549 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:54:55,549 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:54:55,549 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:54:55,549 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:55,550 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:54:55,550 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:55,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:55,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:55,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:54:55,551 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:54:55,551 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:54:55,552 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:54:55,557 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:54:55,557 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:55,559 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:55,559 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:55,561 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:55,561 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:55,561 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:55,562 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:55,572 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5547, Threshold=0.6229, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:54:55,572 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5547
2025-08-04 20:55:15,883 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:15,883 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:55:15,883 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:55:15,883 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:55:15,883 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:55:15,883 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:16,366 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:16,367 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:16,475 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:55:16,517 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:55:16,517 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:16,650 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:16,660 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:16,660 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:16,667 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:55:16,677 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:16,677 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:55:16,678 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:16,678 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:16,678 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:55:16,688 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:16,690 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:16,693 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:16,695 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:16,698 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:16,700 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:16,703 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:16,706 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:16,708 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:16,710 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:16,713 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:16,723 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:16,723 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:55:16,728 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:55:16,728 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:55:16,733 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:16,733 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:55:16,743 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:16,743 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:55:16,743 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:16,759 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:16,764 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:55:16,771 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:55:16,771 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:16,771 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:16,771 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:16,771 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:16,772 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:16,772 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:55:16,772 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:16,772 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:55:16,773 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:16,774 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:55:16,774 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:55:16,775 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:16,775 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:55:16,775 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:16,775 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:16,775 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:16,775 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:55:16,775 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:55:16,776 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:55:16,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:55:16,776 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:55:16,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:55:16,776 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:55:16,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:55:16,777 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:55:16,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:55:16,778 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:55:16,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:55:16,778 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:16,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:55:16,779 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:16,779 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:16,779 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:16,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:55:16,779 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:55:16,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:55:16,780 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:55:16,786 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:55:16,786 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:16,788 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:16,788 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:55:16,790 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:16,790 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:16,790 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:16,791 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:16,800 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5388, Threshold=0.6072, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:55:16,800 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5388
2025-08-04 20:55:34,076 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:34,076 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:55:34,076 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:55:34,076 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:55:34,076 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:55:34,077 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:34,482 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:34,482 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:34,589 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:55:34,639 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:55:34,640 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:34,810 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:34,818 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:34,818 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:34,826 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:55:34,835 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:34,836 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:55:34,837 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:34,837 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:34,837 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:55:34,850 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:34,853 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:34,855 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:34,858 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:34,861 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:34,865 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:34,868 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:34,870 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:34,873 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:34,876 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:34,879 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:34,890 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:34,890 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:55:34,895 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:55:34,895 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:55:34,901 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:34,901 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:55:34,917 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:34,917 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:55:34,917 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:34,939 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:34,945 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:55:34,951 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:55:34,951 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:34,951 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:34,951 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:34,952 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:34,953 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:34,953 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:55:34,954 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:34,954 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:55:34,954 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:34,960 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:55:34,961 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:55:34,961 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:34,962 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:55:34,962 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:34,962 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:34,962 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:34,962 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:55:34,962 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:55:34,962 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:55:34,963 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:55:34,963 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:55:34,963 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:55:34,963 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:55:34,963 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:55:34,964 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:55:34,964 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:55:34,965 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:55:34,965 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:55:34,965 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:34,965 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:55:34,965 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:34,966 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:34,966 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:34,966 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:55:34,966 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:55:34,966 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:55:34,967 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:55:34,975 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:55:34,975 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:34,977 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:34,977 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:55:34,978 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:34,978 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:34,979 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:34,980 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:34,990 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4713, Threshold=0.5127, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:55:34,991 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4713
2025-08-04 20:55:55,280 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:55,280 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:55:55,280 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:55:55,280 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:55:55,280 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:55:55,280 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:55,702 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:55,703 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:55,806 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:55:55,851 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:55:55,851 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:56,033 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:56,041 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:56,041 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:56,054 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:55:56,070 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:56,070 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:55:56,071 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:56,071 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:56,071 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:55:56,083 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:56,087 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,091 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:56,093 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:56,096 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:56,099 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:56,102 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,105 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:56,109 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:56,111 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:56,113 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:56,125 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:56,125 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:55:56,131 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:55:56,131 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:55:56,139 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:56,139 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:55:56,158 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:56,159 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:55:56,159 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:56,182 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:56,189 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:55:56,208 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:55:56,209 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:56,210 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:56,210 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:56,211 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:56,212 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:56,213 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:55:56,213 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:56,214 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:55:56,216 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:56,218 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:55:56,218 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:55:56,219 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:56,219 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:55:56,219 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:56,220 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:56,221 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:56,221 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:55:56,221 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:55:56,222 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:55:56,223 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:55:56,223 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:55:56,224 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:55:56,225 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:55:56,225 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:55:56,226 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:55:56,227 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:55:56,227 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:55:56,228 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:55:56,228 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:56,229 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:55:56,230 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:56,230 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:56,232 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:56,232 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:55:56,233 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:55:56,233 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:55:56,234 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:55:56,241 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:55:56,242 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:56,243 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:56,244 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:55:56,245 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:56,245 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:56,245 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:56,246 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:56,254 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5734, Threshold=0.6543, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:55:56,255 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5734
2025-08-04 20:56:07,546 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:07,546 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:07,547 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:07,547 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:56:07,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:56:07,547 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:08,049 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:08,049 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:08,152 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:56:08,215 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:56:08,215 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:08,426 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:08,434 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:08,434 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:08,442 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:56:08,450 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:08,451 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:56:08,452 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:08,452 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:08,453 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:56:08,467 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:08,471 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:08,474 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:08,477 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:08,480 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:08,483 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:08,486 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:08,489 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:08,492 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:08,494 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:08,496 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:08,510 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:08,510 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:56:08,515 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:56:08,516 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:56:08,522 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:08,523 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:56:08,536 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:08,537 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:56:08,537 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:08,556 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:08,564 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:56:08,576 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:56:08,576 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:08,576 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:08,576 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:08,577 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:08,577 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:08,577 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:56:08,578 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:08,578 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:56:08,578 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:08,579 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:56:08,580 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:56:08,580 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:08,580 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:56:08,580 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:08,581 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:08,581 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:08,581 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:56:08,581 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:56:08,581 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:56:08,582 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:56:08,582 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:56:08,583 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:56:08,583 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:56:08,583 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:56:08,584 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:56:08,584 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:56:08,584 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:56:08,585 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:56:08,585 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:08,585 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:56:08,585 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:08,586 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:08,586 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:08,587 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:56:08,587 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:56:08,588 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:56:08,588 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:56:08,598 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:56:08,598 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:08,599 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:08,600 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:08,601 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:08,601 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:08,601 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:08,602 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:08,611 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5005, Threshold=0.5429, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:56:08,611 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5005
2025-08-04 20:56:25,900 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:25,900 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:25,901 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:25,901 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:56:25,901 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:56:25,901 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:26,342 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:26,342 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:26,439 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:56:26,474 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:56:26,474 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:26,613 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:26,620 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:26,620 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:26,626 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:56:26,632 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:26,633 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:56:26,634 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:26,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:26,634 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:56:26,646 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:26,651 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:26,653 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:26,657 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:26,659 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:26,662 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:26,664 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:26,667 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:26,670 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:26,673 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:26,676 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:26,688 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:26,688 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:56:26,693 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:56:26,693 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:56:26,699 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:26,700 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:56:26,715 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:26,716 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:56:26,716 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:26,733 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:26,738 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:56:26,744 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:56:26,744 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:26,745 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:26,745 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:26,745 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:26,746 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:26,746 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:56:26,746 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:26,746 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:56:26,746 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:26,748 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:56:26,748 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:56:26,748 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:26,749 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:56:26,749 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:26,749 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:26,749 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:26,749 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:56:26,749 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:56:26,749 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:56:26,750 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:56:26,750 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:56:26,750 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:56:26,750 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:56:26,751 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:56:26,751 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:56:26,751 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:56:26,751 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:56:26,752 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:56:26,752 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:26,752 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:56:26,752 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:26,752 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:26,753 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:26,753 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:56:26,753 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:56:26,754 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:56:26,754 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:56:26,761 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:56:26,761 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:26,763 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:26,764 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:26,765 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:26,768 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:26,768 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:26,769 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:26,777 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5551, Threshold=0.6300, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:56:26,777 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5551
2025-08-04 20:56:47,056 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:47,056 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:47,056 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:47,056 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:56:47,056 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:56:47,056 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:47,506 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:47,506 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:47,616 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:56:47,669 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:56:47,669 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:47,814 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:47,822 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:47,823 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:47,831 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:56:47,840 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:47,840 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:56:47,841 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:47,841 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:47,842 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:56:47,852 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:47,856 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:47,858 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:47,860 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:47,863 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:47,866 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:47,869 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:47,873 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:47,876 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:47,878 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:47,881 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:47,893 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:47,893 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:56:47,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:56:47,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:56:47,905 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:47,905 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:56:47,922 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:47,922 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:56:47,923 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:47,943 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:47,954 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:56:47,964 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:56:47,967 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:47,967 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:47,967 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:47,968 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:47,968 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:47,968 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:56:47,968 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:47,969 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:56:47,969 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:47,971 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:56:47,974 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:56:47,974 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:47,975 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:56:47,975 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:47,975 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:47,975 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:47,976 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:56:47,976 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:56:47,976 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:56:47,976 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:56:47,976 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:56:47,977 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:56:47,977 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:56:47,977 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:56:47,978 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:56:47,978 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:56:47,978 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:56:47,979 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:56:47,979 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:47,979 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:56:47,980 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:47,980 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:47,980 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:47,980 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:56:47,981 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:56:47,981 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:56:47,981 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:56:47,986 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:56:47,986 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:47,988 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:47,988 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:47,990 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:47,990 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:47,990 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:47,991 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:48,001 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4705, Threshold=0.5055, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:56:48,001 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4705
2025-08-04 20:57:05,284 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:05,284 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:05,284 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:05,285 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:57:05,285 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:57:05,285 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:05,644 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:05,645 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:05,736 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:57:05,772 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:57:05,772 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:05,922 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:05,932 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:05,933 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:05,944 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:57:05,955 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:05,955 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:57:05,956 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:05,956 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:05,956 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:57:05,967 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:05,970 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:05,973 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:05,976 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:05,980 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:05,983 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:05,986 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:05,989 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:05,992 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:05,994 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:05,998 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:06,012 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:06,012 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:57:06,019 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:57:06,019 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:57:06,028 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:06,028 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:57:06,039 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:06,040 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:57:06,040 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:06,057 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:06,063 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:57:06,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:57:06,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:06,082 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:06,082 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:06,083 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:06,083 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:06,083 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:57:06,083 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:06,084 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:57:06,084 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:06,085 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:57:06,085 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:57:06,086 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:06,086 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:57:06,086 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:06,086 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:06,087 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:06,087 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:57:06,087 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:57:06,087 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:57:06,087 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:57:06,087 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:57:06,088 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:57:06,088 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:57:06,088 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:57:06,088 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:57:06,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:57:06,089 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:57:06,089 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:57:06,089 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:06,090 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:57:06,090 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:06,090 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:06,090 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:06,091 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:57:06,091 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:57:06,092 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:57:06,092 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:57:06,101 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:57:06,101 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:06,103 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:06,103 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:06,105 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:06,105 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:06,105 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:06,106 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:06,115 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5271, Threshold=0.5854, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:57:06,115 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5271
2025-08-04 20:57:26,398 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:26,398 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:26,398 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:26,398 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:57:26,398 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:57:26,398 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:26,819 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:26,819 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:26,916 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:57:26,966 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:57:26,966 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:27,121 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:27,130 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:27,130 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:27,138 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:57:27,149 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:27,149 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:57:27,150 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:27,150 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:27,151 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:57:27,161 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:27,164 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:27,167 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:27,169 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:27,172 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:27,175 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:27,177 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:27,180 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:27,183 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:27,185 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:27,188 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:27,200 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:27,200 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:57:27,205 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:57:27,205 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:57:27,212 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:27,212 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:57:27,228 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:27,229 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:57:27,229 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:27,249 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:27,255 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:57:27,261 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:57:27,261 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:27,261 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:27,261 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:27,262 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:27,262 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:27,263 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:57:27,263 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:27,263 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:57:27,263 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:27,265 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:57:27,265 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:57:27,265 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:27,265 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:57:27,266 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:27,266 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:27,266 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:27,266 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:57:27,267 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:57:27,267 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:57:27,267 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:57:27,267 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:57:27,267 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:57:27,268 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:57:27,268 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:57:27,268 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:57:27,269 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:57:27,269 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:57:27,269 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:57:27,270 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:27,270 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:57:27,270 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:27,271 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:27,271 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:27,271 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:57:27,272 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:57:27,272 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:57:27,272 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:57:27,279 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:57:27,279 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:27,281 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:27,281 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:27,284 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:27,284 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:27,284 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:27,285 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:27,298 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5358, Threshold=0.5960, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:57:27,298 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5358
2025-08-04 20:57:32,561 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:32,561 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:32,562 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:32,562 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:57:32,562 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:57:32,562 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:32,916 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:32,917 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:33,001 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:57:33,024 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:57:33,024 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:33,128 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:33,134 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:33,135 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:33,140 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:57:33,145 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:33,145 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:57:33,146 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:33,146 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:33,146 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:57:33,155 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:33,158 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:33,160 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:33,162 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:33,165 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:33,167 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:33,170 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:33,173 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:33,176 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:33,179 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:33,181 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:33,190 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:33,190 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:57:33,195 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:57:33,195 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:57:33,201 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:33,201 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:57:33,213 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:33,213 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:57:33,213 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:33,228 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:33,233 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:57:33,237 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:57:33,238 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:33,238 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:33,238 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:33,238 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:33,239 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:33,239 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:57:33,239 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:33,239 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:57:33,239 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:33,241 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:57:33,241 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:57:33,242 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:33,242 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:57:33,242 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:33,242 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:33,242 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:33,243 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:57:33,243 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:57:33,243 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:57:33,243 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:57:33,243 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:57:33,243 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:57:33,243 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:57:33,244 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:57:33,244 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:57:33,244 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:57:33,244 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:57:33,244 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:57:33,244 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:33,245 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:57:33,245 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:33,245 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:33,245 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:33,245 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:57:33,246 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:57:33,246 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:57:33,246 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:57:33,254 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:57:33,254 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:33,255 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:33,255 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:33,257 - ClientAppLogger [Client 3] - INFO - [Client] Fit started for round 150/400.
2025-08-04 20:57:33,358 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:33,359 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:33,360 - ClientAppLogger [Client 3] - INFO - [Client] Semi-supervised: Added 71 anomalous samples to GAN training data (target: 71).
2025-08-04 20:57:33,361 - ClientAppLogger [Client 3] - INFO - [Client] Round 150: Training GAN with 309 samples (238 normal, 71 anomalous).
2025-08-04 20:57:33,361 - ClientAppLogger [Client 3] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:33,631 - ClientAppLogger [Client 3] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0830, Avg D Loss: 0.7610
2025-08-04 20:57:33,631 - ClientAppLogger [Client 3] - INFO - GAN Training completed. Avg G Loss: 2.0830, Avg D Loss: 0.7610
2025-08-04 20:57:33,631 - ClientAppLogger [Client 3] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:33,640 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5365, Threshold=0.6075, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:57:33,640 - ClientAppLogger [Client 3] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:57:33,641 - ClientAppLogger [Client 3] - INFO - Fit completed for round 150. Duration: 0.38s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '3', 'server_round': 150, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.082965792807175, 'd_loss': 0.7609642293268039, 'post_fit_local_f1': 0.8125, 'fit_time_seconds': 0.3833353519439697, 'cpu_percent_fit': 12.625, 'ram_mb_fit': 7.0703125, 'accumulated_train_samples_this_round': 309}
2025-08-04 20:57:33,641 - ClientAppLogger [Client 3] - INFO - [Client] get_parameters called
2025-08-04 20:57:47,926 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:47,926 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:47,926 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:47,926 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:57:47,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:57:47,926 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:48,231 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:48,232 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:48,323 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:57:48,367 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:57:48,367 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:48,521 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:48,528 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:48,529 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:48,537 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:57:48,546 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:48,546 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:57:48,551 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:48,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:48,551 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:57:48,561 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:48,564 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:48,567 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:48,570 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:48,576 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:48,579 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:48,583 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:48,587 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:48,591 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:48,594 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:48,597 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:48,610 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:48,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:57:48,615 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:57:48,616 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:57:48,622 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:48,622 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:57:48,634 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:48,635 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:57:48,635 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:48,652 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:48,657 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:57:48,663 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:57:48,664 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:48,664 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:48,664 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:48,664 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:48,665 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:48,665 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:57:48,665 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:48,665 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:57:48,665 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:48,667 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:57:48,667 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:57:48,668 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:48,668 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:57:48,668 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:48,668 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:48,668 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:48,668 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:57:48,669 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:57:48,669 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:57:48,669 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:57:48,669 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:57:48,669 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:57:48,670 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:57:48,670 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:57:48,670 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:57:48,670 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:57:48,671 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:57:48,671 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:57:48,671 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:48,671 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:57:48,672 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:48,672 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:48,672 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:48,672 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:57:48,672 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:57:48,673 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:57:48,673 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:57:48,679 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:57:48,680 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:48,681 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:48,682 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:48,683 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:48,683 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:48,683 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:48,684 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:48,693 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5404, Threshold=0.6048, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:57:48,693 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5404
2025-08-04 20:58:05,981 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:05,981 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:58:05,982 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:58:05,982 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:58:05,982 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:58:05,982 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:06,367 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:06,367 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:06,461 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:58:06,494 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:58:06,494 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:06,621 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:06,631 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:06,631 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:06,638 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:58:06,648 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:06,648 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:58:06,649 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:06,649 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:06,649 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:58:06,661 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:06,665 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:06,668 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:06,671 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:06,674 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:06,676 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:06,680 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:06,682 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:06,686 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:06,688 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:06,692 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:06,706 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:06,707 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:58:06,712 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:58:06,712 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:58:06,719 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:06,719 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:58:06,732 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:06,732 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:58:06,733 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:06,751 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:06,757 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:58:06,768 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:58:06,768 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:06,768 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:06,768 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:06,769 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:06,769 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:06,769 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:58:06,769 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:06,770 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:58:06,770 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:06,771 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:58:06,772 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:58:06,772 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:06,772 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:58:06,773 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:06,773 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:06,773 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:06,773 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:58:06,774 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:58:06,774 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:58:06,774 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:58:06,774 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:58:06,775 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:58:06,775 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:58:06,775 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:58:06,775 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:58:06,776 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:58:06,776 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:58:06,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:58:06,778 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:06,778 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:58:06,778 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:06,778 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:06,779 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:06,779 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:58:06,779 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:58:06,780 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:58:06,780 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:58:06,793 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:58:06,793 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:06,795 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:06,796 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:58:06,798 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:06,798 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:06,799 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:06,800 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:06,812 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5159, Threshold=0.5729, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:58:06,812 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5159
2025-08-04 20:58:27,118 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:27,118 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:58:27,118 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:58:27,119 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:58:27,119 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:58:27,119 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:27,465 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:27,465 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:27,557 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:58:27,586 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:58:27,587 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:27,725 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:27,731 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:27,731 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:27,739 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:58:27,748 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:27,748 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:58:27,749 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:27,749 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:27,749 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:58:27,758 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:27,761 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:27,764 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:27,766 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:27,769 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:27,772 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:27,774 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:27,777 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:27,780 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:27,783 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:27,786 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:27,796 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:27,796 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:58:27,801 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:58:27,801 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:58:27,808 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:27,809 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:58:27,821 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:27,822 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:58:27,822 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:27,840 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:27,847 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:58:27,859 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:58:27,859 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:27,859 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:27,859 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:27,860 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:27,860 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:27,860 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:58:27,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:27,861 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:58:27,861 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:27,862 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:58:27,863 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:58:27,863 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:27,863 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:58:27,863 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:27,863 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:27,863 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:27,864 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:58:27,864 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:58:27,864 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:58:27,864 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:58:27,864 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:58:27,864 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:58:27,865 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:58:27,865 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:58:27,865 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:58:27,865 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:58:27,866 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:58:27,866 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:58:27,866 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:27,866 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:58:27,866 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:27,866 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:27,867 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:27,867 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:58:27,867 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:58:27,867 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:58:27,867 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:58:27,872 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:58:27,873 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:27,874 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:27,874 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:58:27,876 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:27,876 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:27,876 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:27,877 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:27,886 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5701, Threshold=0.6456, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:58:27,886 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5701
2025-08-04 20:58:45,180 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:45,180 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:58:45,180 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:58:45,180 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:58:45,180 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:58:45,180 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:45,521 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:45,521 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:45,611 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:58:45,640 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:58:45,641 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:45,770 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:45,777 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:45,777 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:45,782 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:58:45,788 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:45,788 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:58:45,789 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:45,789 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:45,789 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:58:45,799 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:45,802 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:45,804 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:45,807 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:45,809 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:45,812 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:45,815 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:45,818 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:45,821 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:45,823 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:45,825 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:45,837 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:45,838 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:58:45,842 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:58:45,843 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:58:45,849 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:45,849 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:58:45,859 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:45,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:58:45,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:45,876 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:45,880 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:58:45,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:58:45,898 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:45,898 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:45,898 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:45,899 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:45,899 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:45,899 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:58:45,899 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:45,900 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:58:45,900 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:45,901 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:58:45,901 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:58:45,902 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:45,902 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:58:45,902 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:45,902 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:45,902 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:45,902 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:58:45,903 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:58:45,903 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:58:45,903 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:58:45,903 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:58:45,903 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:58:45,903 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:58:45,904 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:58:45,904 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:58:45,904 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:58:45,905 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:58:45,905 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:58:45,905 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:45,905 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:58:45,905 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:45,905 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:45,906 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:45,906 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:58:45,906 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:58:45,906 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:58:45,906 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:58:45,912 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:58:45,912 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:45,914 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:45,914 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:58:45,915 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:45,915 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:45,915 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:45,916 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:45,924 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.4713, Threshold=0.5129, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:58:45,925 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.4713
2025-08-04 20:59:06,233 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:06,233 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:06,233 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:06,233 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:59:06,234 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:59:06,234 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:06,640 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:06,640 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:06,749 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:59:06,789 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:59:06,789 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:06,946 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:06,956 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:06,956 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:06,964 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:59:06,971 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:06,971 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:59:06,972 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:06,972 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:06,972 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:59:06,982 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:06,985 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:06,987 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:06,989 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:06,992 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:06,995 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:06,997 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:07,000 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:07,003 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:07,005 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:07,007 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:07,018 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:07,018 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:59:07,023 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:59:07,023 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:59:07,029 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:07,029 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:59:07,043 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:07,043 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:59:07,044 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:07,062 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:07,068 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:59:07,079 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:59:07,079 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:07,079 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:07,079 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:07,080 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:07,080 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:07,080 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:59:07,080 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:07,080 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:59:07,081 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:07,082 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:59:07,082 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:59:07,083 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:07,083 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:59:07,083 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:07,083 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:07,083 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:07,084 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:59:07,084 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:59:07,084 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:59:07,084 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:59:07,084 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:59:07,084 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:59:07,085 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:59:07,085 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:59:07,085 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:59:07,085 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:59:07,086 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:59:07,086 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:59:07,086 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:07,086 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:59:07,087 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:07,087 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:07,087 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:07,087 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:59:07,088 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:59:07,088 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:59:07,088 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:59:07,093 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:59:07,093 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:07,095 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:07,095 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:07,097 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:07,097 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:07,097 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:07,098 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:07,108 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5316, Threshold=0.5935, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:59:07,108 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5316
2025-08-04 20:59:24,393 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:24,393 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:24,393 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:24,393 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:59:24,393 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:59:24,394 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:24,733 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:24,733 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:24,834 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:59:24,860 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:59:24,860 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:24,987 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:24,994 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:24,995 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:25,000 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:59:25,006 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:25,006 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:59:25,007 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:25,007 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:25,007 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:59:25,016 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:25,019 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:25,021 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:25,023 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:25,026 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:25,028 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:25,030 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:25,033 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:25,036 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:25,039 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:25,041 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:25,052 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:25,052 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:59:25,057 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:59:25,057 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:59:25,062 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:25,062 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:59:25,074 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:25,074 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:59:25,074 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:25,092 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:25,097 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:59:25,102 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:59:25,102 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:25,103 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:25,103 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:25,103 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:25,103 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:25,104 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:59:25,104 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:25,104 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:59:25,104 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:25,105 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:59:25,106 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:59:25,106 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:25,106 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:59:25,106 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:25,106 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:25,107 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:25,107 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:59:25,107 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:59:25,107 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:59:25,108 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:59:25,108 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:59:25,108 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:59:25,108 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:59:25,108 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:59:25,109 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:59:25,109 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:59:25,109 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:59:25,110 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:59:25,110 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:25,110 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:59:25,110 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:25,111 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:25,111 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:25,111 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:59:25,111 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:59:25,111 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:59:25,111 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:59:25,119 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:59:25,120 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:25,121 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:25,121 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:25,123 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:25,123 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:25,123 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:25,124 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:25,133 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5248, Threshold=0.5841, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:59:25,134 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5248
2025-08-04 20:59:36,409 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:36,409 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:36,409 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:36,409 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:59:36,409 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:59:36,409 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:36,797 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:36,797 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:36,893 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:59:36,933 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:59:36,933 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:37,076 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:37,083 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:37,083 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:37,090 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:59:37,099 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:37,100 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:59:37,100 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:37,100 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:37,101 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:59:37,110 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:37,113 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:37,116 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:37,118 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:37,121 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:37,123 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:37,126 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:37,129 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:37,132 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:37,134 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:37,137 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:37,148 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:37,148 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:59:37,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:59:37,153 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:59:37,158 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:37,159 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:59:37,171 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:37,171 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:59:37,171 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:37,189 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:37,194 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:59:37,202 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:59:37,202 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:37,202 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:37,203 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:37,203 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:37,203 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:37,203 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:59:37,204 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:37,204 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:59:37,204 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:37,205 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:59:37,206 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:59:37,206 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:37,206 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:59:37,206 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:37,206 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:37,207 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:37,207 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:59:37,207 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:59:37,207 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:59:37,207 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:59:37,207 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:59:37,207 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:59:37,208 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:59:37,208 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:59:37,208 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:59:37,208 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:59:37,209 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:59:37,209 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:59:37,209 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:37,209 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:59:37,209 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:37,210 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:37,210 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:37,210 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:59:37,210 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:59:37,210 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:59:37,211 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:59:37,215 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:59:37,215 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:37,217 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:37,217 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:37,218 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:37,218 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:37,218 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:37,219 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:37,228 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5011, Threshold=0.5729, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:59:37,228 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5011
2025-08-04 20:59:51,513 - ClientAppLogger [Client 3] - INFO - ClientApp starting for partition_id: 3. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:51,513 - ClientAppLogger [Client 3] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:51,513 - ClientAppLogger [Client 3] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:51,513 - ClientAppLogger [Client 3] - INFO - Loading data for partition 3/10...
2025-08-04 20:59:51,513 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting load_data function.
2025-08-04 20:59:51,514 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:51,913 - ClientAppLogger [Client 3] - INFO - [LoadData 3] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:51,914 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:52,005 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Numeric conversion completed.
2025-08-04 20:59:52,048 - ClientAppLogger [Client 3] - INFO - [LoadData 3] NA values filled.
2025-08-04 20:59:52,048 - ClientAppLogger [Client 3] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:52,180 - ClientAppLogger [Client 3] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:52,190 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:52,190 - ClientAppLogger [Client 3] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:52,196 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Scaler fitting process completed.
2025-08-04 20:59:52,223 - ClientAppLogger [Client 3] - INFO - [LoadData 3] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:52,223 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting semi-supervised data splitting logic.
2025-08-04 20:59:52,224 - ClientAppLogger [Client 3] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:52,224 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:52,224 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting anomaly reduction logic.
2025-08-04 20:59:52,233 - ClientAppLogger [Client 3] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:52,236 - ClientAppLogger [Client 3] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:52,238 - ClientAppLogger [Client 3] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:52,241 - ClientAppLogger [Client 3] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:52,244 - ClientAppLogger [Client 3] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:52,246 - ClientAppLogger [Client 3] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:52,249 - ClientAppLogger [Client 3] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:52,251 - ClientAppLogger [Client 3] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:52,254 - ClientAppLogger [Client 3] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:52,256 - ClientAppLogger [Client 3] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:52,258 - ClientAppLogger [Client 3] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:52,270 - ClientAppLogger [Client 3] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:52,270 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Anomaly reduction logic completed.
2025-08-04 20:59:52,276 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Normal and anomaly indices shuffled.
2025-08-04 20:59:52,276 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating unlabeled training base.
2025-08-04 20:59:52,283 - ClientAppLogger [Client 3] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:52,283 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating labeled pool.
2025-08-04 20:59:52,296 - ClientAppLogger [Client 3] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:52,296 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Labeled pool creation completed.
2025-08-04 20:59:52,297 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:52,316 - ClientAppLogger [Client 3] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:52,322 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Combining data for final AE training set.
2025-08-04 20:59:52,329 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Final AE training data combination completed.
2025-08-04 20:59:52,329 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:52,329 - ClientAppLogger [Client 3] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:52,330 - ClientAppLogger [Client 3] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:52,330 - ClientAppLogger [Client 3] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:52,330 - ClientAppLogger [Client 3] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:52,331 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] START of partitioning block.
2025-08-04 20:59:52,331 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:52,331 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 1: Full indices created.
2025-08-04 20:59:52,332 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:52,333 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 2: Full indices shuffled.
2025-08-04 20:59:52,333 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Full indices shuffled.
2025-08-04 20:59:52,334 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:52,334 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Remainder distribution completed.
2025-08-04 20:59:52,334 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:52,334 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:52,335 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:52,335 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 6: Start indices calculated. train_start=50650
2025-08-04 20:59:52,335 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Start indices calculated. Train_start=50650, Val_start=1114, Test_start=779
2025-08-04 20:59:52,335 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 7: End indices calculated. train_end=51833
2025-08-04 20:59:52,335 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: End indices calculated. Train_end=51833, Val_end=1246, Test_end=4212
2025-08-04 20:59:52,336 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 8: Partition-specific indices extracted. Num train indices: 1183
2025-08-04 20:59:52,336 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Specific indices extracted. Train idx: 1183, Val idx: 132, Test idx: 3433
2025-08-04 20:59:52,336 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9a: Train data sliced for partition. X_train_part_full shape: (1183, 17)
2025-08-04 20:59:52,336 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Train data sliced. Shape: (1183, 17)
2025-08-04 20:59:52,337 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9b: Validation data sliced for partition. X_val_part shape: (132, 17)
2025-08-04 20:59:52,337 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Validation data sliced. Shape: (132, 17)
2025-08-04 20:59:52,338 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 9c: Test data sliced for partition. X_test_part shape: (3433, 17)
2025-08-04 20:59:52,338 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Partitioning: Test data sliced. Shape: (3433, 17)
2025-08-04 20:59:52,338 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:52,338 - ClientAppLogger [Client 3] - INFO - [LoadData 3] Creating TonIoTDataset objects.
2025-08-04 20:59:52,338 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:52,339 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:52,339 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:52,339 - ClientAppLogger [Client 3] - INFO - [LoadData 3] TonIoTDataset objects created.
2025-08-04 20:59:52,340 - ClientAppLogger [Client 3] - INFO - Partition 3 (Static Datasets): Train Potential 1183, Val 132, Test 3433
2025-08-04 20:59:52,340 - ClientAppLogger [Client 3] - INFO - [Partitioning Debug 3] END of partitioning block, returning datasets.
2025-08-04 20:59:52,340 - ClientAppLogger [Client 3] - INFO - [LoadData 3] load_data function completed.
2025-08-04 20:59:52,345 - ClientAppLogger [Client 3] - INFO - Data loaded for partition 3: Train samples: 1183, Val samples: 132
2025-08-04 20:59:52,345 - ClientAppLogger [Client 3] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:52,346 - ClientAppLogger [Client 3] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:52,346 - ClientAppLogger [Client 3] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:52,348 - ClientAppLogger [Client 3] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:52,348 - ClientAppLogger [Client 3] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:52,348 - ClientAppLogger [Client 3] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:52,349 - ClientAppLogger [Client 3] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:52,358 - ClientAppLogger [Client 3] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=132, Avg Anomaly Score (all samples)=0.5086, Threshold=0.5594, Accuracy=0.7273, F1=0.8125, Precision=0.9873, Recall=0.6903
2025-08-04 20:59:52,358 - ClientAppLogger [Client 3] - INFO - [Client] Evaluation finished. Samples: 132, Acc: 0.7273, F1: 0.8125, Prec: 0.9873, Rec: 0.6903, Avg Anomaly Score: 0.5086
