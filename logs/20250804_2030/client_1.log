2025-08-04 20:30:03,374 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:03,374 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:30:03,374 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:30:03,375 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:30:03,375 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:30:03,375 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:03,656 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:03,656 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:03,738 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:30:03,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:30:03,770 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:03,863 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:03,868 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:03,868 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:03,875 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:30:03,881 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:03,882 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:30:03,882 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:03,882 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:03,882 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:30:03,891 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:03,894 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:03,897 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:03,899 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:03,902 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:03,904 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:03,909 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:03,911 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:03,914 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:03,916 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:03,918 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:03,928 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:03,928 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:30:03,932 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:30:03,933 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:30:03,937 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:03,937 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:30:03,946 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:03,946 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:30:03,946 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:03,961 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:03,965 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:30:03,972 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:30:03,972 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:03,972 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:03,972 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:03,972 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:03,973 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:03,973 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:30:03,973 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:03,973 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:30:03,973 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:03,975 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:30:03,975 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:30:03,975 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:03,975 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:30:03,976 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:03,976 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:03,976 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:03,976 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:30:03,976 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:30:03,976 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:30:03,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:30:03,977 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:30:03,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:30:03,980 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:30:03,980 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:30:03,980 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:30:03,980 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:30:03,981 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:30:03,981 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:30:03,981 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:03,981 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:30:03,981 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:03,982 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:03,982 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:03,982 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:30:03,982 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:30:03,982 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:30:03,982 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:30:03,985 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:30:03,985 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:03,986 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:03,986 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:30:03,988 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:03,988 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:03,988 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:03,988 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:04,000 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3505, Threshold=0.3653, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:30:04,000 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3505
2025-08-04 20:30:21,298 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:21,298 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:30:21,299 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:30:21,299 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:30:21,299 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:30:21,299 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:21,650 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:21,650 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:21,741 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:30:21,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:30:21,765 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:21,858 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:21,867 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:21,867 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:21,877 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:30:21,890 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:21,890 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:30:21,891 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:21,891 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:21,891 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:30:21,904 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:21,907 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:21,909 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:21,913 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:21,916 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:21,919 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:21,922 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:21,925 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:21,928 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:21,930 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:21,933 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:21,943 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:21,943 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:30:21,948 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:30:21,948 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:30:21,953 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:21,953 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:30:21,965 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:21,965 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:30:21,965 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:21,982 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:21,987 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:30:21,993 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:30:21,993 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:21,993 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:21,993 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:21,994 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:21,994 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:21,994 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:30:21,994 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:21,994 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:30:21,995 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:21,996 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:30:21,996 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:30:21,997 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:21,997 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:30:21,997 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:21,997 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:21,997 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:21,997 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:30:21,998 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:30:21,998 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:30:21,998 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:30:21,998 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:30:21,998 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:30:22,002 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:30:22,002 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:30:22,002 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:30:22,003 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:30:22,003 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:30:22,003 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:30:22,004 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:22,004 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:30:22,005 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:22,005 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:22,005 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:22,005 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:30:22,005 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:30:22,006 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:30:22,006 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:30:22,010 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:30:22,010 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:22,012 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:22,012 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:30:22,014 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:22,014 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:22,014 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:22,015 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:22,030 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3403, Threshold=0.3550, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:30:22,031 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3403
2025-08-04 20:30:33,315 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:33,316 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:30:33,316 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:30:33,316 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:30:33,316 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:30:33,316 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:33,720 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:33,721 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:33,811 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:30:33,844 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:30:33,844 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:33,950 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:33,957 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:33,957 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:33,968 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:30:33,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:33,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:30:33,977 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:33,978 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:33,978 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:30:33,988 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:33,991 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:33,993 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:33,995 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:33,998 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:34,000 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:34,003 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:34,005 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:34,008 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:34,010 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:34,013 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:34,027 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:34,027 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:30:34,033 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:30:34,033 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:30:34,039 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:34,040 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:30:34,051 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:34,052 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:30:34,052 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:34,072 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:34,078 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:30:34,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:30:34,086 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:34,086 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:34,086 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:34,086 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:34,086 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:34,087 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:30:34,087 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:34,087 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:30:34,087 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:34,088 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:30:34,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:30:34,089 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:34,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:30:34,089 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:34,089 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:34,089 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:34,090 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:30:34,090 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:30:34,090 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:30:34,090 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:30:34,090 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:30:34,090 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:30:34,094 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:30:34,095 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:30:34,095 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:30:34,095 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:30:34,095 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:30:34,095 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:30:34,095 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:34,096 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:30:34,096 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:34,097 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:34,097 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:34,097 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:30:34,097 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:30:34,097 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:30:34,097 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:30:34,100 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:30:34,100 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:34,102 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:34,103 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:30:34,107 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:34,107 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:34,108 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:34,108 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:34,122 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3477, Threshold=0.3627, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:30:34,123 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3477
2025-08-04 20:30:48,421 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:48,421 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:30:48,421 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:30:48,422 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:30:48,422 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:30:48,422 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:48,810 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:48,810 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:48,912 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:30:48,952 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:30:48,952 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:49,048 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:49,055 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:49,055 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:49,062 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:30:49,070 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:49,071 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:30:49,071 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:49,071 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:49,072 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:30:49,082 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:49,085 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:49,087 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:49,089 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:49,092 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:49,094 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:49,096 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:49,099 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:49,101 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:49,103 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:49,106 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:49,119 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:49,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:30:49,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:30:49,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:30:49,132 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:49,132 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:30:49,151 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:49,152 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:30:49,152 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:49,170 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:49,176 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:30:49,185 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:30:49,185 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:49,185 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:49,186 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:49,186 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:49,186 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:49,187 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:30:49,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:49,187 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:30:49,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:49,189 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:30:49,189 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:30:49,190 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:49,190 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:30:49,190 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:49,190 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:49,191 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:49,191 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:30:49,191 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:30:49,191 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:30:49,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:30:49,192 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:30:49,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:30:49,197 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:30:49,197 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:30:49,197 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:30:49,197 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:30:49,198 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:30:49,198 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:30:49,198 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:49,198 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:30:49,199 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:49,199 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:49,200 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:49,200 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:30:49,200 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:30:49,200 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:30:49,200 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:30:49,205 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:30:49,205 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:49,206 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:49,207 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:30:49,208 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:49,208 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:49,209 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:49,209 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:49,224 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3387, Threshold=0.3532, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:30:49,224 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3387
2025-08-04 20:31:06,533 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:06,533 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:06,533 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:06,533 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:31:06,534 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:31:06,534 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:06,929 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:06,929 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:07,023 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:31:07,060 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:31:07,061 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:07,177 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:07,185 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:07,186 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:07,213 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:31:07,260 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:07,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:31:07,261 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:07,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:07,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:31:07,272 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:07,276 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:07,279 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:07,282 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:07,285 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:07,289 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:07,293 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:07,300 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:07,303 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:07,305 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:07,308 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:07,321 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:07,321 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:31:07,327 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:31:07,327 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:31:07,334 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:07,334 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:31:07,351 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:07,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:31:07,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:07,369 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:07,374 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:31:07,382 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:31:07,382 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:07,382 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:07,382 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:07,382 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:07,383 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:07,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:31:07,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:07,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:31:07,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:07,385 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:31:07,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:31:07,386 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:07,386 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:31:07,386 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:07,386 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:07,386 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:07,387 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:31:07,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:31:07,387 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:31:07,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:31:07,387 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:31:07,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:31:07,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:31:07,390 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:31:07,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:31:07,390 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:31:07,391 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:31:07,391 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:31:07,391 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:07,391 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:31:07,391 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:07,392 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:07,392 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:07,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:31:07,392 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:31:07,392 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:31:07,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:31:07,400 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:31:07,400 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:07,401 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:07,402 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:07,403 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:07,403 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:07,403 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:07,404 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:07,419 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3463, Threshold=0.3603, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:31:07,419 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3463
2025-08-04 20:31:21,701 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:21,701 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:21,701 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:21,701 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:31:21,701 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:31:21,701 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:21,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:21,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:22,063 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:31:22,091 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:31:22,092 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:22,191 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:22,197 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:22,198 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:22,203 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:31:22,209 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:22,210 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:31:22,210 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:22,210 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:22,210 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:31:22,219 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:22,222 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:22,224 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:22,227 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:22,230 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:22,232 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:22,235 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:22,237 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:22,240 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:22,242 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:22,244 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:22,254 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:22,255 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:31:22,260 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:31:22,260 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:31:22,264 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:22,265 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:31:22,274 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:22,274 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:31:22,275 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:22,291 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:22,297 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:31:22,307 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:31:22,308 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:22,308 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:22,308 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:22,309 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:22,309 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:22,309 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:31:22,309 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:22,309 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:31:22,310 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:22,311 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:31:22,311 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:31:22,312 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:22,312 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:31:22,312 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:22,312 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:22,312 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:22,313 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:31:22,313 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:31:22,313 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:31:22,313 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:31:22,314 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:31:22,314 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:31:22,319 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:31:22,319 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:31:22,319 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:31:22,319 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:31:22,319 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:31:22,320 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:31:22,320 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:22,320 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:31:22,321 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:22,321 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:22,321 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:22,321 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:31:22,321 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:31:22,322 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:31:22,322 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:31:22,325 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:31:22,326 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:22,327 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:22,327 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:22,329 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:22,330 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:22,330 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:22,331 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:22,345 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3485, Threshold=0.3627, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:31:22,346 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3485
2025-08-04 20:31:36,638 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:36,638 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:36,638 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:36,638 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:31:36,638 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:31:36,638 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:36,958 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:36,958 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:37,053 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:31:37,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:31:37,089 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:37,194 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:37,206 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:37,206 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:37,215 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:31:37,223 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:37,223 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:31:37,224 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:37,224 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:37,224 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:31:37,234 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:37,236 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:37,239 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:37,241 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:37,244 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:37,247 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:37,249 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:37,252 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:37,255 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:37,258 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:37,260 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:37,270 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:37,271 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:31:37,276 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:31:37,276 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:31:37,281 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:37,282 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:31:37,292 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:37,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:31:37,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:37,309 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:37,315 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:31:37,324 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:31:37,324 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:37,324 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:37,324 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:37,325 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:37,325 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:37,325 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:31:37,325 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:37,326 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:31:37,326 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:37,327 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:31:37,327 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:31:37,328 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:37,328 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:31:37,328 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:37,328 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:37,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:37,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:31:37,329 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:31:37,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:31:37,329 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:31:37,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:31:37,330 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:31:37,332 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:31:37,332 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:31:37,332 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:31:37,332 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:31:37,332 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:31:37,333 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:31:37,333 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:37,333 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:31:37,333 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:37,334 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:37,334 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:37,334 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:31:37,334 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:31:37,334 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:31:37,334 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:31:37,341 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:31:37,341 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:37,342 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:37,343 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:37,344 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:37,345 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:37,345 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:37,346 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:37,358 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3279, Threshold=0.3411, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:31:37,359 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3279
2025-08-04 20:31:48,709 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:48,709 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:48,709 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:48,709 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:31:48,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:31:48,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:49,172 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:49,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:49,266 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:31:49,308 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:31:49,308 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:49,469 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:49,482 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:49,482 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:49,496 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:31:49,511 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:49,511 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:31:49,512 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:49,512 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:49,512 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:31:49,523 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:49,526 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:49,529 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:49,531 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:49,534 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:49,537 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:49,540 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:49,543 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:49,546 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:49,548 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:49,551 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:49,565 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:49,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:31:49,570 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:31:49,571 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:31:49,576 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:49,576 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:31:49,591 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:49,591 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:31:49,591 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:49,610 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:49,617 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:31:49,629 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:31:49,630 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:49,630 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:49,630 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:49,631 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:49,631 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:49,631 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:31:49,631 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:49,632 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:31:49,632 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:49,633 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:31:49,634 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:31:49,634 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:49,634 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:31:49,634 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:49,635 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:49,635 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:49,635 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:31:49,635 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:31:49,636 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:31:49,636 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:31:49,636 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:31:49,636 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:31:49,640 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:31:49,640 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:31:49,641 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:31:49,641 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:31:49,641 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:31:49,642 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:31:49,642 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:49,642 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:31:49,643 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:49,643 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:49,643 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:49,643 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:31:49,644 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:31:49,644 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:31:49,644 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:31:49,649 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:31:49,649 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:49,651 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:49,651 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:49,653 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:49,653 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:49,654 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:49,655 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:49,672 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3478, Threshold=0.3632, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:31:49,672 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3478
2025-08-04 20:31:57,944 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:57,944 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:57,944 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:57,944 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:31:57,944 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:31:57,945 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:58,233 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:58,233 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:58,317 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:31:58,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:31:58,352 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:58,440 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:58,446 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:58,446 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:58,451 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:31:58,456 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:58,456 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:31:58,457 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:58,457 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:58,457 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:31:58,466 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:58,468 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:58,471 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:58,473 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:58,476 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:58,478 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:58,481 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:58,483 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:58,486 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:58,488 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:58,490 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:58,500 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:58,500 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:31:58,505 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:31:58,505 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:31:58,512 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:58,512 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:31:58,526 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:58,527 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:31:58,527 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:58,543 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:58,548 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:31:58,555 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:31:58,555 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:58,555 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:58,555 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:58,556 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:58,556 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:58,556 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:31:58,556 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:58,556 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:31:58,557 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:58,558 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:31:58,559 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:31:58,560 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:58,560 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:31:58,560 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:58,560 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:58,560 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:58,560 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:31:58,560 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:31:58,561 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:31:58,561 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:31:58,561 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:31:58,561 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:31:58,563 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:31:58,566 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:31:58,566 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:31:58,567 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:31:58,567 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:31:58,567 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:31:58,567 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:58,567 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:31:58,568 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:58,568 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:58,568 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:58,568 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:31:58,569 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:31:58,569 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:31:58,569 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:31:58,575 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:31:58,576 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:58,577 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:58,577 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:58,579 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 49/400.
2025-08-04 20:31:58,682 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:58,683 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:58,684 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 785 anomalous samples to GAN training data (target: 785).
2025-08-04 20:31:58,689 - ClientAppLogger [Client 1] - INFO - [Client] Round 49: Training GAN with 3403 samples (2618 normal, 785 anomalous).
2025-08-04 20:31:58,690 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:32:01,191 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0860, Avg D Loss: 0.8798
2025-08-04 20:32:01,191 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0860, Avg D Loss: 0.8798
2025-08-04 20:32:01,192 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:32:01,204 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3480, Threshold=0.3681, Accuracy=0.6978, F1=0.7921, Precision=0.9600, Recall=0.6742
2025-08-04 20:32:01,204 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.7921
2025-08-04 20:32:01,204 - ClientAppLogger [Client 1] - INFO - Fit completed for round 49. Duration: 2.62s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 49, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0859760019241835, 'd_loss': 0.8798016452558104, 'post_fit_local_f1': 0.7920792079207921, 'fit_time_seconds': 2.6232759952545166, 'cpu_percent_fit': 12.4875, 'ram_mb_fit': 3.5390625, 'accumulated_train_samples_this_round': 3403}
2025-08-04 20:32:01,205 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:32:06,463 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:06,463 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:06,463 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:06,463 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:32:06,464 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:32:06,464 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:06,740 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:06,740 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:06,826 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:32:06,863 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:32:06,863 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:06,953 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:06,959 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:06,959 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:06,966 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:32:06,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:06,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:32:06,978 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:06,978 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:06,978 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:32:06,988 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:06,991 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:06,993 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:06,995 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:06,998 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:07,000 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:07,003 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:07,005 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:07,008 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:07,010 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:07,013 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:07,023 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:07,023 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:32:07,028 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:32:07,028 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:32:07,033 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:07,033 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:32:07,043 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:07,044 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:32:07,044 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:07,060 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:07,065 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:32:07,071 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:32:07,071 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:07,071 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:07,071 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:07,072 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:07,072 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:07,072 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:32:07,072 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:07,072 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:32:07,073 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:07,074 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:32:07,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:32:07,074 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:07,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:32:07,075 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:07,075 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:07,075 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:07,075 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:32:07,076 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:32:07,076 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:32:07,076 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:32:07,076 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:32:07,076 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:32:07,079 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:32:07,079 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:32:07,079 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:32:07,080 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:32:07,080 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:32:07,080 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:32:07,080 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:07,080 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:32:07,081 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:07,081 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:07,081 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:07,081 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:32:07,081 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:32:07,081 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:32:07,082 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:32:07,086 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:32:07,087 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:07,088 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:07,088 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:07,090 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:07,090 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:07,090 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:07,091 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:07,104 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3515, Threshold=0.3718, Accuracy=0.6978, F1=0.7921, Precision=0.9600, Recall=0.6742
2025-08-04 20:32:07,104 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6978, F1: 0.7921, Prec: 0.9600, Rec: 0.6742, Avg Anomaly Score: 0.3515
2025-08-04 20:32:18,375 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:18,376 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:18,376 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:18,376 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:32:18,376 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:32:18,376 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:18,657 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:18,658 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:18,746 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:32:18,787 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:32:18,788 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:18,905 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:18,911 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:18,911 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:18,916 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:32:18,923 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:18,923 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:32:18,923 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:18,924 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:18,924 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:32:18,932 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:18,935 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:18,938 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:18,940 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:18,943 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:18,945 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:18,948 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:18,950 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:18,953 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:18,955 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:18,957 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:18,967 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:18,967 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:32:18,972 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:32:18,973 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:32:18,978 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:18,978 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:32:18,990 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:18,991 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:32:18,991 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:19,007 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:19,013 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:32:19,018 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:32:19,018 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:19,019 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:19,019 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:19,019 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:19,019 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:19,020 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:32:19,020 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:19,020 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:32:19,020 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:19,021 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:32:19,022 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:32:19,022 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:19,022 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:32:19,022 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:19,022 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:19,023 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:19,023 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:32:19,023 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:32:19,023 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:32:19,023 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:32:19,023 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:32:19,023 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:32:19,026 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:32:19,027 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:32:19,027 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:32:19,027 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:32:19,027 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:32:19,027 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:32:19,027 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:19,028 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:32:19,028 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:19,028 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:19,029 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:19,029 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:32:19,029 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:32:19,029 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:32:19,029 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:32:19,033 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:32:19,033 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:19,035 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:19,035 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:19,037 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:19,037 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:19,037 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:19,038 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:19,049 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3451, Threshold=0.3645, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:32:19,049 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3451
2025-08-04 20:32:30,339 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:30,339 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:30,339 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:30,339 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:32:30,340 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:32:30,340 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:30,621 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:30,621 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:30,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:32:30,738 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:32:30,738 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:30,828 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:30,834 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:30,834 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:30,839 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:32:30,846 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:30,847 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:32:30,847 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:30,847 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:30,847 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:32:30,856 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:30,859 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:30,861 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:30,863 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:30,866 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:30,868 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:30,870 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:30,872 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:30,875 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:30,877 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:30,879 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:30,888 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:30,889 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:32:30,893 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:32:30,894 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:32:30,898 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:30,898 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:32:30,909 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:30,909 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:32:30,909 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:30,924 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:30,929 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:32:30,934 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:32:30,934 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:30,934 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:30,935 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:30,935 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:30,935 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:30,935 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:32:30,935 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:30,936 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:32:30,936 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:30,938 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:32:30,938 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:32:30,938 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:30,938 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:32:30,938 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:30,938 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:30,939 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:30,939 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:32:30,939 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:32:30,939 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:32:30,939 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:32:30,939 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:32:30,940 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:32:30,942 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:32:30,942 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:32:30,942 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:32:30,943 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:32:30,943 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:32:30,943 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:32:30,943 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:30,943 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:32:30,944 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:30,944 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:30,944 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:30,944 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:32:30,945 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:32:30,945 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:32:30,945 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:32:30,950 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:32:30,951 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:30,952 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:30,952 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:30,954 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:30,954 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:30,954 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:30,955 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:30,968 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3523, Threshold=0.3744, Accuracy=0.6978, F1=0.7921, Precision=0.9600, Recall=0.6742
2025-08-04 20:32:30,968 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6978, F1: 0.7921, Prec: 0.9600, Rec: 0.6742, Avg Anomaly Score: 0.3523
2025-08-04 20:32:45,252 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:45,252 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:45,252 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:45,252 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:32:45,252 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:32:45,252 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:45,509 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:45,509 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:45,595 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:32:45,633 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:32:45,634 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:45,742 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:45,748 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:45,748 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:45,754 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:32:45,761 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:45,761 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:32:45,762 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:45,762 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:45,762 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:32:45,771 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:45,774 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:45,776 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:45,778 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:45,781 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:45,784 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:45,787 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:45,790 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:45,792 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:45,794 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:45,797 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:45,807 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:45,807 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:32:45,812 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:32:45,812 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:32:45,816 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:45,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:32:45,824 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:45,825 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:32:45,825 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:45,840 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:45,844 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:32:45,849 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:32:45,849 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:45,850 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:45,850 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:45,850 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:45,850 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:45,851 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:32:45,851 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:45,851 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:32:45,851 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:45,853 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:32:45,853 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:32:45,853 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:45,853 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:32:45,854 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:45,854 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:45,854 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:45,854 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:32:45,854 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:32:45,854 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:32:45,854 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:32:45,855 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:32:45,855 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:32:45,857 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:32:45,857 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:32:45,857 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:32:45,857 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:32:45,858 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:32:45,858 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:32:45,858 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:45,858 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:32:45,859 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:45,859 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:45,859 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:45,859 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:32:45,860 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:32:45,860 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:32:45,860 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:32:45,864 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:32:45,864 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:45,865 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:45,866 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:45,867 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:45,867 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:45,867 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:45,868 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:45,879 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3633, Threshold=0.3878, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:32:45,880 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3633
2025-08-04 20:32:54,152 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:54,152 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:54,152 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:54,152 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:32:54,152 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:32:54,152 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:54,443 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:54,444 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:54,526 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:32:54,570 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:32:54,570 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:54,684 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:54,690 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:54,691 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:54,696 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:32:54,703 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:54,703 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:32:54,703 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:54,704 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:54,704 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:32:54,712 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:54,715 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:54,717 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:54,719 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:54,722 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:54,724 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:54,726 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:54,729 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:54,731 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:54,733 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:54,736 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:54,745 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:54,745 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:32:54,751 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:32:54,751 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:32:54,755 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:54,755 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:32:54,764 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:54,764 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:32:54,764 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:54,779 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:54,783 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:32:54,790 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:32:54,790 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:54,791 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:54,791 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:54,791 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:54,791 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:54,792 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:32:54,792 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:54,792 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:32:54,792 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:54,793 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:32:54,794 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:32:54,794 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:54,794 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:32:54,794 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:54,794 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:54,794 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:54,795 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:32:54,795 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:32:54,795 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:32:54,795 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:32:54,795 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:32:54,795 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:32:54,797 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:32:54,797 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:32:54,798 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:32:54,798 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:32:54,798 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:32:54,798 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:32:54,798 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:54,799 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:32:54,799 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:54,799 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:54,799 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:54,800 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:32:54,800 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:32:54,800 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:32:54,800 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:32:54,805 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:32:54,805 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:54,807 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:54,807 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:54,808 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 53/400.
2025-08-04 20:32:54,910 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:54,910 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:54,912 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 846 anomalous samples to GAN training data (target: 846).
2025-08-04 20:32:54,912 - ClientAppLogger [Client 1] - INFO - [Client] Round 53: Training GAN with 3666 samples (2820 normal, 846 anomalous).
2025-08-04 20:32:54,912 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:32:57,704 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0857, Avg D Loss: 0.8750
2025-08-04 20:32:57,704 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0857, Avg D Loss: 0.8750
2025-08-04 20:32:57,704 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:32:57,716 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3632, Threshold=0.3897, Accuracy=0.6835, F1=0.7822, Precision=0.9480, Recall=0.6657
2025-08-04 20:32:57,716 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.7822
2025-08-04 20:32:57,716 - ClientAppLogger [Client 1] - INFO - Fit completed for round 53. Duration: 2.91s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 53, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.08569941659866, 'd_loss': 0.8750086529457821, 'post_fit_local_f1': 0.7821782178217822, 'fit_time_seconds': 2.9076688289642334, 'cpu_percent_fit': 12.49375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 3666}
2025-08-04 20:32:57,717 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:33:02,989 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:02,989 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:02,989 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:02,989 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:33:02,989 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:33:02,989 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:03,247 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:03,247 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:03,339 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:33:03,380 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:33:03,381 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:03,496 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:03,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:03,502 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:03,507 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:33:03,513 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:03,513 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:33:03,514 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:03,514 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:03,514 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:33:03,522 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:03,525 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:03,527 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:03,529 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:03,532 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:03,534 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:03,537 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:03,539 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:03,542 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:03,544 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:03,546 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:03,555 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:03,555 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:33:03,560 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:33:03,560 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:33:03,564 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:03,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:33:03,573 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:03,574 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:33:03,574 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:03,589 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:03,594 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:33:03,601 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:33:03,601 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:03,601 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:03,601 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:03,601 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:03,601 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:03,602 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:33:03,602 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:03,602 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:33:03,602 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:03,603 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:33:03,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:33:03,604 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:03,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:33:03,604 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:03,604 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:03,604 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:03,605 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:33:03,605 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:33:03,605 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:33:03,605 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:33:03,605 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:33:03,605 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:33:03,607 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:33:03,607 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:33:03,607 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:33:03,607 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:33:03,608 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:33:03,608 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:33:03,608 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:03,608 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:33:03,609 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:03,609 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:03,609 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:03,609 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:33:03,610 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:33:03,610 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:33:03,610 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:33:03,614 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:33:03,614 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:03,616 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:03,616 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:33:03,617 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:03,617 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:03,617 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:03,618 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:03,629 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3645, Threshold=0.3905, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:33:03,630 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3645
2025-08-04 20:33:14,920 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:14,920 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:14,920 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:14,920 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:33:14,920 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:33:14,920 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:15,217 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:15,217 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:15,307 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:33:15,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:33:15,346 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:15,458 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:15,463 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:15,463 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:15,469 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:33:15,475 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:15,475 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:33:15,476 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:15,476 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:15,476 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:33:15,484 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:15,487 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:15,489 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:15,491 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:15,494 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:15,496 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:15,499 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:15,501 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:15,504 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:15,506 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:15,508 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:15,517 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:15,517 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:33:15,522 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:33:15,522 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:33:15,526 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:15,526 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:33:15,533 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:15,534 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:33:15,534 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:15,548 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:15,552 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:33:15,557 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:33:15,557 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:15,557 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:15,557 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:15,558 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:15,558 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:15,558 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:33:15,558 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:15,558 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:33:15,559 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:15,560 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:33:15,560 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:33:15,560 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:15,560 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:33:15,561 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:15,561 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:15,561 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:15,561 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:33:15,561 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:33:15,561 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:33:15,562 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:33:15,562 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:33:15,562 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:33:15,564 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:33:15,564 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:33:15,564 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:33:15,564 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:33:15,564 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:33:15,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:33:15,565 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:15,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:33:15,565 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:15,565 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:15,565 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:15,566 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:33:15,566 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:33:15,566 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:33:15,566 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:33:15,570 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:33:15,570 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:15,571 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:15,571 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:33:15,572 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:15,573 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:15,573 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:15,573 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:15,584 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3490, Threshold=0.3733, Accuracy=0.6835, F1=0.7822, Precision=0.9480, Recall=0.6657
2025-08-04 20:33:15,584 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6835, F1: 0.7822, Prec: 0.9480, Rec: 0.6657, Avg Anomaly Score: 0.3490
2025-08-04 20:33:29,874 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:29,874 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:29,874 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:29,874 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:33:29,874 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:33:29,875 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:30,145 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:30,145 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:30,234 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:33:30,281 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:33:30,281 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:30,393 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:30,398 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:30,399 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:30,404 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:33:30,409 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:30,409 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:33:30,410 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:30,410 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:30,410 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:33:30,418 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:30,421 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:30,423 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:30,425 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:30,428 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:30,430 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:30,432 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:30,435 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:30,438 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:30,440 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:30,442 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:30,451 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:30,451 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:33:30,456 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:33:30,456 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:33:30,461 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:30,461 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:33:30,470 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:30,470 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:33:30,470 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:30,484 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:30,489 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:33:30,494 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:33:30,494 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:30,494 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:30,494 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:30,495 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:30,495 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:30,495 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:33:30,495 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:30,495 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:33:30,495 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:30,497 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:33:30,497 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:33:30,497 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:30,497 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:33:30,497 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:30,498 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:30,498 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:30,498 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:33:30,498 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:33:30,498 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:33:30,498 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:33:30,499 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:33:30,499 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:33:30,501 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:33:30,501 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:33:30,501 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:33:30,501 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:33:30,501 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:33:30,501 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:33:30,502 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:30,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:33:30,502 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:30,502 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:30,503 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:30,503 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:33:30,503 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:33:30,503 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:33:30,503 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:33:30,507 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:33:30,507 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:30,508 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:30,508 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:33:30,510 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:30,510 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:30,510 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:30,511 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:30,522 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3275, Threshold=0.3480, Accuracy=0.6787, F1=0.7789, Precision=0.9440, Recall=0.6629
2025-08-04 20:33:30,522 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6787, F1: 0.7789, Prec: 0.9440, Rec: 0.6629, Avg Anomaly Score: 0.3275
2025-08-04 20:33:47,820 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:47,820 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:47,820 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:47,820 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:33:47,820 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:33:47,821 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:48,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:48,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:48,200 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:33:48,247 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:33:48,247 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:48,358 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:48,363 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:48,364 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:48,369 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:33:48,374 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:48,374 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:33:48,374 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:48,375 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:48,375 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:33:48,383 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:48,386 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:48,388 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:48,390 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:48,392 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:48,394 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:48,397 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:48,400 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:48,402 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:48,404 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:48,406 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:48,415 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:48,415 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:33:48,419 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:33:48,419 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:33:48,424 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:48,424 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:33:48,432 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:48,433 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:33:48,433 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:48,447 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:48,451 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:33:48,457 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:33:48,458 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:48,458 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:48,458 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:48,458 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:48,459 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:48,459 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:33:48,459 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:48,459 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:33:48,459 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:48,461 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:33:48,461 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:33:48,461 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:48,461 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:33:48,461 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:48,462 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:48,462 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:48,462 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:33:48,462 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:33:48,462 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:33:48,462 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:33:48,462 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:33:48,463 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:33:48,464 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:33:48,464 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:33:48,464 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:33:48,464 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:33:48,465 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:33:48,465 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:33:48,465 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:48,465 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:33:48,465 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:48,465 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:48,466 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:48,466 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:33:48,466 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:33:48,466 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:33:48,466 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:33:48,469 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:33:48,470 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:48,471 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:48,471 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:33:48,472 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:48,472 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:48,473 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:48,473 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:48,484 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3637, Threshold=0.3909, Accuracy=0.6787, F1=0.7789, Precision=0.9440, Recall=0.6629
2025-08-04 20:33:48,484 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6787, F1: 0.7789, Prec: 0.9440, Rec: 0.6629, Avg Anomaly Score: 0.3637
2025-08-04 20:33:59,753 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:59,753 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:59,753 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:59,753 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:33:59,753 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:33:59,753 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:00,022 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:00,023 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:00,113 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:34:00,159 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:34:00,159 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:00,276 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:00,282 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:00,282 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:00,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:34:00,298 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:00,298 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:34:00,298 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:00,299 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:00,299 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:34:00,308 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:00,311 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:00,313 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:00,315 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:00,318 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:00,320 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:00,323 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:00,325 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:00,328 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:00,330 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:00,332 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:00,343 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:00,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:34:00,348 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:34:00,349 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:34:00,355 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:00,355 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:34:00,364 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:00,365 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:34:00,365 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:00,381 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:00,386 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:34:00,391 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:34:00,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:00,392 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:00,392 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:00,392 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:00,393 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:00,393 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:34:00,393 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:00,394 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:34:00,394 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:00,395 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:34:00,395 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:34:00,396 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:00,396 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:34:00,396 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:00,396 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:00,396 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:00,397 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:34:00,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:34:00,397 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:34:00,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:34:00,397 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:34:00,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:34:00,399 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:34:00,400 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:34:00,400 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:34:00,400 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:34:00,400 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:34:00,400 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:34:00,400 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:00,400 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:34:00,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:00,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:00,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:00,401 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:34:00,402 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:34:00,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:34:00,402 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:34:00,405 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:34:00,406 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:00,407 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:00,407 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:00,409 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:00,409 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:00,409 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:00,410 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:00,422 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3592, Threshold=0.3857, Accuracy=0.6787, F1=0.7789, Precision=0.9440, Recall=0.6629
2025-08-04 20:34:00,422 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6787, F1: 0.7789, Prec: 0.9440, Rec: 0.6629, Avg Anomaly Score: 0.3592
2025-08-04 20:34:11,695 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:11,695 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:34:11,695 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:34:11,695 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:34:11,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:34:11,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:11,997 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:11,998 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:12,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:34:12,123 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:34:12,124 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:12,232 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:12,238 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:12,238 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:12,243 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:34:12,248 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:12,248 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:34:12,248 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:12,248 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:12,248 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:34:12,256 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:12,259 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:12,261 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:12,263 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:12,266 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:12,268 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:12,271 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:12,273 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:12,276 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:12,278 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:12,280 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:12,288 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:12,288 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:34:12,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:34:12,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:34:12,297 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:12,297 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:34:12,305 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:12,305 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:34:12,305 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:12,319 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:12,324 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:34:12,329 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:34:12,332 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:12,332 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:12,333 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:12,333 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:12,333 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:12,334 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:34:12,335 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:12,335 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:34:12,336 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:12,337 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:34:12,337 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:34:12,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:12,338 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:34:12,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:12,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:12,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:12,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:34:12,339 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:34:12,339 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:34:12,339 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:34:12,339 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:34:12,339 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:34:12,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:34:12,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:34:12,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:34:12,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:34:12,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:34:12,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:34:12,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:12,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:34:12,344 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:12,344 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:12,344 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:12,345 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:34:12,345 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:34:12,345 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:34:12,345 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:34:12,349 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:34:12,349 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:12,350 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:12,350 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:12,351 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:12,352 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:12,352 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:12,352 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:12,364 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3687, Threshold=0.3996, Accuracy=0.6739, F1=0.7756, Precision=0.9400, Recall=0.6601
2025-08-04 20:34:12,364 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6739, F1: 0.7756, Prec: 0.9400, Rec: 0.6601, Avg Anomaly Score: 0.3687
2025-08-04 20:34:26,649 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:26,649 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:34:26,649 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:34:26,649 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:34:26,650 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:34:26,650 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:26,910 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:26,911 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:26,999 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:34:27,039 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:34:27,039 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:27,153 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:27,159 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:27,159 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:27,165 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:34:27,171 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:27,171 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:34:27,171 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:27,171 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:27,172 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:34:27,180 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:27,182 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:27,185 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:27,187 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:27,189 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:27,192 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:27,194 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:27,197 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:27,199 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:27,201 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:27,204 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:27,213 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:27,213 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:34:27,218 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:34:27,218 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:34:27,222 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:27,222 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:34:27,230 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:27,230 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:34:27,230 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:27,244 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:27,249 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:34:27,254 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:34:27,254 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:27,254 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:27,254 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:27,254 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:27,255 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:27,255 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:34:27,255 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:27,255 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:34:27,255 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:27,257 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:34:27,257 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:34:27,257 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:27,258 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:34:27,258 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:27,258 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:27,258 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:27,258 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:34:27,258 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:34:27,258 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:34:27,259 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:34:27,259 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:34:27,259 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:34:27,261 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:34:27,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:34:27,261 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:34:27,262 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:34:27,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:34:27,262 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:34:27,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:27,262 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:34:27,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:27,263 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:27,263 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:27,263 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:34:27,263 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:34:27,263 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:34:27,263 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:34:27,266 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:34:27,267 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:27,268 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:27,268 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:27,270 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:27,270 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:27,270 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:27,270 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:27,282 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3652, Threshold=0.3977, Accuracy=0.6739, F1=0.7756, Precision=0.9400, Recall=0.6601
2025-08-04 20:34:27,282 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6739, F1: 0.7756, Prec: 0.9400, Rec: 0.6601, Avg Anomaly Score: 0.3652
2025-08-04 20:34:38,559 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:38,560 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:34:38,560 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:34:38,560 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:34:38,560 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:34:38,560 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:38,856 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:38,857 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:38,944 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:34:38,986 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:34:38,986 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:39,100 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:39,105 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:39,105 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:39,111 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:34:39,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:39,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:34:39,116 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:39,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:39,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:34:39,124 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:39,127 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:39,130 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:39,132 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:39,135 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:39,137 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:39,140 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:39,142 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:39,145 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:39,147 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:39,149 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:39,157 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:39,157 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:34:39,162 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:34:39,162 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:34:39,166 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:39,166 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:34:39,175 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:39,175 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:34:39,176 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:39,190 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:39,195 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:34:39,202 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:34:39,202 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:39,202 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:39,202 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:39,203 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:39,203 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:39,203 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:34:39,203 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:39,203 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:34:39,204 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:39,205 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:34:39,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:34:39,205 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:39,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:34:39,206 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:39,206 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:39,206 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:39,206 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:34:39,206 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:34:39,206 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:34:39,206 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:34:39,206 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:34:39,206 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:34:39,208 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:34:39,208 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:34:39,208 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:34:39,208 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:34:39,209 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:34:39,209 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:34:39,209 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:39,209 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:34:39,209 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:39,210 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:39,210 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:39,210 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:34:39,210 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:34:39,210 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:34:39,210 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:34:39,215 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:34:39,215 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:39,216 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:39,216 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:39,217 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:39,218 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:39,218 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:39,218 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:39,229 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3564, Threshold=0.3856, Accuracy=0.6739, F1=0.7756, Precision=0.9400, Recall=0.6601
2025-08-04 20:34:39,229 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6739, F1: 0.7756, Prec: 0.9400, Rec: 0.6601, Avg Anomaly Score: 0.3564
2025-08-04 20:34:50,497 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:50,497 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:34:50,497 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:34:50,497 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:34:50,497 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:34:50,497 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:50,776 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:50,776 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:50,869 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:34:50,913 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:34:50,913 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:51,024 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:51,030 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:51,030 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:51,035 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:34:51,040 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:51,040 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:34:51,041 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:51,041 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:51,041 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:34:51,049 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:51,052 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:51,054 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:51,057 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:51,059 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:51,062 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:51,064 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:51,067 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:51,069 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:51,071 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:51,073 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:51,082 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:51,082 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:34:51,086 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:34:51,086 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:34:51,090 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:51,091 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:34:51,098 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:51,099 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:34:51,099 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:51,115 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:51,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:34:51,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:34:51,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:51,124 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:51,124 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:51,125 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:51,125 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:51,125 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:34:51,125 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:51,126 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:34:51,126 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:51,127 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:34:51,127 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:34:51,128 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:51,128 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:34:51,128 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:51,128 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:51,128 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:51,129 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:34:51,129 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:34:51,129 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:34:51,129 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:34:51,129 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:34:51,129 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:34:51,131 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:34:51,132 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:34:51,132 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:34:51,132 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:34:51,132 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:34:51,132 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:34:51,132 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:51,133 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:34:51,133 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:51,133 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:51,133 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:51,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:34:51,134 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:34:51,134 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:34:51,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:34:51,137 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:34:51,137 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:51,139 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:51,139 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:51,140 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:51,141 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:51,141 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:51,141 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:51,153 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3620, Threshold=0.3909, Accuracy=0.6739, F1=0.7756, Precision=0.9400, Recall=0.6601
2025-08-04 20:34:51,153 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6739, F1: 0.7756, Prec: 0.9400, Rec: 0.6601, Avg Anomaly Score: 0.3620
2025-08-04 20:35:08,424 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:08,425 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:08,425 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:08,425 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:35:08,425 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:35:08,425 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:08,773 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:08,773 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:08,865 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:35:08,910 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:35:08,910 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:09,051 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:09,057 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:09,057 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:09,063 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:35:09,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:09,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:35:09,069 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:09,069 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:09,070 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:35:09,078 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:09,082 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:09,084 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:09,087 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:09,092 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:09,095 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:09,097 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:09,100 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:09,103 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:09,105 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:09,108 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:09,118 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:09,118 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:35:09,123 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:35:09,123 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:35:09,129 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:09,129 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:35:09,138 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:09,138 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:35:09,138 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:09,155 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:09,160 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:35:09,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:35:09,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:09,167 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:09,168 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:09,168 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:09,168 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:09,168 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:35:09,169 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:09,169 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:35:09,169 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:09,170 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:35:09,170 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:35:09,171 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:09,171 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:35:09,171 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:09,171 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:09,171 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:09,171 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:35:09,171 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:35:09,172 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:35:09,172 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:35:09,172 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:35:09,172 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:35:09,175 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:35:09,175 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:35:09,176 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:35:09,176 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:35:09,176 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:35:09,176 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:35:09,176 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:09,177 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:35:09,177 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:09,177 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:09,178 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:09,178 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:35:09,178 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:35:09,178 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:35:09,178 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:35:09,182 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:35:09,182 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:09,183 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:09,183 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:09,185 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:09,185 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:09,185 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:09,186 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:09,198 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3678, Threshold=0.4019, Accuracy=0.6739, F1=0.7756, Precision=0.9400, Recall=0.6601
2025-08-04 20:35:09,198 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6739, F1: 0.7756, Prec: 0.9400, Rec: 0.6601, Avg Anomaly Score: 0.3678
2025-08-04 20:35:20,472 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:20,472 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:20,472 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:20,472 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:35:20,472 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:35:20,472 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:20,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:20,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:20,863 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:35:20,905 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:35:20,907 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:21,053 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:21,062 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:21,062 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:21,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:35:21,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:21,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:35:21,075 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:21,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:21,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:35:21,084 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:21,087 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:21,089 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:21,091 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:21,094 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:21,096 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:21,099 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:21,102 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:21,105 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:21,107 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:21,110 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:21,119 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:21,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:35:21,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:35:21,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:35:21,129 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:21,129 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:35:21,137 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:21,138 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:35:21,138 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:21,154 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:21,159 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:35:21,164 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:35:21,164 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:21,164 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:21,164 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:21,165 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:21,165 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:21,165 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:35:21,165 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:21,166 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:35:21,166 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:21,167 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:35:21,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:35:21,168 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:21,168 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:35:21,168 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:21,168 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:21,168 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:21,168 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:35:21,169 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:35:21,169 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:35:21,169 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:35:21,169 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:35:21,169 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:35:21,172 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:35:21,172 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:35:21,172 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:35:21,172 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:35:21,173 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:35:21,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:35:21,173 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:21,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:35:21,173 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:21,174 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:21,174 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:21,174 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:35:21,174 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:35:21,174 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:35:21,174 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:35:21,178 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:35:21,178 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:21,180 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:21,180 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:21,181 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:21,181 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:21,182 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:21,182 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:21,194 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3844, Threshold=0.4187, Accuracy=0.6739, F1=0.7756, Precision=0.9400, Recall=0.6601
2025-08-04 20:35:21,194 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6739, F1: 0.7756, Prec: 0.9400, Rec: 0.6601, Avg Anomaly Score: 0.3844
2025-08-04 20:35:32,458 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:32,458 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:32,458 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:32,458 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:35:32,458 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:35:32,459 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:32,753 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:32,753 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:32,838 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:35:32,886 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:35:32,886 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:33,008 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:33,014 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:33,014 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:33,019 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:35:33,025 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:33,025 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:35:33,025 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:33,025 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:33,026 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:35:33,034 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:33,037 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:33,039 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:33,041 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:33,044 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:33,046 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:33,048 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:33,051 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:33,054 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:33,056 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:33,058 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:33,068 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:33,069 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:35:33,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:35:33,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:35:33,078 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:33,078 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:35:33,087 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:33,088 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:35:33,088 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:33,103 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:33,108 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:35:33,113 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:35:33,113 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:33,113 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:33,113 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:33,113 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:33,114 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:33,114 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:35:33,114 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:33,114 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:35:33,114 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:33,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:35:33,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:35:33,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:33,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:35:33,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:33,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:33,117 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:33,117 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:35:33,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:35:33,117 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:35:33,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:35:33,117 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:35:33,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:35:33,119 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:35:33,120 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:35:33,120 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:35:33,120 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:35:33,120 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:35:33,120 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:35:33,120 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:33,120 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:35:33,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:33,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:33,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:33,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:35:33,121 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:35:33,122 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:35:33,122 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:35:33,125 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:35:33,125 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:33,127 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:33,127 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:33,128 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:33,128 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:33,128 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:33,129 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:33,140 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3556, Threshold=0.3903, Accuracy=0.6787, F1=0.7789, Precision=0.9440, Recall=0.6629
2025-08-04 20:35:33,140 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6787, F1: 0.7789, Prec: 0.9440, Rec: 0.6629, Avg Anomaly Score: 0.3556
2025-08-04 20:35:44,405 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:44,405 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:44,405 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:44,405 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:35:44,405 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:35:44,405 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:44,677 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:44,677 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:44,763 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:35:44,800 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:35:44,800 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:44,910 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:44,915 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:44,915 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:44,920 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:35:44,925 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:44,925 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:35:44,926 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:44,926 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:44,926 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:35:44,934 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:44,936 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:44,939 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:44,941 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:44,943 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:44,946 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:44,948 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:44,950 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:44,953 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:44,955 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:44,957 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:44,965 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:44,965 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:35:44,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:35:44,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:35:44,974 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:44,974 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:35:44,983 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:44,984 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:35:44,984 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:45,000 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:45,005 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:35:45,015 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:35:45,015 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:45,016 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:45,016 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:45,016 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:45,017 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:45,017 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:35:45,017 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:45,017 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:35:45,017 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:45,019 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:35:45,019 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:35:45,019 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:45,019 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:35:45,020 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:45,020 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:45,020 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:45,020 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:35:45,020 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:35:45,020 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:35:45,020 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:35:45,020 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:35:45,021 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:35:45,024 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:35:45,024 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:35:45,024 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:35:45,024 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:35:45,025 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:35:45,025 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:35:45,025 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:45,025 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:35:45,025 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:45,026 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:45,026 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:45,026 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:35:45,026 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:35:45,026 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:35:45,026 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:35:45,030 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:35:45,030 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:45,031 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:45,031 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:45,033 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:45,033 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:45,033 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:45,034 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:45,045 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3700, Threshold=0.4087, Accuracy=0.6787, F1=0.7789, Precision=0.9440, Recall=0.6629
2025-08-04 20:35:45,045 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6787, F1: 0.7789, Prec: 0.9440, Rec: 0.6629, Avg Anomaly Score: 0.3700
2025-08-04 20:35:59,329 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:59,329 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:59,329 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:59,329 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:35:59,330 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:35:59,330 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:59,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:59,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:59,858 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:35:59,902 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:35:59,902 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:00,039 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:00,046 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:00,046 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:00,053 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:36:00,063 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:00,063 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:36:00,064 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:00,064 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:00,065 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:36:00,075 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:00,078 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:00,081 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:00,083 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:00,086 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:00,088 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:00,091 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:00,093 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:00,096 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:00,098 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:00,100 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:00,113 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:00,113 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:36:00,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:36:00,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:36:00,124 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:00,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:36:00,134 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:00,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:36:00,135 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:00,154 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:00,159 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:36:00,165 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:36:00,165 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:00,165 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:00,166 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:00,166 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:00,166 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:00,166 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:36:00,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:00,167 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:36:00,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:00,168 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:36:00,168 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:36:00,169 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:00,169 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:36:00,169 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:00,169 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:00,169 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:00,169 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:36:00,169 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:36:00,170 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:36:00,170 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:36:00,170 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:36:00,170 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:36:00,172 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:36:00,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:36:00,173 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:36:00,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:36:00,173 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:36:00,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:36:00,173 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:00,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:36:00,174 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:00,174 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:00,174 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:00,174 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:36:00,175 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:36:00,175 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:36:00,175 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:36:00,178 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:36:00,178 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:00,180 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:00,180 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:00,181 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:00,182 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:00,182 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:00,182 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:00,196 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3812, Threshold=0.4187, Accuracy=0.6787, F1=0.7789, Precision=0.9440, Recall=0.6629
2025-08-04 20:36:00,196 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6787, F1: 0.7789, Prec: 0.9440, Rec: 0.6629, Avg Anomaly Score: 0.3812
2025-08-04 20:36:05,462 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:05,462 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:05,462 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:05,462 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:36:05,462 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:36:05,462 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:05,747 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:05,748 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:05,832 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:36:05,875 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:36:05,876 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:05,990 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:05,997 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:05,997 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:06,004 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:36:06,013 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:06,013 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:36:06,014 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:06,014 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:06,014 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:36:06,023 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:06,026 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:06,028 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:06,030 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:06,032 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:06,034 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:06,037 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:06,040 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:06,043 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:06,044 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:06,047 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:06,057 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:06,057 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:36:06,062 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:36:06,062 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:36:06,066 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:06,066 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:36:06,076 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:06,076 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:36:06,076 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:06,095 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:06,101 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:36:06,107 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:36:06,107 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:06,107 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:06,107 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:06,108 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:06,108 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:06,108 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:36:06,108 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:06,109 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:36:06,109 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:06,110 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:36:06,110 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:36:06,110 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:06,111 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:36:06,111 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:06,111 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:06,111 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:06,111 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:36:06,111 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:36:06,111 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:36:06,112 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:36:06,112 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:36:06,112 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:36:06,114 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:36:06,114 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:36:06,115 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:36:06,115 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:36:06,115 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:36:06,115 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:36:06,115 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:06,115 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:36:06,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:06,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:06,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:06,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:36:06,116 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:36:06,117 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:36:06,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:36:06,120 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:36:06,120 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:06,122 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:06,122 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:06,123 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 67/400.
2025-08-04 20:36:06,224 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:06,224 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:06,225 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1055 anomalous samples to GAN training data (target: 1055).
2025-08-04 20:36:06,226 - ClientAppLogger [Client 1] - INFO - [Client] Round 67: Training GAN with 4572 samples (3517 normal, 1055 anomalous).
2025-08-04 20:36:06,226 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:09,414 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.8688
2025-08-04 20:36:09,414 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.8688
2025-08-04 20:36:09,415 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:09,425 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3635, Threshold=0.3987, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:36:09,425 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.7855
2025-08-04 20:36:09,426 - ClientAppLogger [Client 1] - INFO - Fit completed for round 67. Duration: 3.30s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 67, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0834972706992483, 'd_loss': 0.8688059627071141, 'post_fit_local_f1': 0.7854785478547854, 'fit_time_seconds': 3.3022959232330322, 'cpu_percent_fit': 12.49375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 4572}
2025-08-04 20:36:09,426 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:36:14,678 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:14,678 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:14,678 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:14,678 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:36:14,678 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:36:14,679 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:14,984 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:14,984 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:15,069 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:36:15,108 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:36:15,108 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:15,229 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:15,235 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:15,236 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:15,241 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:36:15,247 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:15,247 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:36:15,248 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:15,248 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:15,248 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:36:15,257 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:15,260 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:15,262 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:15,265 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:15,268 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:15,270 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:15,273 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:15,276 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:15,279 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:15,280 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:15,283 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:15,293 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:15,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:36:15,298 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:36:15,298 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:36:15,303 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:15,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:36:15,311 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:15,311 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:36:15,311 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:15,325 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:15,330 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:36:15,335 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:36:15,335 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:15,335 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:15,335 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:15,335 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:15,335 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:15,336 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:36:15,336 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:15,336 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:36:15,336 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:15,337 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:36:15,338 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:36:15,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:15,338 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:36:15,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:15,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:15,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:15,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:36:15,339 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:36:15,339 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:36:15,339 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:36:15,339 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:36:15,339 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:36:15,341 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:36:15,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:36:15,341 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:36:15,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:36:15,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:36:15,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:36:15,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:15,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:36:15,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:15,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:15,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:15,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:36:15,343 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:36:15,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:36:15,344 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:36:15,347 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:36:15,347 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:15,349 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:15,349 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:15,350 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:15,351 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:15,351 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:15,352 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:15,364 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3656, Threshold=0.4006, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:36:15,364 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6882, F1: 0.7855, Prec: 0.9520, Rec: 0.6685, Avg Anomaly Score: 0.3656
2025-08-04 20:36:29,679 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:29,680 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:29,680 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:29,680 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:36:29,680 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:36:29,680 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:30,043 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:30,043 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:30,139 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:36:30,181 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:36:30,181 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:30,298 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:30,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:30,303 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:30,308 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:36:30,313 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:30,313 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:36:30,313 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:30,314 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:30,314 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:36:30,322 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:30,324 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:30,327 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:30,329 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:30,331 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:30,333 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:30,336 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:30,338 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:30,341 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:30,343 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:30,345 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:30,353 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:30,353 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:36:30,358 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:36:30,358 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:36:30,363 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:30,363 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:36:30,372 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:30,373 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:36:30,373 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:30,387 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:30,391 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:36:30,396 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:36:30,396 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:30,396 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:30,397 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:30,397 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:30,397 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:30,397 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:36:30,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:30,397 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:36:30,398 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:30,399 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:36:30,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:36:30,399 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:30,400 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:36:30,400 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:30,400 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:30,400 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:30,400 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:36:30,400 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:36:30,400 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:36:30,401 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:36:30,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:36:30,401 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:36:30,403 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:36:30,403 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:36:30,403 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:36:30,403 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:36:30,403 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:36:30,403 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:36:30,404 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:30,404 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:36:30,404 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:30,404 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:30,404 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:30,405 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:36:30,405 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:36:30,405 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:36:30,405 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:36:30,408 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:36:30,408 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:30,409 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:30,410 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:30,411 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:30,411 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:30,411 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:30,412 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:30,423 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3730, Threshold=0.4139, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:36:30,423 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6882, F1: 0.7855, Prec: 0.9520, Rec: 0.6685, Avg Anomaly Score: 0.3730
2025-08-04 20:36:35,680 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:35,680 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:35,680 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:35,681 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:36:35,681 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:36:35,681 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:35,974 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:35,974 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:36,057 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:36:36,109 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:36:36,109 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:36,225 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:36,231 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:36,231 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:36,236 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:36:36,241 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:36,241 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:36:36,242 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:36,242 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:36,242 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:36:36,250 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:36,253 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:36,255 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:36,257 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:36,260 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:36,262 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:36,264 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:36,267 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:36,269 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:36,271 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:36,274 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:36,282 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:36,282 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:36:36,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:36:36,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:36:36,292 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:36,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:36:36,300 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:36,300 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:36:36,300 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:36,315 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:36,319 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:36:36,324 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:36:36,324 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:36,324 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:36,325 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:36,325 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:36,325 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:36,326 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:36:36,326 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:36,326 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:36:36,326 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:36,327 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:36:36,328 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:36:36,328 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:36,328 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:36:36,328 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:36,328 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:36,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:36,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:36:36,329 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:36:36,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:36:36,329 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:36:36,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:36:36,329 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:36:36,332 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:36:36,332 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:36:36,332 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:36:36,332 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:36:36,332 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:36:36,333 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:36:36,333 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:36,333 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:36:36,333 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:36,333 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:36,334 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:36,334 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:36:36,334 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:36:36,334 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:36:36,334 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:36:36,337 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:36:36,338 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:36,339 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:36,339 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:36,340 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 69/400.
2025-08-04 20:36:36,441 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:36,441 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:36,442 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1089 anomalous samples to GAN training data (target: 1089).
2025-08-04 20:36:36,443 - ClientAppLogger [Client 1] - INFO - [Client] Round 69: Training GAN with 4719 samples (3630 normal, 1089 anomalous).
2025-08-04 20:36:36,443 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:39,699 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.8639
2025-08-04 20:36:39,699 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.8639
2025-08-04 20:36:39,699 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:39,710 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3923, Threshold=0.4375, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:36:39,710 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.7888
2025-08-04 20:36:39,711 - ClientAppLogger [Client 1] - INFO - Fit completed for round 69. Duration: 3.37s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 69, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083238665182021, 'd_loss': 0.8638936899670304, 'post_fit_local_f1': 0.7887788778877888, 'fit_time_seconds': 3.3702774047851562, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 4719}
2025-08-04 20:36:39,711 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:36:44,965 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:44,965 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:44,965 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:44,965 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:36:44,965 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:36:44,965 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:45,244 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:45,244 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:45,330 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:36:45,369 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:36:45,369 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:45,499 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:45,506 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:45,506 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:45,513 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:36:45,520 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:45,520 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:36:45,521 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:45,521 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:45,521 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:36:45,530 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:45,533 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:45,535 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:45,537 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:45,540 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:45,542 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:45,545 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:45,548 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:45,550 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:45,552 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:45,555 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:45,565 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:45,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:36:45,569 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:36:45,570 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:36:45,575 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:45,575 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:36:45,583 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:45,584 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:36:45,584 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:45,600 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:45,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:36:45,609 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:36:45,610 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:45,610 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:45,610 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:45,610 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:45,611 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:45,611 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:36:45,611 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:45,611 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:36:45,612 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:45,613 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:36:45,614 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:36:45,614 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:45,614 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:36:45,615 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:45,615 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:45,615 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:45,615 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:36:45,616 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:36:45,616 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:36:45,616 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:36:45,616 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:36:45,616 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:36:45,619 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:36:45,619 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:36:45,620 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:36:45,620 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:36:45,620 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:36:45,620 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:36:45,620 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:45,620 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:36:45,621 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:45,621 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:45,621 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:45,622 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:36:45,622 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:36:45,622 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:36:45,622 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:36:45,626 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:36:45,626 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:45,627 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:45,627 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:45,629 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:45,629 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:45,629 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:45,630 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:45,641 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3917, Threshold=0.4366, Accuracy=0.6882, F1=0.7855, Precision=0.9520, Recall=0.6685
2025-08-04 20:36:45,642 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6882, F1: 0.7855, Prec: 0.9520, Rec: 0.6685, Avg Anomaly Score: 0.3917
2025-08-04 20:36:50,898 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:50,898 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:50,898 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:50,898 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:36:50,898 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:36:50,899 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:51,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:51,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:51,280 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:36:51,315 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:36:51,315 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:51,424 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:51,429 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:51,429 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:51,434 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:36:51,439 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:51,439 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:36:51,440 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:51,440 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:51,440 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:36:51,448 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:51,451 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:51,453 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:51,455 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:51,458 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:51,460 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:51,462 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:51,465 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:51,467 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:51,469 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:51,472 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:51,480 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:51,481 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:36:51,485 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:36:51,485 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:36:51,489 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:51,490 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:36:51,497 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:51,498 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:36:51,498 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:51,512 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:51,516 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:36:51,521 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:36:51,521 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:51,521 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:51,521 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:51,522 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:51,522 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:51,522 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:36:51,522 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:51,523 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:36:51,523 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:51,524 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:36:51,524 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:36:51,524 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:51,525 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:36:51,525 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:51,525 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:51,525 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:51,525 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:36:51,525 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:36:51,525 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:36:51,526 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:36:51,526 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:36:51,526 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:36:51,528 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:36:51,528 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:36:51,528 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:36:51,528 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:36:51,529 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:36:51,529 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:36:51,529 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:51,529 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:36:51,530 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:51,530 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:51,530 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:51,531 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:36:51,531 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:36:51,531 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:36:51,531 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:36:51,535 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:36:51,535 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:51,536 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:51,536 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:51,537 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 70/400.
2025-08-04 20:36:51,638 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:51,638 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:51,640 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1103 anomalous samples to GAN training data (target: 1103).
2025-08-04 20:36:51,640 - ClientAppLogger [Client 1] - INFO - [Client] Round 70: Training GAN with 4781 samples (3678 normal, 1103 anomalous).
2025-08-04 20:36:51,640 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:55,119 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.8633
2025-08-04 20:36:55,119 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.8633
2025-08-04 20:36:55,120 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:55,131 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3833, Threshold=0.4364, Accuracy=0.7026, F1=0.7954, Precision=0.9640, Recall=0.6770
2025-08-04 20:36:55,131 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.7954
2025-08-04 20:36:55,131 - ClientAppLogger [Client 1] - INFO - Fit completed for round 70. Duration: 3.59s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 70, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083153167949813, 'd_loss': 0.8632544141687426, 'post_fit_local_f1': 0.7953795379537953, 'fit_time_seconds': 3.5936450958251953, 'cpu_percent_fit': 12.4875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 4781}
2025-08-04 20:36:55,131 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:37:00,392 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:00,393 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:00,393 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:00,393 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:37:00,393 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:37:00,393 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:00,816 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:00,816 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:00,942 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:37:00,987 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:37:00,988 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:01,150 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:01,160 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:01,160 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:01,168 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:37:01,176 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:01,176 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:37:01,177 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:01,177 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:01,177 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:37:01,188 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:01,191 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:01,193 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:01,195 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:01,198 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:01,200 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:01,203 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:01,205 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:01,208 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:01,210 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:01,213 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:01,224 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:01,224 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:37:01,229 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:37:01,229 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:37:01,237 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:01,237 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:37:01,251 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:01,252 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:37:01,252 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:01,268 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:01,273 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:37:01,282 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:37:01,282 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:01,282 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:01,282 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:01,283 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:01,283 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:01,283 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:37:01,283 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:01,284 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:37:01,284 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:01,285 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:37:01,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:37:01,286 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:01,286 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:37:01,286 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:01,286 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:01,286 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:01,286 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:37:01,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:37:01,287 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:37:01,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:37:01,287 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:37:01,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:37:01,291 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:37:01,291 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:37:01,291 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:37:01,291 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:37:01,292 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:37:01,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:37:01,292 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:01,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:37:01,293 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:01,293 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:01,293 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:01,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:37:01,294 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:37:01,294 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:37:01,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:37:01,299 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:37:01,299 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:01,301 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:01,301 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:01,302 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:01,302 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:01,302 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:01,304 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:01,315 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3797, Threshold=0.4315, Accuracy=0.6930, F1=0.7888, Precision=0.9560, Recall=0.6713
2025-08-04 20:37:01,315 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6930, F1: 0.7888, Prec: 0.9560, Rec: 0.6713, Avg Anomaly Score: 0.3797
2025-08-04 20:37:06,566 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:06,566 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:06,567 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:06,567 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:37:06,567 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:37:06,567 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:06,892 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:06,892 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:06,988 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:37:07,038 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:37:07,038 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:07,177 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:07,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:07,184 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:07,189 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:37:07,198 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:07,198 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:37:07,199 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:07,199 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:07,200 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:37:07,209 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:07,212 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:07,215 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:07,218 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:07,221 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:07,223 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:07,226 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:07,228 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:07,231 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:07,233 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:07,236 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:07,246 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:07,246 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:37:07,251 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:37:07,251 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:37:07,256 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:07,257 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:37:07,269 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:07,270 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:37:07,270 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:07,287 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:07,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:37:07,297 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:37:07,297 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:07,297 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:07,298 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:07,298 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:07,298 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:07,299 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:37:07,299 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:07,299 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:37:07,299 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:07,300 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:37:07,301 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:37:07,301 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:07,301 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:37:07,301 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:07,301 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:07,301 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:07,302 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:37:07,302 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:37:07,302 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:37:07,302 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:37:07,302 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:37:07,302 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:37:07,305 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:37:07,305 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:37:07,305 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:37:07,306 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:37:07,306 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:37:07,306 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:37:07,306 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:07,306 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:37:07,307 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:07,307 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:07,307 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:07,307 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:37:07,307 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:37:07,308 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:37:07,308 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:37:07,312 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:37:07,313 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:07,314 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:07,314 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:07,315 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 71/400.
2025-08-04 20:37:07,416 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:07,416 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:07,418 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1119 anomalous samples to GAN training data (target: 1119).
2025-08-04 20:37:07,419 - ClientAppLogger [Client 1] - INFO - [Client] Round 71: Training GAN with 4852 samples (3733 normal, 1119 anomalous).
2025-08-04 20:37:07,419 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:37:10,863 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.8617
2025-08-04 20:37:10,863 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.8617
2025-08-04 20:37:10,864 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:37:10,874 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3880, Threshold=0.4425, Accuracy=0.7026, F1=0.7954, Precision=0.9640, Recall=0.6770
2025-08-04 20:37:10,875 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.7954
2025-08-04 20:37:10,875 - ClientAppLogger [Client 1] - INFO - Fit completed for round 71. Duration: 3.56s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 71, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0831957529520855, 'd_loss': 0.8617078124788902, 'post_fit_local_f1': 0.7953795379537953, 'fit_time_seconds': 3.559224843978882, 'cpu_percent_fit': 12.50625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 4852}
2025-08-04 20:37:10,875 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:37:16,155 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:16,155 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:16,155 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:16,155 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:37:16,156 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:37:16,156 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:16,446 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:16,446 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:16,532 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:37:16,576 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:37:16,576 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:16,697 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:16,704 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:16,704 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:16,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:37:16,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:16,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:37:16,717 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:16,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:16,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:37:16,726 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:16,729 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:16,731 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:16,733 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:16,736 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:16,738 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:16,741 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:16,743 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:16,746 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:16,748 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:16,751 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:16,762 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:16,762 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:37:16,767 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:37:16,767 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:37:16,773 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:16,773 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:37:16,784 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:16,784 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:37:16,784 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:16,801 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:16,806 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:37:16,818 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:37:16,818 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:16,818 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:16,818 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:16,819 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:16,819 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:16,819 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:37:16,820 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:16,820 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:37:16,820 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:16,821 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:37:16,822 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:37:16,822 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:16,822 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:37:16,822 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:16,822 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:16,822 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:16,823 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:37:16,823 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:37:16,823 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:37:16,823 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:37:16,823 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:37:16,824 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:37:16,827 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:37:16,827 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:37:16,828 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:37:16,828 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:37:16,830 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:37:16,830 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:37:16,830 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:16,830 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:37:16,831 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:16,831 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:16,831 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:16,832 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:37:16,832 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:37:16,832 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:37:16,832 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:37:16,836 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:37:16,836 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:16,837 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:16,837 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:16,838 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:16,839 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:16,839 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:16,839 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:16,850 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3842, Threshold=0.4391, Accuracy=0.7026, F1=0.7954, Precision=0.9640, Recall=0.6770
2025-08-04 20:37:16,850 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7026, F1: 0.7954, Prec: 0.9640, Rec: 0.6770, Avg Anomaly Score: 0.3842
2025-08-04 20:37:28,134 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:28,135 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:28,135 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:28,135 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:37:28,135 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:37:28,135 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:28,422 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:28,422 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:28,507 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:37:28,544 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:37:28,544 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:28,656 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:28,665 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:28,666 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:28,673 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:37:28,680 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:28,680 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:37:28,681 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:28,681 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:28,681 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:37:28,690 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:28,693 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:28,695 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:28,697 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:28,700 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:28,702 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:28,704 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:28,707 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:28,710 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:28,712 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:28,714 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:28,724 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:28,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:37:28,730 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:37:28,730 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:37:28,735 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:28,735 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:37:28,744 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:28,744 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:37:28,744 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:28,760 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:28,764 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:37:28,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:37:28,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:28,769 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:28,769 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:28,770 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:28,770 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:28,770 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:37:28,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:28,770 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:37:28,771 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:28,772 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:37:28,772 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:37:28,772 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:28,772 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:37:28,773 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:28,773 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:28,773 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:28,773 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:37:28,773 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:37:28,773 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:37:28,773 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:37:28,773 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:37:28,774 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:37:28,776 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:37:28,776 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:37:28,776 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:37:28,776 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:37:28,776 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:37:28,777 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:37:28,777 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:28,777 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:37:28,777 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:28,777 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:28,778 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:28,778 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:37:28,778 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:37:28,778 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:37:28,778 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:37:28,782 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:37:28,782 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:28,783 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:28,784 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:28,785 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:28,785 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:28,785 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:28,786 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:28,797 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3598, Threshold=0.4149, Accuracy=0.6978, F1=0.7921, Precision=0.9600, Recall=0.6742
2025-08-04 20:37:28,797 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.6978, F1: 0.7921, Prec: 0.9600, Rec: 0.6742, Avg Anomaly Score: 0.3598
2025-08-04 20:37:43,093 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:43,093 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:43,093 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:43,093 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:37:43,093 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:37:43,093 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:43,373 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:43,373 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:43,462 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:37:43,501 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:37:43,501 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:43,618 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:43,626 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:43,626 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:43,634 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:37:43,639 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:43,639 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:37:43,640 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:43,640 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:43,640 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:37:43,648 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:43,651 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:43,653 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:43,655 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:43,658 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:43,660 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:43,662 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:43,665 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:43,668 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:43,669 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:43,671 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:43,681 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:43,681 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:37:43,686 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:37:43,686 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:37:43,690 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:43,690 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:37:43,700 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:43,700 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:37:43,700 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:43,715 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:43,720 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:37:43,726 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:37:43,726 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:43,726 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:43,727 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:43,727 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:43,727 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:43,727 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:37:43,728 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:43,728 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:37:43,728 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:43,729 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:37:43,729 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:37:43,729 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:43,730 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:37:43,730 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:43,730 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:43,730 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:43,730 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:37:43,730 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:37:43,730 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:37:43,731 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:37:43,731 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:37:43,731 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:37:43,734 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:37:43,734 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:37:43,734 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:37:43,735 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:37:43,735 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:37:43,735 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:37:43,735 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:43,735 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:37:43,736 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:43,736 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:43,736 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:43,737 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:37:43,737 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:37:43,737 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:37:43,737 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:37:43,740 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:37:43,741 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:43,742 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:43,742 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:43,743 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:43,743 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:43,743 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:43,744 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:43,755 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3752, Threshold=0.4365, Accuracy=0.7074, F1=0.7987, Precision=0.9680, Recall=0.6798
2025-08-04 20:37:43,756 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7074, F1: 0.7987, Prec: 0.9680, Rec: 0.6798, Avg Anomaly Score: 0.3752
2025-08-04 20:37:55,034 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:55,034 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:55,034 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:55,034 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:37:55,034 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:37:55,034 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:55,330 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:55,330 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:55,427 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:37:55,468 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:37:55,469 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:55,589 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:55,595 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:55,595 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:55,601 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:37:55,606 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:55,606 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:37:55,607 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:55,607 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:55,607 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:37:55,616 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:55,619 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:55,621 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:55,623 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:55,626 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:55,628 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:55,631 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:55,634 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:55,636 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:55,639 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:55,641 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:55,652 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:55,652 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:37:55,657 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:37:55,657 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:37:55,664 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:55,664 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:37:55,679 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:55,679 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:37:55,679 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:55,696 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:55,702 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:37:55,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:37:55,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:55,716 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:55,717 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:55,717 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:55,717 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:55,717 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:37:55,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:55,718 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:37:55,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:55,719 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:37:55,719 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:37:55,720 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:55,720 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:37:55,720 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:55,720 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:55,720 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:55,721 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:37:55,721 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:37:55,721 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:37:55,721 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:37:55,721 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:37:55,721 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:37:55,724 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:37:55,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:37:55,724 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:37:55,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:37:55,725 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:37:55,725 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:37:55,725 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:55,725 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:37:55,726 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:55,726 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:55,726 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:55,726 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:37:55,727 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:37:55,727 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:37:55,727 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:37:55,732 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:37:55,732 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:55,734 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:55,734 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:55,735 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:55,736 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:55,736 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:55,736 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:55,749 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3807, Threshold=0.4428, Accuracy=0.7170, F1=0.8053, Precision=0.9760, Recall=0.6854
2025-08-04 20:37:55,749 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7170, F1: 0.8053, Prec: 0.9760, Rec: 0.6854, Avg Anomaly Score: 0.3807
2025-08-04 20:38:07,007 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:07,007 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:38:07,007 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:38:07,007 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:38:07,007 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:38:07,007 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:07,302 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:07,302 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:07,396 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:38:07,441 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:38:07,441 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:07,566 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:07,573 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:07,573 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:07,580 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:38:07,588 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:07,588 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:38:07,588 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:07,589 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:07,589 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:38:07,598 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:07,600 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:07,603 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:07,605 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:07,607 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:07,609 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:07,612 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:07,614 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:07,617 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:07,619 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:07,622 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:07,632 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:07,632 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:38:07,637 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:38:07,637 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:38:07,643 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:07,643 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:38:07,652 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:07,652 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:38:07,652 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:07,668 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:07,673 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:38:07,679 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:38:07,679 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:07,679 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:07,679 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:07,680 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:07,680 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:07,680 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:38:07,680 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:07,680 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:38:07,681 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:07,682 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:38:07,682 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:38:07,682 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:07,683 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:38:07,683 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:07,683 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:07,683 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:07,683 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:38:07,683 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:38:07,683 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:38:07,684 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:38:07,684 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:38:07,684 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:38:07,687 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:38:07,687 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:38:07,687 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:38:07,687 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:38:07,687 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:38:07,687 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:38:07,687 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:07,688 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:38:07,688 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:07,688 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:07,689 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:07,689 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:38:07,689 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:38:07,689 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:38:07,689 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:38:07,693 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:38:07,693 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:07,695 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:07,695 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:38:07,696 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:07,696 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:07,696 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:07,697 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:07,708 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3813, Threshold=0.4489, Accuracy=0.7170, F1=0.8053, Precision=0.9760, Recall=0.6854
2025-08-04 20:38:07,708 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7170, F1: 0.8053, Prec: 0.9760, Rec: 0.6854, Avg Anomaly Score: 0.3813
2025-08-04 20:38:21,986 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:21,986 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:38:21,986 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:38:21,987 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:38:21,987 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:38:21,987 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:22,312 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:22,312 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:22,406 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:38:22,448 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:38:22,448 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:22,580 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:22,591 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:22,591 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:22,601 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:38:22,611 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:22,611 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:38:22,612 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:22,612 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:22,612 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:38:22,621 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:22,624 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:22,627 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:22,629 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:22,634 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:22,636 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:22,639 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:22,641 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:22,644 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:22,647 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:22,650 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:22,661 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:22,661 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:38:22,666 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:38:22,666 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:38:22,672 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:22,672 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:38:22,682 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:22,683 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:38:22,683 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:22,700 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:22,705 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:38:22,709 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:38:22,709 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:22,709 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:22,709 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:22,710 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:22,710 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:22,710 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:38:22,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:22,711 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:38:22,711 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:22,712 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:38:22,712 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:38:22,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:22,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:38:22,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:22,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:22,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:22,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:38:22,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:38:22,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:38:22,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:38:22,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:38:22,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:38:22,717 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:38:22,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:38:22,717 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:38:22,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:38:22,718 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:38:22,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:38:22,718 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:22,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:38:22,719 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:22,719 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:22,719 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:22,719 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:38:22,719 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:38:22,720 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:38:22,720 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:38:22,724 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:38:22,727 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:22,729 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:22,729 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:38:22,730 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:22,731 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:22,731 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:22,731 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:22,745 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3787, Threshold=0.4482, Accuracy=0.7170, F1=0.8053, Precision=0.9760, Recall=0.6854
2025-08-04 20:38:22,746 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7170, F1: 0.8053, Prec: 0.9760, Rec: 0.6854, Avg Anomaly Score: 0.3787
2025-08-04 20:38:34,014 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:34,014 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:38:34,015 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:38:34,015 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:38:34,015 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:38:34,015 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:34,277 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:34,277 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:34,365 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:38:34,406 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:38:34,406 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:34,526 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:34,536 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:34,538 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:34,545 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:38:34,553 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:34,553 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:38:34,553 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:34,553 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:34,554 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:38:34,562 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:34,565 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:34,567 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:34,569 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:34,572 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:34,574 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:34,576 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:34,579 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:34,582 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:34,584 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:34,586 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:34,596 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:34,596 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:38:34,600 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:38:34,601 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:38:34,605 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:34,605 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:38:34,613 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:34,614 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:38:34,614 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:34,630 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:34,638 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:38:34,643 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:38:34,643 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:34,643 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:34,643 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:34,644 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:34,644 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:34,644 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:38:34,644 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:34,644 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:38:34,644 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:34,646 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:38:34,646 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:38:34,646 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:34,646 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:38:34,647 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:34,647 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:34,647 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:34,647 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:38:34,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:38:34,647 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:38:34,648 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:38:34,648 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:38:34,648 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:38:34,651 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:38:34,651 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:38:34,651 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:38:34,651 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:38:34,651 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:38:34,652 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:38:34,652 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:34,652 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:38:34,652 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:34,652 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:34,653 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:34,653 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:38:34,653 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:38:34,653 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:38:34,653 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:38:34,656 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:38:34,657 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:34,658 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:34,658 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:38:34,660 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:34,660 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:34,660 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:34,661 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:34,673 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3773, Threshold=0.4517, Accuracy=0.7170, F1=0.8053, Precision=0.9760, Recall=0.6854
2025-08-04 20:38:34,674 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7170, F1: 0.8053, Prec: 0.9760, Rec: 0.6854, Avg Anomaly Score: 0.3773
2025-08-04 20:38:45,937 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:45,937 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:38:45,937 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:38:45,937 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:38:45,937 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:38:45,937 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:46,235 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:46,235 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:46,322 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:38:46,365 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:38:46,367 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:46,513 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:46,522 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:46,522 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:46,528 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:38:46,535 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:46,535 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:38:46,536 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:46,536 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:46,536 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:38:46,547 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:46,550 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:46,552 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:46,554 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:46,557 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:46,559 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:46,562 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:46,564 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:46,567 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:46,569 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:46,571 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:46,581 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:46,581 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:38:46,586 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:38:46,586 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:38:46,591 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:46,592 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:38:46,603 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:46,603 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:38:46,603 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:46,620 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:46,626 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:38:46,634 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:38:46,634 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:46,634 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:46,634 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:46,635 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:46,635 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:46,635 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:38:46,635 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:46,636 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:38:46,636 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:46,637 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:38:46,637 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:38:46,638 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:46,638 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:38:46,638 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:46,638 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:46,638 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:46,639 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:38:46,639 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:38:46,639 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:38:46,639 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:38:46,639 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:38:46,639 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:38:46,644 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:38:46,644 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:38:46,644 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:38:46,645 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:38:46,645 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:38:46,645 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:38:46,645 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:46,645 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:38:46,646 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:46,646 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:46,646 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:46,646 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:38:46,647 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:38:46,647 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:38:46,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:38:46,653 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:38:46,653 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:46,654 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:46,655 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:38:46,656 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:46,656 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:46,656 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:46,657 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:46,670 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3778, Threshold=0.4513, Accuracy=0.7170, F1=0.8053, Precision=0.9760, Recall=0.6854
2025-08-04 20:38:46,670 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7170, F1: 0.8053, Prec: 0.9760, Rec: 0.6854, Avg Anomaly Score: 0.3778
2025-08-04 20:39:00,936 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:00,936 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:00,936 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:00,936 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:39:00,936 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:39:00,936 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:01,214 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:01,214 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:01,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:39:01,344 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:39:01,344 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:01,479 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:01,488 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:01,489 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:01,496 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:39:01,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:01,503 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:39:01,503 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:01,503 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:01,503 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:39:01,512 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:01,515 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:01,517 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:01,520 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:01,522 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:01,524 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:01,527 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:01,530 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:01,533 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:01,534 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:01,536 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:01,546 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:01,546 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:39:01,551 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:39:01,551 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:39:01,557 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:01,557 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:39:01,569 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:01,570 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:39:01,570 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:01,588 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:01,593 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:39:01,602 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:39:01,602 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:01,602 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:01,603 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:01,603 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:01,603 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:01,604 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:39:01,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:01,604 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:39:01,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:01,606 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:39:01,606 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:39:01,606 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:01,607 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:39:01,607 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:01,607 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:01,607 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:01,607 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:39:01,607 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:39:01,608 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:39:01,608 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:39:01,608 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:39:01,608 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:39:01,613 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:39:01,614 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:39:01,614 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:39:01,614 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:39:01,614 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:39:01,614 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:39:01,615 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:01,615 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:39:01,615 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:01,616 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:01,616 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:01,616 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:39:01,616 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:39:01,617 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:39:01,617 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:39:01,620 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:39:01,620 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:01,622 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:01,622 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:01,623 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:01,624 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:01,624 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:01,625 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:01,637 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3732, Threshold=0.4398, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:39:01,637 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.3732
2025-08-04 20:39:06,885 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:06,885 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:06,885 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:06,885 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:39:06,885 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:39:06,885 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:07,214 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:07,214 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:07,299 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:39:07,340 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:39:07,340 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:07,455 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:07,461 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:07,462 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:07,467 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:39:07,472 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:07,473 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:39:07,473 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:07,473 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:07,474 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:39:07,483 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:07,485 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:07,487 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:07,490 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:07,493 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:07,495 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:07,497 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:07,500 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:07,503 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:07,505 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:07,507 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:07,518 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:07,518 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:39:07,523 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:39:07,524 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:39:07,529 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:07,529 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:39:07,537 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:07,538 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:39:07,538 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:07,552 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:07,557 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:39:07,563 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:39:07,563 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:07,563 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:07,564 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:07,564 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:07,564 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:07,565 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:39:07,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:07,565 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:39:07,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:07,566 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:39:07,566 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:39:07,567 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:07,567 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:39:07,567 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:07,568 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:07,568 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:07,568 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:39:07,568 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:39:07,568 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:39:07,568 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:39:07,568 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:39:07,569 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:39:07,571 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:39:07,571 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:39:07,572 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:39:07,572 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:39:07,572 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:39:07,572 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:39:07,572 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:07,572 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:39:07,573 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:07,573 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:07,573 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:07,573 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:39:07,573 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:39:07,574 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:39:07,574 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:39:07,577 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:39:07,577 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:07,579 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:07,579 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:07,580 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 80/400.
2025-08-04 20:39:07,682 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:07,682 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:07,683 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1261 anomalous samples to GAN training data (target: 1261).
2025-08-04 20:39:07,684 - ClientAppLogger [Client 1] - INFO - [Client] Round 80: Training GAN with 5466 samples (4205 normal, 1261 anomalous).
2025-08-04 20:39:07,684 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:11,682 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0837, Avg D Loss: 0.8501
2025-08-04 20:39:11,682 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0837, Avg D Loss: 0.8501
2025-08-04 20:39:11,682 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:11,693 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3942, Threshold=0.4555, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:39:11,693 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8119
2025-08-04 20:39:11,694 - ClientAppLogger [Client 1] - INFO - Fit completed for round 80. Duration: 4.11s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 80, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083658693746643, 'd_loss': 0.8500981137554504, 'post_fit_local_f1': 0.8118811881188119, 'fit_time_seconds': 4.113244295120239, 'cpu_percent_fit': 12.49375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 5466}
2025-08-04 20:39:11,694 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:39:16,969 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:16,969 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:16,969 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:16,970 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:39:16,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:39:16,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:17,206 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:17,207 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:17,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:39:17,333 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:39:17,333 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:17,445 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:17,450 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:17,450 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:17,456 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:39:17,461 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:17,461 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:39:17,461 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:17,462 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:17,462 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:39:17,470 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:17,474 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:17,476 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:17,479 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:17,481 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:17,484 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:17,487 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:17,489 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:17,492 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:17,494 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:17,496 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:17,506 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:17,506 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:39:17,511 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:39:17,511 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:39:17,516 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:17,516 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:39:17,527 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:17,527 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:39:17,528 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:17,545 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:17,550 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:39:17,557 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:39:17,557 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:17,557 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:17,557 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:17,558 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:17,558 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:17,558 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:39:17,559 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:17,559 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:39:17,559 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:17,561 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:39:17,561 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:39:17,561 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:17,561 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:39:17,562 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:17,562 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:17,562 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:17,562 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:39:17,562 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:39:17,562 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:39:17,563 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:39:17,563 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:39:17,563 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:39:17,566 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:39:17,566 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:39:17,567 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:39:17,567 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:39:17,567 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:39:17,567 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:39:17,567 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:17,568 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:39:17,568 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:17,568 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:17,568 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:17,569 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:39:17,569 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:39:17,569 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:39:17,569 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:39:17,573 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:39:17,573 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:17,574 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:17,574 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:17,576 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:17,576 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:17,576 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:17,577 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:17,588 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3984, Threshold=0.4675, Accuracy=0.7170, F1=0.8053, Precision=0.9760, Recall=0.6854
2025-08-04 20:39:17,588 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7170, F1: 0.8053, Prec: 0.9760, Rec: 0.6854, Avg Anomaly Score: 0.3984
2025-08-04 20:39:28,863 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:28,863 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:28,863 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:28,863 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:39:28,863 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:39:28,864 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:29,144 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:29,145 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:29,230 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:39:29,271 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:39:29,272 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:29,383 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:29,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:29,389 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:29,394 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:39:29,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:29,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:39:29,400 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:29,400 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:29,400 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:39:29,408 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:29,411 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:29,413 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:29,415 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:29,418 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:29,420 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:29,423 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:29,425 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:29,428 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:29,430 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:29,432 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:29,442 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:29,442 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:39:29,447 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:39:29,447 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:39:29,452 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:29,452 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:39:29,461 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:29,461 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:39:29,461 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:29,479 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:29,484 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:39:29,491 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:39:29,491 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:29,491 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:29,491 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:29,492 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:29,492 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:29,492 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:39:29,492 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:29,493 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:39:29,493 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:29,494 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:39:29,494 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:39:29,495 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:29,495 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:39:29,495 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:29,495 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:29,495 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:29,495 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:39:29,495 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:39:29,496 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:39:29,496 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:39:29,496 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:39:29,496 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:39:29,500 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:39:29,500 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:39:29,501 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:39:29,501 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:39:29,501 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:39:29,501 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:39:29,501 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:29,501 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:39:29,502 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:29,502 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:29,502 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:29,503 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:39:29,503 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:39:29,503 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:39:29,503 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:39:29,507 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:39:29,507 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:29,508 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:29,508 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:29,510 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:29,510 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:29,510 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:29,511 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:29,522 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3864, Threshold=0.4471, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:39:29,522 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.3864
2025-08-04 20:39:40,798 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:40,798 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:40,798 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:40,798 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:39:40,799 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:39:40,799 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:41,064 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:41,064 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:41,150 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:39:41,191 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:39:41,191 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:41,305 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:41,311 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:41,311 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:41,316 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:39:41,321 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:41,321 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:39:41,322 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:41,322 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:41,322 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:39:41,331 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:41,334 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:41,336 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:41,339 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:41,341 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:41,344 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:41,346 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:41,349 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:41,352 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:41,354 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:41,356 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:41,365 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:41,366 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:39:41,370 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:39:41,371 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:39:41,375 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:41,375 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:39:41,384 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:41,384 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:39:41,384 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:41,399 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:41,403 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:39:41,408 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:39:41,409 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:41,409 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:41,409 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:41,409 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:41,409 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:41,410 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:39:41,410 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:41,410 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:39:41,410 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:41,412 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:39:41,412 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:39:41,412 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:41,412 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:39:41,412 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:41,413 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:41,413 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:41,413 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:39:41,413 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:39:41,413 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:39:41,413 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:39:41,413 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:39:41,413 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:39:41,416 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:39:41,416 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:39:41,416 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:39:41,416 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:39:41,416 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:39:41,417 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:39:41,417 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:41,417 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:39:41,417 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:41,418 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:41,418 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:41,418 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:39:41,418 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:39:41,418 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:39:41,419 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:39:41,423 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:39:41,423 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:41,426 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:41,426 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:41,427 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:41,428 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:41,428 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:41,428 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:41,440 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3751, Threshold=0.4287, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:39:41,440 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.3751
2025-08-04 20:39:55,717 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:55,717 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:55,717 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:55,717 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:39:55,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:39:55,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:56,005 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:56,005 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:56,092 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:39:56,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:39:56,134 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:56,262 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:56,269 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:56,269 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:56,275 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:39:56,286 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:56,286 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:39:56,287 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:56,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:56,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:39:56,296 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:56,299 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:56,301 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:56,303 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:56,306 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:56,309 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:56,311 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:56,314 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:56,317 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:56,319 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:56,321 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:56,331 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:56,332 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:39:56,337 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:39:56,337 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:39:56,342 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:56,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:39:56,350 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:56,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:39:56,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:56,367 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:56,372 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:39:56,379 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:39:56,379 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:56,379 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:56,379 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:56,380 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:56,380 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:56,380 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:39:56,380 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:56,380 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:39:56,381 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:56,382 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:39:56,382 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:39:56,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:56,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:39:56,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:56,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:56,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:56,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:39:56,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:39:56,384 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:39:56,384 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:39:56,384 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:39:56,384 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:39:56,388 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:39:56,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:39:56,388 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:39:56,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:39:56,388 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:39:56,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:39:56,389 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:56,389 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:39:56,389 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:56,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:56,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:56,390 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:39:56,390 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:39:56,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:39:56,390 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:39:56,394 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:39:56,395 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:56,396 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:56,396 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:56,397 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:56,398 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:56,398 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:56,398 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:56,411 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4060, Threshold=0.4664, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:39:56,411 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4060
2025-08-04 20:40:01,663 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:01,663 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:01,663 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:01,663 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:40:01,663 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:40:01,663 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:01,947 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:01,947 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:02,032 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:40:02,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:40:02,069 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:02,185 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:02,191 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:02,191 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:02,196 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:40:02,201 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:02,201 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:40:02,202 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:02,202 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:02,202 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:40:02,210 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:02,214 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:02,216 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:02,218 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:02,221 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:02,223 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:02,226 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:02,228 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:02,231 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:02,233 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:02,235 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:02,245 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:02,245 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:40:02,249 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:40:02,250 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:40:02,254 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:02,254 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:40:02,262 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:02,263 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:40:02,263 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:02,278 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:02,282 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:40:02,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:40:02,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:02,287 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:02,287 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:02,288 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:02,288 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:02,288 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:40:02,288 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:02,289 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:40:02,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:02,290 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:40:02,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:40:02,291 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:02,291 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:40:02,291 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:02,291 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:02,291 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:02,291 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:40:02,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:40:02,292 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:40:02,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:40:02,292 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:40:02,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:40:02,294 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:40:02,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:40:02,295 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:40:02,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:40:02,295 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:40:02,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:40:02,295 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:02,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:40:02,296 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:02,296 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:02,297 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:02,297 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:40:02,297 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:40:02,297 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:40:02,297 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:40:02,300 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:40:02,301 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:02,302 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:02,302 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:02,303 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 84/400.
2025-08-04 20:40:02,405 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:02,405 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:02,407 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1329 anomalous samples to GAN training data (target: 1329).
2025-08-04 20:40:02,407 - ClientAppLogger [Client 1] - INFO - [Client] Round 84: Training GAN with 5761 samples (4432 normal, 1329 anomalous).
2025-08-04 20:40:02,407 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:06,653 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.8439
2025-08-04 20:40:06,653 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.8439
2025-08-04 20:40:06,653 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:06,665 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4033, Threshold=0.4549, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:40:06,665 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8119
2025-08-04 20:40:06,665 - ClientAppLogger [Client 1] - INFO - Fit completed for round 84. Duration: 4.36s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 84, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0839406037823105, 'd_loss': 0.8438514465198109, 'post_fit_local_f1': 0.8118811881188119, 'fit_time_seconds': 4.361752033233643, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 5761}
2025-08-04 20:40:06,665 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:40:11,944 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:11,944 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:11,944 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:11,944 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:40:11,944 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:40:11,945 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:12,229 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:12,230 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:12,323 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:40:12,364 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:40:12,364 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:12,498 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:12,506 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:12,507 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:12,513 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:40:12,520 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:12,521 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:40:12,521 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:12,521 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:12,522 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:40:12,531 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:12,534 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:12,537 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:12,539 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:12,542 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:12,544 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:12,547 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:12,550 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:12,552 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:12,555 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:12,557 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:12,567 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:12,567 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:40:12,572 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:40:12,572 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:40:12,577 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:12,577 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:40:12,586 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:12,587 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:40:12,587 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:12,603 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:12,608 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:40:12,618 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:40:12,618 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:12,618 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:12,618 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:12,618 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:12,619 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:12,619 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:40:12,619 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:12,619 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:40:12,619 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:12,621 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:40:12,621 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:40:12,622 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:12,622 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:40:12,622 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:12,622 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:12,622 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:12,622 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:40:12,623 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:40:12,623 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:40:12,623 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:40:12,623 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:40:12,623 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:40:12,626 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:40:12,626 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:40:12,626 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:40:12,626 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:40:12,626 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:40:12,627 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:40:12,627 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:12,627 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:40:12,627 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:12,628 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:12,628 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:12,628 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:40:12,628 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:40:12,628 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:40:12,628 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:40:12,632 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:40:12,633 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:12,634 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:12,634 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:12,636 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:12,636 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:12,636 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:12,637 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:12,648 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4088, Threshold=0.4699, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:40:12,649 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4088
2025-08-04 20:40:23,932 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:23,932 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:23,932 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:23,932 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:40:23,932 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:40:23,933 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:24,243 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:24,244 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:24,331 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:40:24,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:40:24,388 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:24,535 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:24,544 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:24,544 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:24,553 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:40:24,563 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:24,563 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:40:24,564 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:24,564 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:24,564 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:40:24,573 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:24,577 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:24,579 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:24,582 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:24,585 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:24,587 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:24,590 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:24,593 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:24,595 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:24,597 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:24,600 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:24,614 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:24,614 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:40:24,619 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:40:24,620 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:40:24,628 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:24,629 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:40:24,646 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:24,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:40:24,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:24,665 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:24,671 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:40:24,678 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:40:24,679 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:24,679 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:24,679 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:24,679 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:24,680 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:24,680 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:40:24,680 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:24,680 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:40:24,680 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:24,682 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:40:24,682 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:40:24,682 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:24,683 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:40:24,683 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:24,683 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:24,683 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:24,683 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:40:24,683 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:40:24,683 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:40:24,684 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:40:24,684 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:40:24,684 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:40:24,688 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:40:24,688 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:40:24,688 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:40:24,688 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:40:24,689 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:40:24,689 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:40:24,689 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:24,689 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:40:24,690 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:24,690 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:24,690 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:24,691 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:40:24,691 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:40:24,691 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:40:24,691 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:40:24,695 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:40:24,696 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:24,697 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:24,697 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:24,699 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:24,699 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:24,699 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:24,700 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:24,713 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3859, Threshold=0.4353, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:40:24,713 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.3859
2025-08-04 20:40:38,998 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:38,998 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:38,998 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:38,999 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:40:38,999 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:40:38,999 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:39,265 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:39,266 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:39,356 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:40:39,402 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:40:39,402 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:39,605 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:39,617 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:39,617 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:39,624 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:40:39,632 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:39,633 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:40:39,633 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:39,634 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:39,634 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:40:39,644 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:39,649 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:39,652 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:39,655 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:39,658 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:39,661 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:39,663 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:39,666 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:39,669 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:39,672 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:39,674 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:39,691 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:39,691 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:40:39,696 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:40:39,697 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:40:39,712 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:39,712 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:40:39,735 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:39,736 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:40:39,736 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:39,756 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:39,763 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:40:39,775 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:40:39,776 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:39,776 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:39,776 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:39,777 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:39,777 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:39,778 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:40:39,778 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:39,778 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:40:39,778 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:39,780 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:40:39,780 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:40:39,780 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:39,781 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:40:39,781 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:39,781 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:39,781 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:39,781 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:40:39,781 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:40:39,782 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:40:39,782 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:40:39,782 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:40:39,782 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:40:39,788 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:40:39,788 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:40:39,789 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:40:39,789 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:40:39,789 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:40:39,789 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:40:39,789 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:39,790 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:40:39,791 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:39,791 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:39,791 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:39,791 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:40:39,791 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:40:39,792 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:40:39,792 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:40:39,800 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:40:39,800 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:39,802 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:39,802 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:39,805 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:39,805 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:39,805 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:39,806 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:39,828 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4185, Threshold=0.4840, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:40:39,829 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4185
2025-08-04 20:40:54,109 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:54,109 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:54,109 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:54,109 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:40:54,109 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:40:54,109 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:54,344 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:54,344 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:54,429 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:40:54,465 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:40:54,466 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:54,586 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:54,592 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:54,592 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:54,598 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:40:54,603 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:54,603 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:40:54,604 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:54,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:54,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:40:54,612 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:54,615 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:54,617 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:54,620 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:54,623 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:54,625 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:54,628 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:54,631 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:54,634 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:54,636 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:54,639 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:54,649 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:54,649 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:40:54,654 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:40:54,654 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:40:54,659 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:54,660 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:40:54,671 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:54,671 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:40:54,671 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:54,687 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:54,692 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:40:54,700 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:40:54,700 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:54,700 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:54,701 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:54,701 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:54,701 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:54,702 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:40:54,702 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:54,702 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:40:54,702 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:54,704 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:40:54,704 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:40:54,704 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:54,705 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:40:54,705 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:54,705 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:54,705 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:54,705 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:40:54,706 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:40:54,706 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:40:54,706 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:40:54,706 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:40:54,706 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:40:54,712 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:40:54,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:40:54,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:40:54,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:40:54,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:40:54,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:40:54,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:54,715 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:40:54,715 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:54,716 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:54,716 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:54,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:40:54,717 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:40:54,717 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:40:54,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:40:54,722 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:40:54,723 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:54,725 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:54,725 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:54,727 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:54,727 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:54,727 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:54,728 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:54,743 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4221, Threshold=0.4801, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:40:54,743 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4221
2025-08-04 20:41:09,025 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:09,026 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:09,026 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:09,026 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:41:09,026 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:41:09,026 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:09,301 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:09,301 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:09,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:41:09,427 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:41:09,428 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:09,542 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:09,547 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:09,547 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:09,552 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:41:09,557 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:09,557 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:41:09,558 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:09,558 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:09,558 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:41:09,566 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:09,569 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:09,571 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:09,573 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:09,576 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:09,578 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:09,581 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:09,583 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:09,586 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:09,588 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:09,590 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:09,599 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:09,599 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:41:09,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:41:09,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:41:09,608 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:09,608 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:41:09,617 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:09,617 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:41:09,618 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:09,632 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:09,636 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:41:09,644 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:41:09,644 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:09,644 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:09,644 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:09,644 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:09,645 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:09,645 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:41:09,645 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:09,645 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:41:09,645 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:09,646 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:41:09,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:41:09,647 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:09,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:41:09,647 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:09,647 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:09,648 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:09,648 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:41:09,648 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:41:09,648 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:41:09,648 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:41:09,648 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:41:09,648 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:41:09,650 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:41:09,650 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:41:09,650 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:41:09,650 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:41:09,650 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:41:09,651 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:41:09,651 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:09,651 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:41:09,651 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:09,652 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:09,652 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:09,652 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:41:09,652 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:41:09,652 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:41:09,652 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:41:09,656 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:41:09,656 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:09,658 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:09,658 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:09,659 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:09,659 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:09,659 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:09,660 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:09,672 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3904, Threshold=0.4362, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:41:09,672 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.3904
2025-08-04 20:41:20,940 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:20,940 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:20,940 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:20,940 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:41:20,940 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:41:20,941 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:21,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:21,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:21,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:41:21,327 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:41:21,327 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:21,439 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:21,444 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:21,444 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:21,449 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:41:21,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:21,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:41:21,455 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:21,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:21,456 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:41:21,464 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:21,467 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:21,469 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:21,471 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:21,475 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:21,477 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:21,479 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:21,481 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:21,484 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:21,486 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:21,488 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:21,497 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:21,497 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:41:21,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:41:21,503 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:41:21,507 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:21,507 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:41:21,515 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:21,516 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:41:21,516 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:21,531 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:21,536 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:41:21,542 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:41:21,542 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:21,542 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:21,542 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:21,543 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:21,543 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:21,543 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:41:21,543 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:21,543 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:41:21,543 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:21,545 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:41:21,545 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:41:21,545 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:21,545 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:41:21,545 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:21,545 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:21,545 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:21,546 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:41:21,546 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:41:21,546 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:41:21,546 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:41:21,546 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:41:21,546 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:41:21,548 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:41:21,548 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:41:21,548 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:41:21,548 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:41:21,548 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:41:21,549 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:41:21,549 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:21,549 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:41:21,549 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:21,550 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:21,550 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:21,550 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:41:21,550 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:41:21,550 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:41:21,550 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:41:21,554 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:41:21,555 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:21,556 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:21,556 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:21,557 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:21,557 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:21,557 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:21,558 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:21,570 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3946, Threshold=0.4322, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:41:21,570 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.3946
2025-08-04 20:41:32,855 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:32,855 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:32,855 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:32,855 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:41:32,855 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:41:32,855 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:33,138 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:33,138 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:33,223 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:41:33,259 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:41:33,259 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:33,369 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:33,375 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:33,375 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:33,381 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:41:33,386 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:33,386 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:41:33,386 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:33,386 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:33,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:41:33,394 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:33,397 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:33,399 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:33,401 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:33,404 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:33,406 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:33,408 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:33,411 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:33,413 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:33,415 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:33,417 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:33,426 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:33,426 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:41:33,431 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:41:33,431 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:41:33,435 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:33,435 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:41:33,443 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:33,444 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:41:33,444 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:33,459 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:33,463 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:41:33,469 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:41:33,469 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:33,469 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:33,469 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:33,470 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:33,470 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:33,470 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:41:33,470 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:33,470 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:41:33,471 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:33,472 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:41:33,472 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:41:33,473 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:33,473 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:41:33,473 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:33,473 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:33,473 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:33,474 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:41:33,474 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:41:33,474 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:41:33,474 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:41:33,474 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:41:33,475 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:41:33,478 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:41:33,478 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:41:33,478 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:41:33,478 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:41:33,479 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:41:33,479 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:41:33,479 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:33,479 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:41:33,480 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:33,480 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:33,480 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:33,480 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:41:33,480 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:41:33,481 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:41:33,481 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:41:33,484 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:41:33,484 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:33,486 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:33,486 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:33,487 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:33,488 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:33,488 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:33,488 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:33,500 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4389, Threshold=0.4993, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:41:33,500 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4389
2025-08-04 20:41:47,777 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:47,777 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:47,777 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:47,777 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:41:47,777 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:41:47,778 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:48,049 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:48,049 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:48,140 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:41:48,178 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:41:48,178 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:48,289 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:48,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:48,294 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:48,299 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:41:48,304 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:48,304 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:41:48,305 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:48,305 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:48,305 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:41:48,313 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:48,316 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:48,318 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:48,320 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:48,323 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:48,325 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:48,328 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:48,330 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:48,333 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:48,335 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:48,337 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:48,346 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:48,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:41:48,350 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:41:48,350 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:41:48,355 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:48,355 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:41:48,362 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:48,363 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:41:48,363 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:48,377 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:48,381 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:41:48,386 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:41:48,386 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:48,386 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:48,386 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:48,387 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:48,387 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:48,387 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:41:48,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:48,388 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:41:48,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:48,389 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:41:48,389 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:41:48,389 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:48,389 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:41:48,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:48,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:48,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:48,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:41:48,390 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:41:48,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:41:48,390 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:41:48,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:41:48,391 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:41:48,392 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:41:48,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:41:48,393 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:41:48,393 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:41:48,393 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:41:48,393 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:41:48,393 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:48,393 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:41:48,394 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:48,394 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:48,394 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:48,395 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:41:48,395 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:41:48,395 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:41:48,395 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:41:48,399 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:41:48,399 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:48,400 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:48,400 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:48,402 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:48,402 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:48,402 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:48,402 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:48,415 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4293, Threshold=0.4951, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:41:48,415 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4293
2025-08-04 20:42:02,700 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:02,700 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:42:02,701 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:42:02,701 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:42:02,701 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:42:02,701 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:02,990 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:02,991 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:03,077 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:42:03,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:42:03,116 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:03,228 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:03,233 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:03,233 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:03,238 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:42:03,244 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:03,244 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:42:03,244 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:03,245 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:03,245 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:42:03,253 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:03,255 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:03,258 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:03,260 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:03,263 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:03,265 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:03,267 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:03,270 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:03,273 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:03,274 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:03,277 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:03,285 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:03,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:42:03,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:42:03,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:42:03,294 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:03,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:42:03,303 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:03,304 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:42:03,304 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:03,320 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:03,324 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:42:03,330 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:42:03,331 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:03,331 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:03,331 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:03,331 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:03,332 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:03,332 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:42:03,332 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:03,332 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:42:03,332 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:03,333 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:42:03,334 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:42:03,334 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:03,334 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:42:03,334 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:03,334 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:03,335 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:03,335 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:42:03,335 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:42:03,335 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:42:03,335 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:42:03,335 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:42:03,335 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:42:03,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:42:03,338 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:42:03,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:42:03,339 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:42:03,339 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:42:03,339 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:42:03,339 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:03,339 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:42:03,340 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:03,340 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:03,340 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:03,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:42:03,341 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:42:03,341 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:42:03,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:42:03,345 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:42:03,345 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:03,346 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:03,346 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:42:03,348 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:03,348 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:03,348 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:03,349 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:03,361 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3938, Threshold=0.4451, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:42:03,362 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.3938
2025-08-04 20:42:20,654 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:20,654 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:42:20,655 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:42:20,655 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:42:20,655 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:42:20,655 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:20,925 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:20,925 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:21,023 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:42:21,061 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:42:21,061 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:21,172 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:21,179 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:21,180 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:21,186 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:42:21,191 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:21,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:42:21,192 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:21,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:21,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:42:21,201 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:21,204 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:21,207 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:21,209 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:21,211 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:21,214 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:21,217 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:21,219 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:21,222 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:21,224 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:21,227 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:21,238 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:21,238 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:42:21,243 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:42:21,243 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:42:21,248 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:21,248 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:42:21,258 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:21,258 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:42:21,258 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:21,275 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:21,280 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:42:21,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:42:21,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:21,289 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:21,289 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:21,289 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:21,290 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:21,290 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:42:21,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:21,290 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:42:21,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:21,292 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:42:21,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:42:21,292 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:21,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:42:21,293 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:21,293 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:21,293 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:21,293 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:42:21,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:42:21,294 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:42:21,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:42:21,294 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:42:21,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:42:21,296 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:42:21,296 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:42:21,296 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:42:21,296 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:42:21,296 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:42:21,296 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:42:21,297 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:21,297 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:42:21,297 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:21,297 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:21,298 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:21,298 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:42:21,298 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:42:21,298 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:42:21,298 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:42:21,303 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:42:21,303 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:21,304 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:21,305 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:42:21,306 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:21,306 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:21,306 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:21,307 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:21,318 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4106, Threshold=0.4521, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:42:21,319 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4106
2025-08-04 20:42:35,586 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:35,586 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:42:35,586 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:42:35,587 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:42:35,587 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:42:35,587 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:35,923 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:35,923 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:36,016 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:42:36,054 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:42:36,054 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:36,173 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:36,180 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:36,180 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:36,186 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:42:36,191 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:36,191 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:42:36,192 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:36,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:36,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:42:36,201 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:36,204 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:36,206 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:36,208 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:36,211 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:36,213 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:36,215 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:36,218 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:36,221 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:36,222 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:36,225 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:36,236 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:36,236 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:42:36,242 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:42:36,242 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:42:36,248 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:36,248 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:42:36,258 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:36,259 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:42:36,259 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:36,275 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:36,279 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:42:36,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:42:36,286 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:36,286 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:36,286 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:36,286 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:36,286 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:36,287 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:42:36,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:36,287 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:42:36,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:36,288 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:42:36,288 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:42:36,288 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:36,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:42:36,289 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:36,289 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:36,289 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:36,289 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:42:36,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:42:36,290 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:42:36,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:42:36,290 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:42:36,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:42:36,292 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:42:36,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:42:36,292 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:42:36,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:42:36,292 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:42:36,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:42:36,292 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:36,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:42:36,293 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:36,293 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:36,293 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:36,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:42:36,294 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:42:36,294 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:42:36,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:42:36,299 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:42:36,299 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:36,300 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:36,300 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:42:36,302 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:36,302 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:36,302 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:36,303 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:36,313 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3876, Threshold=0.4204, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:42:36,314 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.3876
2025-08-04 20:42:53,588 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:53,588 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:42:53,588 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:42:53,588 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:42:53,588 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:42:53,588 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:53,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:53,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:53,973 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:42:54,016 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:42:54,017 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:54,163 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:54,172 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:54,172 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:54,180 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:42:54,188 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:54,188 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:42:54,189 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:54,189 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:54,189 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:42:54,197 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:54,200 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:54,202 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:54,204 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:54,207 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:54,210 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:54,213 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:54,215 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:54,218 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:54,220 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:54,222 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:54,232 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:54,232 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:42:54,236 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:42:54,237 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:42:54,241 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:54,241 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:42:54,250 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:54,251 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:42:54,251 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:54,267 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:54,271 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:42:54,279 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:42:54,279 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:54,279 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:54,280 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:54,280 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:54,280 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:54,281 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:42:54,281 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:54,281 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:42:54,281 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:54,282 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:42:54,282 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:42:54,283 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:54,283 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:42:54,283 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:54,284 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:54,284 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:54,284 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:42:54,284 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:42:54,284 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:42:54,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:42:54,285 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:42:54,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:42:54,288 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:42:54,288 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:42:54,289 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:42:54,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:42:54,289 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:42:54,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:42:54,289 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:54,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:42:54,290 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:54,290 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:54,290 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:54,291 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:42:54,291 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:42:54,291 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:42:54,291 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:42:54,295 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:42:54,296 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:54,297 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:54,297 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:42:54,299 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:54,299 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:54,299 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:54,300 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:54,311 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4062, Threshold=0.4309, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:42:54,311 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4062
2025-08-04 20:43:08,594 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:08,594 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:08,594 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:08,594 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:43:08,594 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:43:08,594 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:08,942 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:08,942 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:09,039 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:43:09,094 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:43:09,095 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:09,253 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:09,260 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:09,260 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:09,265 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:43:09,273 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:09,273 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:43:09,273 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:09,273 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:09,273 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:43:09,284 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:09,287 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:09,290 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:09,292 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:09,295 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:09,298 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:09,301 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:09,303 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:09,306 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:09,308 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:09,311 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:09,321 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:09,321 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:43:09,326 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:43:09,326 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:43:09,331 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:09,331 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:43:09,341 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:09,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:43:09,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:09,358 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:09,363 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:43:09,375 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:43:09,375 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:09,375 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:09,376 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:09,376 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:09,376 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:09,376 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:43:09,377 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:09,377 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:43:09,377 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:09,378 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:43:09,379 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:43:09,379 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:09,379 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:43:09,380 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:09,380 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:09,380 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:09,380 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:43:09,380 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:43:09,381 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:43:09,381 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:43:09,381 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:43:09,381 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:43:09,385 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:43:09,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:43:09,385 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:43:09,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:43:09,385 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:43:09,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:43:09,385 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:09,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:43:09,386 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:09,386 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:09,387 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:09,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:43:09,387 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:43:09,387 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:43:09,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:43:09,393 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:43:09,393 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:09,394 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:09,394 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:09,396 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:09,396 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:09,396 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:09,397 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:09,410 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4401, Threshold=0.4715, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:43:09,410 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4401
2025-08-04 20:43:14,696 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:14,696 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:14,696 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:14,697 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:43:14,697 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:43:14,697 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:15,015 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:15,015 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:15,111 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:43:15,159 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:43:15,159 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:15,288 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:15,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:15,295 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:15,302 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:43:15,308 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:15,308 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:43:15,309 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:15,309 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:15,309 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:43:15,318 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:15,321 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:15,323 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:15,325 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:15,328 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:15,330 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:15,333 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:15,335 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:15,338 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:15,340 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:15,342 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:15,352 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:15,352 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:43:15,357 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:43:15,358 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:43:15,362 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:15,363 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:43:15,372 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:15,373 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:43:15,373 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:15,387 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:15,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:43:15,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:43:15,398 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:15,398 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:15,398 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:15,398 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:15,399 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:15,399 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:43:15,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:15,399 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:43:15,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:15,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:43:15,401 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:43:15,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:15,401 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:43:15,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:15,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:15,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:15,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:43:15,402 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:43:15,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:43:15,402 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:43:15,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:43:15,402 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:43:15,406 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:43:15,406 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:43:15,406 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:43:15,406 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:43:15,406 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:43:15,406 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:43:15,406 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:15,407 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:43:15,407 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:15,407 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:15,407 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:15,408 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:43:15,408 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:43:15,408 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:43:15,408 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:43:15,412 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:43:15,412 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:15,413 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:15,413 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:15,415 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 97/400.
2025-08-04 20:43:15,516 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:15,516 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:15,518 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1529 anomalous samples to GAN training data (target: 1529).
2025-08-04 20:43:15,518 - ClientAppLogger [Client 1] - INFO - [Client] Round 97: Training GAN with 6626 samples (5097 normal, 1529 anomalous).
2025-08-04 20:43:15,518 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:20,230 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0848, Avg D Loss: 0.8270
2025-08-04 20:43:20,231 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0848, Avg D Loss: 0.8270
2025-08-04 20:43:20,231 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:20,242 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4107, Threshold=0.4336, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:43:20,242 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8119
2025-08-04 20:43:20,242 - ClientAppLogger [Client 1] - INFO - Fit completed for round 97. Duration: 4.83s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 97, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0847512058933946, 'd_loss': 0.8269786034722794, 'post_fit_local_f1': 0.8118811881188119, 'fit_time_seconds': 4.827000617980957, 'cpu_percent_fit': 12.49375, 'ram_mb_fit': 6.91796875, 'accumulated_train_samples_this_round': 6626}
2025-08-04 20:43:20,242 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:43:25,501 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:25,501 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:25,501 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:25,501 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:43:25,501 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:43:25,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:25,785 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:25,785 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:25,868 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:43:25,906 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:43:25,906 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:26,013 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:26,019 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:26,019 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:26,024 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:43:26,029 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:26,029 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:43:26,030 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:26,030 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:26,030 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:43:26,038 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:26,041 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:26,043 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:26,045 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:26,048 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:26,050 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:26,054 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:26,056 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:26,059 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:26,061 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:26,063 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:26,072 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:26,072 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:43:26,077 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:43:26,077 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:43:26,082 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:26,082 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:43:26,090 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:26,090 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:43:26,091 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:26,106 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:26,111 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:43:26,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:43:26,120 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:26,120 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:26,120 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:26,120 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:26,120 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:26,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:43:26,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:26,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:43:26,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:26,122 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:43:26,123 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:43:26,123 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:26,123 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:43:26,123 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:26,124 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:26,124 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:26,124 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:43:26,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:43:26,124 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:43:26,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:43:26,124 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:43:26,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:43:26,127 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:43:26,127 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:43:26,127 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:43:26,128 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:43:26,128 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:43:26,128 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:43:26,128 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:26,128 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:43:26,129 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:26,129 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:26,129 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:26,129 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:43:26,129 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:43:26,129 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:43:26,130 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:43:26,134 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:43:26,134 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:26,136 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:26,136 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:26,137 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:26,137 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:26,137 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:26,138 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:26,150 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4124, Threshold=0.4361, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:43:26,150 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4124
2025-08-04 20:43:31,406 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:31,406 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:31,406 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:31,406 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:43:31,406 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:43:31,406 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:31,673 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:31,673 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:31,759 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:43:31,797 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:43:31,797 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:31,905 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:31,910 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:31,910 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:31,915 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:43:31,920 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:31,921 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:43:31,921 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:31,921 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:31,921 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:43:31,929 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:31,932 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:31,935 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:31,938 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:31,940 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:31,942 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:31,945 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:31,947 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:31,950 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:31,952 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:31,954 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:31,962 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:31,963 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:43:31,967 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:43:31,967 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:43:31,972 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:31,972 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:43:31,979 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:31,980 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:43:31,980 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:31,994 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:31,999 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:43:32,004 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:43:32,004 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:32,004 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:32,004 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:32,005 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:32,005 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:32,005 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:43:32,005 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:32,005 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:43:32,006 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:32,007 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:43:32,007 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:43:32,007 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:32,007 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:43:32,007 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:32,008 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:32,008 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:32,008 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:43:32,008 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:43:32,008 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:43:32,008 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:43:32,008 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:43:32,008 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:43:32,010 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:43:32,011 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:43:32,011 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:43:32,011 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:43:32,011 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:43:32,011 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:43:32,012 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:32,012 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:43:32,012 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:32,012 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:32,013 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:32,013 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:43:32,013 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:43:32,013 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:43:32,013 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:43:32,017 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:43:32,017 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:32,018 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:32,018 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:32,020 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 98/400.
2025-08-04 20:43:32,121 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:32,121 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:32,122 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1544 anomalous samples to GAN training data (target: 1544).
2025-08-04 20:43:32,123 - ClientAppLogger [Client 1] - INFO - [Client] Round 98: Training GAN with 6691 samples (5147 normal, 1544 anomalous).
2025-08-04 20:43:32,123 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:36,901 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0850, Avg D Loss: 0.8217
2025-08-04 20:43:36,901 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0850, Avg D Loss: 0.8217
2025-08-04 20:43:36,901 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:36,913 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4505, Threshold=0.4718, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:43:36,913 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8119
2025-08-04 20:43:36,913 - ClientAppLogger [Client 1] - INFO - Fit completed for round 98. Duration: 4.89s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 98, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0849936927207615, 'd_loss': 0.8216545634411532, 'post_fit_local_f1': 0.8118811881188119, 'fit_time_seconds': 4.893239259719849, 'cpu_percent_fit': 12.49375, 'ram_mb_fit': 0.14453125, 'accumulated_train_samples_this_round': 6691}
2025-08-04 20:43:36,913 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:43:42,176 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:42,176 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:42,177 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:42,177 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:43:42,177 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:43:42,177 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:42,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:42,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:42,652 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:43:42,693 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:43:42,693 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:42,827 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:42,835 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:42,835 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:42,841 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:43:42,847 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:42,850 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:43:42,851 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:42,851 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:42,851 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:43:42,861 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:42,865 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:42,867 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:42,869 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:42,872 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:42,874 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:42,877 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:42,881 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:42,887 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:42,889 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:42,892 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:42,903 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:42,903 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:43:42,908 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:43:42,909 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:43:42,913 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:42,914 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:43:42,922 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:42,923 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:43:42,923 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:42,939 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:42,943 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:43:42,949 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:43:42,949 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:42,949 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:42,949 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:42,950 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:42,950 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:42,950 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:43:42,950 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:42,950 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:43:42,951 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:42,952 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:43:42,952 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:43:42,952 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:42,953 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:43:42,953 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:42,953 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:42,953 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:42,953 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:43:42,953 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:43:42,953 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:43:42,954 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:43:42,954 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:43:42,954 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:43:42,957 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:43:42,957 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:43:42,958 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:43:42,958 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:43:42,958 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:43:42,958 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:43:42,958 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:42,959 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:43:42,959 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:42,959 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:42,959 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:42,960 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:43:42,960 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:43:42,960 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:43:42,960 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:43:42,964 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:43:42,964 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:42,965 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:42,965 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:42,967 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:42,967 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:42,967 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:42,968 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:42,980 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4493, Threshold=0.4714, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:43:42,980 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4493
2025-08-04 20:43:48,243 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:48,243 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:48,244 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:48,244 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:43:48,244 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:43:48,244 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:48,554 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:48,554 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:48,637 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:43:48,682 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:43:48,683 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:48,806 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:48,812 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:48,813 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:48,818 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:43:48,825 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:48,825 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:43:48,825 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:48,825 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:48,826 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:43:48,834 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:48,838 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:48,839 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:48,842 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:48,844 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:48,846 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:48,849 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:48,852 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:48,855 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:48,857 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:48,859 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:48,870 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:48,870 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:43:48,875 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:43:48,875 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:43:48,880 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:48,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:43:48,889 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:48,889 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:43:48,889 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:48,904 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:48,909 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:43:48,914 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:43:48,914 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:48,914 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:48,914 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:48,915 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:48,915 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:48,916 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:43:48,916 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:48,916 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:43:48,916 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:48,917 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:43:48,918 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:43:48,918 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:48,918 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:43:48,918 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:48,919 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:48,919 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:48,919 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:43:48,919 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:43:48,919 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:43:48,919 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:43:48,919 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:43:48,920 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:43:48,921 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:43:48,921 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:43:48,922 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:43:48,922 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:43:48,922 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:43:48,922 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:43:48,922 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:48,922 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:43:48,923 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:48,923 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:48,923 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:48,923 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:43:48,923 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:43:48,923 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:43:48,924 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:43:48,926 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:43:48,926 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:48,928 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:48,928 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:48,929 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 99/400.
2025-08-04 20:43:49,031 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:49,031 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:49,032 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1560 anomalous samples to GAN training data (target: 1560).
2025-08-04 20:43:49,033 - ClientAppLogger [Client 1] - INFO - [Client] Round 99: Training GAN with 6760 samples (5200 normal, 1560 anomalous).
2025-08-04 20:43:49,033 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:53,768 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0853, Avg D Loss: 0.8198
2025-08-04 20:43:53,768 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0853, Avg D Loss: 0.8198
2025-08-04 20:43:53,769 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:53,780 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3833, Threshold=0.3839, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:43:53,780 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8119
2025-08-04 20:43:53,780 - ClientAppLogger [Client 1] - INFO - Fit completed for round 99. Duration: 4.85s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 99, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0852928924560548, 'd_loss': 0.8198450665572692, 'post_fit_local_f1': 0.8118811881188119, 'fit_time_seconds': 4.8505918979644775, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 6760}
2025-08-04 20:43:53,780 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:43:59,034 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:59,034 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:59,034 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:59,035 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:43:59,035 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:43:59,035 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:59,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:59,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:59,430 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:43:59,471 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:43:59,471 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:59,614 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:59,626 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:59,626 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:59,634 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:43:59,646 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:59,646 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:43:59,647 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:59,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:59,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:43:59,657 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:59,660 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:59,663 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:59,665 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:59,667 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:59,670 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:59,672 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:59,675 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:59,678 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:59,680 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:59,683 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:59,694 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:59,694 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:43:59,700 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:43:59,700 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:43:59,706 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:59,706 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:43:59,717 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:59,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:43:59,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:59,735 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:59,741 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:43:59,751 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:43:59,751 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:59,751 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:59,751 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:59,752 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:59,752 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:59,752 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:43:59,752 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:59,753 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:43:59,753 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:59,754 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:43:59,755 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:43:59,755 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:59,755 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:43:59,756 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:59,756 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:59,756 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:59,756 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:43:59,756 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:43:59,757 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:43:59,757 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:43:59,757 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:43:59,757 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:43:59,762 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:43:59,762 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:43:59,762 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:43:59,762 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:43:59,763 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:43:59,763 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:43:59,763 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:59,763 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:43:59,764 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:59,764 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:59,764 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:59,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:43:59,765 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:43:59,765 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:43:59,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:43:59,772 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:43:59,773 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:59,775 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:59,775 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:59,777 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:59,777 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:59,777 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:59,778 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:59,791 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.3870, Threshold=0.3892, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:43:59,791 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.3870
2025-08-04 20:44:11,056 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:11,057 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:44:11,057 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:44:11,057 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:44:11,057 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:44:11,057 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:11,381 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:11,382 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:11,474 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:44:11,516 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:44:11,521 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:11,711 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:11,726 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:11,727 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:11,734 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:44:11,744 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:11,744 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:44:11,745 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:11,745 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:11,745 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:44:11,756 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:11,760 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:11,762 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:11,764 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:11,768 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:11,770 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:11,773 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:11,775 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:11,778 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:11,780 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:11,783 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:11,796 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:11,796 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:44:11,801 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:44:11,801 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:44:11,811 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:11,812 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:44:11,827 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:11,828 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:44:11,828 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:11,847 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:11,854 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:44:11,868 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:44:11,868 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:11,868 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:11,868 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:11,869 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:11,869 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:11,869 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:44:11,869 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:11,870 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:44:11,870 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:11,872 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:44:11,872 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:44:11,872 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:11,872 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:44:11,873 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:11,873 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:11,873 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:11,873 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:44:11,873 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:44:11,874 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:44:11,874 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:44:11,874 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:44:11,874 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:44:11,879 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:44:11,879 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:44:11,879 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:44:11,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:44:11,880 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:44:11,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:44:11,880 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:11,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:44:11,881 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:11,882 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:11,882 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:11,882 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:44:11,883 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:44:11,883 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:44:11,883 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:44:11,892 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:44:11,892 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:11,894 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:11,894 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:11,895 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:11,896 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:11,896 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:11,896 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:11,909 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4095, Threshold=0.4151, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:44:11,909 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4095
2025-08-04 20:44:20,172 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:20,172 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:44:20,172 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:44:20,173 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:44:20,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:44:20,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:20,437 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:20,437 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:20,524 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:44:20,567 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:44:20,567 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:20,693 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:20,701 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:20,701 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:20,707 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:44:20,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:20,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:44:20,714 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:20,715 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:20,715 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:44:20,724 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:20,727 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:20,729 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:20,732 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:20,734 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:20,737 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:20,739 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:20,741 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:20,744 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:20,746 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:20,748 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:20,759 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:20,759 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:44:20,764 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:44:20,764 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:44:20,770 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:20,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:44:20,782 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:20,782 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:44:20,782 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:20,798 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:20,803 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:44:20,809 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:44:20,809 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:20,809 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:20,809 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:20,810 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:20,810 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:20,810 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:44:20,810 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:20,810 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:44:20,811 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:20,812 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:44:20,812 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:44:20,813 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:20,813 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:44:20,813 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:20,813 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:20,813 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:20,813 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:44:20,814 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:44:20,814 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:44:20,814 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:44:20,814 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:44:20,814 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:44:20,816 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:44:20,816 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:44:20,817 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:44:20,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:44:20,817 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:44:20,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:44:20,817 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:20,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:44:20,818 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:20,818 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:20,818 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:20,818 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:44:20,818 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:44:20,819 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:44:20,819 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:44:20,823 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:44:20,823 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:20,825 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:20,825 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:20,826 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 101/400.
2025-08-04 20:44:20,928 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:20,928 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:20,930 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1592 anomalous samples to GAN training data (target: 1592).
2025-08-04 20:44:20,931 - ClientAppLogger [Client 1] - INFO - [Client] Round 101: Training GAN with 6899 samples (5307 normal, 1592 anomalous).
2025-08-04 20:44:20,931 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:44:25,890 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0855, Avg D Loss: 0.8139
2025-08-04 20:44:25,890 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0855, Avg D Loss: 0.8139
2025-08-04 20:44:25,891 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:44:25,902 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4165, Threshold=0.4191, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:44:25,902 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8119
2025-08-04 20:44:25,903 - ClientAppLogger [Client 1] - INFO - Fit completed for round 101. Duration: 5.08s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 101, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0854590909725377, 'd_loss': 0.8139176604470959, 'post_fit_local_f1': 0.8118811881188119, 'fit_time_seconds': 5.075962066650391, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 6899}
2025-08-04 20:44:25,903 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:44:31,166 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:31,166 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:44:31,166 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:44:31,166 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:44:31,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:44:31,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:31,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:31,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:31,538 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:44:31,582 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:44:31,582 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:31,706 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:31,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:31,713 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:31,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:44:31,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:31,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:44:31,725 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:31,725 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:31,725 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:44:31,733 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:31,736 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:31,739 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:31,742 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:31,745 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:31,748 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:31,750 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:31,753 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:31,756 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:31,758 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:31,760 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:31,770 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:31,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:44:31,775 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:44:31,775 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:44:31,780 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:31,780 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:44:31,788 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:31,788 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:44:31,788 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:31,802 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:31,807 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:44:31,812 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:44:31,812 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:31,813 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:31,813 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:31,813 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:31,814 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:31,814 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:44:31,814 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:31,814 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:44:31,814 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:31,816 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:44:31,816 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:44:31,816 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:31,816 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:44:31,816 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:31,816 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:31,817 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:31,817 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:44:31,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:44:31,817 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:44:31,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:44:31,817 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:44:31,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:44:31,820 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:44:31,820 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:44:31,820 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:44:31,820 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:44:31,820 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:44:31,821 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:44:31,821 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:31,821 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:44:31,821 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:31,821 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:31,822 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:31,822 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:44:31,822 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:44:31,822 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:44:31,822 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:44:31,826 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:44:31,826 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:31,827 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:31,827 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:31,829 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:31,829 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:31,829 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:31,830 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:31,841 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4210, Threshold=0.4241, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:44:31,842 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4210
2025-08-04 20:44:37,097 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:37,097 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:44:37,098 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:44:37,098 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:44:37,098 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:44:37,098 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:37,379 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:37,379 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:37,461 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:44:37,504 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:44:37,504 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:37,611 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:37,616 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:37,617 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:37,621 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:44:37,626 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:37,626 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:44:37,627 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:37,627 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:37,627 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:44:37,635 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:37,637 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:37,640 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:37,642 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:37,644 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:37,647 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:37,649 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:37,652 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:37,654 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:37,656 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:37,658 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:37,666 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:37,666 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:44:37,671 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:44:37,671 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:44:37,675 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:37,675 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:44:37,683 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:37,683 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:44:37,683 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:37,697 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:37,702 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:44:37,706 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:44:37,706 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:37,707 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:37,707 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:37,707 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:37,707 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:37,707 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:44:37,708 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:37,708 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:44:37,708 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:37,709 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:44:37,709 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:44:37,710 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:37,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:44:37,710 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:37,710 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:37,710 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:37,710 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:44:37,710 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:44:37,711 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:44:37,711 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:44:37,711 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:44:37,711 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:44:37,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:44:37,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:44:37,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:44:37,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:44:37,713 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:44:37,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:44:37,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:37,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:44:37,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:37,714 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:37,715 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:37,715 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:44:37,715 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:44:37,715 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:44:37,715 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:44:37,719 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:44:37,719 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:37,720 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:37,720 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:37,721 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 102/400.
2025-08-04 20:44:37,823 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:37,823 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:37,824 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1607 anomalous samples to GAN training data (target: 1607).
2025-08-04 20:44:37,825 - ClientAppLogger [Client 1] - INFO - [Client] Round 102: Training GAN with 6966 samples (5359 normal, 1607 anomalous).
2025-08-04 20:44:37,825 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:44:42,755 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0854, Avg D Loss: 0.8090
2025-08-04 20:44:42,755 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0854, Avg D Loss: 0.8090
2025-08-04 20:44:42,756 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:44:42,766 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4433, Threshold=0.4539, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:44:42,767 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8119
2025-08-04 20:44:42,767 - ClientAppLogger [Client 1] - INFO - Fit completed for round 102. Duration: 5.05s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 102, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0854499947774903, 'd_loss': 0.8090329928744501, 'post_fit_local_f1': 0.8118811881188119, 'fit_time_seconds': 5.045206308364868, 'cpu_percent_fit': 12.4875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 6966}
2025-08-04 20:44:42,767 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:44:48,015 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:48,015 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:44:48,015 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:44:48,015 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:44:48,015 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:44:48,016 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:48,308 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:48,308 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:48,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:44:48,441 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:44:48,442 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:48,596 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:48,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:48,604 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:48,612 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:44:48,621 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:48,621 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:44:48,622 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:48,622 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:48,622 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:44:48,632 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:48,635 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:48,637 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:48,640 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:48,642 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:48,644 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:48,647 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:48,650 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:48,652 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:48,654 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:48,657 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:48,670 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:48,670 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:44:48,676 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:44:48,676 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:44:48,682 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:48,682 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:44:48,696 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:48,696 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:44:48,696 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:48,713 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:48,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:44:48,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:44:48,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:48,724 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:48,724 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:48,724 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:48,725 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:48,725 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:44:48,725 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:48,725 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:44:48,726 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:48,727 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:44:48,727 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:44:48,727 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:48,728 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:44:48,728 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:48,728 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:48,728 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:48,728 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:44:48,728 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:44:48,729 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:44:48,729 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:44:48,729 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:44:48,729 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:44:48,731 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:44:48,731 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:44:48,732 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:44:48,732 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:44:48,732 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:44:48,732 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:44:48,732 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:48,732 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:44:48,733 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:48,733 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:48,733 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:48,733 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:44:48,733 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:44:48,734 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:44:48,734 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:44:48,740 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:44:48,741 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:48,742 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:48,742 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:48,743 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:48,744 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:48,744 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:48,745 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:48,756 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4432, Threshold=0.4538, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:44:48,756 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4432
2025-08-04 20:45:00,027 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:00,027 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:00,027 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:00,027 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:45:00,028 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:45:00,028 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:00,308 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:00,308 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:00,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:45:00,439 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:45:00,439 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:00,559 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:00,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:00,566 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:00,572 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:45:00,578 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:00,578 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:45:00,579 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:00,579 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:00,579 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:45:00,588 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:00,591 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:00,593 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:00,595 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:00,598 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:00,600 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:00,602 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:00,605 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:00,608 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:00,610 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:00,613 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:00,622 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:00,622 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:45:00,627 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:45:00,627 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:45:00,632 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:00,632 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:45:00,641 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:00,641 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:45:00,645 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:00,659 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:00,664 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:45:00,671 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:45:00,671 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:00,672 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:00,672 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:00,672 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:00,672 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:00,673 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:45:00,673 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:00,673 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:45:00,673 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:00,674 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:45:00,674 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:45:00,675 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:00,675 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:45:00,675 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:00,675 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:00,676 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:00,676 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:45:00,676 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:45:00,676 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:45:00,676 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:45:00,676 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:45:00,676 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:45:00,679 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:45:00,680 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:45:00,680 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:45:00,680 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:45:00,680 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:45:00,680 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:45:00,680 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:00,681 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:45:00,681 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:00,681 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:00,681 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:00,682 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:45:00,682 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:45:00,682 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:45:00,682 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:45:00,685 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:45:00,685 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:00,687 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:00,687 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:00,688 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 103/400.
2025-08-04 20:45:00,790 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:00,790 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:00,791 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1626 anomalous samples to GAN training data (target: 1626).
2025-08-04 20:45:00,792 - ClientAppLogger [Client 1] - INFO - [Client] Round 103: Training GAN with 7046 samples (5420 normal, 1626 anomalous).
2025-08-04 20:45:00,792 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:05,657 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0851, Avg D Loss: 0.8039
2025-08-04 20:45:05,657 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0851, Avg D Loss: 0.8039
2025-08-04 20:45:05,657 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:05,668 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4615, Threshold=0.4888, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:45:05,669 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8119
2025-08-04 20:45:05,669 - ClientAppLogger [Client 1] - INFO - Fit completed for round 103. Duration: 4.98s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 103, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.085063024647291, 'd_loss': 0.8039232158099188, 'post_fit_local_f1': 0.8118811881188119, 'fit_time_seconds': 4.980357646942139, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 7046}
2025-08-04 20:45:05,669 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:45:10,920 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:10,920 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:10,921 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:10,921 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:45:10,921 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:45:10,921 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:11,160 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:11,160 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:11,245 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:45:11,283 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:45:11,284 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:11,392 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:11,398 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:11,398 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:11,403 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:45:11,408 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:11,408 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:45:11,409 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:11,409 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:11,409 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:45:11,417 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:11,420 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:11,422 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:11,424 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:11,427 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:11,429 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:11,431 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:11,434 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:11,436 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:11,438 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:11,441 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:11,450 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:11,450 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:45:11,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:45:11,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:45:11,459 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:11,460 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:45:11,468 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:11,468 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:45:11,468 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:11,484 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:11,489 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:45:11,494 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:45:11,494 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:11,494 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:11,494 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:11,495 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:11,495 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:11,495 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:45:11,495 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:11,495 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:45:11,496 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:11,497 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:45:11,497 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:45:11,497 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:11,498 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:45:11,498 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:11,498 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:11,498 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:11,498 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:45:11,498 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:45:11,499 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:45:11,499 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:45:11,499 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:45:11,499 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:45:11,502 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:45:11,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:45:11,502 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:45:11,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:45:11,502 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:45:11,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:45:11,502 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:11,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:45:11,503 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:11,503 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:11,503 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:11,503 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:45:11,503 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:45:11,504 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:45:11,504 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:45:11,507 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:45:11,507 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:11,509 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:11,509 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:11,510 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:11,510 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:11,511 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:11,511 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:11,522 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4612, Threshold=0.4882, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:45:11,523 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4612
2025-08-04 20:45:19,778 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:19,778 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:19,778 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:19,778 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:45:19,778 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:45:19,778 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:20,050 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:20,050 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:20,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:45:20,170 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:45:20,170 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:20,276 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:20,282 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:20,282 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:20,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:45:20,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:20,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:45:20,293 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:20,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:20,293 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:45:20,301 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:20,304 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:20,306 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:20,308 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:20,311 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:20,313 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:20,315 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:20,318 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:20,321 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:20,322 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:20,325 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:20,333 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:20,333 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:45:20,337 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:45:20,338 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:45:20,342 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:20,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:45:20,350 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:20,350 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:45:20,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:20,365 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:20,369 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:45:20,374 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:45:20,374 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:20,375 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:20,375 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:20,375 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:20,375 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:20,375 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:45:20,376 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:20,376 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:45:20,376 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:20,377 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:45:20,377 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:45:20,378 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:20,378 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:45:20,378 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:20,378 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:20,378 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:20,379 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:45:20,379 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:45:20,379 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:45:20,379 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:45:20,379 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:45:20,379 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:45:20,381 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:45:20,381 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:45:20,381 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:45:20,382 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:45:20,382 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:45:20,382 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:45:20,382 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:20,382 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:45:20,382 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:20,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:20,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:20,383 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:45:20,383 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:45:20,383 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:45:20,384 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:45:20,388 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:45:20,388 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:20,389 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:20,389 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:20,390 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 104/400.
2025-08-04 20:45:20,491 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:20,491 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:20,493 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1639 anomalous samples to GAN training data (target: 1639).
2025-08-04 20:45:20,494 - ClientAppLogger [Client 1] - INFO - [Client] Round 104: Training GAN with 7105 samples (5466 normal, 1639 anomalous).
2025-08-04 20:45:20,494 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:25,603 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0850, Avg D Loss: 0.8031
2025-08-04 20:45:25,603 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0850, Avg D Loss: 0.8031
2025-08-04 20:45:25,603 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:25,614 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4743, Threshold=0.5096, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:45:25,615 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8119
2025-08-04 20:45:25,615 - ClientAppLogger [Client 1] - INFO - Fit completed for round 104. Duration: 5.22s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 104, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0849885909344263, 'd_loss': 0.8030614032575902, 'post_fit_local_f1': 0.8118811881188119, 'fit_time_seconds': 5.224724531173706, 'cpu_percent_fit': 12.4875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 7105}
2025-08-04 20:45:25,615 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:45:30,894 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:30,894 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:30,894 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:30,894 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:45:30,894 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:45:30,894 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:31,182 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:31,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:31,267 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:45:31,313 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:45:31,313 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:31,429 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:31,435 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:31,435 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:31,439 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:45:31,444 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:31,446 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:45:31,447 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:31,447 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:31,447 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:45:31,456 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:31,459 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:31,461 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:31,463 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:31,465 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:31,468 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:31,470 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:31,473 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:31,475 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:31,477 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:31,479 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:31,488 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:31,488 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:45:31,493 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:45:31,493 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:45:31,497 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:31,498 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:45:31,505 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:31,506 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:45:31,506 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:31,519 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:31,524 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:45:31,529 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:45:31,529 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:31,529 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:31,529 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:31,529 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:31,530 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:31,530 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:45:31,530 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:31,530 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:45:31,530 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:31,532 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:45:31,532 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:45:31,533 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:31,533 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:45:31,533 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:31,533 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:31,533 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:31,533 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:45:31,533 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:45:31,534 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:45:31,534 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:45:31,534 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:45:31,534 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:45:31,536 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:45:31,537 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:45:31,537 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:45:31,537 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:45:31,537 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:45:31,537 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:45:31,537 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:31,538 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:45:31,538 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:31,538 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:31,538 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:31,539 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:45:31,539 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:45:31,539 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:45:31,539 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:45:31,543 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:45:31,543 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:31,544 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:31,544 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:31,545 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:31,545 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:31,545 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:31,546 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:31,557 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4945, Threshold=0.5208, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:45:31,557 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.4945
2025-08-04 20:45:45,869 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:45,870 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:45,870 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:45,870 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:45:45,870 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:45:45,871 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:46,288 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:46,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:46,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:45:46,444 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:45:46,445 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:46,571 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:46,577 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:46,577 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:46,583 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:45:46,588 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:46,588 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:45:46,589 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:46,589 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:46,589 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:45:46,598 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:46,601 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:46,603 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:46,605 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:46,608 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:46,610 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:46,612 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:46,615 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:46,618 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:46,620 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:46,622 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:46,633 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:46,633 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:45:46,638 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:45:46,638 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:45:46,644 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:46,644 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:45:46,655 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:46,655 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:45:46,655 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:46,671 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:46,675 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:45:46,681 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:45:46,681 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:46,681 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:46,681 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:46,681 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:46,681 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:46,682 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:45:46,682 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:46,682 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:45:46,682 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:46,684 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:45:46,684 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:45:46,684 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:46,684 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:45:46,684 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:46,685 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:46,685 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:46,685 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:45:46,685 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:45:46,685 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:45:46,685 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:45:46,685 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:45:46,685 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:45:46,687 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:45:46,688 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:45:46,688 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:45:46,688 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:45:46,688 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:45:46,688 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:45:46,688 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:46,689 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:45:46,689 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:46,689 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:46,689 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:46,690 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:45:46,690 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:45:46,690 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:45:46,690 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:45:46,693 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:45:46,693 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:46,695 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:46,695 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:46,696 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:46,697 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:46,697 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:46,697 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:46,708 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5075, Threshold=0.5624, Accuracy=0.7170, F1=0.8053, Precision=0.9760, Recall=0.6854
2025-08-04 20:45:46,709 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7170, F1: 0.8053, Prec: 0.9760, Rec: 0.6854, Avg Anomaly Score: 0.5075
2025-08-04 20:45:57,992 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:57,992 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:57,992 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:57,992 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:45:57,993 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:45:57,993 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:58,317 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:58,318 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:58,417 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:45:58,465 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:45:58,465 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:58,579 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:58,586 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:58,586 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:58,592 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:45:58,599 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:58,599 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:45:58,599 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:58,600 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:58,600 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:45:58,608 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:58,611 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:58,613 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:58,615 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:58,618 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:58,620 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:58,622 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:58,625 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:58,628 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:58,630 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:58,632 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:58,642 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:58,642 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:45:58,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:45:58,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:45:58,652 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:58,652 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:45:58,663 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:58,663 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:45:58,663 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:58,680 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:58,686 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:45:58,691 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:45:58,691 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:58,691 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:58,691 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:58,692 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:58,692 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:58,692 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:45:58,692 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:58,693 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:45:58,693 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:58,694 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:45:58,694 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:45:58,694 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:58,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:45:58,695 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:58,695 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:58,695 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:58,695 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:45:58,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:45:58,695 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:45:58,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:45:58,696 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:45:58,696 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:45:58,698 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:45:58,698 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:45:58,698 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:45:58,698 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:45:58,698 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:45:58,698 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:45:58,699 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:58,699 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:45:58,699 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:58,700 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:58,700 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:58,700 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:45:58,700 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:45:58,700 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:45:58,701 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:45:58,705 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:45:58,705 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:58,706 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:58,706 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:58,707 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:58,708 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:58,708 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:58,708 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:58,721 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4628, Threshold=0.4929, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:45:58,721 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4628
2025-08-04 20:46:13,007 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:13,007 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:13,007 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:13,007 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:46:13,008 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:46:13,008 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:13,411 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:13,411 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:13,516 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:46:13,562 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:46:13,562 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:13,706 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:13,712 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:13,712 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:13,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:46:13,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:13,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:46:13,724 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:13,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:13,725 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:46:13,733 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:13,738 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:13,741 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:13,744 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:13,746 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:13,749 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:13,751 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:13,754 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:13,757 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:13,758 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:13,761 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:13,770 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:13,771 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:46:13,775 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:46:13,775 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:46:13,780 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:13,781 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:46:13,790 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:13,791 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:46:13,791 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:13,808 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:13,812 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:46:13,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:46:13,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:13,817 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:13,817 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:13,818 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:13,818 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:13,818 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:46:13,818 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:13,818 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:46:13,819 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:13,820 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:46:13,820 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:46:13,820 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:13,821 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:46:13,821 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:13,821 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:13,821 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:13,821 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:46:13,821 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:46:13,821 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:46:13,822 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:46:13,822 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:46:13,822 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:46:13,824 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:46:13,824 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:46:13,825 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:46:13,825 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:46:13,825 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:46:13,825 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:46:13,825 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:13,825 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:46:13,826 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:13,826 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:13,826 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:13,827 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:46:13,827 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:46:13,827 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:46:13,827 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:46:13,831 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:46:13,831 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:13,832 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:13,832 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:13,833 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:13,834 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:13,834 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:13,834 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:13,845 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4690, Threshold=0.5003, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:46:13,845 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4690
2025-08-04 20:46:19,101 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:19,101 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:19,101 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:19,101 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:46:19,101 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:46:19,101 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:19,415 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:19,415 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:19,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:46:19,541 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:46:19,542 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:19,657 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:19,664 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:19,664 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:19,669 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:46:19,675 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:19,677 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:46:19,677 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:19,677 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:19,677 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:46:19,686 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:19,689 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:19,691 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:19,695 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:19,700 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:19,705 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:19,707 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:19,710 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:19,714 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:19,716 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:19,718 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:19,728 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:19,728 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:46:19,732 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:46:19,733 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:46:19,738 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:19,739 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:46:19,750 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:19,750 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:46:19,752 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:19,766 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:19,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:46:19,775 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:46:19,776 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:19,776 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:19,776 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:19,777 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:19,777 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:19,777 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:46:19,777 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:19,777 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:46:19,777 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:19,779 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:46:19,779 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:46:19,779 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:19,779 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:46:19,780 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:19,780 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:19,780 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:19,780 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:46:19,780 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:46:19,780 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:46:19,781 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:46:19,781 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:46:19,781 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:46:19,784 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:46:19,784 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:46:19,784 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:46:19,784 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:46:19,784 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:46:19,785 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:46:19,785 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:19,785 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:46:19,785 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:19,786 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:19,786 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:19,786 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:46:19,786 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:46:19,786 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:46:19,786 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:46:19,790 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:46:19,790 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:19,791 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:19,791 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:19,792 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 108/400.
2025-08-04 20:46:19,894 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:19,894 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:19,895 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1704 anomalous samples to GAN training data (target: 1704).
2025-08-04 20:46:19,896 - ClientAppLogger [Client 1] - INFO - [Client] Round 108: Training GAN with 7386 samples (5682 normal, 1704 anomalous).
2025-08-04 20:46:19,896 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:25,169 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0847, Avg D Loss: 0.7969
2025-08-04 20:46:25,170 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0847, Avg D Loss: 0.7969
2025-08-04 20:46:25,170 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:25,182 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4787, Threshold=0.5167, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:46:25,182 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:46:25,182 - ClientAppLogger [Client 1] - INFO - Fit completed for round 108. Duration: 5.39s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 108, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0846802130773274, 'd_loss': 0.796851394956363, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 5.389544725418091, 'cpu_percent_fit': 12.50625, 'ram_mb_fit': 0.30078125, 'accumulated_train_samples_this_round': 7386}
2025-08-04 20:46:25,182 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:46:30,448 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:30,448 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:30,448 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:30,448 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:46:30,448 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:46:30,448 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:30,786 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:30,787 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:30,885 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:46:30,929 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:46:30,929 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:31,057 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:31,064 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:31,064 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:31,069 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:46:31,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:31,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:46:31,075 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:31,076 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:31,076 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:46:31,084 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:31,087 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:31,089 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:31,091 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:31,094 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:31,097 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:31,099 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:31,102 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:31,105 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:31,106 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:31,109 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:31,118 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:31,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:46:31,123 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:46:31,123 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:46:31,128 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:31,128 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:46:31,139 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:31,140 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:46:31,140 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:31,157 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:31,163 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:46:31,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:46:31,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:31,173 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:31,173 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:31,173 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:31,174 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:31,174 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:46:31,174 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:31,174 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:46:31,174 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:31,175 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:46:31,177 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:46:31,178 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:31,178 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:46:31,178 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:31,179 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:31,179 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:31,179 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:46:31,179 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:46:31,179 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:46:31,179 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:46:31,179 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:46:31,179 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:46:31,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:46:31,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:46:31,183 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:46:31,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:46:31,183 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:46:31,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:46:31,183 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:31,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:46:31,184 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:31,184 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:31,184 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:31,185 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:46:31,185 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:46:31,185 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:46:31,185 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:46:31,190 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:46:31,190 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:31,191 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:31,194 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:31,195 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:31,195 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:31,196 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:31,196 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:31,208 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4893, Threshold=0.5325, Accuracy=0.7242, F1=0.8099, Precision=0.9839, Recall=0.6882
2025-08-04 20:46:31,208 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7242, F1: 0.8099, Prec: 0.9839, Rec: 0.6882, Avg Anomaly Score: 0.4893
2025-08-04 20:46:45,488 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:45,488 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:45,488 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:45,488 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:46:45,488 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:46:45,488 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:45,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:45,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:45,864 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:46:45,911 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:46:45,911 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:46,040 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:46,045 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:46,045 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:46,051 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:46:46,056 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:46,056 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:46:46,056 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:46,057 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:46,057 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:46:46,065 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:46,068 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:46,070 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:46,072 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:46,075 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:46,077 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:46,080 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:46,083 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:46,085 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:46,087 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:46,089 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:46,099 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:46,099 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:46:46,105 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:46:46,105 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:46:46,111 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:46,111 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:46:46,120 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:46,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:46:46,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:46,137 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:46,141 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:46:46,150 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:46:46,150 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:46,150 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:46,150 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:46,151 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:46,151 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:46,151 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:46:46,151 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:46,152 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:46:46,152 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:46,153 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:46:46,153 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:46:46,154 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:46,154 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:46:46,154 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:46,154 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:46,154 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:46,154 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:46:46,155 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:46:46,155 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:46:46,155 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:46:46,155 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:46:46,155 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:46:46,159 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:46:46,159 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:46:46,160 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:46:46,160 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:46:46,160 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:46:46,160 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:46:46,160 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:46,160 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:46:46,161 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:46,161 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:46,161 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:46,161 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:46:46,162 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:46:46,162 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:46:46,162 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:46:46,165 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:46:46,166 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:46,167 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:46,167 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:46,169 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:46,169 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:46,169 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:46,170 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:46,182 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4724, Threshold=0.5067, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:46:46,182 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4724
2025-08-04 20:47:00,472 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:00,472 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:00,472 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:00,472 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:47:00,472 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:47:00,472 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:00,793 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:00,794 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:00,882 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:47:00,926 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:47:00,928 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:01,049 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:01,055 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:01,055 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:01,061 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:47:01,066 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:01,067 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:47:01,067 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:01,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:01,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:47:01,076 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:01,079 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:01,081 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:01,083 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:01,086 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:01,088 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:01,091 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:01,093 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:01,096 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:01,099 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:01,101 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:01,111 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:01,112 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:47:01,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:47:01,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:47:01,121 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:01,122 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:47:01,130 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:01,130 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:47:01,130 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:01,145 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:01,149 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:47:01,156 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:47:01,156 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:01,156 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:01,156 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:01,157 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:01,157 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:01,157 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:47:01,157 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:01,158 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:47:01,158 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:01,159 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:47:01,159 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:47:01,159 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:01,160 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:47:01,160 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:01,160 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:01,160 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:01,160 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:47:01,160 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:47:01,160 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:47:01,161 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:47:01,161 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:47:01,161 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:47:01,162 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:47:01,162 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:47:01,162 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:47:01,163 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:47:01,163 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:47:01,163 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:47:01,163 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:01,163 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:47:01,164 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:01,164 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:01,164 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:01,164 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:47:01,165 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:47:01,165 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:47:01,165 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:47:01,169 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:47:01,169 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:01,170 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:01,170 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:01,172 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:01,173 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:01,173 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:01,174 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:01,186 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5114, Threshold=0.5562, Accuracy=0.7170, F1=0.8053, Precision=0.9760, Recall=0.6854
2025-08-04 20:47:01,186 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7170, F1: 0.8053, Prec: 0.9760, Rec: 0.6854, Avg Anomaly Score: 0.5114
2025-08-04 20:47:15,457 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:15,457 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:15,457 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:15,457 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:47:15,457 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:47:15,458 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:15,809 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:15,809 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:15,904 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:47:15,950 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:47:15,950 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:16,107 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:16,115 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:16,115 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:16,123 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:47:16,131 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:16,132 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:47:16,132 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:16,132 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:16,133 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:47:16,142 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:16,145 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:16,147 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:16,150 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:16,153 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:16,155 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:16,157 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:16,160 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:16,163 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:16,165 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:16,167 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:16,179 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:16,179 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:47:16,184 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:47:16,184 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:47:16,189 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:16,189 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:47:16,199 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:16,199 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:47:16,199 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:16,215 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:16,220 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:47:16,227 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:47:16,227 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:16,227 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:16,227 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:16,228 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:16,228 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:16,228 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:47:16,229 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:16,229 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:47:16,229 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:16,230 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:47:16,230 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:47:16,231 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:16,231 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:47:16,231 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:16,231 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:16,231 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:16,231 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:47:16,232 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:47:16,232 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:47:16,232 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:47:16,232 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:47:16,232 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:47:16,235 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:47:16,235 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:47:16,235 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:47:16,235 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:47:16,235 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:47:16,236 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:47:16,236 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:16,236 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:47:16,236 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:16,236 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:16,237 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:16,237 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:47:16,237 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:47:16,237 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:47:16,237 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:47:16,242 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:47:16,242 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:16,243 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:16,243 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:16,245 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:16,245 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:16,245 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:16,246 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:16,260 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4819, Threshold=0.5181, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:47:16,260 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4819
2025-08-04 20:47:21,513 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:21,513 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:21,513 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:21,513 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:47:21,514 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:47:21,514 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:21,822 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:21,823 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:21,910 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:47:21,950 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:47:21,950 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:22,068 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:22,076 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:22,076 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:22,081 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:47:22,087 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:22,087 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:47:22,087 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:22,088 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:22,088 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:47:22,096 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:22,099 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:22,101 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:22,103 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:22,106 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:22,108 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:22,111 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:22,113 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:22,116 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:22,118 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:22,121 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:22,130 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:22,130 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:47:22,135 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:47:22,136 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:47:22,140 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:22,141 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:47:22,150 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:22,150 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:47:22,151 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:22,167 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:22,172 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:47:22,180 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:47:22,180 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:22,180 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:22,180 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:22,181 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:22,181 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:22,181 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:47:22,181 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:22,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:47:22,182 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:22,183 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:47:22,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:47:22,184 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:22,184 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:47:22,184 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:22,184 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:22,184 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:22,184 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:47:22,184 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:47:22,185 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:47:22,185 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:47:22,185 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:47:22,185 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:47:22,187 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:47:22,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:47:22,187 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:47:22,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:47:22,187 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:47:22,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:47:22,187 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:22,188 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:47:22,188 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:22,188 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:22,188 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:22,189 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:47:22,189 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:47:22,189 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:47:22,189 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:47:22,193 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:47:22,193 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:22,195 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:22,195 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:22,196 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 112/400.
2025-08-04 20:47:22,298 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:22,298 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:22,299 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1766 anomalous samples to GAN training data (target: 1766).
2025-08-04 20:47:22,300 - ClientAppLogger [Client 1] - INFO - [Client] Round 112: Training GAN with 7655 samples (5889 normal, 1766 anomalous).
2025-08-04 20:47:22,300 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:47:27,615 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0844, Avg D Loss: 0.7928
2025-08-04 20:47:27,615 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0844, Avg D Loss: 0.7928
2025-08-04 20:47:27,615 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:47:27,627 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4506, Threshold=0.4713, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:47:27,628 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:47:27,628 - ClientAppLogger [Client 1] - INFO - Fit completed for round 112. Duration: 5.43s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 112, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0844001302712885, 'd_loss': 0.7928017989846323, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 5.431401968002319, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 7655}
2025-08-04 20:47:27,628 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:47:32,889 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:32,890 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:32,890 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:32,890 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:47:32,890 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:47:32,890 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:33,283 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:33,283 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:33,375 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:47:33,414 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:47:33,414 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:33,539 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:33,545 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:33,545 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:33,551 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:47:33,557 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:33,558 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:47:33,558 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:33,558 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:33,559 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:47:33,567 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:33,571 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:33,573 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:33,575 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:33,578 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:33,580 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:33,583 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:33,586 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:33,589 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:33,591 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:33,594 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:33,605 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:33,605 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:47:33,610 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:47:33,611 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:47:33,620 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:33,620 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:47:33,635 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:33,636 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:47:33,636 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:33,654 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:33,660 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:47:33,667 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:47:33,667 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:33,667 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:33,667 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:33,668 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:33,668 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:33,668 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:47:33,668 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:33,669 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:47:33,669 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:33,670 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:47:33,670 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:47:33,671 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:33,671 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:47:33,671 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:33,671 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:33,671 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:33,672 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:47:33,672 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:47:33,672 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:47:33,672 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:47:33,672 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:47:33,672 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:47:33,675 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:47:33,675 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:47:33,675 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:47:33,675 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:47:33,676 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:47:33,676 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:47:33,676 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:33,676 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:47:33,676 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:33,677 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:33,677 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:33,677 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:47:33,677 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:47:33,677 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:47:33,677 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:47:33,681 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:47:33,681 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:33,683 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:33,683 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:33,684 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:33,684 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:33,684 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:33,686 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:33,698 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4508, Threshold=0.4718, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:47:33,699 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4508
2025-08-04 20:47:44,960 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:44,960 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:44,960 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:44,960 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:47:44,960 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:47:44,961 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:45,212 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:45,212 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:45,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:47:45,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:47:45,346 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:45,472 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:45,480 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:45,480 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:45,486 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:47:45,493 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:45,494 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:47:45,494 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:45,494 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:45,495 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:47:45,504 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:45,507 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:45,510 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:45,512 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:45,514 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:45,517 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:45,519 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:45,522 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:45,524 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:45,526 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:45,529 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:45,539 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:45,539 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:47:45,543 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:47:45,544 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:47:45,549 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:45,549 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:47:45,559 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:45,559 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:47:45,559 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:45,576 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:45,581 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:47:45,592 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:47:45,592 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:45,592 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:45,592 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:45,593 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:45,593 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:45,593 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:47:45,593 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:45,593 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:47:45,593 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:45,595 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:47:45,595 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:47:45,596 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:45,596 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:47:45,596 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:45,596 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:45,596 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:45,596 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:47:45,596 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:47:45,597 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:47:45,597 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:47:45,597 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:47:45,597 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:47:45,603 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:47:45,603 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:47:45,603 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:47:45,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:47:45,604 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:47:45,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:47:45,604 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:45,604 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:47:45,605 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:45,605 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:45,605 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:45,606 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:47:45,606 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:47:45,606 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:47:45,606 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:47:45,611 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:47:45,612 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:45,613 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:45,613 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:45,615 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:45,615 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:45,615 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:45,616 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:45,631 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4944, Threshold=0.5412, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:47:45,632 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4944
2025-08-04 20:47:50,896 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:50,896 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:50,897 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:50,897 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:47:50,897 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:47:50,897 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:51,142 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:51,142 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:51,233 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:47:51,275 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:47:51,276 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:51,404 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:51,410 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:51,411 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:51,417 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:47:51,425 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:51,425 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:47:51,426 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:51,426 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:51,426 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:47:51,435 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:51,438 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:51,440 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:51,442 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:51,445 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:51,447 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:51,450 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:51,452 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:51,455 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:51,457 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:51,459 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:51,469 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:51,469 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:47:51,474 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:47:51,474 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:47:51,480 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:51,481 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:47:51,494 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:51,494 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:47:51,494 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:51,512 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:51,517 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:47:51,526 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:47:51,526 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:51,526 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:51,526 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:51,527 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:51,527 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:51,527 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:47:51,527 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:51,527 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:47:51,528 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:51,529 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:47:51,529 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:47:51,530 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:51,530 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:47:51,530 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:51,530 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:51,531 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:51,531 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:47:51,531 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:47:51,531 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:47:51,531 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:47:51,531 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:47:51,532 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:47:51,536 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:47:51,536 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:47:51,536 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:47:51,536 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:47:51,536 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:47:51,537 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:47:51,537 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:51,537 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:47:51,537 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:51,537 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:51,538 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:51,538 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:47:51,538 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:47:51,538 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:47:51,538 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:47:51,542 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:47:51,542 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:51,543 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:51,543 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:51,545 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 114/400.
2025-08-04 20:47:51,646 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:51,646 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:51,648 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1802 anomalous samples to GAN training data (target: 1802).
2025-08-04 20:47:51,648 - ClientAppLogger [Client 1] - INFO - [Client] Round 114: Training GAN with 7810 samples (6008 normal, 1802 anomalous).
2025-08-04 20:47:51,649 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:47:57,232 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0844, Avg D Loss: 0.7906
2025-08-04 20:47:57,232 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0844, Avg D Loss: 0.7906
2025-08-04 20:47:57,232 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:47:57,243 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5223, Threshold=0.5685, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:47:57,244 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:47:57,244 - ClientAppLogger [Client 1] - INFO - Fit completed for round 114. Duration: 5.70s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 114, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.084419260189872, 'd_loss': 0.790570730282311, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 5.699079751968384, 'cpu_percent_fit': 12.49375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 7810}
2025-08-04 20:47:57,244 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:48:02,512 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:02,512 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:02,512 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:02,512 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:48:02,513 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:48:02,513 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:02,837 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:02,837 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:02,932 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:48:02,972 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:48:02,972 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:03,088 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:03,095 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:03,095 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:03,100 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:48:03,106 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:03,106 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:48:03,107 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:03,107 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:03,107 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:48:03,115 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:03,118 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:03,120 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:03,122 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:03,125 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:03,127 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:03,130 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:03,133 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:03,136 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:03,138 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:03,140 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:03,152 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:03,152 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:48:03,157 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:48:03,157 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:48:03,162 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:03,162 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:48:03,170 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:03,171 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:48:03,171 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:03,186 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:03,191 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:48:03,200 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:48:03,200 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:03,200 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:03,200 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:03,201 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:03,201 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:03,201 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:48:03,201 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:03,201 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:48:03,202 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:03,203 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:48:03,203 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:48:03,203 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:03,204 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:48:03,204 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:03,204 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:03,204 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:03,204 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:48:03,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:48:03,205 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:48:03,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:48:03,205 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:48:03,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:48:03,208 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:48:03,208 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:48:03,208 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:48:03,208 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:48:03,208 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:48:03,208 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:48:03,209 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:03,209 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:48:03,209 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:03,209 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:03,209 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:03,210 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:48:03,210 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:48:03,210 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:48:03,210 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:48:03,214 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:48:03,214 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:03,215 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:03,216 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:03,217 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:03,217 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:03,217 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:03,218 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:03,230 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5277, Threshold=0.5812, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:48:03,230 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5277
2025-08-04 20:48:14,511 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:14,511 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:14,511 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:14,511 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:48:14,512 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:48:14,512 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:14,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:14,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:14,910 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:48:14,951 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:48:14,951 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:15,065 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:15,071 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:15,072 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:15,078 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:48:15,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:15,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:48:15,085 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:15,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:15,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:48:15,095 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:15,098 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:15,100 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:15,102 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:15,105 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:15,108 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:15,110 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:15,113 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:15,116 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:15,118 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:15,120 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:15,131 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:15,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:48:15,139 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:48:15,139 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:48:15,143 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:15,144 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:48:15,152 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:15,153 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:48:15,153 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:15,169 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:15,174 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:48:15,180 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:48:15,180 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:15,181 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:15,181 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:15,181 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:15,181 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:15,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:48:15,182 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:15,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:48:15,182 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:15,184 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:48:15,184 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:48:15,185 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:15,185 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:48:15,185 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:15,185 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:15,185 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:15,185 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:48:15,186 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:48:15,186 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:48:15,186 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:48:15,186 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:48:15,186 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:48:15,189 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:48:15,190 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:48:15,190 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:48:15,190 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:48:15,190 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:48:15,191 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:48:15,191 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:15,191 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:48:15,191 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:15,191 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:15,192 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:15,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:48:15,192 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:48:15,192 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:48:15,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:48:15,196 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:48:15,196 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:15,197 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:15,197 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:15,199 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:15,199 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:15,199 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:15,200 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:15,213 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5617, Threshold=0.6181, Accuracy=0.7170, F1=0.8053, Precision=0.9760, Recall=0.6854
2025-08-04 20:48:15,213 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7170, F1: 0.8053, Prec: 0.9760, Rec: 0.6854, Avg Anomaly Score: 0.5617
2025-08-04 20:48:26,498 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:26,498 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:26,498 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:26,498 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:48:26,498 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:48:26,498 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:26,786 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:26,786 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:26,869 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:48:26,911 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:48:26,911 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:27,024 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:27,029 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:27,029 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:27,034 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:48:27,040 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:27,040 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:48:27,041 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:27,041 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:27,041 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:48:27,049 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:27,052 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:27,054 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:27,056 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:27,059 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:27,061 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:27,064 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:27,066 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:27,069 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:27,070 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:27,073 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:27,086 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:27,086 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:48:27,091 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:48:27,092 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:48:27,097 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:27,097 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:48:27,110 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:27,111 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:48:27,111 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:27,125 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:27,130 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:48:27,135 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:48:27,135 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:27,135 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:27,135 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:27,136 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:27,136 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:27,137 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:48:27,137 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:27,137 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:48:27,137 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:27,138 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:48:27,138 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:48:27,139 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:27,139 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:48:27,139 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:27,139 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:27,139 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:27,139 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:48:27,140 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:48:27,140 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:48:27,140 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:48:27,140 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:48:27,140 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:48:27,143 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:48:27,143 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:48:27,143 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:48:27,144 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:48:27,144 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:48:27,144 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:48:27,144 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:27,144 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:48:27,145 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:27,145 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:27,145 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:27,145 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:48:27,145 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:48:27,146 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:48:27,146 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:48:27,149 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:48:27,149 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:27,151 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:27,151 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:27,152 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:27,152 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:27,152 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:27,153 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:27,165 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4691, Threshold=0.5119, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:48:27,166 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4691
2025-08-04 20:48:41,460 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:41,460 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:41,460 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:41,460 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:48:41,460 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:48:41,460 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:41,759 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:41,759 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:41,848 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:48:41,889 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:48:41,889 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:42,016 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:42,024 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:42,024 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:42,031 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:48:42,042 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:42,042 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:48:42,042 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:42,043 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:42,043 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:48:42,052 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:42,055 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:42,057 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:42,059 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:42,062 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:42,064 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:42,066 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:42,068 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:42,071 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:42,073 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:42,075 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:42,085 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:42,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:48:42,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:48:42,090 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:48:42,094 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:42,095 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:48:42,105 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:42,105 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:48:42,105 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:42,122 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:42,127 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:48:42,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:48:42,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:42,134 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:42,134 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:42,135 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:42,135 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:42,135 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:48:42,135 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:42,136 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:48:42,136 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:42,137 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:48:42,137 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:48:42,138 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:42,138 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:48:42,138 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:42,138 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:42,138 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:42,138 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:48:42,138 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:48:42,139 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:48:42,139 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:48:42,139 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:48:42,139 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:48:42,142 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:48:42,142 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:48:42,142 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:48:42,142 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:48:42,143 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:48:42,143 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:48:42,143 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:42,143 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:48:42,143 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:42,144 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:42,144 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:42,144 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:48:42,144 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:48:42,144 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:48:42,145 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:48:42,148 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:48:42,148 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:42,149 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:42,150 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:42,151 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:42,151 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:42,152 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:42,152 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:42,166 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4905, Threshold=0.5281, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:48:42,167 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4905
2025-08-04 20:48:53,458 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:53,458 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:53,458 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:53,458 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:48:53,458 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:48:53,459 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:53,782 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:53,782 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:53,872 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:48:53,914 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:48:53,915 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:54,032 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:54,038 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:54,039 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:54,044 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:48:54,050 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:54,050 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:48:54,050 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:54,051 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:54,051 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:48:54,059 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:54,062 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:54,064 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:54,066 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:54,069 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:54,071 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:54,074 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:54,076 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:54,079 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:54,081 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:54,083 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:54,095 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:54,095 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:48:54,100 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:48:54,100 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:48:54,108 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:54,108 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:48:54,123 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:54,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:48:54,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:54,141 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:54,146 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:48:54,158 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:48:54,158 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:54,158 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:54,158 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:54,159 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:54,159 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:54,159 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:48:54,159 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:54,160 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:48:54,160 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:54,161 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:48:54,161 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:48:54,162 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:54,162 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:48:54,162 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:54,162 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:54,162 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:54,162 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:48:54,162 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:48:54,163 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:48:54,163 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:48:54,163 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:48:54,163 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:48:54,167 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:48:54,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:48:54,168 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:48:54,168 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:48:54,168 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:48:54,168 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:48:54,168 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:54,168 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:48:54,169 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:54,169 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:54,169 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:54,169 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:48:54,169 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:48:54,170 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:48:54,170 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:48:54,173 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:48:54,173 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:54,175 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:54,175 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:54,177 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:54,177 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:54,177 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:54,178 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:54,190 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5202, Threshold=0.5711, Accuracy=0.7266, F1=0.8119, Precision=0.9840, Recall=0.6910
2025-08-04 20:48:54,190 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7266, F1: 0.8119, Prec: 0.9840, Rec: 0.6910, Avg Anomaly Score: 0.5202
2025-08-04 20:49:05,472 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:05,472 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:05,473 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:05,473 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:49:05,474 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:49:05,474 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:05,763 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:05,763 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:05,854 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:49:05,894 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:49:05,894 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:06,009 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:06,018 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:06,018 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:06,025 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:49:06,035 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:06,035 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:49:06,036 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:06,036 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:06,036 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:49:06,047 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:06,050 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:06,053 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:06,055 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:06,057 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:06,060 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:06,062 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:06,065 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:06,068 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:06,070 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:06,073 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:06,083 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:06,083 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:49:06,088 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:49:06,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:49:06,094 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:06,094 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:49:06,104 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:06,104 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:49:06,105 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:06,120 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:06,125 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:49:06,130 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:49:06,130 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:06,130 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:06,131 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:06,131 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:06,131 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:06,131 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:49:06,132 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:06,132 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:49:06,132 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:06,133 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:49:06,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:49:06,134 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:06,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:49:06,134 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:06,135 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:06,135 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:06,135 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:49:06,135 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:49:06,135 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:49:06,135 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:49:06,135 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:49:06,136 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:49:06,139 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:49:06,139 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:49:06,140 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:49:06,140 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:49:06,140 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:49:06,140 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:49:06,140 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:06,140 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:49:06,141 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:06,141 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:06,141 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:06,142 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:49:06,142 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:49:06,142 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:49:06,142 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:49:06,146 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:49:06,146 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:06,148 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:06,148 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:06,149 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:06,149 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:06,149 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:06,150 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:06,162 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5004, Threshold=0.5439, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:49:06,162 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5004
2025-08-04 20:49:11,427 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:11,428 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:11,428 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:11,428 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:49:11,428 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:49:11,428 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:11,729 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:11,729 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:11,813 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:49:11,856 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:49:11,857 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:11,975 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:11,982 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:11,982 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:11,988 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:49:11,994 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:11,994 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:49:11,994 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:11,995 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:11,995 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:49:12,004 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:12,006 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:12,009 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:12,011 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:12,014 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:12,016 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:12,018 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:12,021 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:12,024 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:12,026 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:12,028 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:12,038 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:12,038 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:49:12,043 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:49:12,043 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:49:12,049 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:12,049 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:49:12,061 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:12,062 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:49:12,062 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:12,080 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:12,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:49:12,098 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:49:12,098 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:12,098 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:12,098 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:12,099 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:12,099 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:12,099 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:49:12,099 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:12,099 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:49:12,100 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:12,101 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:49:12,101 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:49:12,102 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:12,102 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:49:12,102 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:12,102 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:12,102 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:12,102 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:49:12,103 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:49:12,103 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:49:12,103 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:49:12,103 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:49:12,103 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:49:12,106 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:49:12,106 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:49:12,106 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:49:12,106 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:49:12,106 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:49:12,107 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:49:12,107 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:12,107 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:49:12,108 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:12,108 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:12,108 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:12,108 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:49:12,108 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:49:12,108 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:49:12,109 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:49:12,114 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:49:12,114 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:12,115 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:12,116 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:12,117 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 120/400.
2025-08-04 20:49:12,218 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:12,219 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:12,220 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 1895 anomalous samples to GAN training data (target: 1895).
2025-08-04 20:49:12,221 - ClientAppLogger [Client 1] - INFO - [Client] Round 120: Training GAN with 8212 samples (6317 normal, 1895 anomalous).
2025-08-04 20:49:12,221 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:18,090 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.7899
2025-08-04 20:49:18,090 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.7899
2025-08-04 20:49:18,090 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:18,102 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5102, Threshold=0.5451, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:49:18,102 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:49:18,102 - ClientAppLogger [Client 1] - INFO - Fit completed for round 120. Duration: 5.98s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 120, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.084081309723146, 'd_loss': 0.7899463949584403, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 5.984825611114502, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 8212}
2025-08-04 20:49:18,102 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:49:23,367 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:23,367 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:23,367 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:23,367 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:49:23,367 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:49:23,367 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:23,683 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:23,684 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:23,771 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:49:23,814 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:49:23,814 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:23,932 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:23,939 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:23,939 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:23,944 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:49:23,949 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:23,949 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:49:23,950 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:23,950 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:23,950 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:49:23,960 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:23,963 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:23,965 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:23,967 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:23,970 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:23,972 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:23,974 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:23,977 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:23,980 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:23,981 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:23,984 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:23,993 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:23,993 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:49:23,998 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:49:23,998 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:49:24,003 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:24,003 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:49:24,010 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:24,011 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:49:24,011 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:24,025 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:24,029 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:49:24,034 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:49:24,034 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:24,035 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:24,035 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:24,035 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:24,035 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:24,035 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:49:24,036 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:24,036 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:49:24,036 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:24,037 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:49:24,037 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:49:24,038 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:24,038 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:49:24,038 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:24,038 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:24,038 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:24,039 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:49:24,039 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:49:24,039 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:49:24,039 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:49:24,039 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:49:24,039 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:49:24,041 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:49:24,041 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:49:24,042 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:49:24,042 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:49:24,042 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:49:24,042 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:49:24,042 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:24,042 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:49:24,043 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:24,043 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:24,043 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:24,043 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:49:24,043 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:49:24,044 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:49:24,044 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:49:24,047 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:49:24,047 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:24,048 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:24,048 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:24,050 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:24,050 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:24,050 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:24,050 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:24,062 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5192, Threshold=0.5637, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:49:24,062 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5192
2025-08-04 20:49:35,320 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:35,320 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:35,320 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:35,320 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:49:35,320 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:49:35,321 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:35,628 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:35,628 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:35,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:49:35,766 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:49:35,767 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:35,875 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:35,882 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:35,883 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:35,889 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:49:35,895 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:35,895 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:49:35,896 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:35,896 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:35,896 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:49:35,904 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:35,907 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:35,909 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:35,911 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:35,914 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:35,916 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:35,919 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:35,921 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:35,924 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:35,926 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:35,928 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:35,938 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:35,938 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:49:35,943 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:49:35,943 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:49:35,948 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:35,948 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:49:35,956 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:35,956 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:49:35,957 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:35,972 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:35,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:49:35,981 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:49:35,982 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:35,982 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:35,982 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:35,982 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:35,982 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:35,983 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:49:35,983 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:35,983 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:49:35,983 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:35,985 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:49:35,985 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:49:35,985 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:35,985 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:49:35,986 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:35,986 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:35,986 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:35,986 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:49:35,986 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:49:35,986 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:49:35,986 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:49:35,986 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:49:35,986 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:49:35,988 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:49:35,989 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:49:35,989 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:49:35,989 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:49:35,989 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:49:35,989 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:49:35,989 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:35,989 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:49:35,990 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:35,990 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:35,990 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:35,990 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:49:35,991 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:49:35,991 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:49:35,991 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:49:35,994 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:49:35,995 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:35,996 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:35,996 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:35,997 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:35,997 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:35,997 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:35,998 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:36,010 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4591, Threshold=0.4817, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:49:36,010 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4591
2025-08-04 20:49:47,273 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:47,273 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:47,273 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:47,274 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:49:47,274 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:49:47,274 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:47,546 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:47,546 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:47,638 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:49:47,677 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:49:47,677 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:47,788 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:47,793 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:47,794 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:47,799 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:49:47,804 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:47,804 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:49:47,804 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:47,805 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:47,805 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:49:47,813 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:47,816 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:47,818 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:47,820 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:47,823 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:47,825 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:47,827 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:47,830 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:47,833 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:47,834 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:47,837 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:47,845 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:47,845 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:49:47,850 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:49:47,850 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:49:47,854 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:47,854 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:49:47,862 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:47,863 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:49:47,863 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:47,877 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:47,881 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:49:47,887 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:49:47,887 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:47,887 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:47,887 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:47,887 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:47,888 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:47,888 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:49:47,888 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:47,888 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:49:47,888 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:47,890 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:49:47,890 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:49:47,890 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:47,890 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:49:47,891 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:47,891 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:47,891 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:47,891 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:49:47,891 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:49:47,891 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:49:47,891 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:49:47,892 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:49:47,892 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:49:47,894 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:49:47,894 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:49:47,895 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:49:47,895 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:49:47,895 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:49:47,895 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:49:47,895 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:47,895 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:49:47,896 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:47,896 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:47,896 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:47,896 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:49:47,897 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:49:47,897 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:49:47,897 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:49:47,900 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:49:47,900 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:47,902 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:47,902 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:47,904 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:47,904 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:47,904 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:47,905 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:47,916 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5300, Threshold=0.5934, Accuracy=0.7170, F1=0.8053, Precision=0.9760, Recall=0.6854
2025-08-04 20:49:47,916 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7170, F1: 0.8053, Prec: 0.9760, Rec: 0.6854, Avg Anomaly Score: 0.5300
2025-08-04 20:50:02,176 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:02,176 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:02,177 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:02,177 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:50:02,177 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:50:02,177 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:02,448 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:02,448 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:02,532 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:50:02,570 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:50:02,570 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:02,688 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:02,694 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:02,694 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:02,699 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:50:02,705 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:02,705 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:50:02,705 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:02,705 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:02,706 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:50:02,715 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:02,718 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:02,720 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:02,722 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:02,725 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:02,727 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:02,729 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:02,732 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:02,735 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:02,737 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:02,739 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:02,748 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:02,748 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:50:02,753 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:50:02,754 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:50:02,759 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:02,759 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:50:02,769 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:02,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:50:02,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:02,784 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:02,789 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:50:02,794 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:50:02,794 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:02,794 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:02,794 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:02,795 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:02,795 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:02,795 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:50:02,796 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:02,796 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:50:02,796 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:02,797 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:50:02,798 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:50:02,798 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:02,798 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:50:02,798 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:02,798 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:02,799 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:02,799 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:50:02,799 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:50:02,799 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:50:02,799 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:50:02,799 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:50:02,799 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:50:02,802 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:50:02,802 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:50:02,802 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:50:02,803 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:50:02,803 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:50:02,803 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:50:02,803 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:02,803 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:50:02,804 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:02,804 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:02,804 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:02,804 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:50:02,804 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:50:02,805 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:50:02,805 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:50:02,809 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:50:02,809 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:02,811 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:02,811 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:02,813 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:02,813 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:02,813 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:02,813 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:02,825 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5477, Threshold=0.6103, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:50:02,825 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5477
2025-08-04 20:50:20,115 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:20,116 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:20,116 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:20,116 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:50:20,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:50:20,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:20,484 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:20,485 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:20,581 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:50:20,623 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:50:20,623 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:20,760 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:20,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:20,769 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:20,776 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:50:20,783 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:20,783 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:50:20,784 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:20,784 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:20,784 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:50:20,793 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:20,795 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:20,798 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:20,800 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:20,803 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:20,806 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:20,809 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:20,813 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:20,816 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:20,818 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:20,821 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:20,833 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:20,833 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:50:20,840 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:50:20,843 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:50:20,848 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:20,848 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:50:20,856 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:20,857 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:50:20,857 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:20,872 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:20,876 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:50:20,882 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:50:20,882 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:20,882 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:20,882 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:20,882 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:20,882 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:20,883 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:50:20,883 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:20,883 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:50:20,883 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:20,885 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:50:20,887 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:50:20,888 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:20,888 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:50:20,888 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:20,888 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:20,888 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:20,888 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:50:20,888 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:50:20,889 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:50:20,889 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:50:20,889 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:50:20,889 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:50:20,891 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:50:20,891 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:50:20,892 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:50:20,892 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:50:20,892 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:50:20,892 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:50:20,892 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:20,893 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:50:20,893 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:20,893 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:20,894 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:20,894 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:50:20,894 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:50:20,894 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:50:20,894 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:50:20,897 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:50:20,898 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:20,899 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:20,899 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:20,901 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:20,901 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:20,901 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:20,901 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:20,913 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5261, Threshold=0.5891, Accuracy=0.7170, F1=0.8053, Precision=0.9760, Recall=0.6854
2025-08-04 20:50:20,913 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7170, F1: 0.8053, Prec: 0.9760, Rec: 0.6854, Avg Anomaly Score: 0.5261
2025-08-04 20:50:35,176 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:35,176 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:35,176 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:35,176 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:50:35,176 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:50:35,176 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:35,465 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:35,466 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:35,553 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:50:35,600 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:50:35,600 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:35,723 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:35,732 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:35,732 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:35,742 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:50:35,755 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:35,756 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:50:35,756 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:35,757 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:35,757 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:50:35,767 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:35,770 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:35,772 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:35,774 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:35,777 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:35,779 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:35,781 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:35,784 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:35,787 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:35,789 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:35,791 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:35,802 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:35,803 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:50:35,808 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:50:35,808 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:50:35,815 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:35,815 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:50:35,829 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:35,829 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:50:35,830 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:35,856 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:35,863 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:50:35,873 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:50:35,874 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:35,875 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:35,875 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:35,875 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:35,876 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:35,876 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:50:35,876 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:35,877 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:50:35,877 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:35,879 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:50:35,879 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:50:35,879 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:35,879 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:50:35,880 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:35,880 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:35,880 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:35,880 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:50:35,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:50:35,880 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:50:35,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:50:35,881 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:50:35,881 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:50:35,886 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:50:35,886 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:50:35,886 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:50:35,887 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:50:35,887 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:50:35,887 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:50:35,887 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:35,887 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:50:35,888 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:35,889 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:35,889 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:35,889 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:50:35,890 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:50:35,890 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:50:35,890 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:50:35,894 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:50:35,895 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:35,896 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:35,899 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:35,901 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:35,901 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:35,901 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:35,902 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:35,918 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5329, Threshold=0.5877, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:50:35,918 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5329
2025-08-04 20:50:50,198 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:50,198 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:50,198 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:50,198 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:50:50,198 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:50:50,198 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:50,599 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:50,599 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:50,690 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:50:50,748 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:50:50,748 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:50,906 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:50,919 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:50,919 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:50,926 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:50:50,934 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:50,935 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:50:50,935 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:50,935 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:50,936 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:50:50,947 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:50,950 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:50,953 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:50,955 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:50,958 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:50,961 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:50,964 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:50,968 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:50,972 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:50,975 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:50,978 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:50,993 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:50,993 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:50:50,999 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:50:51,000 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:50:51,006 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:51,006 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:50:51,018 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:51,018 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:50:51,019 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:51,044 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:51,050 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:50:51,055 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:50:51,055 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:51,055 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:51,056 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:51,056 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:51,056 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:51,056 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:50:51,057 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:51,057 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:50:51,057 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:51,058 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:50:51,059 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:50:51,059 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:51,059 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:50:51,059 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:51,060 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:51,060 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:51,060 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:50:51,060 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:50:51,060 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:50:51,061 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:50:51,061 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:50:51,061 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:50:51,064 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:50:51,064 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:50:51,065 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:50:51,065 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:50:51,065 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:50:51,066 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:50:51,066 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:51,066 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:50:51,066 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:51,067 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:51,067 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:51,067 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:50:51,067 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:50:51,067 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:50:51,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:50:51,072 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:50:51,072 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:51,073 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:51,073 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:51,075 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:51,075 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:51,075 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:51,076 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:51,088 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5238, Threshold=0.5857, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:50:51,088 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5238
2025-08-04 20:51:08,378 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:08,378 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:51:08,378 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:51:08,378 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:51:08,378 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:51:08,378 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:08,766 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:08,766 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:08,856 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:51:08,905 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:51:08,905 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:09,047 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:09,056 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:09,056 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:09,064 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:51:09,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:09,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:51:09,075 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:09,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:09,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:51:09,086 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:09,089 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:09,092 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:09,094 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:09,098 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:09,101 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:09,104 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:09,107 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:09,111 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:09,114 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:09,118 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:09,130 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:09,130 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:51:09,135 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:51:09,135 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:51:09,140 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:09,140 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:51:09,149 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:09,149 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:51:09,150 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:09,166 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:09,170 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:51:09,178 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:51:09,178 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:09,178 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:09,178 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:09,179 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:09,179 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:09,179 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:51:09,179 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:09,179 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:51:09,179 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:09,181 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:51:09,181 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:51:09,181 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:09,181 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:51:09,181 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:09,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:09,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:09,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:51:09,182 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:51:09,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:51:09,182 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:51:09,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:51:09,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:51:09,185 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:51:09,186 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:51:09,186 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:51:09,186 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:51:09,186 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:51:09,186 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:51:09,186 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:09,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:51:09,187 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:09,187 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:09,188 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:09,188 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:51:09,188 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:51:09,188 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:51:09,188 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:51:09,192 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:51:09,192 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:09,193 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:09,194 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:51:09,195 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:09,195 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:09,195 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:09,196 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:09,209 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5260, Threshold=0.5887, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:51:09,209 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5260
2025-08-04 20:51:23,488 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:23,488 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:51:23,488 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:51:23,488 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:51:23,488 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:51:23,488 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:23,855 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:23,855 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:23,952 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:51:24,000 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:51:24,001 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:24,139 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:24,146 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:24,146 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:24,155 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:51:24,164 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:24,164 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:51:24,165 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:24,165 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:24,165 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:51:24,174 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:24,177 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:24,180 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:24,182 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:24,185 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:24,187 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:24,190 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:24,192 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:24,195 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:24,197 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:24,200 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:24,211 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:24,211 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:51:24,216 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:51:24,216 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:51:24,221 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:24,221 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:51:24,231 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:24,231 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:51:24,231 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:24,247 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:24,252 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:51:24,258 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:51:24,258 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:24,258 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:24,258 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:24,259 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:24,259 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:24,259 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:51:24,259 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:24,260 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:51:24,260 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:24,261 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:51:24,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:51:24,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:24,262 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:51:24,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:24,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:24,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:24,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:51:24,262 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:51:24,263 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:51:24,263 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:51:24,263 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:51:24,263 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:51:24,265 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:51:24,266 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:51:24,266 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:51:24,266 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:51:24,266 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:51:24,266 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:51:24,266 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:24,267 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:51:24,267 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:24,267 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:24,267 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:24,268 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:51:24,268 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:51:24,268 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:51:24,268 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:51:24,272 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:51:24,272 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:24,276 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:24,276 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:51:24,278 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:24,278 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:24,278 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:24,279 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:24,291 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5205, Threshold=0.5751, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:51:24,292 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5205
2025-08-04 20:51:41,579 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:41,580 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:51:41,580 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:51:41,580 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:51:41,580 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:51:41,580 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:41,899 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:41,900 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:41,987 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:51:42,029 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:51:42,029 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:42,147 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:42,154 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:42,154 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:42,159 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:51:42,164 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:42,164 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:51:42,165 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:42,165 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:42,165 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:51:42,173 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:42,176 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:42,178 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:42,181 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:42,184 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:42,187 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:42,189 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:42,192 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:42,195 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:42,196 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:42,199 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:42,208 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:42,208 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:51:42,213 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:51:42,213 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:51:42,218 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:42,218 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:51:42,226 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:42,226 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:51:42,226 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:42,241 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:42,246 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:51:42,252 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:51:42,252 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:42,252 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:42,252 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:42,253 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:42,253 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:42,253 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:51:42,253 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:42,253 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:51:42,253 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:42,255 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:51:42,255 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:51:42,255 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:42,255 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:51:42,255 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:42,256 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:42,256 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:42,256 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:51:42,256 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:51:42,256 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:51:42,256 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:51:42,256 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:51:42,257 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:51:42,258 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:51:42,258 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:51:42,258 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:51:42,258 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:51:42,259 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:51:42,259 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:51:42,259 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:42,259 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:51:42,260 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:42,260 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:42,260 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:42,260 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:51:42,261 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:51:42,261 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:51:42,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:51:42,265 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:51:42,266 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:42,267 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:42,267 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:51:42,268 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:42,268 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:42,268 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:42,269 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:42,281 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5206, Threshold=0.5784, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:51:42,281 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5206
2025-08-04 20:51:56,565 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:56,565 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:51:56,565 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:51:56,565 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:51:56,566 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:51:56,566 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:56,900 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:56,900 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:56,984 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:51:57,032 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:51:57,032 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:57,151 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:57,157 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:57,157 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:57,162 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:51:57,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:57,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:51:57,168 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:57,168 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:57,168 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:51:57,176 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:57,179 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:57,181 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:57,184 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:57,186 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:57,189 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:57,192 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:57,194 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:57,197 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:57,199 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:57,201 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:57,210 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:57,210 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:51:57,215 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:51:57,215 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:51:57,219 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:57,219 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:51:57,228 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:57,228 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:51:57,228 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:57,243 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:57,247 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:51:57,253 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:51:57,253 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:57,253 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:57,253 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:57,253 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:57,254 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:57,254 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:51:57,254 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:57,254 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:51:57,254 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:57,256 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:51:57,256 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:51:57,256 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:57,256 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:51:57,256 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:57,257 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:57,257 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:57,257 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:51:57,257 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:51:57,257 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:51:57,257 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:51:57,258 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:51:57,258 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:51:57,260 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:51:57,260 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:51:57,260 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:51:57,260 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:51:57,261 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:51:57,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:51:57,261 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:57,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:51:57,261 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:57,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:57,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:57,262 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:51:57,262 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:51:57,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:51:57,262 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:51:57,265 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:51:57,266 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:57,267 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:57,267 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:51:57,269 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:57,269 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:57,269 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:57,270 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:57,281 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4921, Threshold=0.5295, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:51:57,281 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4921
2025-08-04 20:52:08,561 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:08,561 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:08,561 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:08,561 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:52:08,561 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:52:08,561 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:08,860 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:08,860 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:08,945 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:52:08,987 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:52:08,987 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:09,106 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:09,111 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:09,111 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:09,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:52:09,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:09,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:52:09,122 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:09,122 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:09,122 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:52:09,130 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:09,133 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:09,135 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:09,137 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:09,140 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:09,142 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:09,145 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:09,148 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:09,150 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:09,152 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:09,154 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:09,162 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:09,163 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:52:09,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:52:09,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:52:09,171 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:09,171 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:52:09,180 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:09,180 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:52:09,180 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:09,195 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:09,199 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:52:09,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:52:09,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:09,205 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:09,205 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:09,206 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:09,206 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:09,206 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:52:09,207 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:09,207 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:52:09,207 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:09,208 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:52:09,208 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:52:09,209 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:09,209 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:52:09,209 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:09,209 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:09,209 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:09,210 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:52:09,210 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:52:09,210 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:52:09,210 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:52:09,210 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:52:09,210 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:52:09,211 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:52:09,212 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:52:09,212 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:52:09,212 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:52:09,212 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:52:09,212 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:52:09,212 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:09,212 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:52:09,213 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:09,213 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:09,213 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:09,213 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:52:09,213 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:52:09,214 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:52:09,214 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:52:09,218 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:52:09,219 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:09,220 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:09,220 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:09,221 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:09,221 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:09,221 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:09,222 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:09,234 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5182, Threshold=0.5707, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:52:09,234 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5182
2025-08-04 20:52:20,508 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:20,508 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:20,509 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:20,509 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:52:20,509 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:52:20,509 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:20,840 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:20,840 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:20,928 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:52:20,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:52:20,970 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:21,090 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:21,095 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:21,096 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:21,100 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:52:21,105 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:21,105 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:52:21,106 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:21,106 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:21,106 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:52:21,114 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:21,117 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:21,119 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:21,122 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:21,124 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:21,127 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:21,129 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:21,132 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:21,135 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:21,137 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:21,139 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:21,148 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:21,148 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:52:21,153 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:52:21,153 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:52:21,158 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:21,158 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:52:21,166 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:21,166 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:52:21,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:21,181 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:21,186 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:52:21,191 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:52:21,191 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:21,191 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:21,191 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:21,192 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:21,192 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:21,192 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:52:21,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:21,193 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:52:21,193 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:21,194 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:52:21,194 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:52:21,195 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:21,195 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:52:21,195 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:21,195 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:21,195 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:21,195 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:52:21,196 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:52:21,196 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:52:21,196 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:52:21,196 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:52:21,196 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:52:21,198 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:52:21,198 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:52:21,199 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:52:21,199 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:52:21,199 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:52:21,199 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:52:21,199 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:21,199 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:52:21,200 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:21,200 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:21,200 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:21,200 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:52:21,200 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:52:21,201 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:52:21,201 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:52:21,204 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:52:21,205 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:21,206 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:21,206 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:21,207 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:21,207 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:21,207 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:21,208 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:21,219 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5383, Threshold=0.5941, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:52:21,219 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5383
2025-08-04 20:52:26,475 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:26,475 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:26,476 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:26,476 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:52:26,476 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:52:26,476 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:26,752 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:26,752 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:26,836 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:52:26,873 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:52:26,873 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:26,980 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:26,986 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:26,986 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:26,991 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:52:26,996 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:26,996 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:52:26,997 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:26,997 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:26,997 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:52:27,005 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:27,008 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:27,010 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:27,012 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:27,015 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:27,017 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:27,020 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:27,022 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:27,025 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:27,027 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:27,029 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:27,038 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:27,038 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:52:27,043 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:52:27,043 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:52:27,047 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:27,048 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:52:27,056 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:27,056 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:52:27,056 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:27,070 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:27,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:52:27,080 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:52:27,080 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:27,080 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:27,080 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:27,081 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:27,081 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:27,081 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:52:27,081 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:27,081 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:52:27,082 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:27,083 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:52:27,083 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:52:27,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:27,084 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:52:27,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:27,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:27,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:27,084 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:52:27,084 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:52:27,085 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:52:27,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:52:27,085 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:52:27,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:52:27,087 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:52:27,087 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:52:27,087 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:52:27,087 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:52:27,088 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:52:27,088 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:52:27,088 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:27,088 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:52:27,088 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:27,089 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:27,089 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:27,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:52:27,089 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:52:27,089 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:52:27,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:52:27,093 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:52:27,093 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:27,095 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:27,095 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:27,096 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 133/400.
2025-08-04 20:52:27,197 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:27,197 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:27,199 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2096 anomalous samples to GAN training data (target: 2096).
2025-08-04 20:52:27,201 - ClientAppLogger [Client 1] - INFO - [Client] Round 133: Training GAN with 9085 samples (6989 normal, 2096 anomalous).
2025-08-04 20:52:27,201 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:33,515 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0838, Avg D Loss: 0.7868
2025-08-04 20:52:33,516 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0838, Avg D Loss: 0.7868
2025-08-04 20:52:33,516 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:33,527 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5782, Threshold=0.6426, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:52:33,527 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:52:33,527 - ClientAppLogger [Client 1] - INFO - Fit completed for round 133. Duration: 6.43s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 133, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0838290137383857, 'd_loss': 0.7868224082966722, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 6.430926561355591, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 1.34765625, 'accumulated_train_samples_this_round': 9085}
2025-08-04 20:52:33,527 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:52:38,789 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:38,789 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:38,789 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:38,789 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:52:38,790 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:52:38,790 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:39,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:39,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:39,151 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:52:39,188 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:52:39,188 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:39,298 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:39,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:39,303 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:39,308 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:52:39,313 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:39,313 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:52:39,314 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:39,314 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:39,314 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:52:39,322 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:39,325 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:39,327 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:39,329 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:39,332 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:39,334 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:39,337 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:39,340 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:39,342 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:39,344 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:39,347 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:39,356 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:39,356 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:52:39,361 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:52:39,361 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:52:39,365 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:39,365 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:52:39,373 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:39,373 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:52:39,374 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:39,388 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:39,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:52:39,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:52:39,398 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:39,398 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:39,398 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:39,398 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:39,399 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:39,399 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:52:39,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:39,399 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:52:39,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:39,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:52:39,401 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:52:39,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:39,402 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:52:39,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:39,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:39,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:39,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:52:39,403 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:52:39,403 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:52:39,403 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:52:39,403 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:52:39,403 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:52:39,405 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:52:39,405 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:52:39,405 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:52:39,406 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:52:39,406 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:52:39,406 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:52:39,406 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:39,406 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:52:39,407 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:39,407 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:39,407 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:39,407 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:52:39,407 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:52:39,407 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:52:39,408 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:52:39,411 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:52:39,411 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:39,412 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:39,412 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:39,413 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:39,414 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:39,414 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:39,415 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:39,426 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5773, Threshold=0.6413, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:52:39,427 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5773
2025-08-04 20:52:50,695 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:50,695 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:50,695 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:50,695 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:52:50,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:52:50,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:50,976 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:50,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:51,058 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:52:51,101 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:52:51,101 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:51,222 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:51,228 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:51,228 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:51,234 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:52:51,239 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:51,239 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:52:51,240 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:51,240 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:51,240 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:52:51,248 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:51,251 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:51,253 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:51,255 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:51,258 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:51,260 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:51,263 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:51,265 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:51,268 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:51,270 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:51,272 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:51,281 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:51,281 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:52:51,286 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:52:51,286 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:52:51,291 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:51,291 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:52:51,300 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:51,300 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:52:51,300 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:51,316 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:51,322 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:52:51,337 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:52:51,337 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:51,337 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:51,337 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:51,338 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:51,338 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:51,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:52:51,338 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:51,338 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:52:51,339 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:51,340 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:52:51,340 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:52:51,341 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:51,341 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:52:51,341 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:51,341 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:51,341 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:51,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:52:51,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:52:51,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:52:51,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:52:51,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:52:51,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:52:51,346 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:52:51,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:52:51,346 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:52:51,347 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:52:51,347 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:52:51,347 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:52:51,347 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:51,347 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:52:51,348 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:51,348 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:51,348 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:51,349 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:52:51,349 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:52:51,349 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:52:51,349 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:52:51,354 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:52:51,354 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:51,355 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:51,356 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:51,357 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:51,357 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:51,357 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:51,358 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:51,371 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5146, Threshold=0.5589, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:52:51,371 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5146
2025-08-04 20:53:02,684 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:02,684 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:02,684 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:02,684 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:53:02,684 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:53:02,684 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:03,026 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:03,026 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:03,114 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:53:03,157 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:53:03,157 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:03,274 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:03,282 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:03,282 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:03,288 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:53:03,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:03,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:53:03,295 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:03,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:03,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:53:03,304 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:03,307 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:03,309 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:03,311 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:03,314 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:03,316 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:03,318 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:03,321 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:03,323 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:03,325 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:03,327 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:03,338 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:03,338 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:53:03,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:53:03,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:53:03,348 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:03,350 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:53:03,362 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:03,363 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:53:03,363 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:03,381 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:03,386 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:53:03,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:53:03,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:03,392 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:03,393 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:03,393 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:03,393 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:03,393 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:53:03,394 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:03,394 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:53:03,394 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:03,395 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:53:03,395 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:53:03,396 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:03,396 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:53:03,396 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:03,396 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:03,396 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:03,396 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:53:03,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:53:03,397 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:53:03,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:53:03,397 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:53:03,397 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:53:03,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:53:03,402 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:53:03,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:53:03,402 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:53:03,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:53:03,402 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:53:03,403 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:03,403 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:53:03,403 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:03,403 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:03,404 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:03,404 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:53:03,404 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:53:03,404 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:53:03,404 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:53:03,408 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:53:03,409 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:03,410 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:03,410 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:03,412 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:03,412 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:03,413 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:03,413 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:03,427 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5208, Threshold=0.5801, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:53:03,427 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5208
2025-08-04 20:53:14,744 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:14,745 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:14,745 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:14,745 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:53:14,745 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:53:14,745 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:15,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:15,076 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:15,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:53:15,213 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:53:15,213 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:15,379 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:15,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:15,387 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:15,395 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:53:15,404 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:15,404 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:53:15,405 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:15,405 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:15,405 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:53:15,416 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:15,419 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:15,421 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:15,424 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:15,427 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:15,429 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:15,432 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:15,435 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:15,437 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:15,440 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:15,442 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:15,453 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:15,454 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:53:15,459 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:53:15,459 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:53:15,467 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:15,467 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:53:15,482 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:15,483 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:53:15,483 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:15,502 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:15,508 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:53:15,516 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:53:15,516 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:15,516 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:15,516 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:15,517 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:15,517 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:15,517 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:53:15,517 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:15,518 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:53:15,518 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:15,520 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:53:15,520 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:53:15,520 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:15,520 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:53:15,521 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:15,521 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:15,521 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:15,521 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:53:15,521 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:53:15,521 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:53:15,521 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:53:15,522 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:53:15,522 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:53:15,527 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:53:15,530 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:53:15,530 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:53:15,530 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:53:15,530 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:53:15,530 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:53:15,531 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:15,531 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:53:15,531 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:15,531 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:15,532 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:15,532 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:53:15,532 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:53:15,532 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:53:15,532 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:53:15,539 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:53:15,540 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:15,541 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:15,542 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:15,543 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:15,543 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:15,543 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:15,544 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:15,558 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5511, Threshold=0.6066, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:53:15,558 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5511
2025-08-04 20:53:20,819 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:20,819 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:20,819 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:20,819 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:53:20,819 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:53:20,820 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:21,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:21,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:21,208 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:53:21,250 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:53:21,250 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:21,369 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:21,376 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:21,376 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:21,381 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:53:21,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:21,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:53:21,387 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:21,387 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:21,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:53:21,396 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:21,398 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:21,400 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:21,402 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:21,405 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:21,407 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:21,409 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:21,412 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:21,414 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:21,416 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:21,419 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:21,427 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:21,428 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:53:21,432 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:53:21,432 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:53:21,437 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:21,437 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:53:21,446 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:21,446 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:53:21,450 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:21,465 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:21,470 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:53:21,475 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:53:21,475 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:21,475 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:21,475 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:21,476 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:21,476 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:21,476 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:53:21,476 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:21,477 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:53:21,477 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:21,479 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:53:21,479 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:53:21,479 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:21,480 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:53:21,480 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:21,480 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:21,480 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:21,481 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:53:21,481 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:53:21,481 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:53:21,481 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:53:21,481 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:53:21,481 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:53:21,484 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:53:21,484 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:53:21,484 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:53:21,484 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:53:21,485 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:53:21,485 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:53:21,485 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:21,485 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:53:21,486 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:21,486 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:21,486 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:21,486 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:53:21,486 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:53:21,486 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:53:21,487 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:53:21,490 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:53:21,492 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:21,493 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:21,493 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:21,494 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 137/400.
2025-08-04 20:53:21,596 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:21,596 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:21,598 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2165 anomalous samples to GAN training data (target: 2165).
2025-08-04 20:53:21,599 - ClientAppLogger [Client 1] - INFO - [Client] Round 137: Training GAN with 9384 samples (7219 normal, 2165 anomalous).
2025-08-04 20:53:21,599 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:53:28,274 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7851
2025-08-04 20:53:28,274 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7851
2025-08-04 20:53:28,274 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:53:28,285 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5506, Threshold=0.6049, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:53:28,286 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:53:28,286 - ClientAppLogger [Client 1] - INFO - Fit completed for round 137. Duration: 6.79s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 137, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0838540313595497, 'd_loss': 0.7851195810497671, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 6.791354417800903, 'cpu_percent_fit': 12.50625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 9384}
2025-08-04 20:53:28,286 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:53:33,537 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:33,537 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:33,537 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:33,537 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:53:33,537 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:53:33,537 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:33,808 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:33,808 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:33,890 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:53:33,939 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:53:33,939 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:34,058 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:34,065 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:34,065 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:34,071 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:53:34,079 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:34,079 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:53:34,080 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:34,080 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:34,080 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:53:34,089 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:34,092 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:34,094 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:34,096 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:34,099 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:34,102 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:34,104 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:34,106 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:34,109 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:34,111 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:34,114 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:34,124 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:34,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:53:34,129 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:53:34,129 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:53:34,134 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:34,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:53:34,145 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:34,146 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:53:34,146 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:34,162 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:34,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:53:34,178 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:53:34,178 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:34,178 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:34,179 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:34,179 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:34,179 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:34,179 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:53:34,179 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:34,180 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:53:34,180 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:34,181 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:53:34,181 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:53:34,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:34,182 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:53:34,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:34,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:34,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:34,183 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:53:34,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:53:34,183 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:53:34,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:53:34,183 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:53:34,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:53:34,186 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:53:34,186 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:53:34,186 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:53:34,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:53:34,187 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:53:34,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:53:34,187 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:34,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:53:34,188 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:34,188 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:34,188 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:34,188 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:53:34,188 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:53:34,188 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:53:34,189 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:53:34,193 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:53:34,193 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:34,194 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:34,195 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:34,196 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:34,196 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:34,196 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:34,197 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:34,209 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5502, Threshold=0.6045, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:53:34,209 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5502
2025-08-04 20:53:42,464 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:42,464 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:42,465 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:42,465 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:53:42,465 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:53:42,465 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:42,731 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:42,731 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:42,816 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:53:42,854 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:53:42,854 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:42,961 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:42,966 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:42,966 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:42,971 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:53:42,976 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:42,976 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:53:42,976 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:42,976 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:42,976 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:53:42,984 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:42,987 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:42,989 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:42,991 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:42,994 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:42,996 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:42,999 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:43,002 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:43,004 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:43,006 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:43,009 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:43,017 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:43,017 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:53:43,022 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:53:43,022 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:53:43,026 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:43,027 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:53:43,035 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:43,035 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:53:43,035 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:43,049 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:43,054 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:53:43,059 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:53:43,059 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:43,059 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:43,059 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:43,059 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:43,060 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:43,060 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:53:43,060 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:43,061 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:53:43,061 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:43,062 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:53:43,062 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:53:43,062 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:43,063 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:53:43,063 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:43,063 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:43,063 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:43,063 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:53:43,063 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:53:43,063 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:53:43,064 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:53:43,064 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:53:43,064 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:53:43,066 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:53:43,066 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:53:43,066 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:53:43,067 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:53:43,067 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:53:43,067 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:53:43,067 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:43,067 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:53:43,068 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:43,068 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:43,068 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:43,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:53:43,068 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:53:43,068 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:53:43,069 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:53:43,072 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:53:43,072 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:43,073 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:43,073 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:43,074 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 138/400.
2025-08-04 20:53:43,175 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:43,175 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:43,177 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2181 anomalous samples to GAN training data (target: 2181).
2025-08-04 20:53:43,177 - ClientAppLogger [Client 1] - INFO - [Client] Round 138: Training GAN with 9452 samples (7271 normal, 2181 anomalous).
2025-08-04 20:53:43,178 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:53:49,808 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0838, Avg D Loss: 0.7840
2025-08-04 20:53:49,808 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0838, Avg D Loss: 0.7840
2025-08-04 20:53:49,808 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:53:49,819 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5411, Threshold=0.5963, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:53:49,820 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:53:49,820 - ClientAppLogger [Client 1] - INFO - Fit completed for round 138. Duration: 6.75s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 138, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083817529658165, 'd_loss': 0.7839586956164013, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 6.745611190795898, 'cpu_percent_fit': 12.49375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 9452}
2025-08-04 20:53:49,820 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:53:55,087 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:55,087 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:55,087 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:55,087 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:53:55,087 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:53:55,087 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:55,419 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:55,419 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:55,504 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:53:55,548 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:53:55,548 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:55,670 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:55,678 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:55,679 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:55,684 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:53:55,690 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:55,690 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:53:55,695 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:55,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:55,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:53:55,704 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:55,707 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:55,710 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:55,713 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:55,716 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:55,719 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:55,722 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:55,725 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:55,728 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:55,730 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:55,733 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:55,744 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:55,744 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:53:55,749 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:53:55,749 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:53:55,755 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:55,755 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:53:55,765 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:55,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:53:55,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:55,781 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:55,786 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:53:55,792 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:53:55,792 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:55,792 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:55,792 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:55,793 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:55,793 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:55,793 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:53:55,793 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:55,793 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:53:55,794 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:55,795 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:53:55,796 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:53:55,796 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:55,796 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:53:55,797 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:55,797 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:55,797 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:55,797 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:53:55,798 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:53:55,798 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:53:55,798 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:53:55,798 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:53:55,798 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:53:55,802 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:53:55,802 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:53:55,802 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:53:55,803 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:53:55,803 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:53:55,803 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:53:55,803 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:55,803 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:53:55,804 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:55,804 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:55,804 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:55,804 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:53:55,805 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:53:55,805 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:53:55,805 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:53:55,809 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:53:55,809 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:55,810 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:55,810 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:55,811 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:55,811 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:55,812 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:55,812 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:55,824 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5412, Threshold=0.5970, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:53:55,824 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5412
2025-08-04 20:54:01,082 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:01,082 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:01,082 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:01,082 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:54:01,082 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:54:01,082 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:01,428 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:01,428 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:01,514 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:54:01,546 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:54:01,546 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:01,649 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:01,658 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:01,658 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:01,663 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:54:01,669 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:01,669 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:54:01,670 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:01,670 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:01,670 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:54:01,679 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:01,682 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:01,684 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:01,686 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:01,690 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:01,692 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:01,697 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:01,700 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:01,702 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:01,705 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:01,707 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:01,717 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:01,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:54:01,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:54:01,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:54:01,728 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:01,728 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:54:01,737 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:01,737 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:54:01,737 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:01,752 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:01,756 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:54:01,761 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:54:01,761 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:01,761 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:01,761 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:01,762 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:01,762 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:01,762 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:54:01,762 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:01,762 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:54:01,762 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:01,764 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:54:01,764 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:54:01,764 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:01,764 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:54:01,764 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:01,764 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:01,764 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:01,765 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:54:01,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:54:01,765 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:54:01,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:54:01,765 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:54:01,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:54:01,767 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:54:01,767 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:54:01,768 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:54:01,768 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:54:01,768 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:54:01,768 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:54:01,768 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:01,768 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:54:01,768 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:01,769 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:01,769 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:01,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:54:01,769 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:54:01,770 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:54:01,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:54:01,774 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:54:01,775 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:01,776 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:01,776 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:01,777 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 139/400.
2025-08-04 20:54:01,878 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:01,879 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:01,880 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2199 anomalous samples to GAN training data (target: 2199).
2025-08-04 20:54:01,881 - ClientAppLogger [Client 1] - INFO - [Client] Round 139: Training GAN with 9529 samples (7330 normal, 2199 anomalous).
2025-08-04 20:54:01,882 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:54:08,642 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7830
2025-08-04 20:54:08,642 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7830
2025-08-04 20:54:08,643 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:54:08,654 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5788, Threshold=0.6446, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:54:08,654 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:54:08,654 - ClientAppLogger [Client 1] - INFO - Fit completed for round 139. Duration: 6.88s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 139, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083879340334246, 'd_loss': 0.7830227985795166, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 6.876591444015503, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 0.14453125, 'accumulated_train_samples_this_round': 9529}
2025-08-04 20:54:08,654 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:54:13,931 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:13,931 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:13,931 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:13,932 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:54:13,932 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:54:13,932 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:14,297 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:14,297 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:14,385 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:54:14,432 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:54:14,432 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:14,581 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:14,591 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:14,591 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:14,599 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:54:14,609 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:14,610 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:54:14,610 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:14,611 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:14,611 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:54:14,623 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:14,627 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:14,630 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:14,632 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:14,635 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:14,638 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:14,641 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:14,644 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:14,647 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:14,649 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:14,651 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:14,664 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:14,665 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:54:14,670 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:54:14,670 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:54:14,676 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:14,677 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:54:14,692 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:14,693 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:54:14,693 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:14,725 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:14,734 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:54:14,744 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:54:14,744 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:14,744 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:14,744 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:14,745 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:14,745 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:14,745 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:54:14,746 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:14,746 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:54:14,746 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:14,748 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:54:14,748 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:54:14,749 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:14,749 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:54:14,749 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:14,749 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:14,749 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:14,750 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:54:14,750 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:54:14,751 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:54:14,751 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:54:14,751 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:54:14,752 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:54:14,760 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:54:14,761 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:54:14,761 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:54:14,762 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:54:14,762 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:54:14,762 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:54:14,763 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:14,764 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:54:14,764 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:14,765 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:14,765 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:14,765 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:54:14,766 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:54:14,766 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:54:14,767 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:54:14,775 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:54:14,775 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:14,777 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:14,777 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:14,779 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:14,780 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:14,780 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:14,781 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:14,797 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5781, Threshold=0.6436, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:54:14,797 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5781
2025-08-04 20:54:20,061 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:20,062 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:20,062 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:20,062 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:54:20,062 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:54:20,062 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:20,400 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:20,400 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:20,483 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:54:20,525 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:54:20,525 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:20,707 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:20,713 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:20,714 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:20,719 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:54:20,725 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:20,725 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:54:20,725 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:20,726 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:20,726 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:54:20,735 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:20,738 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:20,740 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:20,742 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:20,745 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:20,747 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:20,749 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:20,752 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:20,755 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:20,757 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:20,759 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:20,768 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:20,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:54:20,773 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:54:20,773 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:54:20,779 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:20,779 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:54:20,791 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:20,791 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:54:20,792 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:20,808 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:20,816 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:54:20,824 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:54:20,824 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:20,824 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:20,824 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:20,825 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:20,825 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:20,825 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:54:20,825 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:20,826 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:54:20,826 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:20,827 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:54:20,827 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:54:20,828 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:20,828 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:54:20,828 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:20,828 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:20,828 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:20,828 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:54:20,828 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:54:20,829 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:54:20,829 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:54:20,829 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:54:20,829 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:54:20,833 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:54:20,833 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:54:20,833 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:54:20,833 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:54:20,833 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:54:20,834 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:54:20,834 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:20,834 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:54:20,834 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:20,835 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:20,835 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:20,835 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:54:20,835 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:54:20,836 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:54:20,836 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:54:20,842 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:54:20,843 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:20,844 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:20,844 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:20,845 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 140/400.
2025-08-04 20:54:20,946 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:20,947 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:20,948 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2215 anomalous samples to GAN training data (target: 2215).
2025-08-04 20:54:20,949 - ClientAppLogger [Client 1] - INFO - [Client] Round 140: Training GAN with 9601 samples (7386 normal, 2215 anomalous).
2025-08-04 20:54:20,949 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:54:27,949 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7829
2025-08-04 20:54:27,950 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7829
2025-08-04 20:54:27,950 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:54:27,962 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5348, Threshold=0.5811, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:54:27,962 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:54:27,962 - ClientAppLogger [Client 1] - INFO - Fit completed for round 140. Duration: 7.12s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 140, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0838549547276886, 'd_loss': 0.7829401521462473, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.116693019866943, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 9601}
2025-08-04 20:54:27,963 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:54:33,233 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:33,233 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:33,233 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:33,233 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:54:33,233 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:54:33,234 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:33,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:33,769 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:33,892 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:54:33,957 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:54:33,957 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:34,098 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:34,106 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:34,107 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:34,114 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:54:34,126 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:34,126 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:54:34,127 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:34,127 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:34,127 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:54:34,137 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:34,141 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:34,144 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:34,147 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:34,150 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:34,153 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:34,156 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:34,159 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:34,163 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:34,166 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:34,168 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:34,181 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:34,182 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:54:34,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:54:34,188 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:54:34,196 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:34,196 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:54:34,215 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:34,215 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:54:34,216 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:34,236 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:34,242 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:54:34,256 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:54:34,257 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:34,258 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:34,258 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:34,258 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:34,258 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:34,259 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:54:34,259 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:34,259 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:54:34,259 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:34,261 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:54:34,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:54:34,261 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:34,262 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:54:34,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:34,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:34,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:34,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:54:34,262 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:54:34,262 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:54:34,263 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:54:34,263 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:54:34,263 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:54:34,268 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:54:34,268 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:54:34,268 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:54:34,268 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:54:34,268 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:54:34,273 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:54:34,273 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:34,273 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:54:34,274 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:34,274 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:34,275 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:34,275 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:54:34,275 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:54:34,275 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:54:34,275 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:54:34,281 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:54:34,282 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:34,284 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:34,284 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:34,286 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:34,286 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:34,286 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:34,287 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:34,301 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5354, Threshold=0.5825, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:54:34,301 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5354
2025-08-04 20:54:39,567 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:39,568 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:39,568 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:39,568 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:54:39,568 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:54:39,568 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:39,888 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:39,888 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:39,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:54:40,016 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:54:40,016 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:40,186 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:40,193 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:40,194 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:40,199 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:54:40,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:40,205 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:54:40,206 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:40,206 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:40,206 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:54:40,214 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:40,217 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:40,219 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:40,221 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:40,224 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:40,226 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:40,228 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:40,231 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:40,233 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:40,235 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:40,238 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:40,247 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:40,247 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:54:40,252 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:54:40,252 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:54:40,257 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:40,257 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:54:40,266 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:40,267 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:54:40,267 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:40,282 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:40,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:54:40,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:54:40,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:40,293 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:40,293 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:40,293 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:40,293 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:40,293 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:54:40,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:40,294 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:54:40,294 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:40,295 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:54:40,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:54:40,296 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:40,296 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:54:40,296 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:40,296 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:40,297 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:40,297 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:54:40,297 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:54:40,297 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:54:40,298 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:54:40,298 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:54:40,298 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:54:40,301 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:54:40,302 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:54:40,302 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:54:40,302 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:54:40,302 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:54:40,302 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:54:40,303 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:40,303 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:54:40,303 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:40,304 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:40,304 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:40,304 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:54:40,304 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:54:40,304 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:54:40,304 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:54:40,308 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:54:40,309 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:40,310 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:40,310 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:40,311 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 141/400.
2025-08-04 20:54:40,413 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:40,413 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:40,415 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2231 anomalous samples to GAN training data (target: 2231).
2025-08-04 20:54:40,416 - ClientAppLogger [Client 1] - INFO - [Client] Round 141: Training GAN with 9670 samples (7439 normal, 2231 anomalous).
2025-08-04 20:54:40,416 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:54:47,208 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0838, Avg D Loss: 0.7826
2025-08-04 20:54:47,209 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0838, Avg D Loss: 0.7826
2025-08-04 20:54:47,209 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:54:47,220 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5664, Threshold=0.6166, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:54:47,221 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:54:47,221 - ClientAppLogger [Client 1] - INFO - Fit completed for round 141. Duration: 6.91s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 141, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0838341986085167, 'd_loss': 0.782552538370519, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 6.9092912673950195, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 7.20703125, 'accumulated_train_samples_this_round': 9670}
2025-08-04 20:54:47,221 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:54:52,492 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:52,493 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:52,493 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:52,493 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:54:52,493 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:54:52,493 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:52,835 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:52,835 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:52,922 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:54:52,963 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:54:52,963 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:53,073 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:53,078 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:53,078 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:53,083 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:54:53,088 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:53,088 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:54:53,089 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:53,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:53,089 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:54:53,098 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:53,100 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:53,103 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:53,105 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:53,108 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:53,110 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:53,112 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:53,115 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:53,117 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:53,119 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:53,122 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:53,131 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:53,131 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:54:53,136 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:54:53,136 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:54:53,141 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:53,141 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:54:53,148 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:53,149 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:54:53,149 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:53,163 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:53,167 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:54:53,172 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:54:53,172 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:53,172 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:53,172 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:53,173 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:53,173 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:53,173 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:54:53,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:53,174 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:54:53,174 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:53,175 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:54:53,175 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:54:53,176 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:53,176 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:54:53,176 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:53,176 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:53,176 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:53,177 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:54:53,177 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:54:53,177 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:54:53,177 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:54:53,177 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:54:53,177 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:54:53,179 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:54:53,179 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:54:53,180 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:54:53,180 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:54:53,180 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:54:53,180 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:54:53,180 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:53,180 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:54:53,181 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:53,181 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:53,181 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:53,181 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:54:53,182 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:54:53,182 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:54:53,182 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:54:53,186 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:54:53,186 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:53,187 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:53,187 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:53,189 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:53,189 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:53,189 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:53,190 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:53,201 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5661, Threshold=0.6163, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:54:53,201 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5661
2025-08-04 20:55:01,461 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:01,461 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:55:01,461 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:55:01,462 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:55:01,462 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:55:01,462 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:01,784 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:01,785 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:01,867 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:55:01,908 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:55:01,908 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:02,015 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:02,022 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:02,022 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:02,028 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:55:02,033 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:02,033 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:55:02,034 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:02,034 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:02,034 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:55:02,042 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:02,045 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:02,047 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:02,049 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:02,052 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:02,054 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:02,056 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:02,059 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:02,062 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:02,063 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:02,066 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:02,074 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:02,074 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:55:02,079 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:55:02,079 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:55:02,083 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:02,083 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:55:02,091 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:02,091 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:55:02,091 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:02,106 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:02,110 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:55:02,115 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:55:02,115 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:02,115 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:02,115 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:02,115 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:02,116 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:02,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:55:02,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:02,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:55:02,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:02,117 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:55:02,118 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:55:02,118 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:02,118 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:55:02,118 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:02,118 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:02,119 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:02,119 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:55:02,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:55:02,119 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:55:02,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:55:02,119 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:55:02,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:55:02,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:55:02,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:55:02,122 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:55:02,122 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:55:02,122 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:55:02,122 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:55:02,122 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:02,122 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:55:02,123 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:02,123 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:02,123 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:02,123 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:55:02,123 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:55:02,124 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:55:02,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:55:02,127 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:55:02,127 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:02,129 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:02,129 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:55:02,130 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 142/400.
2025-08-04 20:55:02,231 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:02,231 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:02,233 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2246 anomalous samples to GAN training data (target: 2246).
2025-08-04 20:55:02,234 - ClientAppLogger [Client 1] - INFO - [Client] Round 142: Training GAN with 9735 samples (7489 normal, 2246 anomalous).
2025-08-04 20:55:02,234 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:55:09,394 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7818
2025-08-04 20:55:09,394 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7818
2025-08-04 20:55:09,394 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:55:09,406 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5622, Threshold=0.6145, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:55:09,406 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:55:09,406 - ClientAppLogger [Client 1] - INFO - Fit completed for round 142. Duration: 7.28s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 142, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083882186583023, 'd_loss': 0.7817648435330844, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.275965929031372, 'cpu_percent_fit': 12.50625, 'ram_mb_fit': 6.09765625, 'accumulated_train_samples_this_round': 9735}
2025-08-04 20:55:09,406 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:55:14,677 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:14,677 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:55:14,678 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:55:14,678 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:55:14,678 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:55:14,678 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:14,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:14,977 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:15,064 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:55:15,107 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:55:15,107 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:15,219 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:15,225 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:15,225 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:15,230 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:55:15,236 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:15,236 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:55:15,236 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:15,237 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:15,238 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:55:15,248 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:15,251 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:15,253 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:15,255 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:15,258 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:15,260 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:15,263 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:15,265 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:15,268 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:15,270 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:15,273 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:15,282 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:15,282 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:55:15,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:55:15,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:55:15,291 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:15,292 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:55:15,300 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:15,300 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:55:15,301 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:15,315 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:15,320 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:55:15,325 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:55:15,325 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:15,325 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:15,325 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:15,325 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:15,326 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:15,326 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:55:15,326 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:15,327 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:55:15,327 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:15,328 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:55:15,328 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:55:15,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:15,329 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:55:15,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:15,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:15,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:15,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:55:15,329 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:55:15,329 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:55:15,330 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:55:15,330 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:55:15,330 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:55:15,332 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:55:15,332 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:55:15,333 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:55:15,333 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:55:15,333 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:55:15,333 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:55:15,333 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:15,333 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:55:15,334 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:15,334 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:15,334 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:15,334 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:55:15,334 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:55:15,335 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:55:15,335 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:55:15,338 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:55:15,338 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:15,339 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:15,340 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:55:15,341 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:15,341 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:15,341 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:15,342 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:15,354 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5507, Threshold=0.5997, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:55:15,355 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5507
2025-08-04 20:55:23,631 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:23,631 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:55:23,631 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:55:23,631 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:55:23,631 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:55:23,631 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:23,942 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:23,942 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:24,025 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:55:24,066 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:55:24,066 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:24,176 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:24,183 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:24,184 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:24,189 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:55:24,195 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:24,195 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:55:24,195 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:24,195 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:24,195 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:55:24,204 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:24,206 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:24,209 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:24,211 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:24,214 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:24,216 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:24,218 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:24,220 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:24,223 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:24,225 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:24,227 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:24,235 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:24,235 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:55:24,240 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:55:24,240 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:55:24,244 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:24,244 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:55:24,253 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:24,253 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:55:24,253 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:24,268 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:24,274 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:55:24,282 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:55:24,282 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:24,282 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:24,282 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:24,282 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:24,283 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:24,283 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:55:24,283 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:24,283 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:55:24,283 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:24,284 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:55:24,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:55:24,285 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:24,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:55:24,285 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:24,285 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:24,285 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:24,286 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:55:24,286 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:55:24,286 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:55:24,286 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:55:24,286 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:55:24,286 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:55:24,288 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:55:24,288 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:55:24,288 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:55:24,288 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:55:24,288 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:55:24,288 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:55:24,288 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:24,289 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:55:24,289 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:24,289 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:24,289 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:24,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:55:24,290 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:55:24,290 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:55:24,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:55:24,295 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:55:24,295 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:24,296 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:24,296 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:55:24,298 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 143/400.
2025-08-04 20:55:24,399 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:24,399 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:24,400 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2265 anomalous samples to GAN training data (target: 2265).
2025-08-04 20:55:24,401 - ClientAppLogger [Client 1] - INFO - [Client] Round 143: Training GAN with 9815 samples (7550 normal, 2265 anomalous).
2025-08-04 20:55:24,401 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:55:31,551 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7833
2025-08-04 20:55:31,551 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7833
2025-08-04 20:55:31,552 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:55:31,564 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4834, Threshold=0.5059, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:55:31,564 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:55:31,564 - ClientAppLogger [Client 1] - INFO - Fit completed for round 143. Duration: 7.27s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 143, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0839094036012904, 'd_loss': 0.7832638040362604, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.266357421875, 'cpu_percent_fit': 12.48125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 9815}
2025-08-04 20:55:31,564 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:55:36,832 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:36,832 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:55:36,832 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:55:36,832 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:55:36,832 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:55:36,833 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:37,244 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:37,244 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:37,338 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:55:37,382 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:55:37,382 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:37,527 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:37,533 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:37,534 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:37,539 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:55:37,545 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:37,546 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:55:37,546 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:37,546 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:37,546 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:55:37,555 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:37,559 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:37,561 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:37,563 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:37,565 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:37,567 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:37,570 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:37,572 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:37,575 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:37,577 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:37,579 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:37,589 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:37,589 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:55:37,595 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:55:37,595 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:55:37,601 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:37,601 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:55:37,611 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:37,611 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:55:37,611 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:37,626 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:37,631 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:55:37,636 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:55:37,636 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:37,636 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:37,637 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:37,637 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:37,637 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:37,638 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:55:37,638 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:37,638 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:55:37,638 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:37,640 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:55:37,640 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:55:37,640 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:37,641 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:55:37,641 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:37,641 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:37,641 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:37,641 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:55:37,642 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:55:37,642 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:55:37,642 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:55:37,642 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:55:37,642 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:55:37,645 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:55:37,645 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:55:37,645 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:55:37,645 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:55:37,645 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:55:37,645 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:55:37,645 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:37,646 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:55:37,646 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:37,646 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:37,646 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:37,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:55:37,647 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:55:37,647 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:55:37,647 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:55:37,651 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:55:37,651 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:37,652 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:37,652 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:55:37,654 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:37,654 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:37,654 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:37,655 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:37,666 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4836, Threshold=0.5064, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:55:37,666 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4836
2025-08-04 20:55:42,909 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:42,909 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:55:42,909 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:55:42,909 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:55:42,909 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:55:42,909 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:43,226 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:43,226 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:43,311 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:55:43,352 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:55:43,352 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:43,469 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:43,475 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:43,475 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:43,482 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:55:43,488 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:43,488 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:55:43,489 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:43,489 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:43,489 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:55:43,499 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:43,502 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:43,504 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:43,506 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:43,509 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:43,512 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:43,515 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:43,517 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:43,521 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:43,522 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:43,525 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:43,535 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:43,535 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:55:43,540 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:55:43,540 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:55:43,545 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:43,545 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:55:43,554 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:43,555 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:55:43,555 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:43,571 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:43,577 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:55:43,587 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:55:43,587 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:43,587 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:43,587 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:43,588 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:43,588 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:43,588 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:55:43,589 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:43,589 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:55:43,589 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:43,590 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:55:43,590 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:55:43,591 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:43,591 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:55:43,591 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:43,591 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:43,591 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:43,592 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:55:43,592 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:55:43,592 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:55:43,592 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:55:43,592 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:55:43,592 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:55:43,594 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:55:43,595 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:55:43,595 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:55:43,595 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:55:43,595 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:55:43,595 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:55:43,595 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:43,596 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:55:43,596 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:43,596 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:43,597 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:43,597 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:55:43,597 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:55:43,597 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:55:43,597 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:55:43,601 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:55:43,601 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:43,602 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:43,602 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:55:43,605 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 144/400.
2025-08-04 20:55:43,706 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:43,706 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:43,708 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2279 anomalous samples to GAN training data (target: 2279).
2025-08-04 20:55:43,708 - ClientAppLogger [Client 1] - INFO - [Client] Round 144: Training GAN with 9878 samples (7599 normal, 2279 anomalous).
2025-08-04 20:55:43,708 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:55:50,683 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0838, Avg D Loss: 0.7808
2025-08-04 20:55:50,683 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0838, Avg D Loss: 0.7808
2025-08-04 20:55:50,683 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:55:50,694 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5880, Threshold=0.6507, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:55:50,695 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:55:50,695 - ClientAppLogger [Client 1] - INFO - Fit completed for round 144. Duration: 7.09s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 144, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0837585864846204, 'd_loss': 0.7807774051514007, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.090142488479614, 'cpu_percent_fit': 12.49375, 'ram_mb_fit': 2.16015625, 'accumulated_train_samples_this_round': 9878}
2025-08-04 20:55:50,695 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:55:55,982 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:55,982 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:55:55,983 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:55:55,983 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:55:55,983 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:55:55,983 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:56,434 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:56,435 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:56,536 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:55:56,577 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:55:56,579 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:56,709 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:56,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:56,716 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:56,721 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:55:56,727 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:56,727 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:55:56,727 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:56,727 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:56,727 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:55:56,736 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:56,739 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,741 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:56,743 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:56,746 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:56,748 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:56,751 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,753 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:56,756 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:56,758 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:56,760 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:56,769 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:56,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:55:56,774 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:55:56,774 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:55:56,779 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:56,779 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:55:56,787 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:56,788 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:55:56,788 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:56,804 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:56,809 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:55:56,814 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:55:56,815 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:56,815 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:56,815 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:56,815 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:56,816 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:56,816 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:55:56,816 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:56,816 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:55:56,816 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:56,818 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:55:56,818 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:55:56,818 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:56,818 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:55:56,818 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:56,819 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:56,819 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:56,819 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:55:56,819 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:55:56,819 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:55:56,820 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:55:56,820 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:55:56,820 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:55:56,824 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:55:56,824 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:55:56,824 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:55:56,824 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:55:56,825 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:55:56,825 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:55:56,825 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:56,825 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:55:56,825 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:56,826 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:56,826 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:56,826 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:55:56,826 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:55:56,826 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:55:56,826 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:55:56,831 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:55:56,831 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:56,832 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:56,832 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:55:56,834 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:56,834 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:56,834 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:56,834 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:56,847 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5860, Threshold=0.6483, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:55:56,847 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5860
2025-08-04 20:56:08,161 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:08,162 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:08,162 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:08,162 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:56:08,162 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:56:08,162 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:08,698 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:08,698 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:08,792 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:56:08,841 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:56:08,841 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:08,974 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:08,979 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:08,980 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:08,985 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:56:08,991 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:08,991 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:56:08,992 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:08,992 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:08,992 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:56:09,001 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:09,004 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:09,006 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:09,009 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:09,012 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:09,014 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:09,016 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:09,019 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:09,022 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:09,024 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:09,027 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:09,039 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:09,039 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:56:09,044 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:56:09,044 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:56:09,051 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:09,051 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:56:09,062 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:09,062 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:56:09,062 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:09,080 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:09,085 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:56:09,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:56:09,120 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:09,120 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:09,120 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:09,120 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:09,120 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:09,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:56:09,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:09,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:56:09,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:09,122 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:56:09,123 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:56:09,123 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:09,123 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:56:09,123 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:09,123 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:09,123 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:09,124 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:56:09,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:56:09,124 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:56:09,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:56:09,124 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:56:09,124 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:56:09,128 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:56:09,128 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:56:09,128 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:56:09,129 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:56:09,129 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:56:09,129 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:56:09,129 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:09,129 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:56:09,130 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:09,130 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:09,130 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:09,131 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:56:09,131 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:56:09,131 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:56:09,131 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:56:09,135 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:56:09,135 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:09,137 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:09,137 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:09,138 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:09,138 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:09,138 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:09,139 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:09,151 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5124, Threshold=0.5298, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:56:09,151 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5124
2025-08-04 20:56:14,408 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:14,408 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:14,408 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:14,408 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:56:14,409 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:56:14,409 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:14,764 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:14,764 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:14,854 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:56:14,891 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:56:14,891 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:15,005 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:15,012 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:15,012 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:15,017 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:56:15,022 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:15,022 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:56:15,022 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:15,023 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:15,023 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:56:15,031 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:15,034 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:15,036 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:15,038 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:15,040 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:15,042 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:15,045 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:15,047 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:15,050 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:15,052 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:15,054 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:15,064 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:15,064 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:56:15,069 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:56:15,069 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:56:15,073 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:15,073 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:56:15,085 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:15,086 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:56:15,086 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:15,102 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:15,107 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:56:15,112 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:56:15,113 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:15,113 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:15,113 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:15,113 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:15,113 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:15,114 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:56:15,114 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:15,114 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:56:15,114 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:15,115 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:56:15,115 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:56:15,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:15,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:56:15,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:15,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:15,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:15,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:56:15,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:56:15,117 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:56:15,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:56:15,117 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:56:15,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:56:15,119 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:56:15,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:56:15,120 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:56:15,120 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:56:15,120 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:56:15,120 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:56:15,120 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:15,120 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:56:15,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:15,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:15,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:15,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:56:15,121 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:56:15,121 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:56:15,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:56:15,125 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:56:15,125 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:15,126 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:15,126 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:15,128 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 146/400.
2025-08-04 20:56:15,229 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:15,229 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:15,231 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2313 anomalous samples to GAN training data (target: 2313).
2025-08-04 20:56:15,232 - ClientAppLogger [Client 1] - INFO - [Client] Round 146: Training GAN with 10025 samples (7712 normal, 2313 anomalous).
2025-08-04 20:56:15,232 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:56:22,356 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0837, Avg D Loss: 0.7815
2025-08-04 20:56:22,356 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0837, Avg D Loss: 0.7815
2025-08-04 20:56:22,356 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:56:22,367 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5677, Threshold=0.6249, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:56:22,367 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:56:22,367 - ClientAppLogger [Client 1] - INFO - Fit completed for round 146. Duration: 7.24s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 146, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0836852380010553, 'd_loss': 0.7814620718944103, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.2394044399261475, 'cpu_percent_fit': 12.49375, 'ram_mb_fit': 5.75, 'accumulated_train_samples_this_round': 10025}
2025-08-04 20:56:22,367 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:56:27,661 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:27,661 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:27,662 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:27,662 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:56:27,662 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:56:27,662 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:28,058 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:28,058 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:28,150 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:56:28,203 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:56:28,204 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:28,355 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:28,362 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:28,362 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:28,368 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:56:28,374 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:28,374 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:56:28,375 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:28,375 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:28,375 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:56:28,385 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:28,388 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:28,390 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:28,393 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:28,396 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:28,398 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:28,401 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:28,404 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:28,406 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:28,408 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:28,411 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:28,424 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:28,424 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:56:28,430 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:56:28,430 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:56:28,435 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:28,436 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:56:28,447 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:28,448 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:56:28,448 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:28,464 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:28,469 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:56:28,474 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:56:28,474 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:28,474 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:28,474 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:28,475 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:28,475 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:28,475 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:56:28,475 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:28,476 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:56:28,476 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:28,477 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:56:28,477 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:56:28,478 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:28,478 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:56:28,478 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:28,478 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:28,478 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:28,479 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:56:28,479 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:56:28,479 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:56:28,479 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:56:28,479 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:56:28,479 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:56:28,484 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:56:28,484 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:56:28,484 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:56:28,484 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:56:28,485 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:56:28,485 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:56:28,485 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:28,485 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:56:28,486 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:28,486 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:28,486 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:28,486 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:56:28,487 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:56:28,487 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:56:28,487 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:56:28,493 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:56:28,493 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:28,495 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:28,495 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:28,496 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:28,496 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:28,496 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:28,497 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:28,509 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5674, Threshold=0.6245, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:56:28,509 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5674
2025-08-04 20:56:33,787 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:33,787 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:33,787 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:33,787 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:56:33,787 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:56:33,788 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:34,136 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:34,136 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:34,225 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:56:34,267 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:56:34,268 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:34,388 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:34,394 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:34,394 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:34,400 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:56:34,407 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:34,407 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:56:34,408 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:34,408 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:34,408 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:56:34,416 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:34,419 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:34,421 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:34,423 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:34,426 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:34,428 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:34,431 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:34,433 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:34,436 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:34,438 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:34,440 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:34,449 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:34,449 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:56:34,454 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:56:34,454 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:56:34,458 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:34,458 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:56:34,466 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:34,467 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:56:34,467 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:34,481 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:34,486 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:56:34,491 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:56:34,491 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:34,492 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:34,492 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:34,492 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:34,492 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:34,493 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:56:34,493 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:34,493 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:56:34,493 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:34,495 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:56:34,495 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:56:34,495 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:34,496 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:56:34,496 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:34,496 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:34,496 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:34,496 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:56:34,496 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:56:34,496 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:56:34,497 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:56:34,497 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:56:34,497 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:56:34,499 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:56:34,499 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:56:34,499 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:56:34,499 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:56:34,500 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:56:34,500 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:56:34,500 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:34,500 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:56:34,500 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:34,501 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:34,501 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:34,501 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:56:34,501 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:56:34,501 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:56:34,502 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:56:34,506 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:56:34,506 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:34,508 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:34,508 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:34,509 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 147/400.
2025-08-04 20:56:34,610 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:34,610 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:34,612 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2327 anomalous samples to GAN training data (target: 2327).
2025-08-04 20:56:34,613 - ClientAppLogger [Client 1] - INFO - [Client] Round 147: Training GAN with 10084 samples (7757 normal, 2327 anomalous).
2025-08-04 20:56:34,613 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:56:41,924 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0837, Avg D Loss: 0.7816
2025-08-04 20:56:41,925 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0837, Avg D Loss: 0.7816
2025-08-04 20:56:41,925 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:56:41,939 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4818, Threshold=0.4964, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:56:41,939 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:56:41,940 - ClientAppLogger [Client 1] - INFO - Fit completed for round 147. Duration: 7.43s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 147, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083723468914811, 'd_loss': 0.7815570669768113, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.430171489715576, 'cpu_percent_fit': 12.49375, 'ram_mb_fit': 2.0, 'accumulated_train_samples_this_round': 10084}
2025-08-04 20:56:41,940 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:56:47,213 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:47,213 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:47,214 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:47,214 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:56:47,214 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:56:47,214 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:47,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:47,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:47,810 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:56:47,870 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:56:47,871 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:48,057 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:48,065 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:48,066 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:48,072 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:56:48,078 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:48,078 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:56:48,079 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:48,079 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:48,079 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:56:48,089 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:48,092 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:48,095 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:48,097 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:48,100 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:48,103 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:48,105 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:48,108 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:48,111 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:48,112 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:48,115 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:48,129 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:48,129 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:56:48,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:56:48,134 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:56:48,140 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:48,141 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:56:48,152 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:48,152 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:56:48,152 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:48,169 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:48,173 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:56:48,185 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:56:48,185 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:48,185 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:48,185 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:48,186 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:48,186 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:48,186 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:56:48,186 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:48,186 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:56:48,186 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:48,188 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:56:48,188 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:56:48,188 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:48,188 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:56:48,189 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:48,189 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:48,189 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:48,189 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:56:48,189 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:56:48,190 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:56:48,190 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:56:48,190 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:56:48,190 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:56:48,193 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:56:48,193 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:56:48,193 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:56:48,193 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:56:48,194 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:56:48,194 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:56:48,194 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:48,194 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:56:48,195 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:48,195 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:48,195 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:48,195 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:56:48,195 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:56:48,196 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:56:48,196 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:56:48,203 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:56:48,203 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:48,204 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:48,204 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:48,206 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:48,206 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:48,206 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:48,207 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:48,219 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4821, Threshold=0.4970, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:56:48,219 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4821
2025-08-04 20:56:53,492 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:53,492 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:53,492 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:53,492 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:56:53,492 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:56:53,492 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:53,809 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:53,810 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:53,897 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:56:53,940 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:56:53,941 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:54,117 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:54,126 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:54,126 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:54,135 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:56:54,141 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:54,142 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:56:54,142 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:54,142 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:54,143 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:56:54,151 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:54,154 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:54,156 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:54,159 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:54,162 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:54,164 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:54,167 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:54,170 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:54,173 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:54,175 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:54,177 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:54,187 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:54,187 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:56:54,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:56:54,192 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:56:54,197 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:54,197 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:56:54,207 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:54,207 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:56:54,208 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:54,222 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:54,227 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:56:54,232 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:56:54,232 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:54,233 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:54,233 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:54,233 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:54,233 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:54,234 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:56:54,234 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:54,234 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:56:54,234 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:54,235 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:56:54,235 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:56:54,236 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:54,236 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:56:54,236 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:54,236 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:54,236 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:54,236 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:56:54,237 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:56:54,237 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:56:54,237 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:56:54,237 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:56:54,237 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:56:54,239 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:56:54,239 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:56:54,240 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:56:54,240 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:56:54,240 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:56:54,240 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:56:54,240 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:54,240 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:56:54,240 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:54,241 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:54,241 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:54,241 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:56:54,241 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:56:54,241 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:56:54,241 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:56:54,247 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:56:54,248 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:54,249 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:54,249 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:54,251 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 148/400.
2025-08-04 20:56:54,352 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:54,352 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:54,354 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2345 anomalous samples to GAN training data (target: 2345).
2025-08-04 20:56:54,355 - ClientAppLogger [Client 1] - INFO - [Client] Round 148: Training GAN with 10163 samples (7818 normal, 2345 anomalous).
2025-08-04 20:56:54,355 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:01,997 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0838, Avg D Loss: 0.7816
2025-08-04 20:57:01,998 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0838, Avg D Loss: 0.7816
2025-08-04 20:57:01,998 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:02,009 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5426, Threshold=0.5817, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:57:02,009 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:57:02,009 - ClientAppLogger [Client 1] - INFO - Fit completed for round 148. Duration: 7.76s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 148, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083773463065378, 'd_loss': 0.7815952394177076, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.758286714553833, 'cpu_percent_fit': 12.50625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10163}
2025-08-04 20:57:02,009 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:57:07,289 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:07,290 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:07,290 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:07,290 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:57:07,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:57:07,290 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:07,681 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:07,681 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:07,770 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:57:07,813 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:57:07,814 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:07,936 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:07,942 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:07,942 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:07,947 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:57:07,953 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:07,953 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:57:07,953 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:07,953 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:07,954 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:57:07,963 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:07,966 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:07,968 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:07,970 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:07,973 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:07,976 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:07,979 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:07,982 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:07,984 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:07,986 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:07,989 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:07,997 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:07,997 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:57:08,002 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:57:08,002 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:57:08,006 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:08,007 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:57:08,015 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:08,015 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:57:08,016 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:08,031 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:08,036 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:57:08,046 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:57:08,047 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:08,047 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:08,047 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:08,047 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:08,048 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:08,048 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:57:08,048 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:08,048 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:57:08,048 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:08,049 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:57:08,049 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:57:08,050 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:08,050 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:57:08,050 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:08,050 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:08,051 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:08,051 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:57:08,051 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:57:08,051 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:57:08,051 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:57:08,051 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:57:08,051 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:57:08,053 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:57:08,054 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:57:08,054 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:57:08,054 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:57:08,054 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:57:08,054 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:57:08,054 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:08,054 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:57:08,055 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:08,055 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:08,055 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:08,055 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:57:08,056 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:57:08,056 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:57:08,056 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:57:08,063 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:57:08,063 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:08,064 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:08,064 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:08,065 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:08,066 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:08,066 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:08,066 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:08,077 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5386, Threshold=0.5761, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:57:08,078 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5386
2025-08-04 20:57:13,342 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:13,342 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:13,342 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:13,343 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:57:13,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:57:13,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:13,725 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:13,725 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:13,816 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:57:13,856 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:57:13,856 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:14,009 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:14,015 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:14,016 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:14,021 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:57:14,026 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:14,026 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:57:14,027 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:14,027 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:14,027 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:57:14,035 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:14,038 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:14,040 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:14,042 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:14,045 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:14,047 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:14,050 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:14,052 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:14,055 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:14,057 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:14,059 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:14,068 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:14,068 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:57:14,073 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:57:14,073 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:57:14,078 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:14,078 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:57:14,086 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:14,087 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:57:14,087 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:14,101 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:14,106 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:57:14,111 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:57:14,111 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:14,111 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:14,111 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:14,112 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:14,112 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:14,112 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:57:14,112 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:14,113 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:57:14,113 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:14,114 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:57:14,114 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:57:14,114 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:14,115 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:57:14,115 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:14,115 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:14,115 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:14,115 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:57:14,115 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:57:14,115 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:57:14,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:57:14,116 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:57:14,116 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:57:14,118 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:57:14,118 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:57:14,118 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:57:14,118 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:57:14,118 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:57:14,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:57:14,119 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:14,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:57:14,119 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:14,120 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:14,120 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:14,120 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:57:14,120 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:57:14,120 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:57:14,121 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:57:14,127 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:57:14,127 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:14,128 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:14,128 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:14,130 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 149/400.
2025-08-04 20:57:14,231 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:14,231 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:14,233 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2360 anomalous samples to GAN training data (target: 2360).
2025-08-04 20:57:14,233 - ClientAppLogger [Client 1] - INFO - [Client] Round 149: Training GAN with 10228 samples (7868 normal, 2360 anomalous).
2025-08-04 20:57:14,234 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:21,710 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0837, Avg D Loss: 0.7809
2025-08-04 20:57:21,711 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0837, Avg D Loss: 0.7809
2025-08-04 20:57:21,711 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:21,723 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5466, Threshold=0.5838, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:57:21,723 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:57:21,723 - ClientAppLogger [Client 1] - INFO - Fit completed for round 149. Duration: 7.59s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 149, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083696084354462, 'd_loss': 0.7809363276896926, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.593538522720337, 'cpu_percent_fit': 12.50625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10228}
2025-08-04 20:57:21,723 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:57:27,009 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:27,009 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:27,009 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:27,010 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:57:27,010 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:57:27,010 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:27,481 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:27,484 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:27,595 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:57:27,642 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:57:27,642 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:27,849 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:27,857 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:27,857 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:27,869 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:57:27,886 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:27,886 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:57:27,887 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:27,887 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:27,887 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:57:27,899 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:27,902 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:27,905 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:27,907 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:27,912 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:27,915 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:27,919 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:27,922 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:27,925 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:27,927 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:27,929 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:27,942 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:27,942 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:57:27,948 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:57:27,948 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:57:27,956 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:27,957 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:57:27,979 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:27,980 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:57:27,980 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:28,001 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:28,008 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:57:28,019 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:57:28,020 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:28,020 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:28,020 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:28,020 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:28,021 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:28,021 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:57:28,021 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:28,021 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:57:28,021 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:28,023 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:57:28,023 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:57:28,023 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:28,024 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:57:28,024 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:28,024 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:28,024 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:28,024 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:57:28,025 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:57:28,025 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:57:28,025 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:57:28,026 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:57:28,026 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:57:28,029 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:57:28,029 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:57:28,029 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:57:28,030 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:57:28,030 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:57:28,030 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:57:28,030 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:28,030 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:57:28,031 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:28,031 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:28,032 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:28,032 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:57:28,032 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:57:28,033 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:57:28,033 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:57:28,041 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:57:28,041 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:28,043 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:28,043 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:28,045 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:28,045 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:28,045 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:28,046 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:28,060 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5470, Threshold=0.5851, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:57:28,061 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5470
2025-08-04 20:57:33,328 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:33,329 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:33,329 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:33,329 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:57:33,329 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:57:33,329 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:33,692 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:33,692 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:33,783 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:57:33,828 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:57:33,828 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:33,976 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:33,983 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:33,983 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:33,990 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:57:33,998 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:33,998 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:57:33,998 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:33,998 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:33,999 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:57:34,008 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:34,011 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:34,013 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:34,015 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:34,018 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:34,020 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:34,023 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:34,025 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:34,028 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:34,031 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:34,033 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:34,043 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:34,044 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:57:34,049 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:57:34,049 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:57:34,058 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:34,058 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:57:34,074 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:34,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:57:34,075 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:34,094 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:34,100 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:57:34,106 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:57:34,106 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:34,106 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:34,107 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:34,107 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:34,107 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:34,108 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:57:34,108 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:34,108 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:57:34,108 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:34,110 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:57:34,110 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:57:34,110 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:34,110 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:57:34,111 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:34,111 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:34,111 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:34,111 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:57:34,111 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:57:34,111 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:57:34,112 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:57:34,112 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:57:34,112 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:57:34,117 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:57:34,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:57:34,117 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:57:34,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:57:34,117 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:57:34,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:57:34,118 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:34,118 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:57:34,118 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:34,119 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:34,119 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:34,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:57:34,119 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:57:34,119 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:57:34,119 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:57:34,125 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:57:34,125 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:34,127 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:34,127 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:34,128 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 150/400.
2025-08-04 20:57:34,229 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:34,230 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:34,232 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2373 anomalous samples to GAN training data (target: 2373).
2025-08-04 20:57:34,232 - ClientAppLogger [Client 1] - INFO - [Client] Round 150: Training GAN with 10285 samples (7912 normal, 2373 anomalous).
2025-08-04 20:57:34,233 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:41,734 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0837, Avg D Loss: 0.7821
2025-08-04 20:57:41,734 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0837, Avg D Loss: 0.7821
2025-08-04 20:57:41,734 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:41,745 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5315, Threshold=0.5612, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:57:41,745 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:57:41,745 - ClientAppLogger [Client 1] - INFO - Fit completed for round 150. Duration: 7.62s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 150, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0837484203592695, 'd_loss': 0.7820591588627671, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.616812229156494, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10285}
2025-08-04 20:57:41,745 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:57:46,998 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:46,998 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:46,998 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:46,998 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:57:46,998 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:57:46,998 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:47,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:47,344 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:47,431 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:57:47,472 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:57:47,472 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:47,607 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:47,613 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:47,613 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:47,620 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:57:47,626 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:47,626 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:57:47,627 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:47,627 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:47,627 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:57:47,636 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:47,639 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:47,641 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:47,643 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:47,646 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:47,648 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:47,651 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:47,654 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:47,657 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:47,659 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:47,661 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:47,671 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:47,673 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:57:47,679 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:57:47,679 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:57:47,686 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:47,686 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:57:47,697 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:47,697 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:57:47,698 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:47,713 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:47,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:57:47,722 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:57:47,722 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:47,723 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:47,723 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:47,723 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:47,723 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:47,724 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:57:47,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:47,724 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:57:47,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:47,725 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:57:47,726 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:57:47,726 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:47,726 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:57:47,726 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:47,726 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:47,727 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:47,727 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:57:47,727 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:57:47,727 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:57:47,727 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:57:47,727 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:57:47,728 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:57:47,730 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:57:47,730 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:57:47,731 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:57:47,731 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:57:47,731 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:57:47,731 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:57:47,732 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:47,732 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:57:47,732 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:47,733 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:47,733 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:47,733 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:57:47,733 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:57:47,733 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:57:47,733 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:57:47,738 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:57:47,738 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:47,740 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:47,740 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:47,742 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:47,742 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:47,742 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:47,743 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:47,754 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5519, Threshold=0.5955, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:57:47,754 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5519
2025-08-04 20:57:53,005 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:53,005 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:53,005 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:53,005 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:57:53,005 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:57:53,005 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:53,364 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:53,364 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:53,451 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:57:53,496 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:57:53,496 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:53,630 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:53,636 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:53,636 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:53,642 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:57:53,649 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:53,649 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:57:53,649 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:53,650 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:53,650 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:57:53,659 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:53,663 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:53,665 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:53,667 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:53,670 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:53,673 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:53,675 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:53,678 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:53,681 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:53,683 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:53,685 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:53,694 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:53,695 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:57:53,700 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:57:53,700 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:57:53,705 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:53,705 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:57:53,717 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:53,717 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:57:53,718 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:53,736 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:53,741 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:57:53,746 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:57:53,746 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:53,746 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:53,746 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:53,747 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:53,747 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:53,747 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:57:53,748 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:53,748 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:57:53,748 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:53,749 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:57:53,749 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:57:53,750 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:53,750 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:57:53,750 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:53,750 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:53,750 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:53,750 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:57:53,751 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:57:53,751 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:57:53,751 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:57:53,751 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:57:53,751 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:57:53,753 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:57:53,754 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:57:53,754 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:57:53,754 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:57:53,754 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:57:53,754 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:57:53,755 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:53,755 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:57:53,755 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:53,756 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:53,756 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:53,756 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:57:53,756 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:57:53,756 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:57:53,756 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:57:53,762 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:57:53,762 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:53,764 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:53,764 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:53,765 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 151/400.
2025-08-04 20:57:53,866 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:53,867 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:53,868 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2388 anomalous samples to GAN training data (target: 2388).
2025-08-04 20:57:53,869 - ClientAppLogger [Client 1] - INFO - [Client] Round 151: Training GAN with 10348 samples (7960 normal, 2388 anomalous).
2025-08-04 20:57:53,869 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:58:01,223 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.7804
2025-08-04 20:58:01,223 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.7804
2025-08-04 20:58:01,223 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:58:01,236 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5285, Threshold=0.5649, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:58:01,236 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:58:01,236 - ClientAppLogger [Client 1] - INFO - Fit completed for round 151. Duration: 7.47s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 151, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0835158272051286, 'd_loss': 0.7804446230789017, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.470962762832642, 'cpu_percent_fit': 12.50625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10348}
2025-08-04 20:58:01,236 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:58:06,527 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:06,527 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:58:06,527 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:58:06,527 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:58:06,527 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:58:06,527 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:06,920 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:06,920 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:07,014 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:58:07,066 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:58:07,067 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:07,236 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:07,245 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:07,245 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:07,252 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:58:07,260 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:07,260 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:58:07,261 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:07,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:07,261 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:58:07,273 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:07,276 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:07,278 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:07,280 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:07,283 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:07,286 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:07,288 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:07,291 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:07,294 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:07,296 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:07,299 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:07,310 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:07,311 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:58:07,315 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:58:07,315 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:58:07,324 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:07,324 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:58:07,345 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:07,345 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:58:07,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:07,364 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:07,370 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:58:07,384 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:58:07,384 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:07,384 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:07,384 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:07,385 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:07,385 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:07,385 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:58:07,386 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:07,386 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:58:07,386 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:07,388 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:58:07,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:58:07,388 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:07,389 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:58:07,389 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:07,389 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:07,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:07,390 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:58:07,391 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:58:07,391 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:58:07,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:58:07,392 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:58:07,392 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:58:07,398 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:58:07,398 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:58:07,398 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:58:07,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:58:07,399 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:58:07,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:58:07,399 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:07,399 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:58:07,400 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:07,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:07,401 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:07,401 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:58:07,402 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:58:07,402 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:58:07,402 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:58:07,410 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:58:07,410 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:07,413 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:07,413 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:58:07,415 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:07,415 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:07,415 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:07,416 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:07,430 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5283, Threshold=0.5645, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:58:07,430 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5283
2025-08-04 20:58:12,704 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:12,704 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:58:12,704 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:58:12,704 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:58:12,704 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:58:12,704 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:13,053 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:13,053 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:13,145 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:58:13,194 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:58:13,194 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:13,338 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:13,346 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:13,346 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:13,353 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:58:13,359 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:13,359 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:58:13,360 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:13,360 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:13,360 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:58:13,369 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:13,372 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:13,374 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:13,377 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:13,380 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:13,382 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:13,385 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:13,387 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:13,390 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:13,392 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:13,394 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:13,404 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:13,404 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:58:13,409 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:58:13,409 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:58:13,414 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:13,414 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:58:13,425 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:13,425 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:58:13,425 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:13,440 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:13,444 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:58:13,450 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:58:13,450 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:13,450 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:13,450 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:13,450 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:13,451 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:13,451 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:58:13,451 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:13,451 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:58:13,451 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:13,453 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:58:13,453 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:58:13,453 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:13,453 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:58:13,454 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:13,454 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:13,454 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:13,454 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:58:13,454 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:58:13,454 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:58:13,454 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:58:13,454 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:58:13,455 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:58:13,458 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:58:13,458 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:58:13,458 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:58:13,458 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:58:13,458 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:58:13,458 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:58:13,458 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:13,459 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:58:13,459 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:13,459 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:13,459 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:13,460 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:58:13,460 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:58:13,460 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:58:13,460 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:58:13,466 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:58:13,466 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:13,467 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:13,467 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:58:13,469 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 152/400.
2025-08-04 20:58:13,570 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:13,570 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:13,572 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2403 anomalous samples to GAN training data (target: 2403).
2025-08-04 20:58:13,572 - ClientAppLogger [Client 1] - INFO - [Client] Round 152: Training GAN with 10413 samples (8010 normal, 2403 anomalous).
2025-08-04 20:58:13,572 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:58:21,016 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.7830
2025-08-04 20:58:21,017 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.7830
2025-08-04 20:58:21,017 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:58:21,027 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5824, Threshold=0.6388, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:58:21,027 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:58:21,028 - ClientAppLogger [Client 1] - INFO - Fit completed for round 152. Duration: 7.56s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 152, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0834540016836844, 'd_loss': 0.7829532781698674, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.559124708175659, 'cpu_percent_fit': 12.5, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10413}
2025-08-04 20:58:21,028 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:58:26,279 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:26,279 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:58:26,279 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:58:26,279 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:58:26,279 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:58:26,279 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:26,621 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:26,621 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:26,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:58:26,752 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:58:26,752 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:26,891 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:26,898 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:26,898 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:26,904 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:58:26,909 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:26,909 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:58:26,910 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:26,910 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:26,910 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:58:26,919 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:26,922 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:26,924 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:26,926 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:26,929 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:26,931 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:26,934 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:26,937 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:26,939 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:26,941 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:26,944 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:26,953 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:26,953 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:58:26,958 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:58:26,958 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:58:26,963 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:26,964 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:58:26,972 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:26,973 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:58:26,973 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:26,988 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:26,993 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:58:26,998 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:58:26,998 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:26,999 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:26,999 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:26,999 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:26,999 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:27,000 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:58:27,000 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:27,000 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:58:27,000 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:27,002 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:58:27,002 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:58:27,002 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:27,002 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:58:27,003 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:27,003 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:27,003 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:27,003 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:58:27,003 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:58:27,003 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:58:27,003 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:58:27,004 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:58:27,004 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:58:27,006 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:58:27,007 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:58:27,007 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:58:27,007 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:58:27,007 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:58:27,007 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:58:27,008 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:27,008 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:58:27,008 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:27,008 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:27,009 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:27,009 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:58:27,009 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:58:27,009 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:58:27,009 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:58:27,014 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:58:27,014 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:27,015 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:27,015 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:58:27,017 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:27,017 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:27,018 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:27,018 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:27,030 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5822, Threshold=0.6385, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:58:27,030 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5822
2025-08-04 20:58:32,284 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:32,285 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:58:32,285 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:58:32,285 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:58:32,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:58:32,285 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:32,631 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:32,631 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:32,716 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:58:32,754 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:58:32,754 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:32,864 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:32,870 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:32,870 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:32,875 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:58:32,879 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:32,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:58:32,880 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:32,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:32,880 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:58:32,888 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:32,891 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:32,894 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:32,896 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:32,899 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:32,901 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:32,904 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:32,906 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:32,909 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:32,911 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:32,913 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:32,921 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:32,921 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:58:32,926 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:58:32,926 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:58:32,930 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:32,930 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:58:32,938 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:32,938 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:58:32,939 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:32,953 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:32,958 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:58:32,962 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:58:32,963 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:32,963 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:32,963 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:32,963 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:32,963 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:32,963 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:58:32,964 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:32,964 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:58:32,964 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:32,965 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:58:32,965 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:58:32,966 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:32,966 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:58:32,966 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:32,966 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:32,966 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:32,966 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:58:32,966 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:58:32,967 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:58:32,967 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:58:32,967 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:58:32,967 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:58:32,969 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:58:32,969 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:58:32,969 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:58:32,969 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:58:32,970 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:58:32,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:58:32,970 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:32,970 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:58:32,970 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:32,971 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:32,971 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:32,971 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:58:32,971 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:58:32,971 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:58:32,972 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:58:32,975 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:58:32,975 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:32,976 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:32,977 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:58:32,978 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 153/400.
2025-08-04 20:58:33,079 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:33,079 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:33,080 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2421 anomalous samples to GAN training data (target: 2421).
2025-08-04 20:58:33,081 - ClientAppLogger [Client 1] - INFO - [Client] Round 153: Training GAN with 10492 samples (8071 normal, 2421 anomalous).
2025-08-04 20:58:33,081 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:58:40,522 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0834, Avg D Loss: 0.7796
2025-08-04 20:58:40,522 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0834, Avg D Loss: 0.7796
2025-08-04 20:58:40,522 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:58:40,533 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4837, Threshold=0.5060, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:58:40,533 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:58:40,534 - ClientAppLogger [Client 1] - INFO - Fit completed for round 153. Duration: 7.56s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 153, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0833794195053006, 'd_loss': 0.7795858692700199, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.555323600769043, 'cpu_percent_fit': 12.49375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10492}
2025-08-04 20:58:40,534 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:58:45,812 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:45,813 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:58:45,813 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:58:45,813 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:58:45,813 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:58:45,814 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:46,249 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:46,249 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:46,339 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:58:46,388 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:58:46,388 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:46,533 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:46,540 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:46,540 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:46,546 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:58:46,554 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:46,555 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:58:46,556 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:46,556 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:46,556 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:58:46,565 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:46,568 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:46,570 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:46,573 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:46,575 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:46,578 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:46,580 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:46,583 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:46,586 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:46,589 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:46,591 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:46,604 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:46,605 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:58:46,609 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:58:46,610 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:58:46,615 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:46,615 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:58:46,628 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:46,628 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:58:46,628 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:46,646 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:46,651 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:58:46,658 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:58:46,658 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:46,658 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:46,659 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:46,659 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:46,660 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:46,661 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:58:46,661 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:46,662 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:58:46,662 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:46,664 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:58:46,664 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:58:46,665 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:46,665 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:58:46,666 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:46,666 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:46,667 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:46,668 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:58:46,668 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:58:46,668 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:58:46,668 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:58:46,668 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:58:46,669 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:58:46,674 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:58:46,674 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:58:46,674 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:58:46,674 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:58:46,675 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:58:46,675 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:58:46,675 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:46,675 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:58:46,676 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:46,676 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:46,677 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:46,677 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:58:46,677 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:58:46,677 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:58:46,677 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:58:46,684 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:58:46,684 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:46,686 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:46,686 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:58:46,688 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:46,688 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:46,689 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:46,689 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:46,705 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.4834, Threshold=0.5056, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:58:46,705 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.4834
2025-08-04 20:58:51,963 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:51,963 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:58:51,963 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:58:51,963 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:58:51,963 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:58:51,964 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:52,316 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:52,316 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:52,408 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:58:52,449 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:58:52,449 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:52,606 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:52,612 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:52,613 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:52,618 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:58:52,624 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:52,624 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:58:52,624 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:52,624 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:52,624 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:58:52,634 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:52,637 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:52,639 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:52,641 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:52,644 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:52,646 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:52,648 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:52,651 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:52,654 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:52,655 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:52,659 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:52,670 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:52,670 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:58:52,675 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:58:52,675 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:58:52,680 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:52,680 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:58:52,690 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:52,690 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:58:52,690 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:52,709 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:52,714 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:58:52,719 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:58:52,719 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:52,719 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:52,720 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:52,720 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:52,720 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:52,720 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:58:52,721 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:52,721 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:58:52,721 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:52,722 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:58:52,722 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:58:52,723 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:52,723 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:58:52,723 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:52,723 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:52,724 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:52,724 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:58:52,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:58:52,724 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:58:52,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:58:52,724 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:58:52,724 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:58:52,727 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:58:52,727 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:58:52,727 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:58:52,727 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:58:52,727 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:58:52,727 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:58:52,727 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:52,728 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:58:52,728 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:52,728 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:52,728 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:52,728 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:58:52,729 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:58:52,729 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:58:52,729 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:58:52,735 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:58:52,736 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:52,737 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:52,737 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:58:52,738 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 154/400.
2025-08-04 20:58:52,840 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:52,840 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:52,842 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2435 anomalous samples to GAN training data (target: 2435).
2025-08-04 20:58:52,843 - ClientAppLogger [Client 1] - INFO - [Client] Round 154: Training GAN with 10552 samples (8117 normal, 2435 anomalous).
2025-08-04 20:58:52,845 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:59:00,475 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0834, Avg D Loss: 0.7819
2025-08-04 20:59:00,476 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0834, Avg D Loss: 0.7819
2025-08-04 20:59:00,476 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:59:00,487 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5311, Threshold=0.5709, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:59:00,488 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:59:00,488 - ClientAppLogger [Client 1] - INFO - Fit completed for round 154. Duration: 7.75s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 154, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083418377716492, 'd_loss': 0.781886357846271, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.749513149261475, 'cpu_percent_fit': 12.4875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10552}
2025-08-04 20:59:00,488 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:59:05,755 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:05,755 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:05,755 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:05,755 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:59:05,755 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:59:05,755 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:06,144 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:06,144 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:06,239 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:59:06,287 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:59:06,288 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:06,438 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:06,444 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:06,444 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:06,450 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:59:06,456 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:06,456 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:59:06,457 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:06,457 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:06,457 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:59:06,466 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:06,469 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:06,472 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:06,474 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:06,477 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:06,479 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:06,482 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:06,485 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:06,488 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:06,490 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:06,492 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:06,504 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:06,505 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:59:06,510 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:59:06,510 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:59:06,520 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:06,520 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:59:06,542 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:06,542 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:59:06,543 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:06,561 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:06,566 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:59:06,582 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:59:06,582 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:06,582 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:06,582 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:06,582 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:06,583 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:06,583 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:59:06,583 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:06,583 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:59:06,583 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:06,585 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:59:06,585 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:59:06,586 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:06,586 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:59:06,586 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:06,586 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:06,586 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:06,587 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:59:06,587 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:59:06,587 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:59:06,587 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:59:06,587 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:59:06,588 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:59:06,591 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:59:06,592 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:59:06,592 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:59:06,592 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:59:06,592 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:59:06,592 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:59:06,592 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:06,592 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:59:06,593 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:06,596 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:06,596 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:06,596 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:59:06,597 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:59:06,597 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:59:06,597 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:59:06,604 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:59:06,604 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:06,605 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:06,605 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:06,607 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:06,607 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:06,608 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:06,608 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:06,621 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5438, Threshold=0.5854, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:59:06,621 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5438
2025-08-04 20:59:11,875 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:11,875 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:11,875 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:11,875 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:59:11,875 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:59:11,875 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:12,209 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:12,210 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:12,297 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:59:12,337 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:59:12,337 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:12,455 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:12,461 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:12,461 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:12,466 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:59:12,471 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:12,472 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:59:12,472 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:12,472 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:12,472 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:59:12,481 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:12,484 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:12,486 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:12,489 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:12,491 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:12,493 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:12,496 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:12,498 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:12,501 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:12,503 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:12,505 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:12,513 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:12,514 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:59:12,518 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:59:12,519 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:59:12,523 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:12,523 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:59:12,531 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:12,531 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:59:12,532 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:12,546 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:12,551 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:59:12,556 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:59:12,556 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:12,556 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:12,556 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:12,557 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:12,557 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:12,557 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:59:12,557 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:12,558 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:59:12,558 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:12,559 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:59:12,559 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:59:12,560 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:12,560 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:59:12,560 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:12,560 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:12,560 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:12,560 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:59:12,561 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:59:12,561 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:59:12,561 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:59:12,561 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:59:12,561 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:59:12,564 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:59:12,564 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:59:12,564 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:59:12,564 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:59:12,565 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:59:12,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:59:12,565 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:12,565 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:59:12,565 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:12,566 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:12,566 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:12,566 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:59:12,566 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:59:12,566 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:59:12,566 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:59:12,570 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:59:12,570 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:12,571 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:12,571 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:12,573 - ClientAppLogger [Client 1] - INFO - [Client] Fit started for round 155/400.
2025-08-04 20:59:12,674 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:12,674 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:12,676 - ClientAppLogger [Client 1] - INFO - [Client] Semi-supervised: Added 2448 anomalous samples to GAN training data (target: 2448).
2025-08-04 20:59:12,677 - ClientAppLogger [Client 1] - INFO - [Client] Round 155: Training GAN with 10610 samples (8162 normal, 2448 anomalous).
2025-08-04 20:59:12,677 - ClientAppLogger [Client 1] - INFO - [Client] Starting GAN training...
2025-08-04 20:59:20,235 - ClientAppLogger [Client 1] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0835, Avg D Loss: 0.7798
2025-08-04 20:59:20,235 - ClientAppLogger [Client 1] - INFO - GAN Training completed. Avg G Loss: 2.0835, Avg D Loss: 0.7798
2025-08-04 20:59:20,236 - ClientAppLogger [Client 1] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:59:20,248 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5367, Threshold=0.5744, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:59:20,248 - ClientAppLogger [Client 1] - INFO - [Client] Post-fit local evaluation F1: 0.8086
2025-08-04 20:59:20,248 - ClientAppLogger [Client 1] - INFO - Fit completed for round 155. Duration: 7.68s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '1', 'server_round': 155, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083462288521237, 'd_loss': 0.7797942397529286, 'post_fit_local_f1': 0.8085808580858086, 'fit_time_seconds': 7.675299167633057, 'cpu_percent_fit': 12.49375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 10610}
2025-08-04 20:59:20,248 - ClientAppLogger [Client 1] - INFO - [Client] get_parameters called
2025-08-04 20:59:25,523 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:25,523 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:25,523 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:25,523 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:59:25,524 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:59:25,524 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:25,912 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:25,912 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:26,007 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:59:26,050 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:59:26,050 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:26,199 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:26,207 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:26,207 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:26,213 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:59:26,221 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:26,222 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:59:26,222 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:26,223 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:26,223 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:59:26,233 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:26,236 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:26,238 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:26,240 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:26,243 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:26,246 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:26,248 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:26,251 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:26,254 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:26,256 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:26,258 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:26,270 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:26,270 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:59:26,275 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:59:26,275 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:59:26,281 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:26,281 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:59:26,294 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:26,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:59:26,295 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:26,314 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:26,321 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:59:26,335 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:59:26,338 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:26,338 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:26,338 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:26,339 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:26,339 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:26,339 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:59:26,340 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:26,340 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:59:26,340 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:26,341 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:59:26,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:59:26,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:26,342 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:59:26,342 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:26,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:26,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:26,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:59:26,343 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:59:26,343 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:59:26,344 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:59:26,344 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:59:26,344 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:59:26,350 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:59:26,350 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:59:26,350 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:59:26,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:59:26,351 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:59:26,351 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:59:26,351 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:26,352 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:59:26,353 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:26,353 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:26,353 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:26,354 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:59:26,354 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:59:26,354 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:59:26,354 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:59:26,359 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:59:26,359 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:26,361 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:26,361 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:26,363 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:26,363 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:26,363 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:26,364 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:26,381 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5365, Threshold=0.5742, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:59:26,381 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5365
2025-08-04 20:59:37,654 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:37,654 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:37,655 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:37,655 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:59:37,655 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:59:37,655 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:38,026 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:38,026 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:38,117 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:59:38,159 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:59:38,159 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:38,333 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:38,340 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:38,340 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:38,352 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:59:38,359 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:38,360 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:59:38,360 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:38,360 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:38,360 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:59:38,369 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:38,372 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:38,374 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:38,376 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:38,379 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:38,381 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:38,384 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:38,386 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:38,390 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:38,392 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:38,394 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:38,405 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:38,405 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:59:38,411 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:59:38,411 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:59:38,419 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:38,419 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:59:38,434 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:38,436 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:59:38,438 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:38,456 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:38,463 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:59:38,471 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:59:38,471 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:38,471 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:38,472 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:38,472 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:38,473 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:38,473 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:59:38,473 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:38,473 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:59:38,473 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:38,475 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:59:38,475 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:59:38,475 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:38,476 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:59:38,476 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:38,476 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:38,476 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:38,477 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:59:38,477 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:59:38,477 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:59:38,477 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:59:38,477 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:59:38,477 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:59:38,481 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:59:38,481 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:59:38,482 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:59:38,482 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:59:38,482 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:59:38,482 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:59:38,483 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:38,483 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:59:38,483 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:38,484 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:38,484 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:38,484 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:59:38,484 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:59:38,484 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:59:38,485 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:59:38,491 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:59:38,491 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:38,492 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:38,493 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:38,494 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:38,494 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:38,494 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:38,495 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:38,509 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5131, Threshold=0.5636, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:59:38,509 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5131
2025-08-04 20:59:52,816 - ClientAppLogger [Client 1] - INFO - ClientApp starting for partition_id: 1. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:52,816 - ClientAppLogger [Client 1] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:52,816 - ClientAppLogger [Client 1] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:52,816 - ClientAppLogger [Client 1] - INFO - Loading data for partition 1/10...
2025-08-04 20:59:52,816 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting load_data function.
2025-08-04 20:59:52,817 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:53,149 - ClientAppLogger [Client 1] - INFO - [LoadData 1] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:53,149 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:53,240 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Numeric conversion completed.
2025-08-04 20:59:53,281 - ClientAppLogger [Client 1] - INFO - [LoadData 1] NA values filled.
2025-08-04 20:59:53,281 - ClientAppLogger [Client 1] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:53,422 - ClientAppLogger [Client 1] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:53,430 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:53,430 - ClientAppLogger [Client 1] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:53,438 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Scaler fitting process completed.
2025-08-04 20:59:53,445 - ClientAppLogger [Client 1] - INFO - [LoadData 1] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:53,445 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting semi-supervised data splitting logic.
2025-08-04 20:59:53,446 - ClientAppLogger [Client 1] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:53,446 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:53,446 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting anomaly reduction logic.
2025-08-04 20:59:53,455 - ClientAppLogger [Client 1] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:53,459 - ClientAppLogger [Client 1] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:53,461 - ClientAppLogger [Client 1] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:53,463 - ClientAppLogger [Client 1] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:53,466 - ClientAppLogger [Client 1] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:53,468 - ClientAppLogger [Client 1] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:53,470 - ClientAppLogger [Client 1] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:53,473 - ClientAppLogger [Client 1] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:53,477 - ClientAppLogger [Client 1] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:53,479 - ClientAppLogger [Client 1] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:53,482 - ClientAppLogger [Client 1] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:53,492 - ClientAppLogger [Client 1] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:53,492 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Anomaly reduction logic completed.
2025-08-04 20:59:53,497 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Normal and anomaly indices shuffled.
2025-08-04 20:59:53,497 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating unlabeled training base.
2025-08-04 20:59:53,503 - ClientAppLogger [Client 1] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:53,503 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating labeled pool.
2025-08-04 20:59:53,514 - ClientAppLogger [Client 1] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:53,515 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Labeled pool creation completed.
2025-08-04 20:59:53,515 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:53,531 - ClientAppLogger [Client 1] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:53,536 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Combining data for final AE training set.
2025-08-04 20:59:53,551 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Final AE training data combination completed.
2025-08-04 20:59:53,551 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:53,551 - ClientAppLogger [Client 1] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:53,551 - ClientAppLogger [Client 1] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:53,552 - ClientAppLogger [Client 1] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:53,552 - ClientAppLogger [Client 1] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:53,553 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] START of partitioning block.
2025-08-04 20:59:53,553 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:53,553 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 1: Full indices created.
2025-08-04 20:59:53,553 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:53,555 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 2: Full indices shuffled.
2025-08-04 20:59:53,555 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Full indices shuffled.
2025-08-04 20:59:53,555 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:53,556 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Remainder distribution completed.
2025-08-04 20:59:53,556 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:53,556 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:53,556 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:53,556 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 6: Start indices calculated. train_start=117
2025-08-04 20:59:53,556 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Start indices calculated. Train_start=117, Val_start=575, Test_start=161
2025-08-04 20:59:53,557 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 7: End indices calculated. train_end=38291
2025-08-04 20:59:53,557 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: End indices calculated. Train_end=38291, Val_end=992, Test_end=387
2025-08-04 20:59:53,557 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 8: Partition-specific indices extracted. Num train indices: 38174
2025-08-04 20:59:53,557 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Specific indices extracted. Train idx: 38174, Val idx: 417, Test idx: 226
2025-08-04 20:59:53,561 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9a: Train data sliced for partition. X_train_part_full shape: (38174, 17)
2025-08-04 20:59:53,561 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Train data sliced. Shape: (38174, 17)
2025-08-04 20:59:53,561 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9b: Validation data sliced for partition. X_val_part shape: (417, 17)
2025-08-04 20:59:53,561 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Validation data sliced. Shape: (417, 17)
2025-08-04 20:59:53,562 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 9c: Test data sliced for partition. X_test_part shape: (226, 17)
2025-08-04 20:59:53,562 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Partitioning: Test data sliced. Shape: (226, 17)
2025-08-04 20:59:53,562 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:53,562 - ClientAppLogger [Client 1] - INFO - [LoadData 1] Creating TonIoTDataset objects.
2025-08-04 20:59:53,563 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:53,563 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:53,564 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:53,564 - ClientAppLogger [Client 1] - INFO - [LoadData 1] TonIoTDataset objects created.
2025-08-04 20:59:53,564 - ClientAppLogger [Client 1] - INFO - Partition 1 (Static Datasets): Train Potential 38174, Val 417, Test 226
2025-08-04 20:59:53,564 - ClientAppLogger [Client 1] - INFO - [Partitioning Debug 1] END of partitioning block, returning datasets.
2025-08-04 20:59:53,564 - ClientAppLogger [Client 1] - INFO - [LoadData 1] load_data function completed.
2025-08-04 20:59:53,570 - ClientAppLogger [Client 1] - INFO - Data loaded for partition 1: Train samples: 38174, Val samples: 417
2025-08-04 20:59:53,570 - ClientAppLogger [Client 1] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:53,572 - ClientAppLogger [Client 1] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:53,572 - ClientAppLogger [Client 1] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:53,573 - ClientAppLogger [Client 1] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:53,574 - ClientAppLogger [Client 1] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:53,574 - ClientAppLogger [Client 1] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:53,574 - ClientAppLogger [Client 1] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:53,587 - ClientAppLogger [Client 1] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=417, Avg Anomaly Score (all samples)=0.5199, Threshold=0.5509, Accuracy=0.7218, F1=0.8086, Precision=0.9800, Recall=0.6882
2025-08-04 20:59:53,587 - ClientAppLogger [Client 1] - INFO - [Client] Evaluation finished. Samples: 417, Acc: 0.7218, F1: 0.8086, Prec: 0.9800, Rec: 0.6882, Avg Anomaly Score: 0.5199
