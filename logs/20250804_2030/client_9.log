2025-08-04 20:30:06,025 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:06,025 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:30:06,025 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:30:06,026 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:30:06,026 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:30:06,026 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:06,325 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:06,325 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:06,418 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:30:06,442 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:30:06,443 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:06,559 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:06,570 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:06,570 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:06,584 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:30:06,596 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:06,596 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:30:06,597 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:06,597 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:06,597 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:30:06,607 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:06,611 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:06,614 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:06,616 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:06,618 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:06,621 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:06,623 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:06,626 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:06,628 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:06,631 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:06,633 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:06,644 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:06,645 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:30:06,650 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:30:06,650 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:30:06,657 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:06,657 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:30:06,672 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:06,672 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:30:06,672 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:06,692 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:06,699 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:30:06,707 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:30:06,707 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:06,707 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:06,707 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:06,708 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:06,708 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:06,708 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:30:06,708 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:06,709 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:30:06,709 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:06,710 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:30:06,710 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:30:06,711 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:06,711 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:30:06,711 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:06,711 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:06,711 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:06,711 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:30:06,712 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:30:06,712 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:30:06,712 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:30:06,712 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:30:06,712 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:30:06,715 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:30:06,715 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:30:06,716 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:30:06,716 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:30:06,716 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:30:06,716 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:30:06,716 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:06,716 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:30:06,717 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:06,717 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:06,717 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:06,718 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:30:06,718 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:30:06,718 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:30:06,718 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:30:06,719 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:30:06,719 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:06,721 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:06,724 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:30:06,726 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:06,726 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:06,726 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:06,727 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:06,740 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3509, Threshold=0.3660, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:30:06,740 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3509
2025-08-04 20:30:21,020 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:21,020 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:30:21,020 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:30:21,020 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:30:21,020 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:30:21,020 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:21,276 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:21,277 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:21,372 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:30:21,419 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:30:21,419 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:21,535 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:21,544 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:21,544 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:21,551 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:30:21,559 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:21,559 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:30:21,559 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:21,560 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:21,560 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:30:21,569 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:21,572 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:21,574 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:21,577 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:21,579 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:21,582 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:21,584 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:21,587 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:21,590 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:21,592 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:21,595 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:21,607 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:21,607 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:30:21,612 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:30:21,612 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:30:21,617 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:21,617 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:30:21,629 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:21,630 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:30:21,630 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:21,649 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:21,655 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:30:21,660 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:30:21,660 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:21,661 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:21,661 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:21,661 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:21,661 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:21,662 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:30:21,662 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:21,662 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:30:21,662 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:21,663 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:30:21,663 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:30:21,664 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:21,664 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:30:21,664 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:21,664 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:21,664 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:21,665 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:30:21,665 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:30:21,665 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:30:21,665 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:30:21,665 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:30:21,665 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:30:21,666 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:30:21,666 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:30:21,667 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:30:21,667 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:30:21,667 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:30:21,667 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:30:21,667 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:21,667 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:30:21,668 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:21,668 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:21,668 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:21,669 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:30:21,669 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:30:21,669 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:30:21,669 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:30:21,673 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:30:21,673 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:21,675 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:21,675 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:30:21,676 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:21,677 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:21,677 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:21,677 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:21,690 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3407, Threshold=0.3557, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:30:21,691 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3407
2025-08-04 20:30:32,970 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:32,970 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:30:32,970 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:30:32,970 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:30:32,971 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:30:32,971 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:33,270 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:33,270 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:33,361 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:30:33,408 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:30:33,408 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:33,573 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:33,582 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:33,582 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:33,589 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:30:33,605 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:33,605 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:30:33,606 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:33,606 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:33,606 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:30:33,617 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:33,620 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:33,622 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:33,625 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:33,628 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:33,630 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:33,632 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:33,635 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:33,638 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:33,641 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:33,644 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:33,658 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:33,658 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:30:33,664 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:30:33,664 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:30:33,672 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:33,673 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:30:33,687 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:33,687 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:30:33,688 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:33,706 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:33,713 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:30:33,726 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:30:33,726 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:33,727 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:33,727 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:33,727 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:33,727 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:33,728 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:30:33,728 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:33,728 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:30:33,728 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:33,729 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:30:33,730 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:30:33,730 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:33,730 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:30:33,730 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:33,730 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:33,731 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:33,731 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:30:33,731 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:30:33,731 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:30:33,731 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:30:33,731 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:30:33,731 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:30:33,734 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:30:33,734 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:30:33,735 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:30:33,735 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:30:33,735 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:30:33,735 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:30:33,735 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:33,736 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:30:33,736 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:33,736 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:33,737 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:33,737 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:30:33,737 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:30:33,737 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:30:33,737 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:30:33,744 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:30:33,744 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:33,746 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:33,746 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:30:33,748 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:33,748 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:33,748 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:33,749 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:33,764 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3482, Threshold=0.3661, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:30:33,764 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3482
2025-08-04 20:30:48,035 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:48,035 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:30:48,035 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:30:48,036 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:30:48,036 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:30:48,036 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:48,348 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:48,349 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:48,444 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:30:48,493 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:30:48,493 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:48,631 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:48,639 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:48,639 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:48,647 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:30:48,654 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:48,655 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:30:48,655 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:48,655 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:48,656 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:30:48,666 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:48,669 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:48,671 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:48,673 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:48,677 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:48,680 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:48,684 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:48,687 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:48,692 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:48,695 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:48,699 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:48,714 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:48,714 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:30:48,720 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:30:48,721 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:30:48,728 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:48,728 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:30:48,747 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:48,748 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:30:48,748 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:48,770 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:48,782 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:30:48,793 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:30:48,794 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:48,794 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:48,794 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:48,795 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:48,796 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:48,796 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:30:48,797 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:48,797 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:30:48,798 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:48,800 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:30:48,801 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:30:48,801 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:48,802 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:30:48,802 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:48,802 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:48,803 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:48,804 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:30:48,804 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:30:48,805 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:30:48,805 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:30:48,806 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:30:48,806 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:30:48,809 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:30:48,809 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:30:48,810 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:30:48,810 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:30:48,810 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:30:48,810 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:30:48,810 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:48,810 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:30:48,811 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:48,812 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:48,812 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:48,812 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:30:48,813 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:30:48,813 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:30:48,813 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:30:48,817 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:30:48,817 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:48,819 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:48,819 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:30:48,821 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:48,821 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:48,821 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:48,822 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:48,836 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3392, Threshold=0.3556, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:30:48,837 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3392
2025-08-04 20:31:06,127 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:06,127 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:31:06,128 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:31:06,128 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:31:06,128 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:31:06,128 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:06,378 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:06,378 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:06,482 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:31:06,515 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:31:06,515 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:06,652 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:06,661 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:06,661 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:06,669 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:31:06,677 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:06,678 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:31:06,678 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:06,679 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:06,679 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:31:06,691 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:06,694 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:06,696 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:06,698 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:06,701 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:06,704 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:06,707 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:06,709 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:06,712 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:06,715 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:06,717 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:06,730 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:06,730 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:31:06,736 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:31:06,736 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:31:06,742 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:06,742 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:31:06,754 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:06,755 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:31:06,755 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:06,772 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:06,777 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:31:06,798 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:31:06,798 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:06,798 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:06,798 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:06,799 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:06,799 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:06,800 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:31:06,801 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:06,801 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:31:06,801 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:06,803 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:31:06,804 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:31:06,804 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:06,804 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:31:06,805 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:06,805 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:06,805 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:06,805 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:31:06,805 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:31:06,806 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:31:06,806 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:31:06,806 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:31:06,807 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:31:06,810 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:31:06,810 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:31:06,812 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:31:06,812 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:31:06,812 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:31:06,812 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:31:06,813 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:06,813 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:31:06,813 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:06,814 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:06,814 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:06,814 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:31:06,814 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:31:06,814 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:31:06,815 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:31:06,823 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:31:06,823 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:06,825 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:06,825 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:31:06,826 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:06,827 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:06,827 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:06,828 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:06,843 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3468, Threshold=0.3629, Accuracy=0.6962, F1=0.7894, Precision=0.9507, Recall=0.6749
2025-08-04 20:31:06,843 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6962, F1: 0.7894, Prec: 0.9507, Rec: 0.6749, Avg Anomaly Score: 0.3468
2025-08-04 20:31:24,119 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:24,127 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:31:24,127 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:31:24,127 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:31:24,127 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:31:24,127 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:24,365 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:24,365 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:24,461 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:31:24,501 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:31:24,501 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:24,629 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:24,638 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:24,638 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:24,646 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:31:24,652 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:24,653 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:31:24,653 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:24,653 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:24,654 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:31:24,663 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:24,666 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:24,668 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:24,670 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:24,673 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:24,675 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:24,678 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:24,681 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:24,683 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:24,685 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:24,687 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:24,698 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:24,698 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:31:24,703 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:31:24,703 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:31:24,708 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:24,708 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:31:24,716 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:24,717 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:31:24,717 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:24,734 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:24,739 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:31:24,744 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:31:24,745 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:24,745 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:24,745 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:24,745 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:24,745 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:24,746 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:31:24,746 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:24,746 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:31:24,746 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:24,748 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:31:24,748 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:31:24,748 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:24,748 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:31:24,748 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:24,749 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:24,749 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:24,749 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:31:24,749 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:31:24,749 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:31:24,750 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:31:24,750 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:31:24,750 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:31:24,752 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:31:24,752 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:31:24,752 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:31:24,753 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:31:24,753 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:31:24,753 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:31:24,753 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:24,753 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:31:24,754 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:24,754 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:24,754 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:24,754 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:31:24,754 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:31:24,755 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:31:24,755 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:31:24,758 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:31:24,758 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:24,760 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:24,760 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:31:24,762 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:24,762 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:24,762 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:24,763 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:24,776 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3490, Threshold=0.3636, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:31:24,776 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3490
2025-08-04 20:31:36,050 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:36,050 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:31:36,050 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:31:36,050 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:31:36,050 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:31:36,050 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:36,277 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:36,277 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:36,367 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:31:36,383 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:31:36,383 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:36,473 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:36,480 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:36,480 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:36,486 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:31:36,492 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:36,493 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:31:36,493 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:36,493 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:36,494 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:31:36,502 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:36,505 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:36,507 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:36,510 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:36,513 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:36,515 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:36,517 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:36,520 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:36,523 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:36,525 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:36,528 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:36,537 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:36,537 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:31:36,542 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:31:36,542 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:31:36,549 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:36,549 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:31:36,561 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:36,562 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:31:36,562 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:36,579 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:36,584 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:31:36,592 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:31:36,592 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:36,592 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:36,592 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:36,593 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:36,593 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:36,593 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:31:36,593 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:36,594 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:31:36,594 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:36,595 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:31:36,595 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:31:36,596 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:36,596 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:31:36,596 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:36,596 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:36,597 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:36,597 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:31:36,597 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:31:36,597 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:31:36,597 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:31:36,598 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:31:36,598 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:31:36,600 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:31:36,600 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:31:36,600 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:31:36,600 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:31:36,601 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:31:36,601 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:31:36,601 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:36,601 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:31:36,602 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:36,602 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:36,602 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:36,602 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:31:36,603 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:31:36,603 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:31:36,603 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:31:36,604 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:31:36,604 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:36,606 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:36,606 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:31:36,607 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:36,607 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:36,608 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:36,608 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:36,622 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3284, Threshold=0.3417, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:31:36,622 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3284
2025-08-04 20:31:47,891 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:47,892 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:31:47,892 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:31:47,892 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:31:47,892 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:31:47,892 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:48,154 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:48,155 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:48,239 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:31:48,283 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:31:48,283 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:48,389 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:48,397 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:48,397 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:48,405 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:31:48,414 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:48,414 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:31:48,415 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:48,415 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:48,415 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:31:48,426 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:48,429 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:48,431 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:48,433 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:48,436 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:48,438 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:48,441 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:48,443 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:48,446 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:48,448 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:48,450 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:48,460 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:48,460 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:31:48,465 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:31:48,465 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:31:48,470 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:48,470 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:31:48,479 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:48,479 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:31:48,479 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:48,494 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:48,498 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:31:48,504 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:31:48,504 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:48,504 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:48,504 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:48,505 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:48,505 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:48,505 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:31:48,505 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:48,506 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:31:48,506 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:48,507 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:31:48,507 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:31:48,508 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:48,508 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:31:48,508 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:48,508 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:48,508 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:48,509 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:31:48,509 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:31:48,509 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:31:48,509 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:31:48,509 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:31:48,510 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:31:48,512 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:31:48,512 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:31:48,512 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:31:48,512 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:31:48,513 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:31:48,513 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:31:48,513 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:48,513 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:31:48,514 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:48,514 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:48,514 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:48,514 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:31:48,515 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:31:48,515 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:31:48,515 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:31:48,520 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:31:48,520 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:48,522 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:48,522 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:31:48,523 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:48,523 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:48,524 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:48,524 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:48,538 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3484, Threshold=0.3639, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:31:48,539 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3484
2025-08-04 20:31:56,835 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:56,835 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:31:56,835 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:31:56,836 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:31:56,836 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:31:56,836 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:57,122 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:57,122 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:57,210 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:31:57,252 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:31:57,252 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:57,373 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:57,379 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:57,379 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:57,385 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:31:57,392 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:57,392 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:31:57,393 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:57,393 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:57,393 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:31:57,401 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:57,404 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:57,406 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:57,408 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:57,411 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:57,413 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:57,416 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:57,418 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:57,421 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:57,423 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:57,425 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:57,434 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:57,435 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:31:57,439 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:31:57,439 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:31:57,444 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:57,444 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:31:57,456 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:57,457 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:31:57,457 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:57,472 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:57,477 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:31:57,482 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:31:57,483 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:57,483 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:57,483 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:57,483 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:57,483 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:57,483 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:31:57,484 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:57,484 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:31:57,484 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:57,485 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:31:57,486 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:31:57,486 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:57,486 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:31:57,486 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:57,486 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:57,487 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:57,487 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:31:57,487 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:31:57,487 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:31:57,487 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:31:57,487 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:31:57,487 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:31:57,488 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:31:57,489 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:31:57,489 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:31:57,489 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:31:57,489 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:31:57,489 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:31:57,489 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:57,490 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:31:57,490 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:57,490 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:57,490 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:57,491 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:31:57,491 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:31:57,491 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:31:57,491 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:31:57,494 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:31:57,494 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:57,496 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:57,496 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:31:57,497 - ClientAppLogger [Client 9] - INFO - [Client] Fit started for round 49/400.
2025-08-04 20:31:57,598 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:57,599 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:57,600 - ClientAppLogger [Client 9] - INFO - [Client] Semi-supervised: Added 356 anomalous samples to GAN training data (target: 356).
2025-08-04 20:31:57,600 - ClientAppLogger [Client 9] - INFO - [Client] Round 49: Training GAN with 1545 samples (1189 normal, 356 anomalous).
2025-08-04 20:31:57,601 - ClientAppLogger [Client 9] - INFO - [Client] Starting GAN training...
2025-08-04 20:31:58,742 - ClientAppLogger [Client 9] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0860, Avg D Loss: 0.8760
2025-08-04 20:31:58,742 - ClientAppLogger [Client 9] - INFO - GAN Training completed. Avg G Loss: 2.0860, Avg D Loss: 0.8760
2025-08-04 20:31:58,742 - ClientAppLogger [Client 9] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:31:58,755 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3587, Threshold=0.3782, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:31:58,756 - ClientAppLogger [Client 9] - INFO - [Client] Post-fit local evaluation F1: 0.7870
2025-08-04 20:31:58,756 - ClientAppLogger [Client 9] - INFO - Fit completed for round 49. Duration: 1.26s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '9', 'server_round': 49, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.086016726848763, 'd_loss': 0.8759576794514763, 'post_fit_local_f1': 0.7870036101083032, 'fit_time_seconds': 1.2586514949798584, 'cpu_percent_fit': 6.2625, 'ram_mb_fit': 3.05859375, 'accumulated_train_samples_this_round': 1545}
2025-08-04 20:31:58,756 - ClientAppLogger [Client 9] - INFO - [Client] get_parameters called
2025-08-04 20:32:04,021 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:04,021 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:32:04,022 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:32:04,022 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:32:04,022 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:32:04,022 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:04,419 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:04,419 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:04,507 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:32:04,533 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:32:04,533 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:04,639 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:04,649 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:04,649 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:04,659 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:32:04,669 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:04,669 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:32:04,670 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:04,670 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:04,670 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:32:04,679 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:04,682 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:04,684 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:04,686 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:04,690 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:04,692 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:04,695 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:04,697 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:04,704 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:04,709 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:04,711 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:04,726 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:04,727 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:32:04,732 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:32:04,733 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:32:04,739 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:04,739 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:32:04,752 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:04,752 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:32:04,752 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:04,773 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:04,779 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:32:04,794 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:32:04,794 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:04,794 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:04,795 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:04,795 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:04,797 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:04,797 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:32:04,797 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:04,798 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:32:04,798 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:04,800 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:32:04,801 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:32:04,801 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:04,801 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:32:04,801 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:04,802 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:04,802 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:04,802 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:32:04,802 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:32:04,802 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:32:04,802 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:32:04,803 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:32:04,803 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:32:04,805 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:32:04,806 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:32:04,806 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:32:04,806 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:32:04,806 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:32:04,807 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:32:04,807 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:04,807 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:32:04,808 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:04,808 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:04,808 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:04,808 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:32:04,808 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:32:04,809 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:32:04,809 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:32:04,814 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:32:04,814 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:04,816 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:04,816 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:32:04,818 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:04,818 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:04,818 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:04,819 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:04,834 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3523, Threshold=0.3730, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:32:04,834 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3523
2025-08-04 20:32:16,102 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:16,103 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:32:16,103 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:32:16,103 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:32:16,103 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:32:16,103 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:16,446 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:16,446 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:16,535 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:32:16,580 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:32:16,581 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:16,708 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:16,717 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:16,717 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:16,727 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:32:16,768 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:16,768 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:32:16,769 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:16,769 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:16,769 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:32:16,780 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:16,784 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:16,786 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:16,789 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:16,792 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:16,795 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:16,799 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:16,801 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:16,805 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:16,807 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:16,809 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:16,821 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:16,821 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:32:16,826 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:32:16,826 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:32:16,832 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:16,832 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:32:16,848 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:16,849 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:32:16,849 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:16,865 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:16,871 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:32:16,876 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:32:16,876 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:16,876 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:16,876 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:16,876 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:16,877 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:16,877 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:32:16,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:16,877 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:32:16,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:16,879 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:32:16,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:32:16,879 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:16,880 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:32:16,880 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:16,880 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:16,880 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:16,880 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:32:16,880 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:32:16,880 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:32:16,880 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:32:16,881 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:32:16,881 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:32:16,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:32:16,882 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:32:16,883 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:32:16,883 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:32:16,883 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:32:16,883 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:32:16,883 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:16,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:32:16,884 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:16,884 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:16,884 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:16,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:32:16,885 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:32:16,885 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:32:16,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:32:16,888 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:32:16,889 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:16,890 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:16,890 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:32:16,892 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:16,892 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:16,892 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:16,893 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:16,909 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3461, Threshold=0.3653, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:32:16,909 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3461
2025-08-04 20:32:31,196 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:31,196 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:32:31,196 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:32:31,197 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:32:31,197 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:32:31,197 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:31,606 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:31,606 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:31,708 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:32:31,760 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:32:31,760 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:31,894 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:31,901 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:31,901 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:31,906 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:32:31,911 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:31,911 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:32:31,912 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:31,912 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:31,912 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:32:31,920 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:31,923 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:31,925 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:31,927 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:31,930 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:31,932 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:31,935 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:31,937 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:31,940 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:31,942 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:31,944 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:31,954 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:31,954 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:32:31,959 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:32:31,960 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:32:31,964 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:31,964 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:32:31,973 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:31,974 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:32:31,974 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:31,990 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:31,995 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:32:32,004 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:32:32,004 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:32,004 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:32,004 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:32,005 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:32,005 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:32,005 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:32:32,005 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:32,006 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:32:32,006 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:32,007 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:32:32,007 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:32:32,008 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:32,008 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:32:32,008 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:32,008 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:32,008 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:32,009 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:32:32,009 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:32:32,009 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:32:32,009 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:32:32,009 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:32:32,009 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:32:32,010 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:32:32,010 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:32:32,011 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:32:32,011 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:32:32,011 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:32:32,011 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:32:32,012 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:32,012 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:32:32,012 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:32,012 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:32,012 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:32,013 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:32:32,013 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:32:32,013 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:32:32,013 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:32:32,019 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:32:32,019 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:32,020 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:32,020 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:32:32,021 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:32,021 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:32,022 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:32,022 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:32,034 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3534, Threshold=0.3755, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:32:32,035 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3534
2025-08-04 20:32:46,319 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:46,319 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:32:46,319 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:32:46,320 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:32:46,320 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:32:46,320 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:46,671 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:46,671 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:46,766 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:32:46,814 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:32:46,814 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:46,952 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:46,960 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:46,960 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:46,967 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:32:46,974 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:46,974 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:32:46,975 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:46,975 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:46,975 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:32:46,984 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:46,987 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:46,989 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:46,992 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:46,995 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:46,997 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:47,000 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:47,003 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:47,007 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:47,009 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:47,012 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:47,023 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:47,023 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:32:47,029 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:32:47,029 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:32:47,040 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:47,040 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:32:47,051 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:47,052 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:32:47,052 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:47,067 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:47,072 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:32:47,076 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:32:47,076 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:47,076 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:47,077 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:47,077 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:47,077 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:47,077 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:32:47,077 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:47,078 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:32:47,078 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:47,079 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:32:47,079 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:32:47,079 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:47,080 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:32:47,080 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:47,080 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:47,080 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:47,080 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:32:47,080 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:32:47,080 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:32:47,081 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:32:47,081 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:32:47,081 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:32:47,082 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:32:47,082 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:32:47,082 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:32:47,083 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:32:47,083 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:32:47,083 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:32:47,083 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:47,083 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:32:47,084 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:47,084 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:47,084 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:47,084 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:32:47,084 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:32:47,085 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:32:47,085 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:32:47,088 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:32:47,088 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:47,089 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:47,089 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:32:47,091 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:47,091 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:47,091 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:47,092 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:47,104 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3646, Threshold=0.3887, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:32:47,104 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3646
2025-08-04 20:32:52,367 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:52,368 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:32:52,368 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:32:52,368 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:32:52,368 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:32:52,368 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:52,640 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:52,640 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:52,727 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:32:52,769 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:32:52,770 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:52,878 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:52,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:52,885 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:52,894 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:32:52,902 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:52,902 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:32:52,903 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:52,903 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:52,903 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:32:52,914 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:52,917 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:52,919 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:52,922 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:52,924 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:52,927 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:52,929 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:52,932 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:52,935 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:52,937 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:52,939 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:52,949 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:52,949 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:32:52,955 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:32:52,955 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:32:52,960 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:52,960 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:32:52,971 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:52,971 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:32:52,971 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:52,988 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:52,993 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:32:53,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:32:53,002 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:53,002 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:53,002 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:53,003 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:53,003 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:53,003 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:32:53,003 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:53,003 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:32:53,004 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:53,005 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:32:53,005 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:32:53,005 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:53,006 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:32:53,006 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:53,006 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:53,006 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:53,006 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:32:53,007 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:32:53,007 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:32:53,007 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:32:53,007 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:32:53,007 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:32:53,009 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:32:53,009 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:32:53,009 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:32:53,009 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:32:53,010 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:32:53,010 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:32:53,010 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:53,010 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:32:53,011 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:53,011 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:53,011 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:53,011 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:32:53,012 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:32:53,012 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:32:53,012 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:32:53,015 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:32:53,015 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:53,017 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:53,017 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:32:53,019 - ClientAppLogger [Client 9] - INFO - [Client] Fit started for round 53/400.
2025-08-04 20:32:53,120 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:53,120 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:53,122 - ClientAppLogger [Client 9] - INFO - [Client] Semi-supervised: Added 383 anomalous samples to GAN training data (target: 383).
2025-08-04 20:32:53,123 - ClientAppLogger [Client 9] - INFO - [Client] Round 53: Training GAN with 1660 samples (1277 normal, 383 anomalous).
2025-08-04 20:32:53,123 - ClientAppLogger [Client 9] - INFO - [Client] Starting GAN training...
2025-08-04 20:32:54,346 - ClientAppLogger [Client 9] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0860, Avg D Loss: 0.8705
2025-08-04 20:32:54,346 - ClientAppLogger [Client 9] - INFO - GAN Training completed. Avg G Loss: 2.0860, Avg D Loss: 0.8705
2025-08-04 20:32:54,347 - ClientAppLogger [Client 9] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:32:54,359 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3694, Threshold=0.3950, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:32:54,360 - ClientAppLogger [Client 9] - INFO - [Client] Post-fit local evaluation F1: 0.7870
2025-08-04 20:32:54,360 - ClientAppLogger [Client 9] - INFO - Fit completed for round 53. Duration: 1.34s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '9', 'server_round': 53, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.085992469327995, 'd_loss': 0.8704924001751178, 'post_fit_local_f1': 0.7870036101083032, 'fit_time_seconds': 1.3410999774932861, 'cpu_percent_fit': 6.25, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 1660}
2025-08-04 20:32:54,360 - ClientAppLogger [Client 9] - INFO - [Client] get_parameters called
2025-08-04 20:33:02,638 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:02,638 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:33:02,638 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:33:02,638 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:33:02,639 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:33:02,639 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:02,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:02,899 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:02,994 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:33:03,043 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:33:03,043 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:03,188 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:03,195 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:03,195 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:03,201 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:33:03,209 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:03,209 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:33:03,210 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:03,210 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:03,210 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:33:03,219 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:03,222 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:03,224 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:03,226 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:03,229 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:03,231 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:03,234 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:03,236 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:03,239 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:03,241 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:03,243 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:03,253 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:03,254 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:33:03,259 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:33:03,259 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:33:03,264 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:03,264 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:33:03,273 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:03,273 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:33:03,273 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:03,288 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:03,293 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:33:03,298 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:33:03,298 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:03,298 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:03,298 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:03,299 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:03,299 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:03,299 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:33:03,299 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:03,300 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:33:03,300 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:03,301 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:33:03,301 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:33:03,302 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:03,302 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:33:03,302 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:03,302 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:03,302 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:03,302 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:33:03,303 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:33:03,303 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:33:03,303 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:33:03,303 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:33:03,303 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:33:03,304 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:33:03,305 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:33:03,305 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:33:03,305 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:33:03,305 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:33:03,305 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:33:03,305 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:03,305 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:33:03,306 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:03,306 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:03,306 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:03,306 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:33:03,307 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:33:03,307 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:33:03,307 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:33:03,312 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:33:03,313 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:03,314 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:03,314 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:33:03,315 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:03,316 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:03,316 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:03,316 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:03,331 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3658, Threshold=0.3918, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:33:03,331 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3658
2025-08-04 20:33:14,609 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:14,609 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:33:14,609 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:33:14,609 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:33:14,609 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:33:14,609 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:14,891 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:14,892 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:14,979 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:33:15,020 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:33:15,020 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:15,121 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:15,127 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:15,127 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:15,133 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:33:15,194 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:15,194 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:33:15,194 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:15,194 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:15,195 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:33:15,203 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:15,206 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:15,208 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:15,210 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:15,213 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:15,215 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:15,218 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:15,220 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:15,223 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:15,225 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:15,227 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:15,236 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:15,237 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:33:15,241 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:33:15,241 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:33:15,247 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:15,247 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:33:15,257 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:15,258 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:33:15,258 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:15,274 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:15,279 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:33:15,284 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:33:15,285 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:15,285 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:15,285 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:15,285 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:15,285 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:15,286 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:33:15,286 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:15,286 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:33:15,286 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:15,287 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:33:15,287 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:33:15,288 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:15,288 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:33:15,288 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:15,288 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:15,289 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:15,289 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:33:15,289 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:33:15,289 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:33:15,289 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:33:15,289 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:33:15,290 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:33:15,291 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:33:15,291 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:33:15,291 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:33:15,291 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:33:15,291 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:33:15,291 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:33:15,291 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:15,292 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:33:15,292 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:15,292 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:15,292 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:15,292 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:33:15,293 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:33:15,293 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:33:15,293 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:33:15,302 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:33:15,302 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:15,304 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:15,304 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:33:15,305 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:15,305 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:15,305 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:15,306 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:15,318 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3506, Threshold=0.3746, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:33:15,319 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3506
2025-08-04 20:33:29,605 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:29,605 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:33:29,605 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:33:29,605 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:33:29,606 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:33:29,606 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:29,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:29,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:29,971 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:33:30,013 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:33:30,013 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:30,129 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:30,136 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:30,136 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:30,144 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:33:30,152 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:30,152 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:33:30,153 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:30,153 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:30,153 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:33:30,161 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:30,164 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:30,166 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:30,168 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:30,171 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:30,173 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:30,176 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:30,178 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:30,181 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:30,183 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:30,185 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:30,195 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:30,195 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:33:30,200 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:33:30,200 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:33:30,205 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:30,205 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:33:30,213 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:30,213 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:33:30,214 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:30,228 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:30,232 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:33:30,238 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:33:30,238 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:30,238 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:30,238 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:30,239 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:30,239 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:30,239 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:33:30,239 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:30,240 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:33:30,240 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:30,241 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:33:30,241 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:33:30,242 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:30,242 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:33:30,242 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:30,242 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:30,242 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:30,242 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:33:30,242 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:33:30,242 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:33:30,243 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:33:30,243 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:33:30,243 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:33:30,244 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:33:30,245 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:33:30,245 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:33:30,245 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:33:30,245 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:33:30,245 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:33:30,245 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:30,246 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:33:30,246 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:30,246 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:30,246 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:30,247 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:33:30,247 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:33:30,247 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:33:30,247 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:33:30,251 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:33:30,251 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:30,252 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:30,252 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:33:30,253 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:30,253 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:30,254 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:30,255 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:30,267 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3291, Threshold=0.3484, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:33:30,267 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3291
2025-08-04 20:33:47,580 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:47,580 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:33:47,580 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:33:47,580 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:33:47,580 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:33:47,581 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:47,855 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:47,855 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:47,946 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:33:47,972 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:33:47,973 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:48,090 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:48,096 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:48,096 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:48,102 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:33:48,108 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:48,108 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:33:48,109 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:48,109 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:48,109 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:33:48,120 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:48,123 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:48,125 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:48,127 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:48,130 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:48,132 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:48,135 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:48,137 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:48,140 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:48,141 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:48,144 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:48,153 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:48,154 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:33:48,158 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:33:48,159 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:33:48,163 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:48,163 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:33:48,172 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:48,172 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:33:48,172 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:48,187 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:48,192 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:33:48,196 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:33:48,197 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:48,197 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:48,197 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:48,197 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:48,197 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:48,198 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:33:48,198 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:48,198 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:33:48,198 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:48,199 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:33:48,199 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:33:48,200 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:48,200 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:33:48,200 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:48,200 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:48,201 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:48,201 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:33:48,201 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:33:48,201 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:33:48,201 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:33:48,201 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:33:48,201 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:33:48,203 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:33:48,203 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:33:48,203 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:33:48,203 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:33:48,203 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:33:48,204 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:33:48,204 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:48,204 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:33:48,204 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:48,205 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:48,205 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:48,205 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:33:48,205 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:33:48,206 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:33:48,206 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:33:48,210 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:33:48,210 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:48,212 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:48,212 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:33:48,213 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:48,214 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:48,214 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:48,214 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:48,228 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3656, Threshold=0.3916, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:33:48,228 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3656
2025-08-04 20:33:59,505 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:59,505 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:33:59,505 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:33:59,505 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:33:59,505 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:33:59,505 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:59,761 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:59,762 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:59,849 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:33:59,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:33:59,895 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:00,011 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:00,019 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:00,019 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:00,026 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:34:00,032 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:00,032 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:34:00,032 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:00,032 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:00,033 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:34:00,041 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:00,044 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:00,046 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:00,048 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:00,051 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:00,053 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:00,056 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:00,058 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:00,061 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:00,063 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:00,065 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:00,074 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:00,074 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:34:00,079 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:34:00,079 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:34:00,084 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:00,084 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:34:00,093 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:00,093 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:34:00,093 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:00,109 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:00,114 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:34:00,122 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:34:00,122 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:00,122 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:00,123 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:00,123 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:00,123 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:00,123 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:34:00,124 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:00,124 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:34:00,124 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:00,125 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:34:00,125 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:34:00,126 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:00,126 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:34:00,126 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:00,126 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:00,126 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:00,126 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:34:00,127 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:34:00,127 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:34:00,127 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:34:00,127 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:34:00,127 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:34:00,129 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:34:00,129 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:34:00,129 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:34:00,130 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:34:00,130 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:34:00,130 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:34:00,130 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:00,130 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:34:00,131 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:00,131 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:00,131 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:00,131 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:34:00,131 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:34:00,132 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:34:00,132 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:34:00,135 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:34:00,135 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:00,137 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:00,137 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:34:00,138 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:00,138 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:00,138 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:00,139 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:00,152 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3612, Threshold=0.3861, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:34:00,152 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3612
2025-08-04 20:34:11,419 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:11,419 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:34:11,419 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:34:11,419 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:34:11,419 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:34:11,419 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:11,690 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:11,690 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:11,779 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:34:11,805 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:34:11,805 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:11,948 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:11,954 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:11,954 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:11,960 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:34:11,966 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:11,966 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:34:11,967 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:11,967 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:11,967 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:34:11,976 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:11,979 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:11,982 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:11,984 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:11,987 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:11,989 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:11,991 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:11,994 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:11,996 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:11,998 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:12,001 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:12,010 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:12,010 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:34:12,015 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:34:12,016 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:34:12,020 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:12,021 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:34:12,030 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:12,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:34:12,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:12,046 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:12,050 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:34:12,055 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:34:12,055 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:12,055 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:12,055 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:12,056 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:12,056 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:12,056 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:34:12,056 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:12,057 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:34:12,057 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:12,058 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:34:12,058 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:34:12,059 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:12,059 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:34:12,059 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:12,059 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:12,059 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:12,059 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:34:12,059 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:34:12,060 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:34:12,060 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:34:12,060 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:34:12,060 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:34:12,061 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:34:12,061 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:34:12,061 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:34:12,061 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:34:12,062 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:34:12,062 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:34:12,062 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:12,062 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:34:12,062 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:12,062 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:12,063 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:12,063 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:34:12,063 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:34:12,063 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:34:12,063 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:34:12,069 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:34:12,069 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:12,070 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:12,070 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:34:12,072 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:12,072 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:12,072 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:12,073 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:12,085 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3710, Threshold=0.4015, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:34:12,085 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3710
2025-08-04 20:34:26,365 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:26,366 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:34:26,366 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:34:26,366 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:34:26,366 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:34:26,366 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:26,684 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:26,684 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:26,774 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:34:26,818 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:34:26,819 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:26,936 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:26,942 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:26,942 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:26,948 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:34:26,954 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:26,954 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:34:26,954 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:26,954 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:26,954 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:34:26,963 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:26,966 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:26,968 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:26,970 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:26,973 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:26,975 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:26,978 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:26,980 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:26,983 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:26,985 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:26,987 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:26,995 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:26,996 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:34:27,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:34:27,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:34:27,005 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:27,005 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:34:27,014 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:27,014 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:34:27,014 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:27,030 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:27,035 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:34:27,042 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:34:27,043 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:27,043 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:27,043 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:27,043 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:27,044 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:27,044 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:34:27,044 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:27,044 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:34:27,044 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:27,046 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:34:27,046 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:34:27,046 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:27,046 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:34:27,046 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:27,047 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:27,047 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:27,047 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:34:27,047 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:34:27,047 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:34:27,047 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:34:27,047 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:34:27,048 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:34:27,048 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:34:27,049 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:34:27,049 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:34:27,049 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:34:27,049 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:34:27,049 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:34:27,049 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:27,049 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:34:27,050 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:27,050 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:27,050 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:27,050 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:34:27,050 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:34:27,051 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:34:27,051 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:34:27,056 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:34:27,056 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:27,058 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:27,058 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:34:27,059 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:27,059 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:27,060 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:27,060 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:27,073 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3677, Threshold=0.3999, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:34:27,073 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3677
2025-08-04 20:34:38,345 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:38,345 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:34:38,345 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:34:38,345 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:34:38,345 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:34:38,345 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:38,658 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:38,658 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:38,749 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:34:38,774 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:34:38,774 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:38,867 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:38,873 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:38,873 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:38,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:34:38,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:38,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:34:38,896 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:38,896 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:38,896 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:34:38,904 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:38,907 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:38,909 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:38,911 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:38,914 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:38,916 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:38,919 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:38,921 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:38,924 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:38,925 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:38,928 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:38,937 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:38,937 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:34:38,941 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:34:38,942 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:34:38,948 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:38,948 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:34:38,958 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:38,959 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:34:38,959 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:38,974 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:38,979 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:34:38,983 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:34:38,984 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:38,984 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:38,984 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:38,984 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:38,984 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:38,985 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:34:38,985 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:38,985 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:34:38,985 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:38,987 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:34:38,987 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:34:38,987 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:38,987 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:34:38,987 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:38,988 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:38,988 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:38,988 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:34:38,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:34:38,988 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:34:38,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:34:38,989 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:34:38,989 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:34:38,990 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:34:38,990 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:34:38,990 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:34:38,990 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:34:38,991 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:34:38,991 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:34:38,991 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:38,991 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:34:38,991 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:38,992 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:38,992 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:38,992 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:34:38,992 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:34:38,992 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:34:38,992 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:34:38,996 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:34:38,996 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:38,998 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:38,998 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:34:38,999 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:38,999 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:38,999 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:39,000 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:39,013 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3588, Threshold=0.3880, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:34:39,013 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3588
2025-08-04 20:34:50,277 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:50,277 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:34:50,277 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:34:50,277 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:34:50,277 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:34:50,277 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:50,527 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:50,527 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:50,613 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:34:50,659 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:34:50,659 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:50,780 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:50,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:50,787 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:50,793 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:34:50,800 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:50,800 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:34:50,801 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:50,801 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:50,801 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:34:50,810 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:50,813 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:50,815 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:50,817 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:50,820 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:50,822 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:50,824 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:50,827 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:50,829 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:50,831 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:50,834 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:50,844 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:50,844 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:34:50,849 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:34:50,849 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:34:50,855 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:50,855 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:34:50,864 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:50,864 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:34:50,864 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:50,880 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:50,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:34:50,891 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:34:50,891 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:50,891 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:50,891 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:50,892 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:50,892 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:50,892 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:34:50,892 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:50,892 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:34:50,893 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:50,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:34:50,894 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:34:50,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:50,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:34:50,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:50,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:50,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:50,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:34:50,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:34:50,896 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:34:50,896 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:34:50,896 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:34:50,896 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:34:50,897 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:34:50,897 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:34:50,897 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:34:50,897 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:34:50,898 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:34:50,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:34:50,898 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:50,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:34:50,898 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:50,899 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:50,899 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:50,899 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:34:50,899 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:34:50,899 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:34:50,899 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:34:50,905 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:34:50,905 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:50,906 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:50,906 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:34:50,908 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:50,908 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:50,908 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:50,909 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:50,921 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3643, Threshold=0.3929, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:34:50,921 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3643
2025-08-04 20:35:08,195 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:08,195 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:35:08,196 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:35:08,196 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:35:08,196 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:35:08,196 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:08,545 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:08,545 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:08,634 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:35:08,665 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:35:08,665 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:08,768 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:08,776 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:08,777 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:08,784 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:35:08,795 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:08,795 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:35:08,796 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:08,796 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:08,796 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:35:08,805 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:08,808 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:08,814 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:08,816 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:08,818 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:08,821 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:08,823 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:08,826 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:08,828 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:08,830 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:08,833 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:08,842 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:08,843 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:35:08,847 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:35:08,848 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:35:08,855 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:08,855 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:35:08,873 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:08,874 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:35:08,874 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:08,891 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:08,896 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:35:08,903 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:35:08,903 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:08,903 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:08,903 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:08,903 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:08,904 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:08,904 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:35:08,904 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:08,904 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:35:08,904 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:08,906 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:35:08,906 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:35:08,906 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:08,906 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:35:08,906 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:08,906 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:08,907 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:08,907 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:35:08,907 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:35:08,907 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:35:08,907 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:35:08,907 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:35:08,907 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:35:08,909 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:35:08,909 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:35:08,909 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:35:08,910 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:35:08,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:35:08,910 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:35:08,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:08,910 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:35:08,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:08,911 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:08,911 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:08,911 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:35:08,911 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:35:08,911 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:35:08,912 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:35:08,913 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:35:08,913 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:08,914 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:08,915 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:35:08,916 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:08,916 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:08,916 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:08,917 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:08,931 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3703, Threshold=0.4039, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:35:08,931 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3703
2025-08-04 20:35:23,219 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:23,219 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:35:23,220 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:35:23,220 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:35:23,220 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:35:23,220 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:23,546 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:23,546 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:23,632 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:35:23,669 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:35:23,670 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:23,758 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:23,764 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:23,764 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:23,769 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:35:23,774 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:23,774 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:35:23,775 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:23,775 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:23,775 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:35:23,784 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:23,786 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:23,789 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:23,791 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:23,794 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:23,796 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:23,798 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:23,801 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:23,804 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:23,806 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:23,808 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:23,816 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:23,816 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:35:23,821 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:35:23,821 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:35:23,825 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:23,826 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:35:23,834 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:23,834 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:35:23,834 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:23,848 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:23,852 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:35:23,857 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:35:23,857 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:23,858 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:23,858 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:23,858 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:23,858 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:23,858 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:35:23,859 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:23,859 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:35:23,859 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:23,860 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:35:23,860 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:35:23,861 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:23,861 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:35:23,861 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:23,861 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:23,861 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:23,861 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:35:23,862 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:35:23,862 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:35:23,862 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:35:23,862 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:35:23,862 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:35:23,863 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:35:23,863 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:35:23,863 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:35:23,864 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:35:23,864 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:35:23,864 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:35:23,864 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:23,864 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:35:23,865 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:23,865 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:23,865 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:23,865 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:35:23,865 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:35:23,865 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:35:23,866 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:35:23,869 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:35:23,869 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:23,870 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:23,870 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:35:23,871 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:23,871 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:23,871 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:23,872 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:23,885 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3870, Threshold=0.4207, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:35:23,885 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3870
2025-08-04 20:35:35,169 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:35,169 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:35:35,169 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:35:35,169 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:35:35,170 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:35:35,170 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:35,532 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:35,532 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:35,627 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:35:35,672 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:35:35,672 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:35,797 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:35,805 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:35,805 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:35,810 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:35:35,815 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:35,815 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:35:35,816 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:35,816 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:35,816 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:35:35,824 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:35,827 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:35,829 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:35,831 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:35,834 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:35,837 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:35,839 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:35,841 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:35,844 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:35,846 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:35,848 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:35,858 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:35,858 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:35:35,863 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:35:35,863 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:35:35,868 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:35,868 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:35:35,876 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:35,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:35:35,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:35,893 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:35,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:35:35,905 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:35:35,905 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:35,906 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:35,906 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:35,906 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:35,907 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:35,907 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:35:35,907 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:35,908 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:35:35,908 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:35,909 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:35:35,909 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:35:35,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:35,910 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:35:35,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:35,911 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:35,911 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:35,911 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:35:35,912 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:35:35,912 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:35:35,912 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:35:35,912 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:35:35,912 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:35:35,913 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:35:35,913 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:35:35,914 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:35:35,914 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:35:35,914 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:35:35,914 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:35:35,914 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:35,915 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:35:35,915 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:35,916 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:35,916 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:35,916 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:35:35,916 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:35:35,917 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:35:35,917 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:35:35,923 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:35:35,923 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:35,924 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:35,924 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:35:35,925 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:35,925 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:35,926 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:35,926 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:35,940 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3583, Threshold=0.3930, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:35:35,940 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3583
2025-08-04 20:35:47,225 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:47,226 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:35:47,226 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:35:47,226 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:35:47,226 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:35:47,226 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:47,608 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:47,608 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:47,701 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:35:47,748 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:35:47,748 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:47,868 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:47,874 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:47,874 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:47,881 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:35:47,887 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:47,888 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:35:47,888 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:47,888 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:47,888 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:35:47,897 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:47,900 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:47,902 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:47,904 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:47,907 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:47,909 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:47,912 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:47,914 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:47,918 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:47,920 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:47,924 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:47,937 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:47,938 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:35:47,943 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:35:47,943 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:35:47,950 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:47,950 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:35:47,961 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:47,961 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:35:47,961 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:47,976 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:47,981 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:35:47,986 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:35:47,986 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:47,986 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:47,986 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:47,987 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:47,987 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:47,987 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:35:47,987 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:47,988 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:35:47,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:47,989 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:35:47,989 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:35:47,990 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:47,990 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:35:47,990 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:47,990 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:47,990 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:47,990 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:35:47,990 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:35:47,991 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:35:47,991 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:35:47,991 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:35:47,991 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:35:47,993 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:35:47,993 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:35:47,993 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:35:47,994 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:35:47,994 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:35:47,994 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:35:47,994 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:47,994 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:35:47,995 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:47,995 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:47,995 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:47,995 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:35:47,995 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:35:47,995 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:35:47,996 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:35:47,999 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:35:47,999 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:48,000 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:48,000 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:35:48,001 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:48,001 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:48,001 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:48,002 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:48,015 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3728, Threshold=0.4118, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:35:48,015 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3728
2025-08-04 20:35:59,295 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:59,295 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:35:59,295 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:35:59,295 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:35:59,295 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:35:59,295 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:59,689 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:59,690 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:59,785 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:35:59,835 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:35:59,835 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:59,966 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:59,973 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:59,973 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:59,980 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:35:59,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:59,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:35:59,989 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:59,989 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:59,990 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:35:59,999 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:00,001 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:00,004 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:00,006 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:00,009 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:00,011 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:00,014 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:00,016 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:00,019 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:00,021 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:00,023 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:00,035 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:00,035 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:36:00,041 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:36:00,043 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:36:00,052 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:00,052 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:36:00,074 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:00,074 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:36:00,074 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:00,092 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:00,097 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:36:00,103 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:36:00,104 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:00,104 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:00,104 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:00,104 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:00,105 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:00,105 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:36:00,105 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:00,105 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:36:00,105 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:00,107 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:36:00,107 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:36:00,108 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:00,108 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:36:00,108 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:00,108 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:00,108 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:00,108 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:36:00,108 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:36:00,108 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:36:00,109 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:36:00,109 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:36:00,109 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:36:00,111 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:36:00,111 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:36:00,111 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:36:00,111 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:36:00,111 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:36:00,111 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:36:00,112 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:00,112 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:36:00,112 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:00,112 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:00,113 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:00,113 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:36:00,113 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:36:00,113 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:36:00,113 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:36:00,117 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:36:00,117 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:00,118 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:00,118 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:36:00,120 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:00,123 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:00,123 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:00,123 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:00,140 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3839, Threshold=0.4217, Accuracy=0.6927, F1=0.7870, Precision=0.9478, Recall=0.6728
2025-08-04 20:36:00,141 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6927, F1: 0.7870, Prec: 0.9478, Rec: 0.6728, Avg Anomaly Score: 0.3839
2025-08-04 20:36:17,420 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:17,420 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:36:17,420 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:36:17,420 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:36:17,420 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:36:17,420 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:17,705 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:17,705 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:17,790 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:36:17,815 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:36:17,815 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:17,914 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:17,920 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:17,920 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:17,926 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:36:17,935 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:17,936 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:36:17,936 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:17,936 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:17,937 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:36:17,946 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:17,949 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:17,951 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:17,953 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:17,956 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:17,958 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:17,960 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:17,963 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:17,966 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:17,969 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:17,972 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:17,983 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:17,983 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:36:17,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:36:17,989 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:36:17,993 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:17,993 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:36:18,002 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:18,002 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:36:18,002 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:18,016 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:18,020 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:36:18,026 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:36:18,026 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:18,026 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:18,027 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:18,027 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:18,027 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:18,027 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:36:18,028 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:18,028 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:36:18,028 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:18,029 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:36:18,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:36:18,030 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:18,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:36:18,030 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:18,030 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:18,030 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:18,030 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:36:18,031 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:36:18,031 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:36:18,031 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:36:18,031 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:36:18,031 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:36:18,032 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:36:18,032 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:36:18,033 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:36:18,033 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:36:18,033 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:36:18,033 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:36:18,033 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:18,033 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:36:18,034 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:18,034 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:18,034 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:18,034 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:36:18,034 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:36:18,035 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:36:18,035 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:36:18,038 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:36:18,038 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:18,040 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:18,040 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:36:18,041 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:18,041 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:18,042 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:18,042 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:18,054 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3676, Threshold=0.4015, Accuracy=0.6997, F1=0.7918, Precision=0.9536, Recall=0.6770
2025-08-04 20:36:18,055 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6997, F1: 0.7918, Prec: 0.9536, Rec: 0.6770, Avg Anomaly Score: 0.3676
2025-08-04 20:36:29,339 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:29,339 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:36:29,340 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:36:29,340 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:36:29,340 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:36:29,340 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:29,710 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:29,710 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:29,813 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:36:29,862 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:36:29,862 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:29,996 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:30,003 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:30,004 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:30,010 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:36:30,017 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:30,018 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:36:30,018 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:30,019 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:30,019 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:36:30,029 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:30,032 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:30,034 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:30,036 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:30,039 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:30,042 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:30,044 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:30,049 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:30,052 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:30,054 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:30,056 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:30,066 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:30,066 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:36:30,071 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:36:30,071 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:36:30,077 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:30,077 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:36:30,090 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:30,091 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:36:30,091 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:30,109 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:30,114 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:36:30,120 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:36:30,120 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:30,121 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:30,121 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:30,121 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:30,121 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:30,121 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:36:30,122 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:30,122 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:36:30,122 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:30,123 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:36:30,123 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:36:30,123 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:30,124 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:36:30,124 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:30,124 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:30,124 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:30,124 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:36:30,124 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:36:30,124 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:36:30,125 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:36:30,125 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:36:30,125 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:36:30,126 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:36:30,126 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:36:30,126 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:36:30,126 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:36:30,127 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:36:30,127 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:36:30,127 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:30,127 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:36:30,128 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:30,128 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:30,128 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:30,128 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:36:30,129 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:36:30,129 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:36:30,129 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:36:30,134 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:36:30,134 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:30,135 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:30,136 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:36:30,137 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:30,137 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:30,137 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:30,138 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:30,151 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3756, Threshold=0.4175, Accuracy=0.6997, F1=0.7918, Precision=0.9536, Recall=0.6770
2025-08-04 20:36:30,151 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.6997, F1: 0.7918, Prec: 0.9536, Rec: 0.6770, Avg Anomaly Score: 0.3756
2025-08-04 20:36:47,449 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:47,449 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:36:47,449 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:36:47,449 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:36:47,449 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:36:47,449 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:47,778 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:47,778 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:47,863 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:36:47,886 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:36:47,887 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:47,988 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:47,994 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:47,994 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:48,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:36:48,007 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:48,007 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:36:48,008 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:48,008 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:48,008 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:36:48,016 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:48,020 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:48,022 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:48,025 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:48,027 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:48,029 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:48,032 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:48,034 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:48,037 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:48,039 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:48,042 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:48,051 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:48,051 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:36:48,057 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:36:48,057 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:36:48,063 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:48,063 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:36:48,074 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:48,076 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:36:48,076 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:48,093 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:48,097 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:36:48,102 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:36:48,102 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:48,102 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:48,103 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:48,103 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:48,103 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:48,103 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:36:48,104 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:48,104 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:36:48,104 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:48,105 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:36:48,105 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:36:48,106 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:48,106 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:36:48,106 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:48,106 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:48,106 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:48,106 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:36:48,107 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:36:48,107 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:36:48,107 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:36:48,107 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:36:48,107 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:36:48,108 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:36:48,108 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:36:48,108 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:36:48,109 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:36:48,109 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:36:48,109 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:36:48,109 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:48,109 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:36:48,110 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:48,110 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:48,110 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:48,110 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:36:48,110 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:36:48,110 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:36:48,111 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:36:48,114 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:36:48,114 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:48,115 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:48,115 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:36:48,117 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:48,117 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:48,117 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:48,118 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:48,131 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3940, Threshold=0.4397, Accuracy=0.7031, F1=0.7942, Precision=0.9565, Recall=0.6790
2025-08-04 20:36:48,131 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7031, F1: 0.7942, Prec: 0.9565, Rec: 0.6790, Avg Anomaly Score: 0.3940
2025-08-04 20:37:02,424 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:02,424 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:37:02,424 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:37:02,424 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:37:02,425 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:37:02,425 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:02,743 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:02,743 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:02,829 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:37:02,871 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:37:02,871 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:02,991 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:02,997 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:02,997 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:03,004 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:37:03,010 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:03,010 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:37:03,010 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:03,010 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:03,011 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:37:03,020 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:03,023 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:03,025 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:03,027 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:03,030 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:03,032 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:03,035 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:03,037 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:03,040 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:03,042 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:03,044 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:03,055 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:03,055 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:37:03,060 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:37:03,060 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:37:03,067 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:03,067 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:37:03,080 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:03,081 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:37:03,081 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:03,097 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:03,102 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:37:03,108 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:37:03,108 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:03,108 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:03,108 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:03,108 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:03,109 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:03,109 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:37:03,109 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:03,109 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:37:03,109 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:03,110 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:37:03,111 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:37:03,111 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:03,111 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:37:03,111 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:03,112 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:03,112 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:03,112 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:37:03,112 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:37:03,112 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:37:03,112 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:37:03,113 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:37:03,113 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:37:03,114 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:37:03,114 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:37:03,115 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:37:03,115 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:37:03,115 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:37:03,115 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:37:03,115 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:03,116 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:37:03,116 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:03,116 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:03,117 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:03,117 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:37:03,117 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:37:03,117 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:37:03,117 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:37:03,121 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:37:03,121 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:03,122 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:03,123 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:37:03,124 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:03,124 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:03,124 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:03,125 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:03,139 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3820, Threshold=0.4327, Accuracy=0.7101, F1=0.7990, Precision=0.9623, Recall=0.6831
2025-08-04 20:37:03,139 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7101, F1: 0.7990, Prec: 0.9623, Rec: 0.6831, Avg Anomaly Score: 0.3820
2025-08-04 20:37:17,418 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:17,418 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:37:17,419 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:37:17,419 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:37:17,419 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:37:17,419 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:17,702 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:17,703 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:17,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:37:17,812 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:37:17,812 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:17,907 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:17,913 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:17,914 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:17,919 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:37:17,928 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:17,928 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:37:17,928 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:17,929 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:17,929 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:37:17,937 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:17,940 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:17,942 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:17,944 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:17,947 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:17,949 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:17,951 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:17,954 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:17,957 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:17,959 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:17,961 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:17,973 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:17,973 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:37:17,978 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:37:17,978 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:37:17,987 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:17,987 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:37:18,002 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:18,003 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:37:18,003 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:18,020 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:18,024 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:37:18,029 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:37:18,029 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:18,029 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:18,029 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:18,030 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:18,030 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:18,030 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:37:18,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:18,031 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:37:18,031 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:18,032 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:37:18,032 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:37:18,033 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:18,033 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:37:18,033 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:18,033 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:18,033 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:18,033 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:37:18,034 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:37:18,034 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:37:18,034 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:37:18,034 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:37:18,034 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:37:18,036 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:37:18,036 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:37:18,036 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:37:18,036 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:37:18,036 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:37:18,036 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:37:18,037 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:18,037 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:37:18,037 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:18,037 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:18,037 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:18,038 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:37:18,038 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:37:18,038 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:37:18,038 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:37:18,043 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:37:18,043 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:18,044 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:18,044 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:37:18,045 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:18,045 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:18,046 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:18,046 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:18,060 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3864, Threshold=0.4407, Accuracy=0.7205, F1=0.8063, Precision=0.9710, Recall=0.6893
2025-08-04 20:37:18,060 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7205, F1: 0.8063, Prec: 0.9710, Rec: 0.6893, Avg Anomaly Score: 0.3864
2025-08-04 20:37:29,349 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:29,349 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:37:29,350 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:37:29,350 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:37:29,350 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:37:29,350 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:29,681 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:29,681 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:29,770 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:37:29,817 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:37:29,817 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:29,938 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:29,946 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:29,947 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:29,955 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:37:29,962 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:29,963 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:37:29,963 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:29,963 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:29,964 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:37:29,973 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:29,976 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:29,979 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:29,981 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:29,983 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:29,986 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:29,988 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:29,990 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:29,993 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:29,995 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:29,997 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:30,008 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:30,008 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:37:30,013 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:37:30,013 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:37:30,018 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:30,018 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:37:30,029 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:30,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:37:30,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:30,048 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:30,054 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:37:30,063 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:37:30,063 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:30,064 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:30,064 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:30,064 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:30,065 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:30,065 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:37:30,065 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:30,065 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:37:30,065 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:30,067 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:37:30,067 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:37:30,067 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:30,067 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:37:30,068 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:30,068 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:30,068 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:30,068 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:37:30,068 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:37:30,068 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:37:30,069 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:37:30,069 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:37:30,069 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:37:30,071 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:37:30,072 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:37:30,072 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:37:30,072 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:37:30,072 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:37:30,072 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:37:30,072 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:30,073 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:37:30,073 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:30,073 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:30,073 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:30,074 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:37:30,074 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:37:30,074 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:37:30,074 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:37:30,078 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:37:30,078 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:30,080 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:30,080 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:37:30,081 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:30,082 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:30,082 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:30,083 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:30,099 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3625, Threshold=0.4166, Accuracy=0.7240, F1=0.8087, Precision=0.9739, Recall=0.6914
2025-08-04 20:37:30,099 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7240, F1: 0.8087, Prec: 0.9739, Rec: 0.6914, Avg Anomaly Score: 0.3625
2025-08-04 20:37:44,380 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:44,381 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:37:44,381 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:37:44,381 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:37:44,381 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:37:44,381 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:44,639 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:44,640 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:44,726 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:37:44,764 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:37:44,764 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:44,867 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:44,874 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:44,874 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:44,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:37:44,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:44,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:37:44,885 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:44,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:44,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:37:44,894 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:44,897 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:44,899 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:44,902 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:44,904 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:44,906 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:44,909 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:44,911 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:44,914 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:44,917 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:44,919 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:44,929 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:44,930 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:37:44,935 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:37:44,935 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:37:44,940 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:44,940 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:37:44,951 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:44,952 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:37:44,952 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:44,967 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:44,972 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:37:44,977 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:37:44,977 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:44,977 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:44,977 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:44,978 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:44,978 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:44,978 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:37:44,978 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:44,978 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:37:44,978 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:44,980 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:37:44,980 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:37:44,980 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:44,980 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:37:44,981 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:44,981 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:44,981 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:44,981 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:37:44,981 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:37:44,981 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:37:44,981 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:37:44,981 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:37:44,982 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:37:44,984 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:37:44,984 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:37:44,984 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:37:44,984 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:37:44,984 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:37:44,984 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:37:44,984 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:44,985 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:37:44,985 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:44,985 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:44,986 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:44,986 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:37:44,986 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:37:44,986 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:37:44,986 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:37:44,987 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:37:44,987 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:44,989 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:44,989 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:37:44,990 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:44,990 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:44,990 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:44,991 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:45,005 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3782, Threshold=0.4391, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:37:45,005 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3782
2025-08-04 20:37:56,312 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:56,313 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:37:56,313 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:37:56,313 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:37:56,313 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:37:56,314 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:56,631 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:56,632 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:56,716 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:37:56,759 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:37:56,759 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:56,877 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:56,886 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:56,887 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:56,893 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:37:56,900 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:56,900 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:37:56,901 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:56,901 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:56,901 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:37:56,911 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:56,914 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:56,917 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:56,919 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:56,922 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:56,924 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:56,927 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:56,930 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:56,933 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:56,935 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:56,937 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:56,948 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:56,948 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:37:56,953 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:37:56,953 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:37:56,958 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:56,959 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:37:56,969 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:56,969 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:37:56,970 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:56,987 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:56,993 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:37:57,000 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:37:57,000 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:57,000 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:57,000 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:57,001 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:57,001 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:57,001 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:37:57,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:57,002 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:37:57,002 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:57,003 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:37:57,003 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:37:57,003 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:57,004 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:37:57,004 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:57,004 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:57,004 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:57,004 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:37:57,004 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:37:57,004 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:37:57,005 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:37:57,005 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:37:57,005 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:37:57,007 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:37:57,007 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:37:57,007 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:37:57,008 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:37:57,008 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:37:57,008 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:37:57,008 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:57,008 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:37:57,009 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:57,009 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:57,009 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:57,009 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:37:57,009 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:37:57,009 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:37:57,010 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:37:57,014 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:37:57,014 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:57,015 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:57,015 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:37:57,017 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:57,017 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:57,017 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:57,018 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:57,032 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3838, Threshold=0.4442, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:37:57,032 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3838
2025-08-04 20:38:08,302 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:08,302 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:38:08,302 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:38:08,302 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:38:08,302 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:38:08,302 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:08,559 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:08,559 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:08,644 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:38:08,667 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:38:08,667 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:08,767 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:08,777 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:08,777 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:08,786 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:38:08,795 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:08,796 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:38:08,796 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:08,797 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:08,797 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:38:08,807 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:08,810 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:08,812 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:08,815 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:08,818 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:08,820 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:08,822 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:08,825 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:08,828 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:08,830 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:08,832 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:08,844 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:08,844 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:38:08,849 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:38:08,849 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:38:08,854 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:08,854 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:38:08,862 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:08,862 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:38:08,863 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:08,878 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:08,883 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:38:08,889 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:38:08,889 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:08,889 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:08,889 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:08,890 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:08,890 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:08,890 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:38:08,891 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:08,891 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:38:08,891 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:08,892 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:38:08,893 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:38:08,893 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:08,893 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:38:08,893 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:08,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:08,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:08,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:38:08,894 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:38:08,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:38:08,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:38:08,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:38:08,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:38:08,898 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:38:08,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:38:08,899 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:38:08,899 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:38:08,899 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:38:08,899 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:38:08,899 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:08,900 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:38:08,900 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:08,900 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:08,901 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:08,901 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:38:08,901 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:38:08,901 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:38:08,901 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:38:08,906 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:38:08,906 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:08,908 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:08,908 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:38:08,910 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:08,910 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:08,910 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:08,911 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:08,924 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3843, Threshold=0.4517, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:38:08,924 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3843
2025-08-04 20:38:23,195 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:23,195 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:38:23,196 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:38:23,196 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:38:23,196 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:38:23,196 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:23,485 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:23,485 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:23,570 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:38:23,620 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:38:23,620 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:23,741 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:23,748 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:23,748 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:23,756 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:38:23,766 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:23,767 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:38:23,767 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:23,768 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:23,768 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:38:23,779 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:23,782 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:23,785 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:23,787 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:23,790 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:23,793 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:23,795 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:23,798 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:23,801 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:23,803 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:23,806 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:23,817 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:23,818 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:38:23,823 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:38:23,823 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:38:23,829 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:23,829 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:38:23,840 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:23,840 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:38:23,840 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:23,856 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:23,861 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:38:23,870 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:38:23,870 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:23,870 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:23,870 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:23,871 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:23,871 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:23,871 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:38:23,871 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:23,872 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:38:23,872 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:23,873 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:38:23,873 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:38:23,873 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:23,874 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:38:23,874 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:23,874 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:23,874 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:23,874 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:38:23,874 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:38:23,874 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:38:23,875 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:38:23,875 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:38:23,875 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:38:23,877 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:38:23,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:38:23,877 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:38:23,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:38:23,878 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:38:23,878 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:38:23,878 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:23,878 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:38:23,879 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:23,879 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:23,879 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:23,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:38:23,879 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:38:23,880 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:38:23,880 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:38:23,885 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:38:23,885 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:23,886 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:23,886 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:38:23,888 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:23,888 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:23,888 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:23,889 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:23,902 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3818, Threshold=0.4515, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:38:23,902 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3818
2025-08-04 20:38:35,175 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:35,176 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:38:35,176 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:38:35,176 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:38:35,176 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:38:35,176 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:35,461 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:35,461 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:35,550 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:38:35,594 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:38:35,595 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:35,712 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:35,720 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:35,720 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:35,728 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:38:35,745 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:35,746 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:38:35,746 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:35,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:35,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:38:35,756 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:35,759 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:35,761 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:35,763 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:35,766 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:35,768 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:35,771 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:35,773 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:35,776 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:35,778 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:35,780 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:35,792 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:35,793 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:38:35,798 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:38:35,798 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:38:35,804 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:35,805 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:38:35,815 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:35,816 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:38:35,816 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:35,832 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:35,837 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:38:35,843 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:38:35,843 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:35,843 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:35,843 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:35,843 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:35,844 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:35,844 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:38:35,844 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:35,844 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:38:35,844 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:35,846 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:38:35,846 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:38:35,847 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:35,847 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:38:35,847 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:35,847 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:35,847 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:35,847 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:38:35,847 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:38:35,848 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:38:35,848 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:38:35,848 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:38:35,848 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:38:35,850 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:38:35,850 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:38:35,850 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:38:35,850 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:38:35,851 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:38:35,851 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:38:35,852 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:35,853 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:38:35,854 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:35,854 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:35,854 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:35,855 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:38:35,855 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:38:35,855 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:38:35,856 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:38:35,863 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:38:35,863 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:35,865 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:35,865 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:38:35,866 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:35,866 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:35,867 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:35,867 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:35,881 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3805, Threshold=0.4544, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:38:35,881 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3805
2025-08-04 20:38:47,148 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:47,148 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:38:47,148 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:38:47,148 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:38:47,148 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:38:47,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:47,411 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:47,412 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:47,495 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:38:47,538 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:38:47,538 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:47,661 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:47,668 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:47,669 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:47,678 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:38:47,685 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:47,685 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:38:47,686 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:47,686 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:47,686 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:38:47,697 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:47,700 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:47,702 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:47,704 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:47,707 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:47,709 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:47,712 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:47,715 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:47,717 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:47,719 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:47,722 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:47,732 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:47,733 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:38:47,738 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:38:47,738 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:38:47,744 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:47,744 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:38:47,754 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:47,754 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:38:47,754 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:47,770 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:47,775 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:38:47,782 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:38:47,783 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:47,783 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:47,783 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:47,783 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:47,783 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:47,784 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:38:47,784 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:47,784 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:38:47,784 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:47,786 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:38:47,786 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:38:47,786 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:47,786 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:38:47,786 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:47,787 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:47,787 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:47,787 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:38:47,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:38:47,787 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:38:47,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:38:47,787 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:38:47,788 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:38:47,790 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:38:47,790 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:38:47,791 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:38:47,791 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:38:47,791 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:38:47,791 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:38:47,791 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:47,791 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:38:47,792 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:47,792 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:47,792 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:47,792 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:38:47,792 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:38:47,793 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:38:47,793 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:38:47,796 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:38:47,796 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:47,798 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:47,798 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:38:47,799 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:47,800 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:47,800 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:47,801 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:47,815 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3811, Threshold=0.4522, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:38:47,815 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.3811
2025-08-04 20:39:02,096 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:02,097 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:39:02,097 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:39:02,097 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:39:02,097 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:39:02,097 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:02,332 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:02,332 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:02,415 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:39:02,438 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:39:02,438 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:02,538 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:02,546 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:02,546 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:02,553 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:39:02,560 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:02,560 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:39:02,561 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:02,561 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:02,561 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:39:02,570 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:02,572 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:02,575 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:02,577 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:02,579 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:02,582 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:02,585 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:02,587 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:02,590 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:02,592 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:02,594 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:02,605 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:02,605 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:39:02,610 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:39:02,610 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:39:02,615 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:02,615 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:39:02,623 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:02,623 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:39:02,624 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:02,639 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:02,644 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:39:02,649 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:39:02,649 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:02,650 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:02,650 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:02,650 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:02,650 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:02,650 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:39:02,651 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:02,651 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:39:02,651 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:02,652 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:39:02,653 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:39:02,653 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:02,653 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:39:02,653 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:02,653 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:02,653 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:02,654 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:39:02,654 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:39:02,654 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:39:02,654 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:39:02,654 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:39:02,654 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:39:02,656 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:39:02,656 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:39:02,656 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:39:02,656 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:39:02,656 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:39:02,656 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:39:02,657 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:02,657 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:39:02,657 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:02,657 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:02,658 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:02,658 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:39:02,658 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:39:02,658 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:39:02,658 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:39:02,662 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:39:02,662 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:02,664 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:02,664 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:39:02,665 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:02,665 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:02,665 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:02,666 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:02,679 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3766, Threshold=0.4417, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:39:02,679 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3766
2025-08-04 20:39:07,935 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:07,935 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:39:07,935 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:39:07,935 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:39:07,935 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:39:07,936 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:08,192 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:08,192 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:08,276 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:39:08,315 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:39:08,315 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:08,424 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:08,431 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:08,431 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:08,436 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:39:08,444 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:08,445 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:39:08,445 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:08,445 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:08,445 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:39:08,454 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:08,457 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:08,459 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:08,461 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:08,464 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:08,466 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:08,469 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:08,471 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:08,474 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:08,476 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:08,478 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:08,489 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:08,489 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:39:08,494 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:39:08,495 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:39:08,499 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:08,499 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:39:08,508 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:08,508 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:39:08,509 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:08,523 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:08,528 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:39:08,533 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:39:08,533 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:08,533 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:08,533 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:08,534 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:08,534 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:08,534 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:39:08,535 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:08,535 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:39:08,535 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:08,536 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:39:08,536 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:39:08,537 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:08,537 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:39:08,537 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:08,537 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:08,537 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:08,537 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:39:08,538 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:39:08,538 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:39:08,538 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:39:08,538 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:39:08,538 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:39:08,540 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:39:08,540 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:39:08,540 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:39:08,540 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:39:08,540 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:39:08,540 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:39:08,541 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:08,541 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:39:08,541 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:08,541 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:08,541 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:08,542 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:39:08,542 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:39:08,542 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:39:08,542 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:39:08,545 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:39:08,545 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:08,547 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:08,547 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:39:08,548 - ClientAppLogger [Client 9] - INFO - [Client] Fit started for round 80/400.
2025-08-04 20:39:08,650 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:08,650 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:08,651 - ClientAppLogger [Client 9] - INFO - [Client] Semi-supervised: Added 580 anomalous samples to GAN training data (target: 580).
2025-08-04 20:39:08,652 - ClientAppLogger [Client 9] - INFO - [Client] Round 80: Training GAN with 2516 samples (1936 normal, 580 anomalous).
2025-08-04 20:39:08,652 - ClientAppLogger [Client 9] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:10,437 - ClientAppLogger [Client 9] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0836, Avg D Loss: 0.8419
2025-08-04 20:39:10,438 - ClientAppLogger [Client 9] - INFO - GAN Training completed. Avg G Loss: 2.0836, Avg D Loss: 0.8419
2025-08-04 20:39:10,438 - ClientAppLogger [Client 9] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:10,451 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4106, Threshold=0.4856, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:39:10,451 - ClientAppLogger [Client 9] - INFO - [Client] Post-fit local evaluation F1: 0.8111
2025-08-04 20:39:10,451 - ClientAppLogger [Client 9] - INFO - Fit completed for round 80. Duration: 1.90s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '9', 'server_round': 80, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0836110052509036, 'd_loss': 0.8418844781827852, 'post_fit_local_f1': 0.8110709987966306, 'fit_time_seconds': 1.902705430984497, 'cpu_percent_fit': 6.24375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2516}
2025-08-04 20:39:10,451 - ClientAppLogger [Client 9] - INFO - [Client] get_parameters called
2025-08-04 20:39:18,735 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:18,735 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:39:18,735 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:39:18,735 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:39:18,735 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:39:18,735 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:18,959 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:18,959 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:19,045 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:39:19,065 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:39:19,065 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:19,148 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:19,153 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:19,153 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:19,159 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:39:19,166 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:19,166 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:39:19,167 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:19,167 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:19,167 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:39:19,175 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:19,178 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:19,180 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:19,182 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:19,185 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:19,187 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:19,190 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:19,192 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:19,195 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:19,197 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:19,199 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:19,207 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:19,207 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:39:19,212 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:39:19,212 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:39:19,217 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:19,217 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:39:19,228 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:19,228 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:39:19,228 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:19,243 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:19,247 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:39:19,252 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:39:19,252 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:19,252 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:19,252 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:19,253 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:19,253 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:19,253 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:39:19,253 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:19,253 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:39:19,253 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:19,255 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:39:19,255 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:39:19,255 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:19,255 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:39:19,256 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:19,256 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:19,256 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:19,256 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:39:19,256 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:39:19,256 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:39:19,256 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:39:19,256 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:39:19,257 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:39:19,257 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:39:19,257 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:39:19,258 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:39:19,258 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:39:19,258 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:39:19,258 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:39:19,258 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:19,258 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:39:19,259 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:19,259 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:19,259 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:19,259 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:39:19,259 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:39:19,259 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:39:19,259 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:39:19,261 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:39:19,261 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:19,262 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:19,263 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:39:19,264 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:19,264 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:19,264 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:19,265 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:19,277 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4011, Threshold=0.4689, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:39:19,277 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.4011
2025-08-04 20:39:30,557 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:30,557 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:39:30,557 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:39:30,558 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:39:30,558 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:39:30,558 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:30,861 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:30,861 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:30,950 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:39:30,993 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:39:30,994 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:31,107 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:31,112 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:31,112 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:31,117 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:39:31,122 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:31,122 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:39:31,122 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:31,123 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:31,123 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:39:31,131 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:31,134 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:31,136 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:31,138 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:31,141 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:31,143 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:31,146 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:31,149 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:31,151 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:31,153 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:31,155 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:31,164 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:31,164 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:39:31,169 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:39:31,169 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:39:31,173 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:31,173 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:39:31,182 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:31,182 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:39:31,182 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:31,196 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:31,200 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:39:31,205 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:39:31,205 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:31,205 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:31,205 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:31,206 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:31,206 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:31,206 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:39:31,206 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:31,207 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:39:31,207 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:31,208 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:39:31,208 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:39:31,208 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:31,209 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:39:31,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:31,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:31,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:31,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:39:31,209 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:39:31,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:39:31,209 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:39:31,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:39:31,210 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:39:31,211 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:39:31,211 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:39:31,211 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:39:31,211 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:39:31,211 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:39:31,211 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:39:31,212 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:31,212 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:39:31,213 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:31,213 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:31,213 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:31,213 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:39:31,214 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:39:31,214 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:39:31,214 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:39:31,217 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:39:31,217 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:31,218 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:31,218 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:39:31,220 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:31,220 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:31,220 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:31,220 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:31,234 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3895, Threshold=0.4499, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:39:31,234 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3895
2025-08-04 20:39:42,509 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:42,509 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:39:42,509 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:39:42,509 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:39:42,510 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:39:42,510 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:42,814 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:42,814 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:42,905 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:39:42,929 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:39:42,929 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:43,066 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:43,072 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:43,072 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:43,077 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:39:43,084 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:43,084 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:39:43,085 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:43,085 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:43,085 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:39:43,094 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:43,097 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:43,099 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:43,101 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:43,104 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:43,107 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:43,109 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:43,112 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:43,115 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:43,117 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:43,119 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:43,128 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:43,129 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:39:43,133 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:39:43,134 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:39:43,138 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:43,139 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:39:43,147 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:43,147 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:39:43,147 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:43,162 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:43,166 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:39:43,171 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:39:43,171 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:43,171 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:43,171 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:43,171 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:43,172 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:43,172 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:39:43,172 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:43,172 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:39:43,173 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:43,174 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:39:43,174 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:39:43,174 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:43,174 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:39:43,175 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:43,175 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:43,175 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:43,175 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:39:43,175 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:39:43,175 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:39:43,175 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:39:43,175 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:39:43,176 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:39:43,177 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:39:43,177 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:39:43,177 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:39:43,177 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:39:43,177 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:39:43,178 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:39:43,178 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:43,178 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:39:43,178 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:43,178 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:43,179 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:43,179 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:39:43,179 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:39:43,179 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:39:43,179 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:39:43,184 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:39:43,185 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:43,186 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:43,186 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:39:43,187 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:43,188 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:43,188 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:43,189 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:43,201 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3785, Threshold=0.4339, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:39:43,202 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3785
2025-08-04 20:39:57,478 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:57,478 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:39:57,478 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:39:57,478 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:39:57,479 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:39:57,479 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:57,777 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:57,777 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:57,875 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:39:57,924 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:39:57,925 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:58,036 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:58,041 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:58,041 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:58,046 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:39:58,051 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:58,051 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:39:58,052 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:58,052 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:58,052 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:39:58,061 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:58,064 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:58,066 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:58,069 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:58,072 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:58,074 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:58,077 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:58,079 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:58,082 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:58,084 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:58,086 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:58,097 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:58,097 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:39:58,101 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:39:58,102 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:39:58,106 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:58,106 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:39:58,116 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:58,116 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:39:58,116 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:58,132 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:58,137 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:39:58,142 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:39:58,142 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:58,143 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:58,143 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:58,143 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:58,143 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:58,143 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:39:58,144 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:58,144 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:39:58,144 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:58,145 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:39:58,145 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:39:58,146 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:58,146 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:39:58,146 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:58,146 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:58,146 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:58,146 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:39:58,147 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:39:58,147 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:39:58,147 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:39:58,147 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:39:58,147 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:39:58,148 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:39:58,148 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:39:58,149 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:39:58,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:39:58,149 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:39:58,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:39:58,149 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:58,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:39:58,149 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:58,150 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:58,150 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:58,150 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:39:58,150 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:39:58,150 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:39:58,150 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:39:58,153 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:39:58,153 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:58,154 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:58,155 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:39:58,156 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:58,156 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:58,156 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:58,157 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:58,171 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4091, Threshold=0.4706, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:39:58,171 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4091
2025-08-04 20:40:03,423 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:03,423 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:40:03,423 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:40:03,423 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:40:03,423 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:40:03,424 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:03,738 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:03,739 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:03,821 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:40:03,844 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:40:03,844 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:03,934 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:03,940 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:03,940 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:03,949 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:40:03,957 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:03,957 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:40:03,957 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:03,958 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:03,958 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:40:03,967 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:03,969 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:03,972 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:03,974 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:03,977 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:03,979 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:03,982 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:03,984 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:03,987 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:03,989 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:03,992 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:04,001 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:04,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:40:04,006 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:40:04,006 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:40:04,012 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:04,012 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:40:04,020 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:04,021 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:40:04,021 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:04,036 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:04,041 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:40:04,046 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:40:04,046 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:04,046 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:04,046 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:04,047 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:04,047 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:04,047 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:40:04,047 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:04,047 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:40:04,048 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:04,049 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:40:04,049 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:40:04,049 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:04,050 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:40:04,050 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:04,050 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:04,050 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:04,050 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:40:04,050 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:40:04,050 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:40:04,050 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:40:04,051 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:40:04,051 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:40:04,052 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:40:04,052 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:40:04,052 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:40:04,052 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:40:04,052 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:40:04,052 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:40:04,053 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:04,053 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:40:04,053 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:04,053 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:04,054 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:04,054 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:40:04,054 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:40:04,054 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:40:04,054 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:40:04,058 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:40:04,058 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:04,060 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:04,060 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:40:04,061 - ClientAppLogger [Client 9] - INFO - [Client] Fit started for round 84/400.
2025-08-04 20:40:04,162 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:04,162 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:04,164 - ClientAppLogger [Client 9] - INFO - [Client] Semi-supervised: Added 608 anomalous samples to GAN training data (target: 608).
2025-08-04 20:40:04,164 - ClientAppLogger [Client 9] - INFO - [Client] Round 84: Training GAN with 2636 samples (2028 normal, 608 anomalous).
2025-08-04 20:40:04,164 - ClientAppLogger [Client 9] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:05,995 - ClientAppLogger [Client 9] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0838, Avg D Loss: 0.8345
2025-08-04 20:40:05,995 - ClientAppLogger [Client 9] - INFO - GAN Training completed. Avg G Loss: 2.0838, Avg D Loss: 0.8345
2025-08-04 20:40:05,996 - ClientAppLogger [Client 9] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:06,009 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4245, Threshold=0.5037, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:40:06,009 - ClientAppLogger [Client 9] - INFO - [Client] Post-fit local evaluation F1: 0.8135
2025-08-04 20:40:06,009 - ClientAppLogger [Client 9] - INFO - Fit completed for round 84. Duration: 1.95s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '9', 'server_round': 84, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0837511115804968, 'd_loss': 0.8345216560436128, 'post_fit_local_f1': 0.8134777376654633, 'fit_time_seconds': 1.9480819702148438, 'cpu_percent_fit': 6.25625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 2636}
2025-08-04 20:40:06,010 - ClientAppLogger [Client 9] - INFO - [Client] get_parameters called
2025-08-04 20:40:11,276 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:11,276 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:40:11,276 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:40:11,276 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:40:11,276 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:40:11,277 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:11,554 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:11,554 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:11,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:40:11,684 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:40:11,684 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:11,815 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:11,820 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:11,820 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:11,825 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:40:11,831 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:11,832 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:40:11,832 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:11,832 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:11,833 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:40:11,843 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:11,846 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:11,848 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:11,850 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:11,853 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:11,856 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:11,859 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:11,861 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:11,864 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:11,866 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:11,868 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:11,878 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:11,878 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:40:11,883 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:40:11,883 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:40:11,889 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:11,889 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:40:11,900 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:11,901 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:40:11,901 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:11,917 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:11,923 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:40:11,929 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:40:11,929 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:11,929 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:11,930 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:11,930 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:11,930 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:11,931 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:40:11,931 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:11,931 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:40:11,931 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:11,933 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:40:11,933 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:40:11,933 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:11,933 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:40:11,934 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:11,934 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:11,934 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:11,934 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:40:11,935 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:40:11,935 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:40:11,935 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:40:11,935 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:40:11,935 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:40:11,937 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:40:11,937 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:40:11,937 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:40:11,938 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:40:11,938 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:40:11,938 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:40:11,939 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:11,939 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:40:11,939 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:11,940 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:11,940 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:11,940 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:40:11,941 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:40:11,941 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:40:11,941 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:40:11,945 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:40:11,945 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:11,946 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:11,947 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:40:11,948 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:11,948 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:11,948 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:11,949 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:11,963 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4117, Threshold=0.4731, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:40:11,963 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4117
2025-08-04 20:40:23,233 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:23,233 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:40:23,233 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:40:23,233 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:40:23,234 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:40:23,234 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:23,520 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:23,521 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:23,603 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:40:23,627 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:40:23,627 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:23,726 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:23,732 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:23,733 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:23,739 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:40:23,826 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:23,826 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:40:23,826 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:23,827 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:23,827 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:40:23,835 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:23,838 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:23,840 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:23,842 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:23,845 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:23,847 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:23,850 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:23,852 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:23,855 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:23,857 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:23,859 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:23,871 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:23,871 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:40:23,876 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:40:23,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:40:23,883 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:23,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:40:23,901 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:23,902 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:40:23,902 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:23,920 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:23,926 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:40:23,932 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:40:23,932 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:23,932 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:23,933 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:23,933 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:23,933 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:23,934 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:40:23,934 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:23,934 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:40:23,934 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:23,936 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:40:23,936 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:40:23,937 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:23,937 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:40:23,937 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:23,937 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:23,937 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:23,938 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:40:23,938 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:40:23,938 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:40:23,938 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:40:23,938 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:40:23,938 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:40:23,940 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:40:23,940 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:40:23,940 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:40:23,941 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:40:23,941 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:40:23,941 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:40:23,941 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:23,941 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:40:23,942 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:23,942 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:23,942 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:23,942 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:40:23,943 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:40:23,943 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:40:23,943 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:40:23,946 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:40:23,947 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:23,948 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:23,948 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:40:23,950 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:23,950 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:23,951 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:23,951 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:23,967 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3894, Threshold=0.4413, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:40:23,967 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3894
2025-08-04 20:40:38,252 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:38,252 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:40:38,252 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:40:38,252 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:40:38,252 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:40:38,252 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:38,516 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:38,516 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:38,600 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:40:38,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:40:38,643 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:38,764 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:38,770 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:38,771 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:38,777 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:40:38,785 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:38,785 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:40:38,786 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:38,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:38,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:40:38,797 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:38,800 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:38,802 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:38,804 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:38,807 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:38,809 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:38,811 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:38,814 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:38,817 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:38,819 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:38,821 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:38,830 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:38,830 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:40:38,835 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:40:38,835 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:40:38,841 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:38,841 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:40:38,853 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:38,854 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:40:38,854 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:38,870 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:38,875 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:40:38,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:40:38,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:38,885 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:38,885 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:38,885 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:38,886 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:38,886 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:40:38,886 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:38,886 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:40:38,886 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:38,888 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:40:38,888 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:40:38,888 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:38,888 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:40:38,889 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:38,889 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:38,889 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:38,889 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:40:38,889 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:40:38,889 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:40:38,889 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:40:38,890 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:40:38,890 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:40:38,891 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:40:38,892 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:40:38,892 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:40:38,892 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:40:38,892 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:40:38,892 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:40:38,892 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:38,893 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:40:38,893 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:38,893 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:38,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:38,894 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:40:38,894 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:40:38,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:40:38,894 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:40:38,900 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:40:38,900 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:38,902 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:38,902 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:40:38,904 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:38,904 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:38,904 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:38,905 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:38,919 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4218, Threshold=0.4879, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:40:38,919 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4218
2025-08-04 20:40:53,201 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:53,201 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:40:53,201 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:40:53,201 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:40:53,201 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:40:53,202 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:53,460 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:53,460 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:53,545 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:40:53,567 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:40:53,567 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:53,661 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:53,667 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:53,667 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:53,673 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:40:53,683 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:53,683 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:40:53,683 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:53,684 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:53,684 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:40:53,692 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:53,695 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:53,697 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:53,699 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:53,702 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:53,705 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:53,707 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:53,710 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:53,713 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:53,715 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:53,717 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:53,726 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:53,726 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:40:53,731 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:40:53,731 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:40:53,736 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:53,737 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:40:53,746 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:53,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:40:53,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:53,762 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:53,767 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:40:53,772 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:40:53,772 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:53,773 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:53,773 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:53,773 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:53,774 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:53,774 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:40:53,774 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:53,774 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:40:53,774 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:53,776 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:40:53,776 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:40:53,776 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:53,776 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:40:53,776 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:53,776 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:53,777 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:53,777 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:40:53,777 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:40:53,777 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:40:53,777 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:40:53,777 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:40:53,777 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:40:53,778 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:40:53,778 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:40:53,778 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:40:53,779 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:40:53,779 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:40:53,779 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:40:53,779 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:53,779 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:40:53,779 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:53,780 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:53,780 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:53,780 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:40:53,780 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:40:53,780 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:40:53,780 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:40:53,784 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:40:53,784 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:53,785 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:53,785 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:40:53,786 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:53,786 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:53,786 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:53,787 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:53,800 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4255, Threshold=0.4854, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:40:53,800 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4255
2025-08-04 20:41:08,076 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:08,077 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:41:08,077 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:41:08,077 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:41:08,077 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:41:08,077 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:08,348 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:08,348 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:08,431 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:41:08,473 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:41:08,473 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:08,598 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:08,604 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:08,604 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:08,610 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:41:08,616 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:08,616 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:41:08,616 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:08,616 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:08,617 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:41:08,625 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:08,628 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:08,630 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:08,632 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:08,635 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:08,637 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:08,640 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:08,642 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:08,645 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:08,647 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:08,649 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:08,659 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:08,659 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:41:08,664 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:41:08,664 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:41:08,668 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:08,668 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:41:08,678 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:08,678 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:41:08,678 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:08,694 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:08,699 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:41:08,704 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:41:08,705 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:08,705 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:08,705 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:08,705 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:08,706 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:08,706 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:41:08,706 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:08,706 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:41:08,706 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:08,708 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:41:08,708 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:41:08,708 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:08,708 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:41:08,709 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:08,709 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:08,709 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:08,709 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:41:08,709 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:41:08,709 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:41:08,709 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:41:08,709 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:41:08,710 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:41:08,711 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:41:08,711 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:41:08,711 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:41:08,711 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:41:08,712 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:41:08,712 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:41:08,712 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:08,712 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:41:08,712 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:08,712 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:08,713 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:08,713 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:41:08,713 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:41:08,713 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:41:08,713 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:41:08,717 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:41:08,717 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:08,718 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:08,718 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:41:08,719 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:08,719 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:08,719 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:08,720 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:08,733 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3937, Threshold=0.4424, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:41:08,734 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3937
2025-08-04 20:41:19,996 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:19,996 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:41:19,996 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:41:19,997 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:41:19,997 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:41:19,997 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:20,238 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:20,239 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:20,319 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:41:20,342 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:41:20,342 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:20,432 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:20,437 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:20,438 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:20,444 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:41:20,461 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:20,461 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:41:20,462 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:20,462 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:20,462 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:41:20,470 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:20,473 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:20,475 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:20,478 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:20,480 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:20,483 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:20,485 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:20,488 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:20,491 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:20,493 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:20,495 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:20,504 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:20,505 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:41:20,509 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:41:20,509 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:41:20,515 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:20,515 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:41:20,527 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:20,527 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:41:20,527 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:20,543 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:20,547 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:41:20,551 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:41:20,551 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:20,552 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:20,552 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:20,552 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:20,552 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:20,553 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:41:20,553 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:20,553 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:41:20,553 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:20,554 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:41:20,555 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:41:20,555 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:20,555 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:41:20,555 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:20,555 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:20,556 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:20,556 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:41:20,556 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:41:20,556 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:41:20,556 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:41:20,556 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:41:20,557 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:41:20,558 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:41:20,559 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:41:20,559 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:41:20,559 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:41:20,559 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:41:20,559 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:41:20,559 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:20,559 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:41:20,560 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:20,560 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:20,560 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:20,560 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:41:20,560 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:41:20,561 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:41:20,561 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:41:20,565 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:41:20,565 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:20,567 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:20,567 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:41:20,568 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:20,569 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:20,569 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:20,569 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:20,585 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3978, Threshold=0.4398, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:41:20,585 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3978
2025-08-04 20:41:31,847 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:31,847 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:41:31,847 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:41:31,847 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:41:31,847 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:41:31,848 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:32,113 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:32,113 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:32,196 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:41:32,218 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:41:32,218 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:32,311 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:32,316 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:32,316 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:32,322 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:41:32,329 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:32,329 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:41:32,330 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:32,330 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:32,330 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:41:32,340 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:32,343 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:32,345 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:32,347 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:32,350 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:32,352 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:32,354 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:32,357 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:32,360 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:32,362 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:32,364 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:32,373 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:32,374 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:41:32,378 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:41:32,378 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:41:32,383 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:32,383 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:41:32,391 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:32,392 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:41:32,392 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:32,407 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:32,411 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:41:32,418 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:41:32,419 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:32,419 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:32,419 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:32,419 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:32,419 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:32,420 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:41:32,420 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:32,420 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:41:32,420 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:32,421 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:41:32,422 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:41:32,422 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:32,422 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:41:32,422 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:32,422 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:32,422 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:32,422 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:41:32,423 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:41:32,423 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:41:32,423 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:41:32,423 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:41:32,423 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:41:32,424 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:41:32,424 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:41:32,424 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:41:32,425 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:41:32,425 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:41:32,425 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:41:32,425 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:32,425 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:41:32,426 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:32,426 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:32,426 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:32,426 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:41:32,426 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:41:32,426 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:41:32,427 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:41:32,430 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:41:32,430 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:32,431 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:32,432 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:41:32,433 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:32,433 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:32,433 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:32,434 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:32,446 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4420, Threshold=0.5038, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:41:32,447 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4420
2025-08-04 20:41:49,737 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:49,737 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:41:49,737 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:41:49,737 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:41:49,738 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:41:49,738 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:50,178 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:50,179 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:50,275 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:41:50,306 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:41:50,306 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:50,425 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:50,434 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:50,434 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:50,442 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:41:50,454 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:50,455 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:41:50,455 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:50,456 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:50,456 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:41:50,465 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:50,468 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:50,471 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:50,473 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:50,475 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:50,478 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:50,480 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:50,483 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:50,485 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:50,488 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:50,491 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:50,505 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:50,505 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:41:50,512 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:41:50,512 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:41:50,521 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:50,522 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:41:50,543 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:50,544 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:41:50,544 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:50,563 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:50,570 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:41:50,579 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:41:50,579 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:50,579 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:50,580 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:50,580 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:50,581 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:50,581 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:41:50,581 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:50,581 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:41:50,582 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:50,583 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:41:50,584 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:41:50,584 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:50,584 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:41:50,584 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:50,584 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:50,585 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:50,585 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:41:50,585 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:41:50,585 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:41:50,585 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:41:50,586 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:41:50,586 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:41:50,589 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:41:50,589 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:41:50,589 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:41:50,590 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:41:50,590 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:41:50,590 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:41:50,590 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:50,590 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:41:50,591 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:50,591 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:50,591 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:50,592 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:41:50,592 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:41:50,592 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:41:50,592 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:41:50,596 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:41:50,597 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:50,598 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:50,598 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:41:50,600 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:50,603 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:50,603 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:50,604 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:50,621 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4324, Threshold=0.4978, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:41:50,624 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.4324
2025-08-04 20:42:04,902 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:04,902 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:42:04,903 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:42:04,903 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:42:04,903 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:42:04,903 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:05,329 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:05,330 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:05,426 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:42:05,474 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:42:05,475 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:05,621 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:05,628 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:05,628 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:05,635 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:42:05,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:05,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:42:05,643 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:05,643 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:05,643 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:42:05,652 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:05,656 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:05,658 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:05,660 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:05,664 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:05,666 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:05,669 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:05,671 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:05,674 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:05,676 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:05,679 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:05,689 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:05,690 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:42:05,695 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:42:05,695 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:42:05,704 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:05,704 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:42:05,720 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:05,721 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:42:05,721 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:05,742 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:05,748 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:42:05,757 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:42:05,757 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:05,758 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:05,758 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:05,758 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:05,758 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:05,759 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:42:05,759 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:05,759 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:42:05,759 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:05,761 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:42:05,761 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:42:05,761 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:05,762 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:42:05,762 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:05,762 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:05,762 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:05,762 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:42:05,762 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:42:05,763 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:42:05,763 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:42:05,763 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:42:05,763 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:42:05,765 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:42:05,766 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:42:05,766 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:42:05,766 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:42:05,766 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:42:05,766 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:42:05,767 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:05,767 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:42:05,767 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:05,767 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:05,768 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:05,768 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:42:05,768 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:42:05,768 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:42:05,768 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:42:05,773 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:42:05,773 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:05,774 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:05,775 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:42:05,776 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:05,776 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:05,776 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:05,777 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:05,792 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3967, Threshold=0.4499, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:42:05,792 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3967
2025-08-04 20:42:23,073 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:23,073 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:42:23,074 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:42:23,074 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:42:23,074 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:42:23,074 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:23,337 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:23,337 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:23,424 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:42:23,453 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:42:23,453 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:23,582 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:23,588 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:23,588 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:23,594 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:42:23,601 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:23,601 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:42:23,602 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:23,602 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:23,602 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:42:23,611 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:23,613 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:23,615 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:23,618 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:23,621 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:23,623 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:23,626 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:23,628 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:23,631 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:23,633 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:23,636 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:23,647 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:23,647 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:42:23,652 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:42:23,652 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:42:23,657 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:23,657 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:42:23,668 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:23,669 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:42:23,669 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:23,687 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:23,693 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:42:23,706 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:42:23,706 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:23,706 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:23,707 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:23,707 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:23,707 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:23,708 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:42:23,708 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:23,708 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:42:23,708 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:23,709 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:42:23,709 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:42:23,710 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:23,710 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:42:23,710 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:23,710 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:23,711 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:23,711 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:42:23,711 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:42:23,711 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:42:23,712 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:42:23,712 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:42:23,712 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:42:23,714 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:42:23,715 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:42:23,715 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:42:23,715 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:42:23,715 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:42:23,715 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:42:23,715 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:23,715 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:42:23,716 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:23,716 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:23,716 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:23,716 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:42:23,717 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:42:23,717 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:42:23,717 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:42:23,721 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:42:23,721 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:23,723 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:23,723 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:42:23,725 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:23,725 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:23,725 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:23,726 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:23,741 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4135, Threshold=0.4591, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:42:23,741 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4135
2025-08-04 20:42:38,033 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:38,033 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:42:38,033 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:42:38,033 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:42:38,034 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:42:38,034 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:38,444 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:38,444 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:38,543 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:42:38,576 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:42:38,576 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:38,701 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:38,710 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:38,710 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:38,738 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:42:38,763 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:38,763 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:42:38,764 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:38,764 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:38,764 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:42:38,775 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:38,779 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:38,781 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:38,784 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:38,787 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:38,790 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:38,792 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:38,795 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:38,799 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:38,801 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:38,803 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:38,816 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:38,816 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:42:38,823 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:42:38,823 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:42:38,830 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:38,831 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:42:38,845 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:38,846 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:42:38,846 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:38,864 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:38,869 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:42:38,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:42:38,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:38,877 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:38,877 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:38,878 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:38,878 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:38,879 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:42:38,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:38,879 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:42:38,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:38,881 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:42:38,881 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:42:38,890 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:38,890 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:42:38,890 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:38,890 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:38,891 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:38,891 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:42:38,891 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:42:38,891 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:42:38,891 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:42:38,891 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:42:38,891 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:42:38,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:42:38,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:42:38,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:42:38,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:42:38,895 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:42:38,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:42:38,896 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:38,896 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:42:38,919 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:38,919 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:38,919 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:38,919 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:42:38,920 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:42:38,920 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:42:38,920 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:42:38,927 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:42:38,927 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:38,936 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:38,937 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:42:38,940 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:38,941 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:38,941 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:38,942 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:38,962 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3907, Threshold=0.4292, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:42:38,962 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3907
2025-08-04 20:42:56,239 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:56,239 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:42:56,239 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:42:56,239 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:42:56,239 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:42:56,240 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:56,583 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:56,583 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:56,676 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:42:56,711 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:42:56,711 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:56,814 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:56,823 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:56,823 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:56,833 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:42:56,846 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:56,846 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:42:56,847 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:56,847 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:56,847 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:42:56,858 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:56,861 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:56,864 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:56,866 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:56,869 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:56,871 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:56,874 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:56,876 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:56,879 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:56,881 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:56,884 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:56,894 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:56,894 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:42:56,899 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:42:56,899 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:42:56,905 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:56,905 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:42:56,916 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:56,917 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:42:56,917 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:56,936 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:56,942 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:42:56,956 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:42:56,956 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:56,956 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:56,956 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:56,957 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:56,957 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:56,957 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:42:56,957 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:56,958 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:42:56,958 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:56,959 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:42:56,959 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:42:56,960 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:56,960 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:42:56,960 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:56,961 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:56,961 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:56,961 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:42:56,961 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:42:56,962 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:42:56,962 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:42:56,962 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:42:56,962 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:42:56,965 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:42:56,966 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:42:56,966 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:42:56,966 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:42:56,966 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:42:56,966 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:42:56,967 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:56,967 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:42:56,967 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:56,968 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:56,968 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:56,968 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:42:56,968 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:42:56,968 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:42:56,969 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:42:56,973 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:42:56,974 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:56,975 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:56,976 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:42:56,977 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:56,977 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:56,978 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:56,978 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:56,995 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4091, Threshold=0.4410, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:42:56,995 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4091
2025-08-04 20:43:11,278 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:11,278 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:43:11,278 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:43:11,278 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:43:11,278 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:43:11,278 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:11,595 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:11,596 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:11,683 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:43:11,729 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:43:11,730 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:11,864 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:11,871 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:11,871 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:11,876 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:43:11,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:11,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:43:11,885 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:11,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:11,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:43:11,894 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:11,897 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:11,900 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:11,902 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:11,904 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:11,907 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:11,909 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:11,912 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:11,915 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:11,917 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:11,919 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:11,930 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:11,931 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:43:11,936 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:43:11,936 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:43:11,943 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:11,944 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:43:11,954 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:11,954 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:43:11,954 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:11,975 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:11,979 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:43:11,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:43:11,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:11,988 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:11,988 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:11,989 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:11,989 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:11,989 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:43:11,989 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:11,989 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:43:11,989 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:11,991 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:43:11,991 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:43:11,991 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:11,992 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:43:11,992 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:11,992 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:11,992 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:11,992 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:43:11,992 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:43:11,992 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:43:11,993 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:43:11,993 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:43:11,993 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:43:11,994 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:43:11,994 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:43:11,994 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:43:11,994 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:43:11,994 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:43:11,995 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:43:11,995 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:11,995 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:43:11,995 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:11,995 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:11,996 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:11,996 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:43:11,996 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:43:11,996 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:43:11,996 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:43:12,001 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:43:12,002 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:12,003 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:12,003 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:43:12,004 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:12,004 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:12,004 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:12,005 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:12,017 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4433, Threshold=0.4821, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:43:12,018 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4433
2025-08-04 20:43:26,312 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:26,312 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:43:26,312 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:43:26,312 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:43:26,312 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:43:26,312 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:26,639 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:26,640 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:26,725 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:43:26,751 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:43:26,751 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:26,856 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:26,864 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:26,865 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:26,874 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:43:26,897 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:26,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:43:26,898 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:26,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:26,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:43:26,907 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:26,910 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:26,912 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:26,914 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:26,917 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:26,920 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:26,922 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:26,926 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:26,929 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:26,931 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:26,934 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:26,946 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:26,946 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:43:26,953 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:43:26,954 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:43:26,961 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:26,961 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:43:26,972 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:26,973 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:43:26,973 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:26,991 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:26,996 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:43:27,004 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:43:27,004 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:27,005 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:27,005 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:27,005 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:27,005 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:27,006 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:43:27,006 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:27,006 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:43:27,006 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:27,008 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:43:27,008 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:43:27,008 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:27,009 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:43:27,009 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:27,009 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:27,009 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:27,009 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:43:27,010 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:43:27,010 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:43:27,010 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:43:27,010 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:43:27,010 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:43:27,013 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:43:27,013 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:43:27,013 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:43:27,014 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:43:27,014 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:43:27,014 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:43:27,014 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:27,014 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:43:27,015 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:27,015 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:27,015 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:27,015 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:43:27,016 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:43:27,016 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:43:27,016 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:43:27,021 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:43:27,022 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:27,023 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:27,023 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:43:27,025 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:27,025 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:27,025 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:27,026 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:27,041 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4148, Threshold=0.4464, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:43:27,041 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4148
2025-08-04 20:43:44,312 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:44,312 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:43:44,313 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:43:44,313 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:43:44,313 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:43:44,313 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:44,649 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:44,649 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:44,734 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:43:44,788 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:43:44,788 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:44,921 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:44,929 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:44,930 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:44,936 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:43:44,942 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:44,942 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:43:44,942 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:44,943 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:44,943 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:43:44,951 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:44,954 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:44,956 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:44,958 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:44,961 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:44,963 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:44,966 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:44,968 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:44,971 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:44,973 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:44,975 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:44,985 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:44,985 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:43:44,990 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:43:44,990 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:43:44,995 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:44,995 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:43:45,004 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:45,005 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:43:45,005 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:45,022 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:45,027 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:43:45,035 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:43:45,035 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:45,035 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:45,036 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:45,036 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:45,036 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:45,036 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:43:45,037 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:45,037 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:43:45,037 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:45,038 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:43:45,039 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:43:45,039 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:45,039 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:43:45,039 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:45,039 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:45,040 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:45,040 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:43:45,040 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:43:45,040 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:43:45,040 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:43:45,040 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:43:45,040 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:43:45,041 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:43:45,041 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:43:45,042 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:43:45,042 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:43:45,042 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:43:45,042 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:43:45,042 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:45,043 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:43:45,043 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:45,043 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:45,043 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:45,044 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:43:45,044 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:43:45,044 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:43:45,044 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:43:45,050 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:43:45,051 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:45,052 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:45,052 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:43:45,054 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:45,054 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:45,054 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:45,055 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:45,070 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4512, Threshold=0.4819, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:43:45,070 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4512
2025-08-04 20:43:59,350 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:59,350 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:43:59,350 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:43:59,350 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:43:59,350 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:43:59,350 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:59,645 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:59,646 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:59,737 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:43:59,764 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:43:59,765 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:59,901 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:59,910 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:59,910 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:59,919 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:43:59,945 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:59,945 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:43:59,945 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:59,946 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:59,946 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:43:59,955 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:59,958 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:59,961 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:59,965 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:59,969 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:59,972 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:59,976 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:59,979 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:59,982 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:59,983 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:59,986 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:59,997 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:59,998 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:44:00,003 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:44:00,003 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:44:00,009 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:00,009 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:44:00,022 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:00,022 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:44:00,022 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:00,038 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:00,044 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:44:00,049 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:44:00,049 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:00,049 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:00,049 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:00,049 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:00,050 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:00,050 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:44:00,050 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:00,050 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:44:00,050 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:00,052 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:44:00,052 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:44:00,052 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:00,052 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:44:00,053 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:00,053 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:00,053 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:00,053 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:44:00,053 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:44:00,053 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:44:00,053 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:44:00,053 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:44:00,054 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:44:00,055 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:44:00,055 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:44:00,055 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:44:00,055 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:44:00,055 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:44:00,056 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:44:00,056 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:00,056 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:44:00,056 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:00,056 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:00,057 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:00,057 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:44:00,057 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:44:00,057 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:44:00,057 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:44:00,065 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:44:00,066 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:00,067 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:00,067 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:44:00,069 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:00,069 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:00,069 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:00,070 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:00,083 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.3886, Threshold=0.4011, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:44:00,083 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.3886
2025-08-04 20:44:11,351 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:11,351 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:44:11,351 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:44:11,352 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:44:11,352 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:44:11,352 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:11,767 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:11,768 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:11,862 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:44:11,917 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:44:11,917 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:12,080 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:12,092 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:12,092 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:12,100 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:44:12,110 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:12,110 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:44:12,111 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:12,111 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:12,112 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:44:12,123 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:12,128 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:12,132 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:12,135 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:12,138 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:12,140 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:12,143 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:12,146 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:12,149 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:12,151 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:12,153 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:12,166 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:12,166 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:44:12,171 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:44:12,171 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:44:12,177 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:12,177 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:44:12,190 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:12,191 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:44:12,191 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:12,209 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:12,216 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:44:12,222 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:44:12,222 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:12,222 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:12,223 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:12,223 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:12,223 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:12,224 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:44:12,224 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:12,224 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:44:12,224 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:12,226 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:44:12,226 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:44:12,227 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:12,227 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:44:12,227 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:12,228 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:12,228 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:12,228 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:44:12,228 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:44:12,228 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:44:12,229 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:44:12,229 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:44:12,229 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:44:12,230 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:44:12,231 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:44:12,231 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:44:12,231 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:44:12,231 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:44:12,232 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:44:12,232 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:12,232 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:44:12,232 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:12,232 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:12,233 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:12,233 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:44:12,233 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:44:12,233 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:44:12,233 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:44:12,237 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:44:12,238 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:12,239 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:12,239 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:44:12,241 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:12,241 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:12,241 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:12,242 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:12,256 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4117, Threshold=0.4282, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:44:12,257 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4117
2025-08-04 20:44:32,552 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:32,553 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:44:32,553 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:44:32,553 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:44:32,553 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:44:32,553 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:32,853 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:32,854 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:32,944 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:44:32,973 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:44:32,974 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:33,105 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:33,113 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:33,113 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:33,121 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:44:33,158 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:33,158 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:44:33,159 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:33,159 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:33,159 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:44:33,168 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:33,171 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:33,174 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:33,176 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:33,179 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:33,182 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:33,185 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:33,188 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:33,191 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:33,193 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:33,195 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:33,206 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:33,206 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:44:33,211 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:44:33,212 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:44:33,217 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:33,217 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:44:33,231 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:33,232 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:44:33,232 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:33,248 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:33,252 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:44:33,258 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:44:33,258 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:33,258 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:33,258 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:33,259 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:33,259 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:33,259 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:44:33,260 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:33,260 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:44:33,260 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:33,261 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:44:33,262 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:44:33,262 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:33,262 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:44:33,262 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:33,262 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:33,263 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:33,263 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:44:33,263 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:44:33,263 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:44:33,263 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:44:33,263 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:44:33,263 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:44:33,265 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:44:33,265 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:44:33,265 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:44:33,265 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:44:33,266 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:44:33,266 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:44:33,266 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:33,266 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:44:33,267 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:33,267 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:33,267 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:33,267 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:44:33,267 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:44:33,267 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:44:33,267 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:44:33,274 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:44:33,274 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:33,275 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:33,276 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:44:33,277 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:33,277 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:33,277 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:33,278 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:33,291 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4224, Threshold=0.4368, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:44:33,291 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4224
2025-08-04 20:44:50,562 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:50,562 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:44:50,562 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:44:50,562 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:44:50,562 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:44:50,562 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:50,863 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:50,864 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:50,952 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:44:51,005 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:44:51,005 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:51,188 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:51,197 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:51,198 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:51,210 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:44:51,221 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:51,221 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:44:51,222 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:51,223 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:51,223 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:44:51,235 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:51,238 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:51,240 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:51,243 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:51,247 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:51,250 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:51,252 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:51,255 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:51,258 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:51,260 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:51,263 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:51,276 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:51,276 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:44:51,282 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:44:51,282 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:44:51,291 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:51,291 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:44:51,309 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:51,310 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:44:51,310 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:51,329 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:51,336 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:44:51,360 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:44:51,360 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:51,360 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:51,361 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:51,361 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:51,362 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:51,362 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:44:51,363 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:51,363 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:44:51,363 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:51,365 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:44:51,365 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:44:51,366 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:51,366 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:44:51,366 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:51,366 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:51,367 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:51,367 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:44:51,367 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:44:51,368 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:44:51,368 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:44:51,368 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:44:51,369 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:44:51,372 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:44:51,372 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:44:51,372 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:44:51,372 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:44:51,373 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:44:51,373 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:44:51,373 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:51,374 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:44:51,374 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:51,374 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:51,375 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:51,375 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:44:51,375 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:44:51,375 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:44:51,375 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:44:51,385 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:44:51,385 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:51,386 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:51,387 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:44:51,388 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:51,388 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:51,388 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:51,389 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:51,403 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4441, Threshold=0.4647, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:44:51,404 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4441
2025-08-04 20:45:11,692 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:11,692 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:45:11,692 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:45:11,692 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:45:11,693 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:45:11,693 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:11,929 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:11,929 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:12,017 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:45:12,041 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:45:12,041 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:12,165 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:12,176 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:12,177 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:12,188 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:45:12,220 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:12,220 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:45:12,221 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:12,221 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:12,221 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:45:12,234 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:12,239 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:12,243 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:12,246 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:12,250 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:12,252 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:12,255 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:12,258 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:12,261 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:12,263 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:12,266 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:12,277 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:12,277 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:45:12,283 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:45:12,283 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:45:12,291 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:12,291 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:45:12,305 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:12,306 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:45:12,306 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:12,324 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:12,330 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:45:12,341 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:45:12,342 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:12,342 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:12,342 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:12,343 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:12,343 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:12,343 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:45:12,343 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:12,344 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:45:12,344 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:12,345 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:45:12,345 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:45:12,346 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:12,346 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:45:12,346 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:12,346 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:12,346 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:12,347 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:45:12,347 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:45:12,347 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:45:12,347 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:45:12,348 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:45:12,348 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:45:12,350 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:45:12,351 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:45:12,351 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:45:12,351 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:45:12,351 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:45:12,351 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:45:12,351 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:12,352 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:45:12,352 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:12,352 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:12,353 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:12,353 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:45:12,353 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:45:12,353 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:45:12,353 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:45:12,357 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:45:12,357 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:12,359 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:12,359 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:45:12,361 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:12,361 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:12,361 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:12,362 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:12,376 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4621, Threshold=0.4916, Accuracy=0.7257, F1=0.8096, Precision=0.9767, Recall=0.6914
2025-08-04 20:45:12,377 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7257, F1: 0.8096, Prec: 0.9767, Rec: 0.6914, Avg Anomaly Score: 0.4621
2025-08-04 20:45:20,635 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:20,635 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:45:20,636 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:45:20,636 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:45:20,636 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:45:20,636 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:20,920 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:20,920 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:21,004 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:45:21,046 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:45:21,046 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:21,163 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:21,170 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:21,170 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:21,176 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:45:21,181 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:21,182 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:45:21,182 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:21,182 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:21,182 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:45:21,191 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:21,194 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:21,197 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:21,199 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:21,202 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:21,204 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:21,206 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:21,209 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:21,212 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:21,214 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:21,216 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:21,225 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:21,225 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:45:21,230 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:45:21,230 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:45:21,235 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:21,235 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:45:21,245 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:21,246 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:45:21,246 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:21,262 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:21,267 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:45:21,273 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:45:21,273 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:21,273 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:21,273 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:21,274 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:21,274 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:21,274 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:45:21,274 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:21,275 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:45:21,275 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:21,276 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:45:21,276 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:45:21,277 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:21,277 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:45:21,277 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:21,277 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:21,277 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:21,277 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:45:21,278 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:45:21,278 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:45:21,278 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:45:21,278 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:45:21,278 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:45:21,280 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:45:21,280 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:45:21,281 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:45:21,281 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:45:21,281 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:45:21,281 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:45:21,281 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:21,281 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:45:21,282 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:21,282 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:21,282 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:21,282 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:45:21,282 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:45:21,282 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:45:21,283 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:45:21,286 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:45:21,286 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:21,287 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:21,287 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:45:21,289 - ClientAppLogger [Client 9] - INFO - [Client] Fit started for round 104/400.
2025-08-04 20:45:21,390 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:21,390 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:21,392 - ClientAppLogger [Client 9] - INFO - [Client] Semi-supervised: Added 759 anomalous samples to GAN training data (target: 759).
2025-08-04 20:45:21,393 - ClientAppLogger [Client 9] - INFO - [Client] Round 104: Training GAN with 3292 samples (2533 normal, 759 anomalous).
2025-08-04 20:45:21,393 - ClientAppLogger [Client 9] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:23,677 - ClientAppLogger [Client 9] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0847, Avg D Loss: 0.7957
2025-08-04 20:45:23,677 - ClientAppLogger [Client 9] - INFO - GAN Training completed. Avg G Loss: 2.0847, Avg D Loss: 0.7957
2025-08-04 20:45:23,677 - ClientAppLogger [Client 9] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:23,689 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5369, Threshold=0.6091, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:45:23,690 - ClientAppLogger [Client 9] - INFO - [Client] Post-fit local evaluation F1: 0.8111
2025-08-04 20:45:23,690 - ClientAppLogger [Client 9] - INFO - Fit completed for round 104. Duration: 2.40s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '9', 'server_round': 104, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.084749296542941, 'd_loss': 0.7957158286400584, 'post_fit_local_f1': 0.8110709987966306, 'fit_time_seconds': 2.4012012481689453, 'cpu_percent_fit': 6.25, 'ram_mb_fit': 4.0390625, 'accumulated_train_samples_this_round': 3292}
2025-08-04 20:45:23,690 - ClientAppLogger [Client 9] - INFO - [Client] get_parameters called
2025-08-04 20:45:31,943 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:31,943 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:45:31,943 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:45:31,943 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:45:31,943 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:45:31,943 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:32,169 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:32,169 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:32,250 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:45:32,270 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:45:32,271 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:32,357 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:32,364 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:32,364 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:32,370 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:45:32,378 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:32,378 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:45:32,378 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:32,379 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:32,379 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:45:32,387 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:32,390 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:32,392 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:32,394 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:32,397 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:32,399 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:32,401 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:32,404 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:32,407 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:32,409 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:32,411 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:32,420 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:32,420 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:45:32,425 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:45:32,425 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:45:32,430 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:32,430 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:45:32,441 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:32,441 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:45:32,442 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:32,457 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:32,461 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:45:32,466 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:45:32,466 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:32,466 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:32,467 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:32,467 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:32,467 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:32,467 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:45:32,467 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:32,468 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:45:32,468 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:32,469 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:45:32,469 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:45:32,470 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:32,470 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:45:32,470 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:32,470 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:32,470 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:32,471 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:45:32,471 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:45:32,471 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:45:32,471 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:45:32,471 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:45:32,471 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:45:32,473 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:45:32,473 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:45:32,473 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:45:32,473 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:45:32,474 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:45:32,474 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:45:32,474 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:32,477 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:45:32,477 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:32,477 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:32,478 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:32,478 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:45:32,478 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:45:32,478 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:45:32,478 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:45:32,482 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:45:32,482 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:32,483 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:32,483 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:45:32,485 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:32,485 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:32,485 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:32,486 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:32,500 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4944, Threshold=0.5296, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:45:32,500 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.4944
2025-08-04 20:45:37,752 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:37,752 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:45:37,752 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:45:37,752 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:45:37,752 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:45:37,752 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:37,994 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:37,994 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:38,076 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:45:38,097 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:45:38,097 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:38,182 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:38,188 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:38,188 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:38,193 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:45:38,200 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:38,201 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:45:38,201 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:38,201 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:38,201 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:45:38,210 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:38,213 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:38,215 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:38,217 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:38,220 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:38,222 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:38,225 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:38,227 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:38,230 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:38,232 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:38,234 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:38,242 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:38,242 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:45:38,247 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:45:38,247 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:45:38,251 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:38,251 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:45:38,260 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:38,260 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:45:38,260 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:38,275 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:38,280 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:45:38,285 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:45:38,285 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:38,285 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:38,285 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:38,285 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:38,286 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:38,286 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:45:38,286 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:38,286 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:45:38,286 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:38,287 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:45:38,288 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:45:38,288 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:38,288 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:45:38,288 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:38,288 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:38,288 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:38,288 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:45:38,289 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:45:38,289 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:45:38,289 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:45:38,289 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:45:38,289 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:45:38,290 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:45:38,290 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:45:38,290 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:45:38,291 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:45:38,291 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:45:38,291 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:45:38,291 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:38,291 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:45:38,292 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:38,292 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:38,292 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:38,292 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:45:38,292 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:45:38,292 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:45:38,293 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:45:38,296 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:45:38,296 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:38,297 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:38,297 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:45:38,299 - ClientAppLogger [Client 9] - INFO - [Client] Fit started for round 105/400.
2025-08-04 20:45:38,399 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:38,399 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:38,401 - ClientAppLogger [Client 9] - INFO - [Client] Semi-supervised: Added 766 anomalous samples to GAN training data (target: 766).
2025-08-04 20:45:38,401 - ClientAppLogger [Client 9] - INFO - [Client] Round 105: Training GAN with 3322 samples (2556 normal, 766 anomalous).
2025-08-04 20:45:38,401 - ClientAppLogger [Client 9] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:40,743 - ClientAppLogger [Client 9] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0847, Avg D Loss: 0.7932
2025-08-04 20:45:40,744 - ClientAppLogger [Client 9] - INFO - GAN Training completed. Avg G Loss: 2.0847, Avg D Loss: 0.7932
2025-08-04 20:45:40,744 - ClientAppLogger [Client 9] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:40,756 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5162, Threshold=0.5791, Accuracy=0.7240, F1=0.8087, Precision=0.9739, Recall=0.6914
2025-08-04 20:45:40,756 - ClientAppLogger [Client 9] - INFO - [Client] Post-fit local evaluation F1: 0.8087
2025-08-04 20:45:40,756 - ClientAppLogger [Client 9] - INFO - Fit completed for round 105. Duration: 2.46s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '9', 'server_round': 105, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0846989079314064, 'd_loss': 0.7931585365716842, 'post_fit_local_f1': 0.8086642599277978, 'fit_time_seconds': 2.4578030109405518, 'cpu_percent_fit': 6.25625, 'ram_mb_fit': -2.125, 'accumulated_train_samples_this_round': 3322}
2025-08-04 20:45:40,757 - ClientAppLogger [Client 9] - INFO - [Client] get_parameters called
2025-08-04 20:45:46,056 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:46,056 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:45:46,057 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:45:46,057 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:45:46,057 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:45:46,057 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:46,428 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:46,428 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:46,519 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:45:46,542 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:45:46,543 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:46,636 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:46,643 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:46,643 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:46,650 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:45:46,659 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:46,659 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:45:46,660 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:46,660 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:46,660 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:45:46,669 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:46,672 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:46,674 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:46,676 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:46,679 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:46,681 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:46,684 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:46,686 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:46,690 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:46,692 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:46,694 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:46,704 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:46,704 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:45:46,709 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:45:46,709 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:45:46,715 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:46,715 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:45:46,726 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:46,726 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:45:46,726 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:46,740 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:46,745 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:45:46,749 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:45:46,749 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:46,749 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:46,750 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:46,750 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:46,750 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:46,750 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:45:46,750 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:46,751 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:45:46,751 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:46,752 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:45:46,753 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:45:46,753 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:46,753 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:45:46,753 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:46,753 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:46,753 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:46,754 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:45:46,754 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:45:46,754 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:45:46,754 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:45:46,754 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:45:46,754 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:45:46,755 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:45:46,755 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:45:46,756 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:45:46,756 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:45:46,756 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:45:46,756 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:45:46,756 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:46,756 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:45:46,757 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:46,757 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:46,757 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:46,757 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:45:46,757 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:45:46,758 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:45:46,758 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:45:46,761 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:45:46,761 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:46,762 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:46,762 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:45:46,763 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:46,763 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:46,764 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:46,764 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:46,776 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5072, Threshold=0.5642, Accuracy=0.7240, F1=0.8087, Precision=0.9739, Recall=0.6914
2025-08-04 20:45:46,776 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7240, F1: 0.8087, Prec: 0.9739, Rec: 0.6914, Avg Anomaly Score: 0.5072
2025-08-04 20:45:58,061 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:58,061 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:45:58,061 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:45:58,062 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:45:58,062 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:45:58,062 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:58,411 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:58,411 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:58,499 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:45:58,540 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:45:58,541 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:58,661 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:58,668 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:58,668 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:58,673 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:45:58,678 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:58,679 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:45:58,679 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:58,679 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:58,679 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:45:58,688 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:58,691 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:58,693 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:58,696 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:58,699 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:58,702 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:58,704 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:58,707 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:58,711 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:58,713 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:58,715 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:58,725 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:58,725 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:45:58,730 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:45:58,730 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:45:58,734 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:58,734 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:45:58,743 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:58,743 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:45:58,743 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:58,758 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:58,762 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:45:58,767 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:45:58,768 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:58,768 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:58,768 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:58,768 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:58,769 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:58,769 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:45:58,769 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:58,769 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:45:58,769 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:58,771 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:45:58,771 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:45:58,771 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:58,771 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:45:58,771 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:58,771 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:58,771 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:58,772 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:45:58,772 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:45:58,772 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:45:58,772 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:45:58,772 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:45:58,772 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:45:58,774 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:45:58,774 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:45:58,774 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:45:58,774 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:45:58,774 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:45:58,774 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:45:58,774 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:58,775 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:45:58,775 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:58,775 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:58,775 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:58,775 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:45:58,776 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:45:58,776 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:45:58,776 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:45:58,779 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:45:58,779 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:58,780 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:58,780 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:45:58,782 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:58,782 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:58,782 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:58,782 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:58,796 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4629, Threshold=0.5018, Accuracy=0.7378, F1=0.8183, Precision=0.9855, Recall=0.6996
2025-08-04 20:45:58,796 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7378, F1: 0.8183, Prec: 0.9855, Rec: 0.6996, Avg Anomaly Score: 0.4629
2025-08-04 20:46:13,080 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:13,080 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:46:13,080 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:46:13,080 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:46:13,080 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:46:13,080 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:13,443 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:13,443 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:13,538 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:46:13,566 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:46:13,566 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:13,669 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:13,676 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:13,676 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:13,683 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:46:13,693 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:13,693 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:46:13,694 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:13,694 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:13,694 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:46:13,704 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:13,707 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:13,710 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:13,712 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:13,715 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:13,718 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:13,721 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:13,724 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:13,727 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:13,729 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:13,731 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:13,742 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:13,742 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:46:13,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:46:13,748 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:46:13,753 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:13,754 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:46:13,764 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:13,765 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:46:13,765 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:13,780 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:13,785 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:46:13,791 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:46:13,791 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:13,791 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:13,791 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:13,792 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:13,792 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:13,792 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:46:13,792 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:13,792 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:46:13,793 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:13,794 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:46:13,794 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:46:13,794 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:13,794 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:46:13,795 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:13,795 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:13,795 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:13,795 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:46:13,795 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:46:13,795 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:46:13,795 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:46:13,796 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:46:13,796 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:46:13,797 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:46:13,797 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:46:13,797 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:46:13,797 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:46:13,797 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:46:13,797 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:46:13,797 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:13,798 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:46:13,798 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:13,798 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:13,798 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:13,798 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:46:13,799 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:46:13,799 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:46:13,799 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:46:13,801 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:46:13,801 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:13,802 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:13,802 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:46:13,804 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:13,804 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:13,804 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:13,805 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:13,819 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4685, Threshold=0.5089, Accuracy=0.7344, F1=0.8159, Precision=0.9826, Recall=0.6975
2025-08-04 20:46:13,819 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7344, F1: 0.8159, Prec: 0.9826, Rec: 0.6975, Avg Anomaly Score: 0.4685
2025-08-04 20:46:19,083 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:19,083 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:46:19,083 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:46:19,083 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:46:19,083 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:46:19,084 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:19,390 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:19,390 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:19,473 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:46:19,517 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:46:19,517 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:19,628 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:19,634 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:19,634 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:19,640 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:46:19,645 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:19,645 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:46:19,646 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:19,646 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:19,646 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:46:19,654 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:19,657 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:19,660 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:19,662 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:19,665 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:19,667 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:19,670 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:19,672 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:19,675 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:19,677 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:19,679 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:19,689 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:19,689 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:46:19,694 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:46:19,694 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:46:19,699 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:19,699 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:46:19,708 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:19,708 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:46:19,708 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:19,724 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:19,729 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:46:19,736 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:46:19,736 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:19,736 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:19,736 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:19,737 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:19,737 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:19,737 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:46:19,737 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:19,737 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:46:19,738 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:19,739 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:46:19,739 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:46:19,739 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:19,739 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:46:19,739 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:19,740 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:19,740 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:19,740 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:46:19,740 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:46:19,740 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:46:19,740 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:46:19,740 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:46:19,740 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:46:19,741 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:46:19,741 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:46:19,742 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:46:19,742 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:46:19,742 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:46:19,742 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:46:19,742 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:19,742 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:46:19,743 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:19,743 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:19,743 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:19,743 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:46:19,744 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:46:19,744 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:46:19,744 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:46:19,750 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:46:19,750 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:19,752 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:19,752 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:46:19,753 - ClientAppLogger [Client 9] - INFO - [Client] Fit started for round 108/400.
2025-08-04 20:46:19,855 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:19,855 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:19,856 - ClientAppLogger [Client 9] - INFO - [Client] Semi-supervised: Added 789 anomalous samples to GAN training data (target: 789).
2025-08-04 20:46:19,857 - ClientAppLogger [Client 9] - INFO - [Client] Round 108: Training GAN with 3419 samples (2630 normal, 789 anomalous).
2025-08-04 20:46:19,857 - ClientAppLogger [Client 9] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:22,289 - ClientAppLogger [Client 9] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0846, Avg D Loss: 0.7920
2025-08-04 20:46:22,289 - ClientAppLogger [Client 9] - INFO - GAN Training completed. Avg G Loss: 2.0846, Avg D Loss: 0.7920
2025-08-04 20:46:22,290 - ClientAppLogger [Client 9] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:22,302 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5092, Threshold=0.5518, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:46:22,303 - ClientAppLogger [Client 9] - INFO - [Client] Post-fit local evaluation F1: 0.8111
2025-08-04 20:46:22,303 - ClientAppLogger [Client 9] - INFO - Fit completed for round 108. Duration: 2.55s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '9', 'server_round': 108, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.084585881979363, 'd_loss': 0.7919501342265081, 'post_fit_local_f1': 0.8110709987966306, 'fit_time_seconds': 2.5496490001678467, 'cpu_percent_fit': 6.25625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 3419}
2025-08-04 20:46:22,303 - ClientAppLogger [Client 9] - INFO - [Client] get_parameters called
2025-08-04 20:46:30,583 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:30,583 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:46:30,583 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:46:30,583 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:46:30,583 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:46:30,584 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:30,961 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:30,961 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:31,054 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:46:31,103 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:46:31,103 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:31,231 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:31,238 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:31,241 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:31,246 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:46:31,252 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:31,252 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:46:31,253 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:31,253 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:31,253 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:46:31,262 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:31,266 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:31,270 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:31,272 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:31,278 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:31,281 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:31,283 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:31,286 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:31,289 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:31,291 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:31,293 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:31,303 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:31,303 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:46:31,307 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:46:31,308 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:46:31,312 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:31,312 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:46:31,320 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:31,320 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:46:31,320 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:31,335 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:31,340 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:46:31,347 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:46:31,347 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:31,347 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:31,348 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:31,348 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:31,348 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:31,349 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:46:31,349 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:31,349 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:46:31,349 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:31,351 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:46:31,351 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:46:31,351 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:31,351 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:46:31,352 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:31,352 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:31,352 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:31,352 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:46:31,352 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:46:31,352 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:46:31,352 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:46:31,352 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:46:31,353 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:46:31,354 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:46:31,354 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:46:31,354 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:46:31,354 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:46:31,354 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:46:31,355 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:46:31,355 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:31,355 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:46:31,355 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:31,355 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:31,356 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:31,356 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:46:31,356 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:46:31,356 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:46:31,356 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:46:31,360 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:46:31,360 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:31,362 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:31,362 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:46:31,364 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:31,364 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:31,364 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:31,365 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:31,377 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4881, Threshold=0.5344, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:46:31,377 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.4881
2025-08-04 20:46:45,665 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:45,665 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:46:45,665 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:46:45,665 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:46:45,666 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:46:45,666 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:45,982 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:45,982 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:46,071 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:46:46,117 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:46:46,117 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:46,239 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:46,245 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:46,245 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:46,250 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:46:46,257 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:46,257 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:46:46,257 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:46,257 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:46,258 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:46:46,267 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:46,270 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:46,272 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:46,275 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:46,278 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:46,280 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:46,283 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:46,285 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:46,288 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:46,290 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:46,292 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:46,301 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:46,301 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:46:46,306 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:46:46,306 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:46:46,310 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:46,310 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:46:46,319 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:46,320 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:46:46,320 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:46,337 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:46,342 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:46:46,347 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:46:46,347 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:46,347 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:46,348 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:46,348 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:46,348 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:46,348 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:46:46,349 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:46,349 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:46:46,349 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:46,350 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:46:46,350 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:46:46,351 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:46,351 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:46:46,351 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:46,351 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:46,351 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:46,351 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:46:46,351 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:46:46,352 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:46:46,352 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:46:46,352 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:46:46,352 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:46:46,353 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:46:46,353 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:46:46,353 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:46:46,353 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:46:46,353 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:46:46,353 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:46:46,354 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:46,354 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:46:46,354 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:46,354 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:46,355 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:46,355 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:46:46,355 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:46:46,355 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:46:46,355 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:46:46,358 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:46:46,358 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:46,360 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:46,360 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:46:46,362 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:46,362 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:46,362 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:46,363 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:46,375 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4709, Threshold=0.5144, Accuracy=0.7344, F1=0.8159, Precision=0.9826, Recall=0.6975
2025-08-04 20:46:46,375 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7344, F1: 0.8159, Prec: 0.9826, Rec: 0.6975, Avg Anomaly Score: 0.4709
2025-08-04 20:46:51,634 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:51,634 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:46:51,634 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:46:51,634 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:46:51,634 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:46:51,635 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:51,910 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:51,910 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:51,999 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:46:52,043 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:46:52,043 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:52,159 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:52,165 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:52,165 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:52,170 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:46:52,175 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:52,175 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:46:52,176 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:52,176 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:52,176 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:46:52,184 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:52,187 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:52,189 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:52,192 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:52,194 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:52,197 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:52,199 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:52,202 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:52,205 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:52,207 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:52,209 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:52,218 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:52,219 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:46:52,223 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:46:52,224 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:46:52,228 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:52,228 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:46:52,240 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:52,240 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:46:52,240 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:52,257 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:52,262 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:46:52,267 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:46:52,267 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:52,267 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:52,267 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:52,268 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:52,268 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:52,268 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:46:52,268 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:52,269 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:46:52,269 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:52,270 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:46:52,270 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:46:52,271 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:52,271 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:46:52,271 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:52,271 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:52,271 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:52,271 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:46:52,271 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:46:52,271 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:46:52,272 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:46:52,272 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:46:52,272 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:46:52,273 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:46:52,273 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:46:52,273 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:46:52,273 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:46:52,273 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:46:52,273 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:46:52,273 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:52,274 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:46:52,274 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:52,274 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:52,274 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:52,275 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:46:52,275 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:46:52,275 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:46:52,275 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:46:52,278 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:46:52,278 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:52,280 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:52,280 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:46:52,281 - ClientAppLogger [Client 9] - INFO - [Client] Fit started for round 110/400.
2025-08-04 20:46:52,383 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:52,383 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:52,384 - ClientAppLogger [Client 9] - INFO - [Client] Semi-supervised: Added 800 anomalous samples to GAN training data (target: 800).
2025-08-04 20:46:52,385 - ClientAppLogger [Client 9] - INFO - [Client] Round 110: Training GAN with 3468 samples (2668 normal, 800 anomalous).
2025-08-04 20:46:52,385 - ClientAppLogger [Client 9] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:54,752 - ClientAppLogger [Client 9] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0846, Avg D Loss: 0.7885
2025-08-04 20:46:54,752 - ClientAppLogger [Client 9] - INFO - GAN Training completed. Avg G Loss: 2.0846, Avg D Loss: 0.7885
2025-08-04 20:46:54,753 - ClientAppLogger [Client 9] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:54,766 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5128, Threshold=0.5647, Accuracy=0.7240, F1=0.8087, Precision=0.9739, Recall=0.6914
2025-08-04 20:46:54,766 - ClientAppLogger [Client 9] - INFO - [Client] Post-fit local evaluation F1: 0.8087
2025-08-04 20:46:54,766 - ClientAppLogger [Client 9] - INFO - Fit completed for round 110. Duration: 2.48s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '9', 'server_round': 110, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0845749941114184, 'd_loss': 0.7884981903787852, 'post_fit_local_f1': 0.8086642599277978, 'fit_time_seconds': 2.4847850799560547, 'cpu_percent_fit': 6.24375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 3468}
2025-08-04 20:46:54,766 - ClientAppLogger [Client 9] - INFO - [Client] get_parameters called
2025-08-04 20:47:00,014 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:00,014 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:47:00,014 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:47:00,014 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:47:00,014 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:47:00,014 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:00,260 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:00,260 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:00,352 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:47:00,400 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:47:00,401 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:00,560 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:00,568 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:00,568 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:00,575 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:47:00,584 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:00,584 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:47:00,585 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:00,585 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:00,585 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:47:00,594 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:00,598 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:00,600 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:00,602 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:00,605 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:00,607 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:00,610 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:00,613 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:00,616 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:00,619 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:00,621 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:00,636 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:00,636 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:47:00,641 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:47:00,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:47:00,647 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:00,647 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:47:00,657 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:00,658 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:47:00,658 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:00,674 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:00,680 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:47:00,689 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:47:00,689 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:00,689 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:00,689 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:00,690 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:00,690 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:00,690 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:47:00,690 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:00,690 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:47:00,691 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:00,692 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:47:00,692 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:47:00,692 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:00,692 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:47:00,693 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:00,693 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:00,693 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:00,693 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:47:00,694 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:47:00,694 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:47:00,694 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:47:00,694 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:47:00,694 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:47:00,696 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:47:00,697 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:47:00,697 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:47:00,697 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:47:00,697 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:47:00,697 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:47:00,697 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:00,698 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:47:00,698 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:00,699 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:00,699 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:00,699 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:47:00,699 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:47:00,699 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:47:00,699 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:47:00,705 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:47:00,705 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:00,707 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:00,707 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:47:00,709 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:00,709 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:00,709 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:00,710 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:00,723 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5106, Threshold=0.5591, Accuracy=0.7240, F1=0.8087, Precision=0.9739, Recall=0.6914
2025-08-04 20:47:00,723 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7240, F1: 0.8087, Prec: 0.9739, Rec: 0.6914, Avg Anomaly Score: 0.5106
2025-08-04 20:47:15,001 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:15,001 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:47:15,001 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:47:15,001 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:47:15,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:47:15,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:15,271 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:15,272 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:15,358 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:47:15,404 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:47:15,405 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:15,534 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:15,543 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:15,543 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:15,550 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:47:15,558 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:15,558 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:47:15,559 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:15,559 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:15,559 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:47:15,570 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:15,573 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:15,575 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:15,577 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:15,580 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:15,582 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:15,584 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:15,587 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:15,590 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:15,592 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:15,595 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:15,606 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:15,606 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:47:15,611 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:47:15,611 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:47:15,616 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:15,616 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:47:15,627 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:15,627 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:47:15,628 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:15,644 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:15,649 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:47:15,667 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:47:15,667 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:15,667 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:15,667 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:15,668 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:15,668 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:15,668 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:47:15,668 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:15,668 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:47:15,669 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:15,670 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:47:15,670 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:47:15,671 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:15,671 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:47:15,671 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:15,671 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:15,671 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:15,671 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:47:15,672 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:47:15,672 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:47:15,672 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:47:15,672 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:47:15,672 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:47:15,674 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:47:15,674 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:47:15,675 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:47:15,675 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:47:15,675 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:47:15,675 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:47:15,675 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:15,675 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:47:15,676 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:15,676 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:15,676 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:15,676 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:47:15,677 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:47:15,677 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:47:15,677 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:47:15,683 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:47:15,683 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:15,684 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:15,684 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:47:15,686 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:15,686 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:15,686 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:15,687 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:15,700 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4810, Threshold=0.5275, Accuracy=0.7344, F1=0.8159, Precision=0.9826, Recall=0.6975
2025-08-04 20:47:15,701 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7344, F1: 0.8159, Prec: 0.9826, Rec: 0.6975, Avg Anomaly Score: 0.4810
2025-08-04 20:47:33,000 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:33,000 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:47:33,000 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:47:33,001 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:47:33,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:47:33,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:33,326 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:33,326 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:33,414 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:47:33,459 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:47:33,460 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:33,610 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:33,619 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:33,619 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:33,628 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:47:33,636 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:33,636 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:47:33,636 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:33,636 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:33,637 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:47:33,646 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:33,649 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:33,651 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:33,653 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:33,657 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:33,659 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:33,662 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:33,665 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:33,668 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:33,670 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:33,674 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:33,685 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:33,685 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:47:33,690 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:47:33,690 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:47:33,696 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:33,696 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:47:33,708 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:33,709 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:47:33,709 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:33,725 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:33,731 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:47:33,738 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:47:33,738 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:33,738 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:33,739 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:33,739 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:33,739 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:33,740 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:47:33,740 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:33,740 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:47:33,740 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:33,742 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:47:33,742 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:47:33,742 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:33,742 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:47:33,743 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:33,743 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:33,743 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:33,743 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:47:33,743 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:47:33,743 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:47:33,743 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:47:33,744 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:47:33,744 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:47:33,745 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:47:33,746 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:47:33,746 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:47:33,746 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:47:33,746 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:47:33,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:47:33,747 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:33,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:47:33,747 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:33,748 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:33,748 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:33,748 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:47:33,748 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:47:33,748 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:47:33,748 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:47:33,754 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:47:33,754 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:33,755 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:33,756 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:47:33,757 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:33,757 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:33,757 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:33,758 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:33,772 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4490, Threshold=0.4818, Accuracy=0.7344, F1=0.8159, Precision=0.9826, Recall=0.6975
2025-08-04 20:47:33,772 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7344, F1: 0.8159, Prec: 0.9826, Rec: 0.6975, Avg Anomaly Score: 0.4490
2025-08-04 20:47:45,048 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:45,049 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:47:45,049 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:47:45,049 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:47:45,049 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:47:45,049 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:45,322 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:45,323 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:45,416 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:47:45,460 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:47:45,460 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:45,591 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:45,598 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:45,598 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:45,607 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:47:45,617 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:45,617 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:47:45,618 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:45,618 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:45,618 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:47:45,629 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:45,633 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:45,635 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:45,638 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:45,641 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:45,643 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:45,646 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:45,648 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:45,651 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:45,653 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:45,656 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:45,666 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:45,667 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:47:45,672 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:47:45,672 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:47:45,676 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:45,676 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:47:45,685 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:45,686 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:47:45,686 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:45,704 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:45,711 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:47:45,717 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:47:45,718 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:45,718 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:45,718 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:45,718 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:45,719 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:45,719 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:47:45,719 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:45,719 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:47:45,719 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:45,721 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:47:45,721 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:47:45,721 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:45,721 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:47:45,722 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:45,722 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:45,722 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:45,722 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:47:45,722 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:47:45,722 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:47:45,723 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:47:45,723 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:47:45,723 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:47:45,725 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:47:45,725 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:47:45,725 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:47:45,726 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:47:45,726 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:47:45,726 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:47:45,726 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:45,726 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:47:45,727 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:45,727 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:45,727 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:45,727 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:47:45,727 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:47:45,728 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:47:45,728 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:47:45,731 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:47:45,731 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:45,733 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:45,733 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:47:45,734 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:45,735 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:45,735 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:45,736 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:45,749 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4932, Threshold=0.5500, Accuracy=0.7344, F1=0.8159, Precision=0.9826, Recall=0.6975
2025-08-04 20:47:45,749 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7344, F1: 0.8159, Prec: 0.9826, Rec: 0.6975, Avg Anomaly Score: 0.4932
2025-08-04 20:47:51,013 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:51,013 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:47:51,013 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:47:51,014 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:47:51,014 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:47:51,014 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:51,287 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:51,288 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:51,374 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:47:51,400 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:47:51,400 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:51,501 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:51,508 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:51,508 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:51,514 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:47:51,536 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:51,536 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:47:51,536 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:51,536 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:51,537 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:47:51,546 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:51,549 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:51,551 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:51,553 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:51,556 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:51,558 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:51,561 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:51,563 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:51,566 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:51,568 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:51,570 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:51,579 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:51,579 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:47:51,584 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:47:51,584 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:47:51,590 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:51,590 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:47:51,601 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:51,601 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:47:51,601 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:51,618 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:51,624 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:47:51,628 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:47:51,629 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:51,629 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:51,629 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:51,629 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:51,629 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:51,630 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:47:51,630 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:51,630 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:47:51,630 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:51,632 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:47:51,632 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:47:51,632 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:51,632 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:47:51,633 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:51,633 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:51,633 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:51,633 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:47:51,633 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:47:51,633 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:47:51,633 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:47:51,634 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:47:51,634 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:47:51,635 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:47:51,635 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:47:51,636 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:47:51,636 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:47:51,636 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:47:51,636 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:47:51,636 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:51,637 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:47:51,637 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:51,637 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:51,637 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:51,638 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:47:51,638 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:47:51,638 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:47:51,638 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:47:51,643 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:47:51,643 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:51,644 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:51,644 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:47:51,646 - ClientAppLogger [Client 9] - INFO - [Client] Fit started for round 114/400.
2025-08-04 20:47:51,747 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:51,747 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:51,749 - ClientAppLogger [Client 9] - INFO - [Client] Semi-supervised: Added 826 anomalous samples to GAN training data (target: 826).
2025-08-04 20:47:51,749 - ClientAppLogger [Client 9] - INFO - [Client] Round 114: Training GAN with 3581 samples (2755 normal, 826 anomalous).
2025-08-04 20:47:51,750 - ClientAppLogger [Client 9] - INFO - [Client] Starting GAN training...
2025-08-04 20:47:54,268 - ClientAppLogger [Client 9] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0843, Avg D Loss: 0.7854
2025-08-04 20:47:54,269 - ClientAppLogger [Client 9] - INFO - GAN Training completed. Avg G Loss: 2.0843, Avg D Loss: 0.7854
2025-08-04 20:47:54,269 - ClientAppLogger [Client 9] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:47:54,282 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5383, Threshold=0.5967, Accuracy=0.7240, F1=0.8087, Precision=0.9739, Recall=0.6914
2025-08-04 20:47:54,282 - ClientAppLogger [Client 9] - INFO - [Client] Post-fit local evaluation F1: 0.8087
2025-08-04 20:47:54,283 - ClientAppLogger [Client 9] - INFO - Fit completed for round 114. Duration: 2.64s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '9', 'server_round': 114, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.084286157980341, 'd_loss': 0.7853621188837269, 'post_fit_local_f1': 0.8086642599277978, 'fit_time_seconds': 2.636796712875366, 'cpu_percent_fit': 6.2375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 3581}
2025-08-04 20:47:54,283 - ClientAppLogger [Client 9] - INFO - [Client] get_parameters called
2025-08-04 20:48:02,550 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:02,550 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:48:02,550 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:48:02,550 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:48:02,550 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:48:02,551 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:02,876 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:02,876 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:02,965 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:48:03,007 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:48:03,007 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:03,125 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:03,131 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:03,131 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:03,136 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:48:03,141 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:03,141 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:48:03,142 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:03,142 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:03,142 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:48:03,151 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:03,154 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:03,156 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:03,159 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:03,161 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:03,164 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:03,166 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:03,169 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:03,172 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:03,173 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:03,176 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:03,185 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:03,186 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:48:03,190 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:48:03,191 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:48:03,196 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:03,196 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:48:03,206 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:03,206 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:48:03,206 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:03,222 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:03,227 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:48:03,235 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:48:03,235 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:03,235 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:03,235 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:03,236 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:03,236 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:03,236 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:48:03,236 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:03,236 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:48:03,237 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:03,238 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:48:03,238 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:48:03,239 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:03,239 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:48:03,239 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:03,239 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:03,239 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:03,239 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:48:03,240 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:48:03,240 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:48:03,240 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:48:03,240 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:48:03,240 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:48:03,242 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:48:03,242 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:48:03,242 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:48:03,242 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:48:03,242 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:48:03,242 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:48:03,243 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:03,243 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:48:03,243 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:03,243 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:03,244 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:03,244 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:48:03,244 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:48:03,244 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:48:03,245 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:48:03,248 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:48:03,248 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:03,249 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:03,249 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:48:03,251 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:03,251 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:03,251 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:03,251 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:03,264 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5258, Threshold=0.5874, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:48:03,264 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5258
2025-08-04 20:48:14,540 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:14,540 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:48:14,540 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:48:14,540 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:48:14,540 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:48:14,540 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:14,851 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:14,851 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:14,935 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:48:14,976 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:48:14,976 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:15,094 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:15,100 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:15,101 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:15,106 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:48:15,114 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:15,114 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:48:15,114 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:15,115 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:15,115 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:48:15,123 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:15,126 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:15,128 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:15,131 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:15,137 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:15,139 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:15,142 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:15,144 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:15,147 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:15,149 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:15,151 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:15,161 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:15,161 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:48:15,166 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:48:15,166 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:48:15,171 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:15,171 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:48:15,183 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:15,183 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:48:15,183 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:15,200 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:15,204 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:48:15,209 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:48:15,210 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:15,210 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:15,210 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:15,210 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:15,211 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:15,211 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:48:15,211 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:15,211 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:48:15,212 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:15,213 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:48:15,213 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:48:15,214 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:15,214 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:48:15,214 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:15,214 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:15,214 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:15,214 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:48:15,215 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:48:15,215 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:48:15,215 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:48:15,215 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:48:15,215 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:48:15,216 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:48:15,217 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:48:15,217 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:48:15,217 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:48:15,217 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:48:15,217 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:48:15,217 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:15,218 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:48:15,218 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:15,218 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:15,218 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:15,219 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:48:15,219 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:48:15,219 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:48:15,219 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:48:15,225 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:48:15,225 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:15,226 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:15,226 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:48:15,227 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:15,228 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:15,228 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:15,228 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:15,241 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5596, Threshold=0.6212, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:48:15,241 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7274, F1: 0.8111, Prec: 0.9768, Rec: 0.6934, Avg Anomaly Score: 0.5596
2025-08-04 20:48:26,525 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:26,525 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:48:26,525 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:48:26,525 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:48:26,525 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:48:26,525 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:26,831 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:26,831 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:26,916 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:48:26,958 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:48:26,958 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:27,073 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:27,081 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:27,082 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:27,090 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:48:27,097 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:27,097 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:48:27,098 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:27,098 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:27,098 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:48:27,109 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:27,112 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:27,114 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:27,116 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:27,119 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:27,121 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:27,124 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:27,127 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:27,129 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:27,131 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:27,134 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:27,143 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:27,144 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:48:27,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:48:27,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:48:27,154 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:27,155 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:48:27,163 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:27,163 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:48:27,164 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:27,179 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:27,183 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:48:27,189 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:48:27,189 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:27,189 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:27,189 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:27,189 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:27,190 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:27,190 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:48:27,190 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:27,190 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:48:27,190 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:27,192 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:48:27,192 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:48:27,192 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:27,192 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:48:27,192 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:27,193 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:27,193 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:27,193 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:48:27,193 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:48:27,193 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:48:27,193 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:48:27,193 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:48:27,194 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:48:27,195 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:48:27,195 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:48:27,195 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:48:27,195 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:48:27,195 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:48:27,196 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:48:27,196 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:27,196 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:48:27,196 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:27,196 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:27,197 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:27,197 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:48:27,197 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:48:27,197 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:48:27,197 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:48:27,201 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:48:27,201 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:27,203 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:27,203 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:48:27,204 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:27,204 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:27,204 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:27,205 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:27,218 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4678, Threshold=0.5183, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:48:27,218 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.4678
2025-08-04 20:48:41,511 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:41,512 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:48:41,512 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:48:41,512 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:48:41,512 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:48:41,512 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:41,826 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:41,826 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:41,911 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:48:41,937 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:48:41,937 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:42,038 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:42,046 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:42,046 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:42,052 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:48:42,061 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:42,062 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:48:42,062 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:42,062 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:42,062 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:48:42,071 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:42,074 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:42,077 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:42,079 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:42,082 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:42,084 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:42,087 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:42,090 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:42,093 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:42,095 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:42,098 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:42,108 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:42,109 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:48:42,114 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:48:42,114 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:48:42,120 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:42,120 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:48:42,132 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:42,133 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:48:42,133 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:42,151 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:42,157 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:48:42,162 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:48:42,162 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:42,162 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:42,162 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:42,162 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:42,163 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:42,163 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:48:42,163 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:42,163 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:48:42,163 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:42,165 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:48:42,165 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:48:42,165 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:42,166 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:48:42,166 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:42,166 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:42,166 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:42,166 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:48:42,167 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:48:42,167 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:48:42,167 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:48:42,167 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:48:42,167 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:48:42,169 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:48:42,169 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:48:42,169 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:48:42,170 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:48:42,170 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:48:42,170 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:48:42,170 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:42,170 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:48:42,171 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:42,171 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:42,171 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:42,171 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:48:42,171 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:48:42,172 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:48:42,172 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:48:42,176 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:48:42,176 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:42,177 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:42,178 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:48:42,179 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:42,179 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:42,179 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:42,180 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:42,194 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4891, Threshold=0.5385, Accuracy=0.7344, F1=0.8159, Precision=0.9826, Recall=0.6975
2025-08-04 20:48:42,194 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7344, F1: 0.8159, Prec: 0.9826, Rec: 0.6975, Avg Anomaly Score: 0.4891
2025-08-04 20:48:53,476 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:53,476 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:48:53,476 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:48:53,476 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:48:53,476 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:48:53,477 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:53,827 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:53,828 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:53,915 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:48:53,960 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:48:53,960 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:54,084 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:54,092 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:54,092 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:54,098 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:48:54,106 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:54,106 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:48:54,107 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:54,107 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:54,108 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:48:54,117 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:54,120 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:54,123 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:54,125 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:54,128 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:54,130 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:54,133 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:54,136 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:54,141 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:54,143 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:54,145 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:54,159 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:54,159 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:48:54,165 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:48:54,165 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:48:54,170 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:54,170 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:48:54,181 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:54,181 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:48:54,181 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:54,199 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:54,205 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:48:54,211 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:48:54,211 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:54,211 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:54,211 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:54,212 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:54,212 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:54,212 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:48:54,212 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:54,213 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:48:54,213 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:54,214 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:48:54,214 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:48:54,215 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:54,215 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:48:54,215 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:54,215 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:54,215 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:54,215 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:48:54,216 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:48:54,216 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:48:54,216 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:48:54,216 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:48:54,216 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:48:54,218 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:48:54,218 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:48:54,219 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:48:54,219 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:48:54,219 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:48:54,219 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:48:54,219 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:54,219 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:48:54,220 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:54,220 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:54,220 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:54,220 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:48:54,220 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:48:54,221 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:48:54,221 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:48:54,224 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:48:54,224 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:54,225 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:54,225 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:48:54,227 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:54,227 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:54,227 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:54,228 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:54,242 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5190, Threshold=0.5757, Accuracy=0.7257, F1=0.8096, Precision=0.9767, Recall=0.6914
2025-08-04 20:48:54,242 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7257, F1: 0.8096, Prec: 0.9767, Rec: 0.6914, Avg Anomaly Score: 0.5190
2025-08-04 20:49:05,522 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:05,522 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:49:05,522 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:49:05,523 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:49:05,523 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:49:05,523 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:05,809 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:05,809 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:05,892 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:49:05,915 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:49:05,915 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:06,006 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:06,015 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:06,015 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:06,024 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:49:06,035 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:06,035 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:49:06,036 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:06,036 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:06,036 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:49:06,048 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:06,051 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:06,053 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:06,055 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:06,058 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:06,060 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:06,063 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:06,065 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:06,068 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:06,070 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:06,072 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:06,083 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:06,083 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:49:06,089 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:49:06,089 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:49:06,095 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:06,095 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:49:06,108 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:06,108 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:49:06,108 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:06,124 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:06,129 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:49:06,134 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:49:06,135 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:06,135 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:06,135 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:06,136 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:06,136 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:06,136 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:49:06,136 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:06,136 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:49:06,137 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:06,138 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:49:06,138 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:49:06,139 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:06,139 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:49:06,139 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:06,139 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:06,139 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:06,140 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:49:06,140 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:49:06,140 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:49:06,140 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:49:06,140 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:49:06,140 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:49:06,142 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:49:06,142 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:49:06,142 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:49:06,143 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:49:06,143 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:49:06,143 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:49:06,143 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:06,143 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:49:06,144 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:06,144 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:06,145 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:06,145 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:49:06,145 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:49:06,145 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:49:06,145 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:49:06,146 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:49:06,147 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:06,148 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:06,148 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:49:06,150 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:06,150 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:06,150 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:06,151 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:06,164 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4990, Threshold=0.5542, Accuracy=0.7344, F1=0.8159, Precision=0.9826, Recall=0.6975
2025-08-04 20:49:06,164 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7344, F1: 0.8159, Prec: 0.9826, Rec: 0.6975, Avg Anomaly Score: 0.4990
2025-08-04 20:49:11,435 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:11,436 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:49:11,436 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:49:11,436 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:49:11,436 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:49:11,436 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:11,782 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:11,782 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:11,871 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:49:11,913 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:49:11,913 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:12,054 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:12,063 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:12,063 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:12,069 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:49:12,074 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:12,074 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:49:12,075 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:12,075 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:12,075 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:49:12,084 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:12,088 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:12,090 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:12,092 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:12,095 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:12,097 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:12,100 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:12,103 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:12,106 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:12,108 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:12,111 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:12,121 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:12,121 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:49:12,125 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:49:12,126 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:49:12,131 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:12,131 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:49:12,140 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:12,140 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:49:12,140 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:12,155 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:12,160 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:49:12,167 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:49:12,167 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:12,167 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:12,167 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:12,168 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:12,168 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:12,168 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:49:12,168 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:12,169 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:49:12,169 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:12,170 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:49:12,171 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:49:12,171 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:12,171 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:49:12,171 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:12,172 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:12,172 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:12,172 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:49:12,172 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:49:12,172 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:49:12,172 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:49:12,172 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:49:12,173 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:49:12,175 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:49:12,175 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:49:12,175 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:49:12,176 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:49:12,176 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:49:12,176 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:49:12,176 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:12,176 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:49:12,177 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:12,177 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:12,177 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:12,178 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:49:12,178 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:49:12,178 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:49:12,178 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:49:12,184 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:49:12,184 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:12,186 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:12,186 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:49:12,187 - ClientAppLogger [Client 9] - INFO - [Client] Fit started for round 120/400.
2025-08-04 20:49:12,288 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:12,288 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:12,290 - ClientAppLogger [Client 9] - INFO - [Client] Semi-supervised: Added 876 anomalous samples to GAN training data (target: 876).
2025-08-04 20:49:12,290 - ClientAppLogger [Client 9] - INFO - [Client] Round 120: Training GAN with 3796 samples (2920 normal, 876 anomalous).
2025-08-04 20:49:12,290 - ClientAppLogger [Client 9] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:14,988 - ClientAppLogger [Client 9] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.8080
2025-08-04 20:49:14,988 - ClientAppLogger [Client 9] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.8080
2025-08-04 20:49:14,988 - ClientAppLogger [Client 9] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:15,001 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5358, Threshold=0.6051, Accuracy=0.7274, F1=0.8111, Precision=0.9768, Recall=0.6934
2025-08-04 20:49:15,001 - ClientAppLogger [Client 9] - INFO - [Client] Post-fit local evaluation F1: 0.8111
2025-08-04 20:49:15,001 - ClientAppLogger [Client 9] - INFO - Fit completed for round 120. Duration: 2.81s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '9', 'server_round': 120, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0840977786338493, 'd_loss': 0.8079843053827798, 'post_fit_local_f1': 0.8110709987966306, 'fit_time_seconds': 2.814025402069092, 'cpu_percent_fit': 6.24375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 3796}
2025-08-04 20:49:15,001 - ClientAppLogger [Client 9] - INFO - [Client] get_parameters called
2025-08-04 20:49:23,268 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:23,268 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:49:23,268 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:49:23,268 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:49:23,268 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:49:23,269 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:23,572 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:23,573 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:23,657 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:49:23,681 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:49:23,681 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:23,767 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:23,774 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:23,774 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:23,780 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:49:23,788 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:23,788 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:49:23,789 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:23,789 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:23,789 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:49:23,798 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:23,800 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:23,803 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:23,805 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:23,808 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:23,810 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:23,813 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:23,815 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:23,818 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:23,820 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:23,822 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:23,832 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:23,832 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:49:23,837 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:49:23,837 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:49:23,843 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:23,843 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:49:23,854 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:23,854 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:49:23,854 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:23,869 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:23,873 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:49:23,878 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:49:23,878 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:23,878 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:23,878 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:23,878 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:23,878 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:23,879 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:49:23,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:23,879 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:49:23,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:23,880 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:49:23,881 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:49:23,881 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:23,881 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:49:23,881 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:23,881 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:23,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:23,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:49:23,882 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:49:23,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:49:23,882 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:49:23,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:49:23,882 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:49:23,884 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:49:23,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:49:23,885 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:49:23,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:49:23,885 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:49:23,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:49:23,886 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:23,886 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:49:23,886 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:23,886 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:23,887 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:23,887 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:49:23,887 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:49:23,887 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:49:23,887 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:49:23,895 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:49:23,895 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:23,896 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:23,897 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:49:23,898 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:23,898 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:23,898 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:23,899 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:23,914 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5164, Threshold=0.5721, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:49:23,914 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5164
2025-08-04 20:49:35,174 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:35,174 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:49:35,174 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:49:35,174 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:49:35,174 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:49:35,175 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:35,423 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:35,423 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:35,507 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:49:35,533 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:49:35,533 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:35,634 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:35,640 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:35,641 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:35,647 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:49:35,656 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:35,656 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:49:35,657 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:35,657 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:35,657 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:49:35,667 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:35,670 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:35,673 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:35,675 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:35,677 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:35,680 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:35,682 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:35,685 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:35,687 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:35,689 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:35,692 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:35,701 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:35,701 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:49:35,706 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:49:35,706 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:49:35,710 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:35,711 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:49:35,719 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:35,720 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:49:35,720 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:35,736 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:35,740 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:49:35,746 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:49:35,746 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:35,746 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:35,746 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:35,746 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:35,746 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:35,747 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:49:35,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:35,747 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:49:35,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:35,748 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:49:35,749 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:49:35,749 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:35,749 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:49:35,749 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:35,749 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:35,750 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:35,750 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:49:35,750 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:49:35,750 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:49:35,750 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:49:35,750 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:49:35,750 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:49:35,752 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:49:35,752 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:49:35,752 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:49:35,752 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:49:35,752 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:49:35,753 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:49:35,753 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:35,753 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:49:35,753 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:35,754 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:35,754 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:35,754 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:49:35,754 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:49:35,754 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:49:35,754 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:49:35,758 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:49:35,758 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:35,760 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:35,760 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:49:35,761 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:35,761 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:35,762 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:35,762 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:35,776 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4562, Threshold=0.4914, Accuracy=0.7344, F1=0.8159, Precision=0.9826, Recall=0.6975
2025-08-04 20:49:35,776 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7344, F1: 0.8159, Prec: 0.9826, Rec: 0.6975, Avg Anomaly Score: 0.4562
2025-08-04 20:49:47,034 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:47,034 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:49:47,035 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:49:47,035 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:49:47,035 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:49:47,035 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:47,273 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:47,273 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:47,358 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:49:47,381 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:49:47,382 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:47,475 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:47,482 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:47,483 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:47,490 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:49:47,505 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:47,505 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:49:47,506 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:47,506 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:47,506 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:49:47,514 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:47,517 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:47,519 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:47,521 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:47,524 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:47,526 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:47,529 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:47,531 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:47,534 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:47,536 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:47,538 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:47,549 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:47,549 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:49:47,554 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:49:47,554 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:49:47,560 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:47,560 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:49:47,570 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:47,570 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:49:47,570 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:47,585 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:47,590 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:49:47,594 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:49:47,594 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:47,594 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:47,594 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:47,594 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:47,595 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:47,595 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:49:47,595 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:47,595 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:49:47,595 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:47,597 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:49:47,597 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:49:47,597 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:47,597 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:49:47,597 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:47,598 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:47,598 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:47,598 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:49:47,598 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:49:47,598 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:49:47,598 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:49:47,598 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:49:47,598 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:49:47,599 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:49:47,600 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:49:47,600 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:49:47,600 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:49:47,600 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:49:47,600 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:49:47,600 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:47,600 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:49:47,601 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:47,601 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:47,601 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:47,601 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:49:47,602 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:49:47,602 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:49:47,602 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:49:47,606 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:49:47,606 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:47,607 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:47,607 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:49:47,609 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:47,609 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:47,609 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:47,610 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:47,622 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5274, Threshold=0.5951, Accuracy=0.7240, F1=0.8087, Precision=0.9739, Recall=0.6914
2025-08-04 20:49:47,623 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7240, F1: 0.8087, Prec: 0.9739, Rec: 0.6914, Avg Anomaly Score: 0.5274
2025-08-04 20:50:04,906 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:04,906 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:50:04,906 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:50:04,906 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:50:04,906 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:50:04,907 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:05,294 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:05,294 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:05,387 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:50:05,436 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:50:05,437 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:05,568 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:05,577 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:05,577 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:05,586 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:50:05,597 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:05,597 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:50:05,598 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:05,598 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:05,598 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:50:05,609 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:05,613 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:05,615 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:05,618 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:05,621 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:05,623 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:05,626 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:05,629 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:05,632 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:05,634 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:05,636 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:05,646 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:05,646 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:50:05,651 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:50:05,651 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:50:05,656 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:05,656 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:50:05,665 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:05,666 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:50:05,666 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:05,684 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:05,689 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:50:05,695 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:50:05,695 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:05,696 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:05,696 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:05,696 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:05,697 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:05,697 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:50:05,697 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:05,697 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:50:05,697 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:05,699 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:50:05,699 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:50:05,699 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:05,699 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:50:05,700 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:05,700 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:05,700 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:05,700 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:50:05,700 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:50:05,700 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:50:05,700 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:50:05,701 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:50:05,701 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:50:05,702 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:50:05,703 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:50:05,703 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:50:05,703 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:50:05,703 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:50:05,703 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:50:05,704 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:05,704 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:50:05,704 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:05,704 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:05,704 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:05,705 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:50:05,705 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:50:05,705 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:50:05,705 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:50:05,709 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:50:05,709 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:05,710 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:05,710 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:50:05,712 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:05,712 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:05,712 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:05,713 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:05,728 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5450, Threshold=0.6147, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:50:05,728 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5450
2025-08-04 20:50:20,005 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:20,005 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:50:20,005 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:50:20,005 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:50:20,005 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:50:20,006 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:20,394 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:20,394 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:20,496 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:50:20,544 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:50:20,544 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:20,671 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:20,680 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:20,680 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:20,689 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:50:20,700 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:20,700 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:50:20,701 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:20,701 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:20,701 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:50:20,712 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:20,715 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:20,717 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:20,720 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:20,722 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:20,725 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:20,728 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:20,730 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:20,733 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:20,735 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:20,737 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:20,747 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:20,748 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:50:20,753 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:50:20,753 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:50:20,759 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:20,759 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:50:20,775 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:20,775 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:50:20,776 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:20,792 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:20,797 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:50:20,804 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:50:20,804 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:20,804 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:20,804 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:20,805 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:20,805 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:20,805 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:50:20,805 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:20,805 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:50:20,805 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:20,807 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:50:20,807 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:50:20,807 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:20,808 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:50:20,808 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:20,808 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:20,808 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:20,808 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:50:20,808 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:50:20,809 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:50:20,809 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:50:20,809 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:50:20,809 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:50:20,811 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:50:20,811 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:50:20,811 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:50:20,812 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:50:20,812 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:50:20,812 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:50:20,812 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:20,812 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:50:20,813 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:20,813 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:20,813 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:20,813 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:50:20,813 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:50:20,813 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:50:20,814 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:50:20,817 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:50:20,817 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:20,818 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:20,819 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:50:20,820 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:20,820 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:20,821 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:20,822 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:20,837 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5232, Threshold=0.5899, Accuracy=0.7240, F1=0.8087, Precision=0.9739, Recall=0.6914
2025-08-04 20:50:20,837 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7240, F1: 0.8087, Prec: 0.9739, Rec: 0.6914, Avg Anomaly Score: 0.5232
2025-08-04 20:50:38,110 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:38,110 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:50:38,110 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:50:38,110 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:50:38,110 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:50:38,110 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:38,454 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:38,454 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:38,543 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:50:38,591 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:50:38,591 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:38,718 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:38,725 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:38,725 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:38,732 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:50:38,738 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:38,738 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:50:38,739 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:38,739 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:38,739 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:50:38,748 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:38,752 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:38,754 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:38,757 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:38,760 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:38,762 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:38,765 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:38,767 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:38,770 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:38,772 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:38,775 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:38,784 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:38,784 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:50:38,789 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:50:38,789 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:50:38,794 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:38,794 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:50:38,805 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:38,806 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:50:38,806 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:38,821 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:38,825 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:50:38,830 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:50:38,831 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:38,831 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:38,831 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:38,831 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:38,831 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:38,832 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:50:38,832 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:38,832 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:50:38,832 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:38,834 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:50:38,834 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:50:38,834 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:38,834 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:50:38,835 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:38,835 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:38,835 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:38,835 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:50:38,835 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:50:38,835 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:50:38,837 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:50:38,837 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:50:38,837 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:50:38,838 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:50:38,839 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:50:38,839 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:50:38,839 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:50:38,839 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:50:38,839 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:50:38,839 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:38,839 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:50:38,840 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:38,840 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:38,840 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:38,841 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:50:38,841 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:50:38,841 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:50:38,841 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:50:38,844 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:50:38,844 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:38,845 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:38,845 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:50:38,846 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:38,847 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:38,847 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:38,847 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:38,860 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5307, Threshold=0.5952, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:50:38,860 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5307
2025-08-04 20:50:50,133 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:50,133 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:50:50,133 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:50:50,134 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:50:50,134 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:50:50,134 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:50,570 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:50,571 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:50,670 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:50:50,728 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:50:50,728 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:50,879 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:50,888 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:50,888 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:50,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:50:50,915 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:50,915 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:50:50,916 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:50,917 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:50,917 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:50:50,927 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:50,930 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:50,933 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:50,936 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:50,939 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:50,941 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:50,944 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:50,947 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:50,950 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:50,952 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:50,955 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:50,967 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:50,969 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:50:50,974 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:50:50,975 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:50:50,983 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:50,984 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:50:50,998 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:50,998 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:50:50,999 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:51,019 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:51,024 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:50:51,031 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:50:51,032 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:51,032 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:51,032 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:51,032 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:51,033 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:51,033 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:50:51,033 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:51,034 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:50:51,034 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:51,036 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:50:51,036 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:50:51,036 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:51,036 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:50:51,037 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:51,037 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:51,037 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:51,037 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:50:51,038 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:50:51,038 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:50:51,038 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:50:51,039 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:50:51,039 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:50:51,040 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:50:51,041 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:50:51,041 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:50:51,041 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:50:51,042 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:50:51,042 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:50:51,042 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:51,043 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:50:51,043 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:51,043 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:51,044 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:51,044 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:50:51,044 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:50:51,044 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:50:51,045 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:50:51,048 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:50:51,048 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:51,050 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:51,050 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:50:51,052 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:51,052 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:51,052 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:51,053 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:51,070 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5221, Threshold=0.5906, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:50:51,070 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5221
2025-08-04 20:51:08,353 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:08,354 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:51:08,354 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:51:08,354 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:51:08,354 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:51:08,354 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:08,685 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:08,685 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:08,781 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:51:08,831 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:51:08,831 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:08,974 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:08,981 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:08,981 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:08,987 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:51:08,995 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:08,995 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:51:08,995 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:08,996 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:08,996 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:51:09,005 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:09,007 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:09,009 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:09,011 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:09,014 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:09,017 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:09,019 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:09,022 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:09,025 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:09,026 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:09,029 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:09,040 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:09,040 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:51:09,045 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:51:09,045 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:51:09,051 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:09,051 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:51:09,066 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:09,067 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:51:09,067 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:09,088 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:09,093 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:51:09,102 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:51:09,103 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:09,103 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:09,103 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:09,103 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:09,104 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:09,104 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:51:09,104 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:09,104 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:51:09,104 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:09,106 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:51:09,106 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:51:09,106 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:09,106 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:51:09,107 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:09,107 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:09,107 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:09,107 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:51:09,107 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:51:09,108 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:51:09,108 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:51:09,108 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:51:09,108 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:51:09,111 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:51:09,111 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:51:09,111 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:51:09,111 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:51:09,111 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:51:09,111 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:51:09,112 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:09,112 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:51:09,112 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:09,115 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:09,115 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:09,115 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:51:09,115 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:51:09,116 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:51:09,116 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:51:09,120 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:51:09,120 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:09,122 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:09,122 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:51:09,123 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:09,124 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:09,124 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:09,125 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:09,139 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5243, Threshold=0.5928, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:51:09,139 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5243
2025-08-04 20:51:23,409 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:23,410 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:51:23,410 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:51:23,410 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:51:23,410 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:51:23,410 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:23,782 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:23,782 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:23,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:51:23,931 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:51:23,931 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:24,063 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:24,070 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:24,070 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:24,076 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:51:24,084 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:24,084 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:51:24,084 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:24,085 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:24,085 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:51:24,099 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:24,103 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:24,106 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:24,109 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:24,112 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:24,114 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:24,117 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:24,120 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:24,122 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:24,125 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:24,127 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:24,141 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:24,141 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:51:24,146 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:51:24,146 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:51:24,154 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:24,154 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:51:24,169 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:24,170 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:51:24,170 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:24,187 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:24,193 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:51:24,199 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:51:24,199 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:24,199 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:24,199 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:24,199 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:24,200 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:24,200 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:51:24,200 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:24,200 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:51:24,200 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:24,202 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:51:24,202 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:51:24,203 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:24,203 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:51:24,203 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:24,203 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:24,203 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:24,204 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:51:24,204 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:51:24,204 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:51:24,204 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:51:24,204 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:51:24,204 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:51:24,206 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:51:24,206 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:51:24,206 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:51:24,207 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:51:24,207 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:51:24,207 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:51:24,207 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:24,207 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:51:24,208 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:24,208 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:24,208 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:24,208 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:51:24,209 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:51:24,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:51:24,209 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:51:24,213 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:51:24,213 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:24,214 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:24,215 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:51:24,216 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:24,216 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:24,216 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:24,217 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:24,231 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5182, Threshold=0.5795, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:51:24,231 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5182
2025-08-04 20:51:41,505 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:41,505 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:51:41,506 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:51:41,506 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:51:41,506 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:51:41,506 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:41,791 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:41,791 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:41,875 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:51:41,899 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:51:41,900 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:41,985 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:41,992 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:41,992 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:41,999 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:51:42,008 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:42,008 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:51:42,009 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:42,009 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:42,009 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:51:42,017 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:42,020 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:42,022 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:42,024 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:42,027 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:42,029 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:42,032 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:42,034 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:42,037 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:42,039 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:42,042 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:42,051 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:42,051 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:51:42,056 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:51:42,056 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:51:42,062 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:42,062 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:51:42,072 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:42,073 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:51:42,073 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:42,088 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:42,093 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:51:42,098 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:51:42,098 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:42,098 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:42,098 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:42,098 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:42,099 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:42,099 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:51:42,099 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:42,099 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:51:42,099 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:42,101 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:51:42,101 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:51:42,101 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:42,101 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:51:42,102 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:42,102 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:42,102 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:42,102 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:51:42,102 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:51:42,102 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:51:42,103 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:51:42,103 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:51:42,103 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:51:42,104 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:51:42,104 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:51:42,105 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:51:42,105 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:51:42,105 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:51:42,105 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:51:42,105 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:42,105 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:51:42,106 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:42,106 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:42,106 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:42,106 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:51:42,106 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:51:42,107 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:51:42,107 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:51:42,111 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:51:42,111 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:42,112 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:42,112 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:51:42,114 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:42,114 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:42,114 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:42,115 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:42,128 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5184, Threshold=0.5840, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:51:42,128 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5184
2025-08-04 20:51:56,406 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:56,406 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:51:56,406 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:51:56,406 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:51:56,406 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:51:56,406 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:56,763 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:56,763 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:56,847 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:51:56,891 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:51:56,891 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:57,006 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:57,014 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:57,014 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:57,020 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:51:57,029 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:57,029 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:51:57,030 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:57,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:57,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:51:57,039 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:57,042 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:57,044 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:57,046 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:57,049 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:57,051 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:57,054 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:57,056 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:57,059 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:57,061 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:57,064 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:57,073 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:57,073 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:51:57,078 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:51:57,078 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:51:57,083 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:57,084 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:51:57,095 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:57,096 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:51:57,096 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:57,111 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:57,116 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:51:57,120 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:51:57,120 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:57,120 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:57,121 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:57,121 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:57,121 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:57,121 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:51:57,121 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:57,122 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:51:57,122 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:57,123 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:51:57,123 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:51:57,124 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:57,124 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:51:57,124 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:57,124 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:57,124 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:57,124 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:51:57,124 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:51:57,125 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:51:57,125 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:51:57,125 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:51:57,125 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:51:57,126 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:51:57,126 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:51:57,127 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:51:57,127 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:51:57,127 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:51:57,127 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:51:57,127 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:57,127 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:51:57,128 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:57,128 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:57,128 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:57,128 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:51:57,128 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:51:57,129 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:51:57,129 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:51:57,135 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:51:57,135 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:57,136 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:57,137 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:51:57,138 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:57,138 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:57,138 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:57,139 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:57,153 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4898, Threshold=0.5401, Accuracy=0.7344, F1=0.8159, Precision=0.9826, Recall=0.6975
2025-08-04 20:51:57,153 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7344, F1: 0.8159, Prec: 0.9826, Rec: 0.6975, Avg Anomaly Score: 0.4898
2025-08-04 20:52:08,414 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:08,414 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:52:08,414 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:52:08,415 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:52:08,415 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:52:08,415 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:08,686 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:08,687 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:08,770 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:52:08,815 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:52:08,816 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:08,931 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:08,937 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:08,937 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:08,942 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:52:08,948 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:08,949 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:52:08,949 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:08,949 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:08,950 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:52:08,958 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:08,961 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:08,963 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:08,966 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:08,968 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:08,971 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:08,973 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:08,976 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:08,978 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:08,980 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:08,983 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:08,992 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:08,992 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:52:08,997 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:52:08,997 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:52:09,002 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:09,002 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:52:09,010 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:09,011 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:52:09,011 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:09,025 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:09,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:52:09,037 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:52:09,037 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:09,038 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:09,038 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:09,038 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:09,038 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:09,039 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:52:09,039 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:09,039 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:52:09,039 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:09,041 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:52:09,041 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:52:09,041 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:09,041 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:52:09,041 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:09,042 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:09,042 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:09,042 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:52:09,042 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:52:09,042 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:52:09,042 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:52:09,042 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:52:09,043 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:52:09,044 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:52:09,044 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:52:09,044 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:52:09,044 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:52:09,044 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:52:09,045 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:52:09,045 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:09,045 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:52:09,045 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:09,046 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:09,046 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:09,046 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:52:09,046 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:52:09,046 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:52:09,046 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:52:09,052 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:52:09,052 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:09,053 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:09,053 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:52:09,054 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:09,055 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:09,055 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:09,056 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:09,068 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5162, Threshold=0.5788, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:52:09,069 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5162
2025-08-04 20:52:20,350 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:20,350 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:52:20,350 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:52:20,350 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:52:20,350 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:52:20,350 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:20,669 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:20,669 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:20,758 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:52:20,801 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:52:20,801 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:20,917 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:20,924 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:20,925 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:20,930 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:52:20,935 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:20,936 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:52:20,936 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:20,936 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:20,936 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:52:20,945 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:20,948 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:20,950 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:20,952 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:20,954 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:20,957 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:20,959 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:20,962 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:20,964 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:20,966 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:20,969 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:20,978 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:20,979 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:52:20,984 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:52:20,984 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:52:20,988 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:20,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:52:20,997 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:20,997 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:52:20,997 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:21,011 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:21,015 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:52:21,021 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:52:21,021 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:21,021 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:21,021 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:21,022 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:21,022 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:21,022 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:52:21,022 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:21,022 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:52:21,022 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:21,024 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:52:21,024 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:52:21,024 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:21,025 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:52:21,025 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:21,025 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:21,025 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:21,025 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:52:21,025 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:52:21,026 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:52:21,026 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:52:21,026 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:52:21,026 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:52:21,028 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:52:21,028 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:52:21,028 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:52:21,028 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:52:21,028 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:52:21,029 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:52:21,029 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:21,029 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:52:21,029 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:21,029 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:21,029 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:21,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:52:21,030 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:52:21,030 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:52:21,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:52:21,033 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:52:21,033 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:21,035 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:21,035 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:52:21,037 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:21,037 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:21,037 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:21,038 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:21,050 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5365, Threshold=0.6024, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:52:21,050 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5365
2025-08-04 20:52:38,330 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:38,330 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:52:38,331 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:52:38,331 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:52:38,331 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:52:38,331 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:38,611 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:38,612 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:38,697 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:52:38,735 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:52:38,735 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:38,853 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:38,860 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:38,860 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:38,865 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:52:38,870 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:38,871 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:52:38,871 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:38,871 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:38,871 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:52:38,881 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:38,883 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:38,886 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:38,888 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:38,891 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:38,893 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:38,895 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:38,898 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:38,901 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:38,902 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:38,905 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:38,915 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:38,915 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:52:38,922 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:52:38,922 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:52:38,927 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:38,927 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:52:38,935 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:38,935 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:52:38,935 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:38,950 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:38,954 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:52:38,959 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:52:38,959 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:38,960 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:38,960 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:38,960 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:38,961 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:38,961 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:52:38,961 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:38,961 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:52:38,961 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:38,963 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:52:38,963 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:52:38,964 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:38,964 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:52:38,964 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:38,964 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:38,964 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:38,965 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:52:38,965 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:52:38,965 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:52:38,965 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:52:38,965 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:52:38,965 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:52:38,966 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:52:38,967 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:52:38,967 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:52:38,967 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:52:38,967 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:52:38,967 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:52:38,967 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:38,967 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:52:38,968 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:38,968 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:38,968 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:38,968 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:52:38,969 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:52:38,969 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:52:38,969 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:52:38,972 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:52:38,973 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:38,974 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:38,974 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:52:38,976 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:38,976 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:38,976 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:38,977 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:38,990 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5737, Threshold=0.6459, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:52:38,990 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5737
2025-08-04 20:52:50,276 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:50,276 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:52:50,277 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:52:50,277 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:52:50,277 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:52:50,277 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:50,536 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:50,536 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:50,618 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:52:50,641 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:52:50,641 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:50,729 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:50,735 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:50,735 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:50,741 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:52:50,752 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:50,752 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:52:50,753 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:50,753 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:50,753 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:52:50,761 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:50,764 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:50,767 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:50,769 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:50,773 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:50,775 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:50,777 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:50,780 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:50,782 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:50,784 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:50,786 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:50,796 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:50,796 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:52:50,801 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:52:50,801 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:52:50,807 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:50,807 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:52:50,818 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:50,819 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:52:50,819 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:50,834 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:50,838 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:52:50,842 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:52:50,842 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:50,843 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:50,843 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:50,843 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:50,843 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:50,844 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:52:50,844 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:50,844 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:52:50,844 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:50,845 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:52:50,846 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:52:50,846 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:50,846 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:52:50,846 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:50,847 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:50,847 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:50,847 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:52:50,847 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:52:50,847 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:52:50,847 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:52:50,848 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:52:50,848 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:52:50,849 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:52:50,849 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:52:50,850 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:52:50,850 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:52:50,850 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:52:50,850 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:52:50,850 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:50,850 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:52:50,851 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:50,851 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:50,851 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:50,851 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:52:50,851 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:52:50,851 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:52:50,852 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:52:50,856 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:52:50,856 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:50,857 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:50,857 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:52:50,859 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:50,859 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:50,859 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:50,860 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:50,874 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5107, Threshold=0.5631, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:52:50,874 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5107
2025-08-04 20:53:02,148 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:02,149 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:53:02,149 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:53:02,149 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:53:02,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:53:02,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:02,545 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:02,545 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:02,646 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:53:02,682 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:53:02,682 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:02,797 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:02,803 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:02,803 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:02,809 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:53:02,816 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:02,816 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:53:02,817 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:02,817 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:02,817 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:53:02,826 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:02,828 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:02,830 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:02,833 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:02,835 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:02,837 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:02,840 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:02,842 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:02,845 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:02,847 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:02,849 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:02,858 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:02,858 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:53:02,863 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:53:02,863 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:53:02,868 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:02,868 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:53:02,879 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:02,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:53:02,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:02,895 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:02,900 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:53:02,906 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:53:02,906 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:02,906 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:02,906 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:02,907 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:02,907 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:02,907 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:53:02,907 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:02,907 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:53:02,908 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:02,909 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:53:02,909 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:53:02,909 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:02,909 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:53:02,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:02,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:02,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:02,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:53:02,910 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:53:02,910 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:53:02,911 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:53:02,911 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:53:02,911 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:53:02,913 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:53:02,913 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:53:02,914 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:53:02,914 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:53:02,914 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:53:02,914 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:53:02,914 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:02,914 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:53:02,915 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:02,915 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:02,915 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:02,915 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:53:02,915 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:53:02,916 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:53:02,916 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:53:02,922 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:53:02,922 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:02,923 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:02,924 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:53:02,925 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:02,925 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:02,925 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:02,926 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:02,939 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5178, Threshold=0.5832, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:53:02,939 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5178
2025-08-04 20:53:14,214 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:14,214 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:53:14,214 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:53:14,215 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:53:14,215 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:53:14,215 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:14,577 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:14,577 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:14,674 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:53:14,721 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:53:14,722 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:14,871 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:14,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:14,879 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:14,886 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:53:14,894 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:14,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:53:14,895 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:14,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:14,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:53:14,906 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:14,909 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:14,911 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:14,913 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:14,916 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:14,919 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:14,921 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:14,924 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:14,927 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:14,928 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:14,931 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:14,941 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:14,941 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:53:14,946 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:53:14,946 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:53:14,954 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:14,954 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:53:14,964 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:14,965 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:53:14,965 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:14,982 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:14,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:53:14,996 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:53:14,996 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:14,996 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:14,996 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:14,997 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:14,997 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:14,997 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:53:14,997 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:14,998 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:53:14,998 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:14,999 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:53:15,000 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:53:15,000 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:15,000 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:53:15,000 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:15,000 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:15,000 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:15,001 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:53:15,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:53:15,001 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:53:15,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:53:15,001 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:53:15,001 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:53:15,004 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:53:15,004 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:53:15,004 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:53:15,004 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:53:15,004 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:53:15,004 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:53:15,005 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:15,005 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:53:15,005 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:15,005 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:15,006 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:15,006 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:53:15,006 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:53:15,006 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:53:15,006 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:53:15,013 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:53:15,013 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:15,014 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:15,014 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:53:15,016 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:15,016 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:15,016 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:15,018 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:15,031 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5477, Threshold=0.6133, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:53:15,032 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5477
2025-08-04 20:53:35,324 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:35,324 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:53:35,324 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:53:35,324 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:53:35,324 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:53:35,324 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:35,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:35,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:35,750 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:53:35,788 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:53:35,788 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:35,888 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:35,896 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:35,896 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:35,904 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:53:35,910 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:35,910 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:53:35,911 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:35,911 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:35,911 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:53:35,920 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:35,923 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:35,925 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:35,928 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:35,931 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:35,933 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:35,935 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:35,938 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:35,941 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:35,943 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:35,945 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:35,955 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:35,955 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:53:35,960 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:53:35,960 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:53:35,964 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:35,964 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:53:35,973 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:35,974 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:53:35,974 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:35,990 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:35,995 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:53:36,026 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:53:36,026 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:36,026 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:36,026 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:36,027 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:36,027 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:36,027 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:53:36,027 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:36,028 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:53:36,028 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:36,029 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:53:36,029 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:53:36,030 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:36,030 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:53:36,030 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:36,030 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:36,030 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:36,031 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:53:36,031 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:53:36,031 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:53:36,031 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:53:36,031 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:53:36,032 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:53:36,033 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:53:36,033 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:53:36,034 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:53:36,034 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:53:36,034 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:53:36,034 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:53:36,034 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:36,034 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:53:36,035 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:36,035 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:36,035 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:36,036 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:53:36,036 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:53:36,036 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:53:36,036 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:53:36,043 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:53:36,043 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:36,045 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:36,045 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:53:36,046 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:36,046 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:36,047 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:36,047 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:36,061 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5455, Threshold=0.6077, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:53:36,061 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5455
2025-08-04 20:53:56,351 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:56,351 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:53:56,351 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:53:56,351 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:53:56,351 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:53:56,352 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:56,711 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:56,711 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:56,802 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:53:56,852 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:53:56,852 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:57,040 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:57,050 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:57,052 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:57,063 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:53:57,084 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:57,084 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:53:57,085 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:57,086 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:57,086 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:53:57,098 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:57,101 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:57,103 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:57,106 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:57,110 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:57,114 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:57,117 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:57,119 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:57,122 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:57,127 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:57,132 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:57,144 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:57,144 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:53:57,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:53:57,150 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:53:57,156 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:57,156 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:53:57,166 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:57,167 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:53:57,167 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:57,185 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:57,191 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:53:57,199 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:53:57,199 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:57,199 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:57,199 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:57,200 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:57,200 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:57,200 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:53:57,201 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:57,201 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:53:57,201 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:57,202 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:53:57,203 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:53:57,203 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:57,203 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:53:57,203 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:57,204 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:57,204 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:57,204 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:53:57,204 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:53:57,205 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:53:57,205 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:53:57,205 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:53:57,205 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:53:57,208 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:53:57,208 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:53:57,208 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:53:57,208 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:53:57,208 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:53:57,209 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:53:57,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:57,209 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:53:57,209 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:57,210 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:57,210 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:57,210 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:53:57,210 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:53:57,210 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:53:57,211 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:53:57,214 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:53:57,214 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:57,216 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:57,216 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:53:57,218 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:57,218 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:57,218 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:57,219 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:57,232 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5380, Threshold=0.6042, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:53:57,232 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5380
2025-08-04 20:54:14,539 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:14,539 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:54:14,539 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:54:14,539 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:54:14,540 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:54:14,540 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:15,119 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:15,119 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:15,239 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:54:15,281 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:54:15,282 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:15,432 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:15,452 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:15,452 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:15,464 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:54:15,518 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:15,518 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:54:15,519 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:15,520 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:15,520 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:54:15,530 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:15,533 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:15,535 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:15,538 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:15,542 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:15,544 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:15,547 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:15,550 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:15,554 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:15,556 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:15,559 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:15,572 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:15,572 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:54:15,577 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:54:15,578 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:54:15,588 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:15,588 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:54:15,608 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:15,609 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:54:15,609 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:15,627 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:15,634 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:54:15,644 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:54:15,644 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:15,645 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:15,645 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:15,645 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:15,645 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:15,646 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:54:15,646 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:15,646 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:54:15,646 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:15,648 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:54:15,648 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:54:15,648 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:15,649 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:54:15,649 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:15,649 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:15,649 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:15,649 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:54:15,649 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:54:15,649 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:54:15,650 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:54:15,650 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:54:15,650 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:54:15,652 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:54:15,653 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:54:15,653 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:54:15,653 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:54:15,653 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:54:15,653 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:54:15,654 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:15,654 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:54:15,654 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:15,655 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:15,655 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:15,655 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:54:15,655 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:54:15,656 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:54:15,656 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:54:15,660 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:54:15,660 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:15,661 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:15,661 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:54:15,663 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:15,663 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:15,663 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:15,664 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:15,681 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5746, Threshold=0.6490, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:54:15,681 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5746
2025-08-04 20:54:32,980 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:32,980 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:54:32,981 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:54:32,981 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:54:32,981 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:54:32,981 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:33,403 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:33,403 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:33,508 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:54:33,538 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:54:33,539 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:33,719 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:33,731 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:33,731 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:33,741 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:54:33,774 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:33,775 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:54:33,776 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:33,776 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:33,776 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:54:33,787 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:33,791 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:33,794 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:33,796 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:33,800 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:33,803 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:33,806 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:33,810 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:33,813 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:33,815 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:33,819 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:33,836 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:33,836 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:54:33,841 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:54:33,841 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:54:33,849 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:33,849 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:54:33,870 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:33,871 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:54:33,871 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:33,896 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:33,903 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:54:33,918 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:54:33,918 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:33,918 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:33,919 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:33,919 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:33,920 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:33,920 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:54:33,920 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:33,921 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:54:33,921 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:33,923 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:54:33,923 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:54:33,923 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:33,924 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:54:33,924 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:33,924 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:33,925 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:33,925 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:54:33,925 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:54:33,925 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:54:33,926 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:54:33,926 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:54:33,926 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:54:33,929 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:54:33,929 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:54:33,933 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:54:33,933 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:54:33,933 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:54:33,934 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:54:33,934 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:33,934 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:54:33,936 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:33,936 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:33,936 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:33,937 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:54:33,937 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:54:33,937 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:54:33,937 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:54:33,949 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:54:33,949 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:33,952 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:33,953 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:54:33,955 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:33,955 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:33,955 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:33,956 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:33,974 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5313, Threshold=0.5910, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:54:33,974 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5313
2025-08-04 20:54:54,249 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:54,249 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:54:54,249 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:54:54,249 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:54:54,249 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:54:54,249 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:54,626 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:54,626 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:54,722 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:54:54,783 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:54:54,784 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:54,982 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:54,990 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:54,990 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:54,997 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:54:55,005 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:55,005 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:54:55,006 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:55,006 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:55,006 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:54:55,017 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:55,021 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:55,026 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:55,028 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:55,032 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:55,035 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:55,038 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:55,042 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:55,046 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:55,049 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:55,052 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:55,069 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:55,069 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:54:55,075 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:54:55,075 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:54:55,082 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:55,082 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:54:55,103 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:55,105 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:54:55,105 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:55,128 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:55,135 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:54:55,141 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:54:55,141 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:55,141 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:55,141 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:55,142 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:55,142 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:55,142 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:54:55,142 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:55,143 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:54:55,143 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:55,144 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:54:55,144 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:54:55,145 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:55,145 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:54:55,146 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:55,146 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:55,146 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:55,146 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:54:55,146 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:54:55,146 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:54:55,146 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:54:55,147 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:54:55,147 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:54:55,148 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:54:55,148 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:54:55,149 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:54:55,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:54:55,149 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:54:55,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:54:55,149 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:55,149 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:54:55,157 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:55,157 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:55,157 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:55,158 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:54:55,158 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:54:55,158 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:54:55,158 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:54:55,165 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:54:55,166 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:55,168 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:55,169 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:54:55,171 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:55,171 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:55,171 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:55,172 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:55,190 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5616, Threshold=0.6252, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:54:55,191 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5616
2025-08-04 20:55:15,491 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:15,491 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:55:15,491 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:55:15,491 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:55:15,491 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:55:15,491 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:15,906 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:15,906 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:16,033 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:55:16,067 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:55:16,067 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:16,209 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:16,218 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:16,218 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:16,227 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:55:16,254 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:16,254 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:55:16,255 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:16,255 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:16,255 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:55:16,266 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:16,271 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:16,274 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:16,276 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:16,278 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:16,281 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:16,283 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:16,290 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:16,294 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:16,296 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:16,299 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:16,311 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:16,311 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:55:16,316 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:55:16,316 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:55:16,325 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:16,326 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:55:16,346 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:16,346 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:55:16,346 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:16,365 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:16,371 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:55:16,377 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:55:16,377 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:16,377 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:16,377 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:16,378 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:16,378 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:16,378 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:55:16,378 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:16,379 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:55:16,379 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:16,380 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:55:16,380 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:55:16,381 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:16,381 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:55:16,381 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:16,381 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:16,381 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:16,381 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:55:16,382 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:55:16,382 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:55:16,382 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:55:16,382 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:55:16,382 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:55:16,384 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:55:16,384 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:55:16,385 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:55:16,385 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:55:16,385 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:55:16,385 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:55:16,385 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:16,386 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:55:16,386 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:16,386 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:16,387 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:16,387 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:55:16,387 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:55:16,387 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:55:16,388 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:55:16,397 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:55:16,397 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:16,398 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:16,398 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:55:16,400 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:16,400 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:16,400 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:16,401 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:16,418 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5464, Threshold=0.6093, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:55:16,418 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5464
2025-08-04 20:55:36,729 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:36,729 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:55:36,729 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:55:36,729 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:55:36,730 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:55:36,730 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:37,118 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:37,119 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:37,215 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:55:37,263 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:55:37,263 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:37,390 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:37,397 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:37,397 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:37,403 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:55:37,409 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:37,409 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:55:37,410 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:37,410 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:37,410 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:55:37,420 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:37,425 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:37,427 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:37,429 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:37,432 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:37,434 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:37,437 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:37,439 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:37,442 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:37,444 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:37,446 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:37,456 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:37,456 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:55:37,461 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:55:37,461 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:55:37,466 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:37,466 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:55:37,480 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:37,481 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:55:37,481 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:37,497 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:37,502 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:55:37,508 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:55:37,508 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:37,509 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:37,509 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:37,509 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:37,509 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:37,509 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:55:37,510 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:37,510 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:55:37,510 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:37,511 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:55:37,511 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:55:37,512 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:37,512 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:55:37,512 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:37,512 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:37,512 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:37,513 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:55:37,513 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:55:37,513 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:55:37,513 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:55:37,513 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:55:37,513 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:55:37,515 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:55:37,515 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:55:37,515 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:55:37,516 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:55:37,516 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:55:37,516 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:55:37,516 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:37,516 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:55:37,517 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:37,517 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:37,517 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:37,517 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:55:37,517 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:55:37,517 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:55:37,518 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:55:37,521 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:55:37,521 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:37,523 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:37,523 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:55:37,524 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:37,524 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:37,525 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:37,525 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:37,539 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4781, Threshold=0.5157, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:55:37,539 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.4781
2025-08-04 20:55:57,829 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:57,829 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:55:57,829 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:55:57,830 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:55:57,830 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:55:57,830 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:58,099 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:58,099 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:58,183 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:55:58,207 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:55:58,207 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:58,324 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:58,330 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:58,330 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:58,334 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:55:58,340 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:58,340 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:55:58,340 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:58,341 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:58,341 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:55:58,349 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:58,352 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:58,354 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:58,357 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:58,359 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:58,362 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:58,364 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:58,367 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:58,369 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:58,371 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:58,373 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:58,382 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:58,382 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:55:58,387 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:55:58,387 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:55:58,393 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:58,393 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:55:58,406 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:58,406 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:55:58,406 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:58,423 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:58,431 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:55:58,436 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:55:58,436 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:58,436 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:58,436 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:58,436 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:58,437 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:58,437 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:55:58,437 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:58,437 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:55:58,437 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:58,439 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:55:58,439 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:55:58,439 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:58,439 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:55:58,439 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:58,440 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:58,440 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:58,440 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:55:58,440 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:55:58,440 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:55:58,440 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:55:58,440 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:55:58,441 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:55:58,442 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:55:58,442 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:55:58,442 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:55:58,442 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:55:58,442 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:55:58,442 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:55:58,442 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:58,443 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:55:58,443 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:58,443 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:58,443 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:58,443 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:55:58,444 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:55:58,444 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:55:58,444 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:55:58,445 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:55:58,445 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:58,446 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:58,446 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:55:58,447 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:58,448 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:58,448 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:58,448 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:58,461 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5815, Threshold=0.6561, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:55:58,461 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5815
2025-08-04 20:56:09,745 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:09,745 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:56:09,745 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:56:09,745 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:56:09,745 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:56:09,745 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:10,061 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:10,062 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:10,145 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:56:10,193 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:56:10,193 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:10,314 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:10,319 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:10,319 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:10,324 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:56:10,329 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:10,329 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:56:10,330 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:10,330 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:10,330 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:56:10,338 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:10,341 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:10,343 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:10,346 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:10,348 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:10,351 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:10,353 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:10,356 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:10,359 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:10,360 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:10,363 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:10,371 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:10,371 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:56:10,376 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:56:10,376 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:56:10,381 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:10,381 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:56:10,389 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:10,390 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:56:10,390 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:10,404 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:10,409 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:56:10,416 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:56:10,416 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:10,416 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:10,416 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:10,416 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:10,417 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:10,417 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:56:10,417 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:10,417 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:56:10,417 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:10,419 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:56:10,419 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:56:10,419 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:10,419 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:56:10,419 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:10,420 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:10,420 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:10,420 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:56:10,420 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:56:10,420 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:56:10,420 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:56:10,420 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:56:10,420 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:56:10,421 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:56:10,422 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:56:10,422 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:56:10,422 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:56:10,422 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:56:10,423 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:56:10,423 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:10,423 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:56:10,423 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:10,424 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:10,424 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:10,424 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:56:10,424 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:56:10,424 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:56:10,424 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:56:10,429 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:56:10,429 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:10,431 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:10,431 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:56:10,432 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:10,432 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:10,432 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:10,433 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:10,445 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5069, Threshold=0.5427, Accuracy=0.7344, F1=0.8159, Precision=0.9826, Recall=0.6975
2025-08-04 20:56:10,445 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7344, F1: 0.8159, Prec: 0.9826, Rec: 0.6975, Avg Anomaly Score: 0.5069
2025-08-04 20:56:27,762 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:27,762 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:56:27,762 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:56:27,762 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:56:27,762 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:56:27,762 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:28,170 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:28,170 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:28,262 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:56:28,286 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:56:28,286 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:28,410 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:28,416 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:28,417 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:28,422 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:56:28,441 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:28,442 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:56:28,442 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:28,442 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:28,443 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:56:28,451 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:28,454 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:28,456 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:28,458 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:28,460 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:28,462 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:28,465 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:28,467 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:28,470 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:28,472 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:28,474 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:28,485 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:28,485 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:56:28,491 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:56:28,491 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:56:28,497 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:28,497 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:56:28,507 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:28,508 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:56:28,508 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:28,525 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:28,530 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:56:28,535 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:56:28,535 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:28,535 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:28,535 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:28,536 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:28,536 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:28,536 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:56:28,536 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:28,537 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:56:28,537 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:28,538 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:56:28,538 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:56:28,539 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:28,539 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:56:28,539 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:28,539 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:28,539 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:28,539 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:56:28,539 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:56:28,540 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:56:28,540 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:56:28,540 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:56:28,540 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:56:28,541 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:56:28,542 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:56:28,542 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:56:28,542 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:56:28,542 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:56:28,543 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:56:28,543 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:28,543 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:56:28,543 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:28,544 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:28,544 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:28,544 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:56:28,544 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:56:28,544 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:56:28,545 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:56:28,550 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:56:28,550 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:28,551 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:28,551 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:56:28,553 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:28,553 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:28,553 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:28,554 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:28,567 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5626, Threshold=0.6309, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:56:28,567 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5626
2025-08-04 20:56:48,879 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:48,880 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:56:48,880 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:56:48,880 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:56:48,880 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:56:48,880 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:49,212 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:49,212 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:49,306 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:56:49,349 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:56:49,349 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:49,457 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:49,463 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:49,464 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:49,468 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:56:49,473 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:49,473 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:56:49,474 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:49,474 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:49,474 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:56:49,483 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:49,485 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:49,487 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:49,489 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:49,492 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:49,494 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:49,496 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:49,499 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:49,501 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:49,503 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:49,505 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:49,514 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:49,514 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:56:49,518 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:56:49,519 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:56:49,523 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:49,523 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:56:49,531 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:49,531 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:56:49,532 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:49,547 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:49,552 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:56:49,558 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:56:49,558 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:49,558 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:49,558 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:49,559 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:49,559 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:49,559 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:56:49,559 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:49,559 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:56:49,560 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:49,561 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:56:49,561 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:56:49,561 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:49,561 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:56:49,562 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:49,562 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:49,562 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:49,562 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:56:49,562 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:56:49,562 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:56:49,562 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:56:49,562 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:56:49,563 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:56:49,563 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:56:49,563 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:56:49,564 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:56:49,564 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:56:49,564 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:56:49,564 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:56:49,564 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:49,564 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:56:49,565 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:49,565 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:49,565 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:49,565 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:56:49,565 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:56:49,566 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:56:49,566 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:56:49,569 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:56:49,569 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:49,571 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:49,571 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:56:49,572 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:49,572 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:49,572 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:49,573 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:49,585 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4767, Threshold=0.5080, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:56:49,586 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.4767
2025-08-04 20:57:06,913 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:06,913 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:57:06,913 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:57:06,913 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:57:06,913 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:57:06,914 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:07,309 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:07,310 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:07,398 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:57:07,437 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:57:07,437 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:07,543 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:07,550 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:07,550 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:07,556 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:57:07,577 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:07,577 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:57:07,578 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:07,578 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:07,578 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:57:07,586 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:07,589 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:07,592 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:07,594 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:07,596 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:07,599 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:07,601 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:07,604 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:07,606 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:07,608 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:07,610 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:07,620 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:07,620 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:57:07,624 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:57:07,625 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:57:07,630 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:07,630 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:57:07,642 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:07,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:57:07,642 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:07,659 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:07,664 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:57:07,670 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:57:07,670 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:07,670 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:07,670 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:07,670 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:07,671 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:07,671 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:57:07,671 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:07,671 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:57:07,671 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:07,672 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:57:07,673 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:57:07,673 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:07,673 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:57:07,673 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:07,673 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:07,674 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:07,674 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:57:07,674 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:57:07,674 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:57:07,674 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:57:07,674 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:57:07,674 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:57:07,676 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:57:07,676 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:57:07,676 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:57:07,676 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:57:07,676 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:57:07,677 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:57:07,677 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:07,677 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:57:07,677 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:07,677 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:07,678 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:07,678 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:57:07,678 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:57:07,678 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:57:07,678 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:57:07,683 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:57:07,683 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:07,684 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:07,684 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:57:07,686 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:07,686 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:07,686 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:07,687 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:07,699 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5339, Threshold=0.5874, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:57:07,699 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5339
2025-08-04 20:57:28,062 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:28,062 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:57:28,063 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:57:28,063 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:57:28,063 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:57:28,063 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:28,436 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:28,436 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:28,523 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:57:28,566 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:57:28,566 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:28,674 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:28,681 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:28,681 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:28,687 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:57:28,697 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:28,697 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:57:28,697 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:28,697 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:28,697 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:57:28,706 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:28,709 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:28,711 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:28,713 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:28,716 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:28,718 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:28,720 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:28,723 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:28,725 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:28,727 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:28,729 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:28,737 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:28,738 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:57:28,742 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:57:28,742 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:57:28,748 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:28,748 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:57:28,759 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:28,759 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:57:28,759 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:28,774 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:28,778 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:57:28,782 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:57:28,782 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:28,782 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:28,782 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:28,783 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:28,783 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:28,783 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:57:28,783 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:28,784 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:57:28,784 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:28,785 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:57:28,785 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:57:28,786 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:28,786 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:57:28,786 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:28,786 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:28,786 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:28,787 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:57:28,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:57:28,787 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:57:28,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:57:28,787 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:57:28,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:57:28,788 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:57:28,788 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:57:28,789 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:57:28,789 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:57:28,789 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:57:28,789 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:57:28,789 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:28,789 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:57:28,790 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:28,790 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:28,790 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:28,790 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:57:28,790 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:57:28,790 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:57:28,791 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:57:28,792 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:57:28,792 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:28,793 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:28,794 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:57:28,795 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:28,795 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:28,795 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:28,795 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:28,808 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5426, Threshold=0.5974, Accuracy=0.7344, F1=0.8159, Precision=0.9826, Recall=0.6975
2025-08-04 20:57:28,808 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7344, F1: 0.8159, Prec: 0.9826, Rec: 0.6975, Avg Anomaly Score: 0.5426
2025-08-04 20:57:34,095 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:34,095 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:57:34,095 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:57:34,095 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:57:34,096 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:57:34,096 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:34,487 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:34,488 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:34,585 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:57:34,626 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:57:34,626 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:34,758 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:34,766 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:34,766 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:34,773 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:57:34,795 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:34,795 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:57:34,795 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:34,796 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:34,796 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:57:34,805 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:34,809 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:34,811 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:34,813 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:34,816 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:34,819 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:34,821 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:34,824 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:34,827 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:34,829 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:34,831 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:34,841 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:34,841 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:57:34,846 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:57:34,847 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:57:34,854 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:34,854 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:57:34,865 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:34,865 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:57:34,865 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:34,880 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:34,886 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:57:34,892 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:57:34,893 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:34,893 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:34,893 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:34,893 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:34,894 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:34,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:57:34,894 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:34,894 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:57:34,895 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:34,896 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:57:34,896 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:57:34,896 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:34,897 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:57:34,897 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:34,897 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:34,897 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:34,897 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:57:34,897 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:57:34,898 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:57:34,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:57:34,898 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:57:34,898 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:57:34,900 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:57:34,900 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:57:34,900 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:57:34,900 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:57:34,900 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:57:34,900 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:57:34,901 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:34,901 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:57:34,901 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:34,901 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:34,901 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:34,902 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:57:34,902 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:57:34,902 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:57:34,902 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:57:34,905 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:57:34,906 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:34,907 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:34,907 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:57:34,909 - ClientAppLogger [Client 9] - INFO - [Client] Fit started for round 150/400.
2025-08-04 20:57:35,009 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:35,010 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:35,011 - ClientAppLogger [Client 9] - INFO - [Client] Semi-supervised: Added 1090 anomalous samples to GAN training data (target: 1090).
2025-08-04 20:57:35,012 - ClientAppLogger [Client 9] - INFO - [Client] Round 150: Training GAN with 4724 samples (3634 normal, 1090 anomalous).
2025-08-04 20:57:35,012 - ClientAppLogger [Client 9] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:38,396 - ClientAppLogger [Client 9] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0836, Avg D Loss: 0.7745
2025-08-04 20:57:38,396 - ClientAppLogger [Client 9] - INFO - GAN Training completed. Avg G Loss: 2.0836, Avg D Loss: 0.7745
2025-08-04 20:57:38,397 - ClientAppLogger [Client 9] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:38,411 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5895, Threshold=0.6703, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:57:38,411 - ClientAppLogger [Client 9] - INFO - [Client] Post-fit local evaluation F1: 0.8135
2025-08-04 20:57:38,412 - ClientAppLogger [Client 9] - INFO - Fit completed for round 150. Duration: 3.50s. Metrics: {'cpu_cores_available': 1, 'client_cid_for_attributes': '9', 'server_round': 150, 'allocated_cores_for_pytorch': 1, 'profile_name': 'Low-End IoT', 'g_loss': 2.0836083608396367, 'd_loss': 0.7744792678515655, 'post_fit_local_f1': 0.8134777376654633, 'fit_time_seconds': 3.5029804706573486, 'cpu_percent_fit': 6.24375, 'ram_mb_fit': 7.28125, 'accumulated_train_samples_this_round': 4724}
2025-08-04 20:57:38,412 - ClientAppLogger [Client 9] - INFO - [Client] get_parameters called
2025-08-04 20:57:49,715 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:49,715 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:57:49,715 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:57:49,715 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:57:49,715 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:57:49,715 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:50,071 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:50,071 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:50,160 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:57:50,205 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:57:50,206 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:50,319 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:50,325 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:50,325 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:50,331 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:57:50,349 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:50,349 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:57:50,350 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:50,350 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:50,350 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:57:50,359 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:50,361 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:50,363 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:50,365 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:50,368 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:50,370 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:50,373 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:50,375 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:50,378 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:50,380 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:50,382 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:50,391 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:50,391 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:57:50,396 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:57:50,396 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:57:50,401 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:50,401 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:57:50,414 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:50,414 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:57:50,414 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:50,429 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:50,433 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:57:50,437 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:57:50,437 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:50,438 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:50,438 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:50,438 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:50,438 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:50,439 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:57:50,439 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:50,439 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:57:50,439 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:50,440 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:57:50,440 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:57:50,441 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:50,441 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:57:50,441 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:50,441 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:50,442 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:50,442 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:57:50,442 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:57:50,442 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:57:50,442 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:57:50,442 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:57:50,442 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:57:50,443 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:57:50,443 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:57:50,444 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:57:50,444 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:57:50,444 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:57:50,444 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:57:50,444 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:50,444 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:57:50,445 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:50,445 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:50,445 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:50,445 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:57:50,445 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:57:50,446 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:57:50,446 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:57:50,450 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:57:50,450 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:50,451 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:50,451 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:57:50,453 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:50,453 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:50,453 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:50,454 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:50,468 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5473, Threshold=0.6057, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:57:50,468 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5473
2025-08-04 20:58:07,789 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:07,789 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:58:07,789 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:58:07,789 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:58:07,789 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:58:07,789 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:08,164 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:08,164 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:08,252 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:58:08,296 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:58:08,296 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:08,411 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:08,418 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:08,418 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:08,423 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:58:08,428 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:08,428 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:58:08,429 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:08,429 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:08,429 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:58:08,437 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:08,440 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:08,443 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:08,445 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:08,448 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:08,450 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:08,453 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:08,455 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:08,459 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:08,461 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:08,463 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:08,472 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:08,472 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:58:08,477 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:58:08,478 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:58:08,482 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:08,483 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:58:08,491 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:08,491 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:58:08,492 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:08,506 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:08,511 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:58:08,520 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:58:08,521 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:08,521 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:08,521 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:08,521 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:08,521 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:08,522 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:58:08,522 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:08,522 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:58:08,522 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:08,523 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:58:08,524 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:58:08,524 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:08,524 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:58:08,524 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:08,524 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:08,525 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:08,525 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:58:08,525 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:58:08,525 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:58:08,525 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:58:08,525 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:58:08,525 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:58:08,526 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:58:08,526 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:58:08,526 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:58:08,527 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:58:08,527 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:58:08,527 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:58:08,527 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:08,527 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:58:08,527 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:08,528 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:08,528 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:08,528 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:58:08,528 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:58:08,528 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:58:08,528 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:58:08,535 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:58:08,535 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:08,536 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:08,536 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:58:08,538 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:08,538 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:08,538 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:08,539 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:08,553 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5235, Threshold=0.5749, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:58:08,553 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5235
2025-08-04 20:58:28,860 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:28,860 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:58:28,861 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:58:28,861 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:58:28,861 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:58:28,861 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:29,238 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:29,238 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:29,329 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:58:29,369 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:58:29,369 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:29,486 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:29,492 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:29,492 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:29,497 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:58:29,502 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:29,502 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:58:29,503 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:29,503 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:29,503 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:58:29,511 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:29,514 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:29,516 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:29,518 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:29,521 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:29,523 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:29,526 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:29,528 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:29,531 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:29,533 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:29,535 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:29,543 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:29,543 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:58:29,548 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:58:29,548 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:58:29,552 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:29,552 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:58:29,561 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:29,561 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:58:29,561 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:29,575 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:29,580 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:58:29,585 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:58:29,585 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:29,585 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:29,585 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:29,585 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:29,585 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:29,586 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:58:29,586 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:29,586 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:58:29,586 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:29,587 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:58:29,588 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:58:29,588 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:29,588 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:58:29,588 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:29,588 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:29,588 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:29,589 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:58:29,589 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:58:29,589 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:58:29,589 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:58:29,589 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:58:29,589 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:58:29,590 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:58:29,590 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:58:29,590 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:58:29,591 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:58:29,591 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:58:29,591 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:58:29,591 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:29,591 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:58:29,592 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:29,592 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:29,592 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:29,592 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:58:29,592 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:58:29,592 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:58:29,593 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:58:29,597 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:58:29,597 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:29,598 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:29,598 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:58:29,600 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:29,600 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:29,600 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:29,600 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:29,613 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5775, Threshold=0.6473, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:58:29,613 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5775
2025-08-04 20:58:46,919 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:46,919 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:58:46,919 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:58:46,919 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:58:46,920 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:58:46,920 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:47,292 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:47,294 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:47,384 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:58:47,429 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:58:47,429 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:47,590 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:47,596 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:47,596 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:47,601 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:58:47,607 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:47,607 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:58:47,608 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:47,608 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:47,608 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:58:47,616 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:47,619 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:47,621 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:47,624 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:47,626 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:47,629 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:47,631 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:47,633 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:47,636 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:47,638 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:47,640 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:47,649 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:47,649 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:58:47,654 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:58:47,654 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:58:47,660 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:47,660 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:58:47,670 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:47,670 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:58:47,671 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:47,685 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:47,689 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:58:47,694 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:58:47,694 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:47,694 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:47,694 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:47,695 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:47,695 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:47,695 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:58:47,695 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:47,695 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:58:47,696 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:47,697 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:58:47,697 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:58:47,697 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:47,698 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:58:47,698 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:47,698 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:47,698 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:47,698 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:58:47,698 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:58:47,698 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:58:47,699 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:58:47,699 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:58:47,699 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:58:47,701 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:58:47,701 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:58:47,701 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:58:47,701 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:58:47,701 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:58:47,701 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:58:47,702 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:47,702 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:58:47,702 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:47,702 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:47,702 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:47,703 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:58:47,703 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:58:47,703 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:58:47,703 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:58:47,709 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:58:47,710 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:47,711 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:47,711 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:58:47,713 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:47,713 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:47,713 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:47,714 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:47,726 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.4784, Threshold=0.5150, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:58:47,726 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.4784
2025-08-04 20:59:08,020 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:08,021 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:59:08,021 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:59:08,021 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:59:08,021 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:59:08,021 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:08,388 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:08,388 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:08,478 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:59:08,502 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:59:08,502 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:08,646 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:08,652 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:08,652 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:08,657 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:59:08,676 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:08,676 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:59:08,677 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:08,677 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:08,677 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:59:08,686 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:08,689 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:08,691 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:08,693 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:08,696 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:08,698 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:08,701 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:08,704 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:08,707 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:08,709 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:08,713 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:08,724 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:08,725 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:59:08,730 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:59:08,730 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:59:08,736 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:08,736 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:59:08,747 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:08,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:59:08,747 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:08,761 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:08,766 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:59:08,771 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:59:08,771 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:08,771 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:08,771 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:08,772 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:08,772 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:08,772 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:59:08,772 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:08,772 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:59:08,772 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:08,774 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:59:08,774 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:59:08,774 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:08,774 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:59:08,774 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:08,774 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:08,775 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:08,775 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:59:08,775 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:59:08,775 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:59:08,775 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:59:08,775 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:59:08,775 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:59:08,776 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:59:08,777 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:59:08,777 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:59:08,777 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:59:08,777 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:59:08,777 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:59:08,777 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:08,777 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:59:08,778 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:08,778 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:08,778 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:08,778 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:59:08,778 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:59:08,778 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:59:08,779 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:59:08,784 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:59:08,784 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:08,785 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:08,786 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:59:08,787 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:08,787 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:08,787 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:08,788 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:08,800 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5390, Threshold=0.5953, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:59:08,800 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5390
2025-08-04 20:59:26,096 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:26,097 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:59:26,097 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:59:26,097 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:59:26,097 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:59:26,097 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:26,457 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:26,458 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:26,548 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:59:26,572 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:59:26,574 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:26,708 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:26,714 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:26,714 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:26,778 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:59:26,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:26,787 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:59:26,788 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:26,788 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:26,788 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:59:26,798 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:26,801 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:26,804 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:26,806 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:26,809 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:26,811 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:26,814 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:26,817 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:26,819 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:26,821 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:26,823 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:26,833 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:26,833 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:59:26,838 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:59:26,838 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:59:26,844 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:26,844 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:59:26,853 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:26,853 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:59:26,853 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:26,869 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:26,873 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:59:26,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:59:26,877 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:26,877 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:26,877 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:26,878 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:26,878 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:26,878 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:59:26,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:26,879 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:59:26,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:26,880 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:59:26,880 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:59:26,881 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:26,881 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:59:26,881 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:26,881 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:26,881 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:26,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:59:26,882 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:59:26,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:59:26,882 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:59:26,882 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:59:26,882 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:59:26,883 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:59:26,883 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:59:26,883 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:59:26,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:59:26,884 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:59:26,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:59:26,884 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:26,884 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:59:26,884 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:26,885 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:26,885 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:26,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:59:26,885 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:59:26,885 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:59:26,885 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:59:26,894 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:59:26,894 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:26,896 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:26,896 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:59:26,897 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:26,897 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:26,898 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:26,898 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:26,912 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5322, Threshold=0.5853, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:59:26,912 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5322
2025-08-04 20:59:38,196 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:38,196 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:59:38,196 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:59:38,196 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:59:38,197 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:59:38,197 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:38,670 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:38,670 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:38,767 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:59:38,815 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:59:38,816 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:38,968 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:38,976 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:38,976 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:38,981 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:59:38,987 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:38,987 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:59:38,988 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:38,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:38,988 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:59:38,998 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:39,001 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:39,004 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:39,007 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:39,010 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:39,012 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:39,015 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:39,018 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:39,021 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:39,022 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:39,025 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:39,035 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:39,035 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:59:39,040 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:59:39,041 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:59:39,045 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:39,045 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:59:39,055 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:39,056 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:59:39,056 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:39,074 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:39,078 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:59:39,084 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:59:39,084 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:39,084 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:39,084 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:39,085 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:39,085 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:39,085 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:59:39,086 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:39,086 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:59:39,086 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:39,088 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:59:39,088 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:59:39,088 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:39,088 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:59:39,088 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:39,089 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:39,089 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:39,089 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:59:39,089 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:59:39,089 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:59:39,089 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:59:39,089 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:59:39,089 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:59:39,091 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:59:39,091 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:59:39,091 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:59:39,092 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:59:39,092 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:59:39,092 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:59:39,092 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:39,092 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:59:39,092 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:39,093 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:39,093 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:39,093 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:59:39,094 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:59:39,094 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:59:39,094 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:59:39,099 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:59:39,100 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:39,101 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:39,101 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:59:39,103 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:39,103 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:39,103 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:39,104 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:39,117 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5099, Threshold=0.5710, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:59:39,117 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5099
2025-08-04 20:59:53,401 - ClientAppLogger [Client 9] - INFO - ClientApp starting for partition_id: 9. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:53,401 - ClientAppLogger [Client 9] - INFO - ALLOCATED_CORES='1' found. Setting PyTorch threads to 1.
2025-08-04 20:59:53,401 - ClientAppLogger [Client 9] - INFO - Called torch.set_num_threads(1). Current PyTorch intra-op threads: 1. Client will operate with 1 core(s).
2025-08-04 20:59:53,401 - ClientAppLogger [Client 9] - INFO - Loading data for partition 9/10...
2025-08-04 20:59:53,402 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting load_data function.
2025-08-04 20:59:53,402 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:53,786 - ClientAppLogger [Client 9] - INFO - [LoadData 9] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:53,786 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:53,879 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Numeric conversion completed.
2025-08-04 20:59:53,916 - ClientAppLogger [Client 9] - INFO - [LoadData 9] NA values filled.
2025-08-04 20:59:53,916 - ClientAppLogger [Client 9] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:54,041 - ClientAppLogger [Client 9] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:54,047 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:54,047 - ClientAppLogger [Client 9] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:54,053 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Scaler fitting process completed.
2025-08-04 20:59:54,062 - ClientAppLogger [Client 9] - INFO - [LoadData 9] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:54,062 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting semi-supervised data splitting logic.
2025-08-04 20:59:54,063 - ClientAppLogger [Client 9] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:54,063 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:54,063 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting anomaly reduction logic.
2025-08-04 20:59:54,072 - ClientAppLogger [Client 9] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:54,076 - ClientAppLogger [Client 9] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:54,078 - ClientAppLogger [Client 9] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:54,080 - ClientAppLogger [Client 9] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:54,083 - ClientAppLogger [Client 9] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:54,085 - ClientAppLogger [Client 9] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:54,088 - ClientAppLogger [Client 9] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:54,091 - ClientAppLogger [Client 9] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:54,093 - ClientAppLogger [Client 9] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:54,095 - ClientAppLogger [Client 9] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:54,097 - ClientAppLogger [Client 9] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:54,111 - ClientAppLogger [Client 9] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:54,112 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Anomaly reduction logic completed.
2025-08-04 20:59:54,117 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Normal and anomaly indices shuffled.
2025-08-04 20:59:54,117 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating unlabeled training base.
2025-08-04 20:59:54,124 - ClientAppLogger [Client 9] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:54,124 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating labeled pool.
2025-08-04 20:59:54,136 - ClientAppLogger [Client 9] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:54,137 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Labeled pool creation completed.
2025-08-04 20:59:54,137 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:54,152 - ClientAppLogger [Client 9] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:54,157 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Combining data for final AE training set.
2025-08-04 20:59:54,163 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Final AE training data combination completed.
2025-08-04 20:59:54,164 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:54,164 - ClientAppLogger [Client 9] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:54,164 - ClientAppLogger [Client 9] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:54,164 - ClientAppLogger [Client 9] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:54,165 - ClientAppLogger [Client 9] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:54,165 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] START of partitioning block.
2025-08-04 20:59:54,165 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:54,166 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 1: Full indices created.
2025-08-04 20:59:54,166 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:54,167 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 2: Full indices shuffled.
2025-08-04 20:59:54,167 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Full indices shuffled.
2025-08-04 20:59:54,168 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:54,168 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Remainder distribution completed.
2025-08-04 20:59:54,168 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:54,168 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:54,168 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:54,168 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 6: Start indices calculated. train_start=54318
2025-08-04 20:59:54,169 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Start indices calculated. Train_start=54318, Val_start=7543, Test_start=8016
2025-08-04 20:59:54,169 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 7: End indices calculated. train_end=71888
2025-08-04 20:59:54,169 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: End indices calculated. Train_end=71888, Val_end=8119, Test_end=8120
2025-08-04 20:59:54,169 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 8: Partition-specific indices extracted. Num train indices: 17570
2025-08-04 20:59:54,169 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Specific indices extracted. Train idx: 17570, Val idx: 576, Test idx: 104
2025-08-04 20:59:54,171 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9a: Train data sliced for partition. X_train_part_full shape: (17570, 17)
2025-08-04 20:59:54,172 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Train data sliced. Shape: (17570, 17)
2025-08-04 20:59:54,172 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9b: Validation data sliced for partition. X_val_part shape: (576, 17)
2025-08-04 20:59:54,172 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Validation data sliced. Shape: (576, 17)
2025-08-04 20:59:54,172 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 9c: Test data sliced for partition. X_test_part shape: (104, 17)
2025-08-04 20:59:54,173 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Partitioning: Test data sliced. Shape: (104, 17)
2025-08-04 20:59:54,173 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:54,173 - ClientAppLogger [Client 9] - INFO - [LoadData 9] Creating TonIoTDataset objects.
2025-08-04 20:59:54,174 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:54,174 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:54,174 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:54,174 - ClientAppLogger [Client 9] - INFO - [LoadData 9] TonIoTDataset objects created.
2025-08-04 20:59:54,174 - ClientAppLogger [Client 9] - INFO - Partition 9 (Static Datasets): Train Potential 17570, Val 576, Test 104
2025-08-04 20:59:54,175 - ClientAppLogger [Client 9] - INFO - [Partitioning Debug 9] END of partitioning block, returning datasets.
2025-08-04 20:59:54,175 - ClientAppLogger [Client 9] - INFO - [LoadData 9] load_data function completed.
2025-08-04 20:59:54,182 - ClientAppLogger [Client 9] - INFO - Data loaded for partition 9: Train samples: 17570, Val samples: 576
2025-08-04 20:59:54,182 - ClientAppLogger [Client 9] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:54,184 - ClientAppLogger [Client 9] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:54,184 - ClientAppLogger [Client 9] - INFO - [Client] Initialized. Device: cpu. Operating with 1 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 1.
2025-08-04 20:59:54,186 - ClientAppLogger [Client 9] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:54,186 - ClientAppLogger [Client 9] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:54,186 - ClientAppLogger [Client 9] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:54,187 - ClientAppLogger [Client 9] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:54,202 - ClientAppLogger [Client 9] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=576, Avg Anomaly Score (all samples)=0.5154, Threshold=0.5604, Accuracy=0.7309, F1=0.8135, Precision=0.9797, Recall=0.6955
2025-08-04 20:59:54,202 - ClientAppLogger [Client 9] - INFO - [Client] Evaluation finished. Samples: 576, Acc: 0.7309, F1: 0.8135, Prec: 0.9797, Rec: 0.6955, Avg Anomaly Score: 0.5154
