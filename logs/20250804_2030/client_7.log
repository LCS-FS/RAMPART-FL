2025-08-04 20:30:00,134 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:00,134 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:30:00,134 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:30:00,134 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:30:00,134 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:30:00,134 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:00,380 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:00,381 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:00,465 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:30:00,501 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:30:00,501 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:00,593 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:00,599 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:00,599 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:00,605 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:30:00,610 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:00,611 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:30:00,611 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:00,611 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:00,611 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:30:00,620 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:00,623 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:00,626 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:00,628 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:00,631 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:00,633 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:00,636 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:00,638 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:00,641 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:00,643 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:00,645 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:00,655 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:00,655 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:30:00,660 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:30:00,660 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:30:00,665 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:00,665 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:30:00,678 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:00,679 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:30:00,679 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:00,697 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:00,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:30:00,708 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:30:00,709 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:00,709 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:00,709 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:00,709 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:00,710 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:00,710 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:30:00,710 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:00,710 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:30:00,710 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:00,711 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:30:00,712 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:30:00,712 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:00,712 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:30:00,712 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:00,712 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:00,712 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:00,713 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:30:00,713 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:30:00,713 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:30:00,713 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:30:00,713 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:30:00,713 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:30:00,713 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:30:00,714 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:30:00,714 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:30:00,714 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:30:00,714 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:30:00,714 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:30:00,714 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:00,714 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:30:00,715 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:00,715 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:00,715 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:00,715 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:30:00,716 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:30:00,716 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:30:00,716 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:30:00,723 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:30:00,723 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:00,724 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:00,724 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:30:00,726 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 41/400.
2025-08-04 20:30:00,827 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:00,827 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:00,828 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 15 anomalous samples to GAN training data (target: 15).
2025-08-04 20:30:00,828 - ClientAppLogger [Client 7] - INFO - [Client] Round 41: Training GAN with 67 samples (52 normal, 15 anomalous).
2025-08-04 20:30:00,829 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:30:00,902 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0834, Avg D Loss: 0.8950
2025-08-04 20:30:00,906 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0834, Avg D Loss: 0.8950
2025-08-04 20:30:00,906 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:30:00,937 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3412, Threshold=0.3606, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:30:00,938 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.7839
2025-08-04 20:30:00,938 - ClientAppLogger [Client 7] - INFO - Fit completed for round 41. Duration: 0.21s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 41, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0834155394070186, 'd_loss': 0.8949811104518263, 'post_fit_local_f1': 0.7839065541855937, 'fit_time_seconds': 0.21199846267700195, 'cpu_percent_fit': 24.15625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 67}
2025-08-04 20:30:00,938 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:30:06,207 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:06,207 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:30:06,207 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:30:06,207 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:30:06,207 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:30:06,208 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:06,582 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:06,583 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:06,680 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:30:06,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:30:06,717 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:06,820 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:06,830 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:06,830 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:06,840 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:30:06,858 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:06,858 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:30:06,859 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:06,859 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:06,859 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:30:06,868 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:06,872 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:06,874 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:06,876 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:06,879 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:06,881 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:06,884 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:06,887 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:06,890 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:06,892 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:06,894 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:06,908 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:06,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:30:06,914 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:30:06,914 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:30:06,921 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:06,921 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:30:06,932 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:06,932 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:30:06,932 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:06,958 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:06,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:30:06,974 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:30:06,974 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:06,974 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:06,974 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:06,975 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:06,975 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:06,975 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:30:06,975 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:06,976 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:30:06,976 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:06,978 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:30:06,978 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:30:06,979 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:06,979 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:30:06,979 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:06,979 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:06,979 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:06,980 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:30:06,980 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:30:06,980 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:30:06,980 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:30:06,980 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:30:06,981 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:30:06,981 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:30:06,981 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:30:06,982 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:30:06,982 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:30:06,982 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:30:06,983 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:30:06,983 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:06,983 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:30:06,983 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:06,984 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:06,984 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:06,984 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:30:06,984 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:30:06,984 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:30:06,985 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:30:06,988 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:30:06,989 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:06,993 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:06,993 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:30:06,995 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:06,998 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:06,998 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:07,000 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:07,042 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3490, Threshold=0.3683, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:30:07,042 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3490
2025-08-04 20:30:21,327 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:21,327 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:30:21,327 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:30:21,327 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:30:21,327 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:30:21,328 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:21,649 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:21,649 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:21,741 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:30:21,779 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:30:21,780 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:21,884 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:21,892 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:21,892 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:21,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:30:21,910 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:21,910 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:30:21,911 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:21,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:21,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:30:21,920 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:21,923 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:21,926 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:21,928 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:21,931 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:21,933 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:21,936 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:21,939 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:21,941 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:21,943 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:21,946 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:21,956 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:21,956 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:30:21,961 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:30:21,961 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:30:21,967 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:21,967 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:30:21,977 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:21,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:30:21,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:21,993 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:21,999 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:30:22,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:30:22,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:22,011 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:22,011 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:22,011 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:22,011 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:22,012 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:30:22,012 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:22,012 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:30:22,012 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:22,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:30:22,013 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:30:22,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:22,014 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:30:22,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:22,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:22,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:22,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:30:22,014 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:30:22,015 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:30:22,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:30:22,015 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:30:22,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:30:22,015 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:30:22,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:30:22,016 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:30:22,016 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:30:22,016 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:30:22,016 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:30:22,016 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:22,016 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:30:22,017 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:22,017 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:22,017 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:22,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:30:22,017 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:30:22,018 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:30:22,018 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:30:22,021 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:30:22,022 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:22,023 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:22,023 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:30:22,025 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:22,025 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:22,025 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:22,026 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:22,061 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3389, Threshold=0.3576, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:30:22,061 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3389
2025-08-04 20:30:33,337 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:33,337 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:30:33,338 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:30:33,338 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:30:33,338 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:30:33,338 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:33,762 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:33,762 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:33,851 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:30:33,893 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:30:33,893 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:34,013 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:34,022 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:34,022 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:34,029 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:30:34,054 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:34,054 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:30:34,055 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:34,056 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:34,056 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:30:34,065 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:34,068 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:34,070 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:34,073 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:34,076 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:34,078 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:34,082 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:34,085 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:34,088 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:34,091 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:34,094 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:34,108 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:34,108 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:30:34,115 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:30:34,115 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:30:34,123 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:34,124 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:30:34,135 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:34,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:30:34,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:34,151 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:34,156 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:30:34,161 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:30:34,161 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:34,162 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:34,162 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:34,162 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:34,162 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:34,162 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:30:34,163 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:34,163 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:30:34,163 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:34,164 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:30:34,164 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:30:34,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:34,165 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:30:34,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:34,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:34,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:34,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:30:34,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:30:34,166 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:30:34,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:30:34,166 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:30:34,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:30:34,166 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:30:34,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:30:34,167 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:30:34,167 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:30:34,167 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:30:34,167 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:30:34,167 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:34,168 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:30:34,168 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:34,168 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:34,168 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:34,168 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:30:34,169 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:30:34,169 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:30:34,169 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:30:34,177 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:30:34,177 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:34,178 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:34,178 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:30:34,180 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:34,180 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:34,180 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:34,181 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:34,221 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3466, Threshold=0.3665, Accuracy=0.6885, F1=0.7826, Precision=0.9349, Recall=0.6730
2025-08-04 20:30:34,221 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6885, F1: 0.7826, Prec: 0.9349, Rec: 0.6730, Avg Anomaly Score: 0.3466
2025-08-04 20:30:48,518 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:48,518 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:30:48,519 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:30:48,519 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:30:48,519 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:30:48,519 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:48,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:48,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:48,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:30:49,006 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:30:49,006 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:49,109 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:49,116 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:49,117 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:49,123 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:30:49,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:49,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:30:49,136 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:49,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:49,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:30:49,148 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:49,151 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:49,153 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:49,156 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:49,159 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:49,162 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:49,164 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:49,167 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:49,170 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:49,172 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:49,175 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:49,188 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:49,188 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:30:49,194 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:30:49,195 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:30:49,203 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:49,203 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:30:49,220 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:49,220 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:30:49,221 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:49,239 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:49,244 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:30:49,253 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:30:49,253 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:49,253 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:49,254 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:49,254 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:49,254 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:49,254 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:30:49,254 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:49,255 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:30:49,255 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:49,256 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:30:49,256 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:30:49,257 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:49,257 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:30:49,257 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:49,257 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:49,257 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:49,258 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:30:49,258 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:30:49,258 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:30:49,258 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:30:49,258 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:30:49,258 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:30:49,258 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:30:49,259 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:30:49,259 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:30:49,259 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:30:49,259 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:30:49,259 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:30:49,259 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:49,259 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:30:49,260 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:49,260 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:49,260 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:49,260 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:30:49,261 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:30:49,261 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:30:49,261 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:30:49,268 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:30:49,268 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:49,269 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:49,270 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:30:49,271 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:49,271 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:49,271 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:49,272 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:49,316 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3376, Threshold=0.3563, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:30:49,316 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3376
2025-08-04 20:31:06,622 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:06,622 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:31:06,623 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:31:06,623 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:31:06,623 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:31:06,623 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:07,005 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:07,005 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:07,096 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:31:07,125 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:31:07,126 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:07,278 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:07,285 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:07,285 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:07,292 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:31:07,306 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:07,306 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:31:07,307 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:07,307 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:07,307 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:31:07,317 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:07,320 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:07,323 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:07,325 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:07,328 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:07,330 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:07,333 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:07,335 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:07,338 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:07,340 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:07,342 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:07,354 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:07,354 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:31:07,359 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:31:07,359 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:31:07,368 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:07,368 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:31:07,380 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:07,381 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:31:07,381 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:07,400 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:07,406 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:31:07,412 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:31:07,413 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:07,413 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:07,413 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:07,413 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:07,413 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:07,414 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:31:07,414 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:07,414 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:31:07,414 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:07,415 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:31:07,416 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:31:07,416 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:07,416 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:31:07,416 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:07,416 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:07,417 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:07,417 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:31:07,417 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:31:07,417 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:31:07,417 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:31:07,417 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:31:07,418 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:31:07,418 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:31:07,418 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:31:07,418 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:31:07,419 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:31:07,419 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:31:07,419 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:31:07,419 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:07,419 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:31:07,419 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:07,420 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:07,420 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:07,420 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:31:07,420 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:31:07,420 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:31:07,421 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:31:07,429 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:31:07,429 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:07,430 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:07,430 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:31:07,432 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:07,432 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:07,432 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:07,433 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:07,469 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3452, Threshold=0.3636, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:31:07,470 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3452
2025-08-04 20:31:21,746 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:21,746 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:31:21,747 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:31:21,747 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:31:21,747 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:31:21,747 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:22,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:22,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:22,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:31:22,167 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:31:22,167 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:22,296 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:22,303 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:22,303 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:22,309 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:31:22,316 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:22,317 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:31:22,317 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:22,317 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:22,318 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:31:22,328 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:22,332 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:22,334 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:22,337 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:22,340 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:22,343 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:22,346 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:22,349 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:22,353 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:22,355 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:22,357 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:22,370 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:22,370 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:31:22,375 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:31:22,375 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:31:22,382 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:22,383 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:31:22,400 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:22,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:31:22,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:22,417 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:22,422 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:31:22,431 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:31:22,431 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:22,431 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:22,431 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:22,432 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:22,432 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:22,433 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:31:22,433 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:22,433 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:31:22,433 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:22,435 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:31:22,435 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:31:22,436 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:22,436 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:31:22,436 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:22,436 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:22,437 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:22,437 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:31:22,437 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:31:22,437 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:31:22,437 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:31:22,438 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:31:22,438 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:31:22,438 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:31:22,438 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:31:22,439 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:31:22,439 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:31:22,439 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:31:22,439 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:31:22,439 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:22,439 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:31:22,440 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:22,440 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:22,440 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:22,441 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:31:22,441 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:31:22,441 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:31:22,441 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:31:22,445 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:31:22,446 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:22,448 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:22,448 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:31:22,449 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:22,450 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:22,450 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:22,450 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:22,485 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3473, Threshold=0.3655, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:31:22,486 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3473
2025-08-04 20:31:33,758 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:33,758 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:31:33,758 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:31:33,758 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:31:33,758 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:31:33,758 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:34,057 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:34,058 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:34,148 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:31:34,191 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:31:34,191 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:34,307 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:34,316 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:34,316 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:34,325 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:31:34,335 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:34,335 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:31:34,335 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:34,336 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:34,336 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:31:34,346 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:34,351 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:34,353 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:34,356 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:34,359 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:34,361 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:34,364 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:34,366 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:34,369 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:34,371 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:34,373 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:34,385 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:34,385 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:31:34,390 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:31:34,391 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:31:34,397 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:34,397 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:31:34,407 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:34,407 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:31:34,408 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:34,427 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:34,432 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:31:34,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:31:34,444 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:34,444 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:34,445 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:34,445 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:34,446 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:34,446 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:31:34,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:34,446 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:31:34,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:34,448 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:31:34,448 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:31:34,449 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:34,449 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:31:34,449 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:34,449 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:34,449 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:34,450 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:31:34,450 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:31:34,450 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:31:34,450 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:31:34,450 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:31:34,450 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:31:34,451 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:31:34,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:31:34,451 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:31:34,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:31:34,452 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:31:34,452 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:31:34,452 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:34,452 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:31:34,452 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:34,453 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:34,453 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:34,453 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:31:34,453 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:31:34,454 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:31:34,454 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:31:34,458 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:31:34,458 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:34,460 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:34,460 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:31:34,462 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:34,462 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:34,462 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:34,463 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:34,503 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3267, Threshold=0.3437, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:31:34,503 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3267
2025-08-04 20:31:48,794 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:48,794 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:31:48,794 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:31:48,794 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:31:48,795 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:31:48,795 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:49,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:49,217 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:49,305 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:31:49,324 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:31:49,324 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:49,429 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:49,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:49,444 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:49,455 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:31:49,469 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:49,469 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:31:49,470 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:49,470 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:49,470 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:31:49,481 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:49,485 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:49,488 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:49,490 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:49,493 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:49,496 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:49,499 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:49,502 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:49,505 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:49,508 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:49,510 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:49,524 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:49,524 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:31:49,530 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:31:49,530 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:31:49,537 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:49,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:31:49,559 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:49,559 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:31:49,560 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:49,578 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:49,585 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:31:49,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:31:49,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:49,593 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:49,593 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:49,594 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:49,594 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:49,594 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:31:49,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:49,594 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:31:49,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:49,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:31:49,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:31:49,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:49,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:31:49,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:49,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:49,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:49,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:31:49,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:31:49,598 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:31:49,598 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:31:49,598 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:31:49,598 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:31:49,598 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:31:49,599 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:31:49,599 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:31:49,599 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:31:49,599 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:31:49,599 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:31:49,600 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:49,600 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:31:49,600 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:49,600 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:49,604 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:49,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:31:49,605 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:31:49,605 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:31:49,605 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:31:49,611 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:31:49,611 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:49,613 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:49,613 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:31:49,614 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:49,614 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:49,614 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:49,615 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:49,661 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3467, Threshold=0.3658, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:31:49,662 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3467
2025-08-04 20:32:06,950 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:06,950 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:32:06,950 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:32:06,950 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:32:06,950 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:32:06,951 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:07,280 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:07,281 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:07,370 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:32:07,415 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:32:07,415 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:07,534 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:07,541 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:07,541 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:07,550 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:32:07,558 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:07,558 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:32:07,559 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:07,559 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:07,559 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:32:07,568 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:07,571 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:07,573 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:07,575 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:07,578 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:07,580 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:07,582 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:07,585 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:07,587 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:07,589 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:07,591 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:07,601 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:07,602 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:32:07,606 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:32:07,606 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:32:07,613 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:07,613 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:32:07,625 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:07,626 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:32:07,626 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:07,643 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:07,648 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:32:07,653 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:32:07,653 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:07,653 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:07,653 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:07,654 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:07,654 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:07,654 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:32:07,654 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:07,654 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:32:07,654 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:07,656 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:32:07,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:32:07,656 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:07,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:32:07,656 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:07,657 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:07,657 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:07,657 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:32:07,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:32:07,657 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:32:07,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:32:07,658 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:32:07,658 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:32:07,658 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:32:07,658 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:32:07,658 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:32:07,658 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:32:07,659 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:32:07,659 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:32:07,659 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:07,659 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:32:07,659 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:07,660 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:07,660 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:07,660 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:32:07,660 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:32:07,660 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:32:07,660 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:32:07,664 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:32:07,664 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:07,665 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:07,666 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:32:07,667 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:07,667 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:07,667 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:07,668 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:07,703 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3505, Threshold=0.3736, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:32:07,703 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3505
2025-08-04 20:32:18,972 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:18,973 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:32:18,973 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:32:18,973 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:32:18,973 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:32:18,973 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:19,306 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:19,306 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:19,394 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:32:19,420 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:32:19,421 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:19,521 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:19,529 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:19,529 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:19,535 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:32:19,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:19,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:32:19,543 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:19,543 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:19,543 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:32:19,552 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:19,555 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:19,557 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:19,560 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:19,562 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:19,565 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:19,567 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:19,570 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:19,573 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:19,575 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:19,577 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:19,588 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:19,589 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:32:19,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:32:19,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:32:19,598 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:19,598 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:32:19,607 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:19,607 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:32:19,608 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:19,629 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:19,637 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:32:19,643 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:32:19,643 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:19,643 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:19,643 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:19,644 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:19,644 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:19,644 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:32:19,644 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:19,644 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:32:19,645 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:19,646 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:32:19,646 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:32:19,647 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:19,647 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:32:19,647 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:19,647 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:19,647 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:19,648 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:32:19,648 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:32:19,648 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:32:19,648 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:32:19,648 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:32:19,649 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:32:19,649 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:32:19,649 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:32:19,649 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:32:19,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:32:19,650 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:32:19,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:32:19,650 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:19,651 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:32:19,651 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:19,651 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:19,652 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:19,652 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:32:19,652 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:32:19,652 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:32:19,652 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:32:19,656 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:32:19,657 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:19,658 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:19,658 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:32:19,660 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:19,660 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:19,660 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:19,661 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:19,696 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3443, Threshold=0.3656, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:32:19,697 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3443
2025-08-04 20:32:30,970 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:30,970 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:32:30,970 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:32:30,971 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:32:30,971 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:32:30,971 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:31,333 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:31,334 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:31,429 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:32:31,465 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:32:31,465 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:31,613 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:31,620 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:31,621 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:31,669 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:32:31,688 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:31,688 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:32:31,689 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:31,689 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:31,689 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:32:31,700 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:31,703 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:31,705 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:31,709 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:31,712 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:31,714 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:31,717 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:31,720 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:31,723 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:31,725 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:31,728 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:31,739 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:31,739 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:32:31,744 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:32:31,744 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:32:31,752 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:31,752 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:32:31,764 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:31,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:32:31,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:31,781 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:31,786 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:32:31,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:32:31,792 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:31,792 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:31,792 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:31,792 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:31,792 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:31,793 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:32:31,793 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:31,793 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:32:31,793 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:31,794 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:32:31,795 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:32:31,795 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:31,795 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:32:31,795 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:31,795 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:31,795 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:31,796 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:32:31,796 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:32:31,796 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:32:31,796 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:32:31,796 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:32:31,796 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:32:31,797 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:32:31,797 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:32:31,797 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:32:31,797 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:32:31,798 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:32:31,798 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:32:31,798 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:31,798 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:32:31,799 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:31,799 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:31,799 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:31,799 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:32:31,799 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:32:31,800 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:32:31,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:32:31,810 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:32:31,810 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:31,811 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:31,812 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:32:31,813 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:31,814 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:31,814 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:31,814 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:31,855 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3516, Threshold=0.3759, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:32:31,855 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3516
2025-08-04 20:32:46,144 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:46,144 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:32:46,144 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:32:46,144 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:32:46,144 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:32:46,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:46,577 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:46,577 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:46,679 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:32:46,722 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:32:46,722 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:46,857 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:46,865 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:46,865 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:46,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:32:46,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:46,886 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:32:46,886 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:46,886 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:46,887 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:32:46,897 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:46,900 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:46,903 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:46,905 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:46,908 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:46,910 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:46,913 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:46,916 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:46,919 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:46,921 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:46,923 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:46,934 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:46,937 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:32:46,942 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:32:46,943 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:32:46,949 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:46,949 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:32:46,968 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:46,969 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:32:46,969 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:46,985 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:46,990 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:32:46,996 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:32:46,996 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:46,996 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:46,996 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:46,997 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:46,997 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:46,997 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:32:46,997 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:46,997 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:32:46,998 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:46,999 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:32:46,999 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:32:47,000 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:47,000 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:32:47,000 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:47,000 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:47,000 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:47,001 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:32:47,001 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:32:47,001 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:32:47,001 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:32:47,001 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:32:47,001 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:32:47,002 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:32:47,002 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:32:47,002 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:32:47,002 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:32:47,003 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:32:47,003 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:32:47,003 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:47,003 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:32:47,004 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:47,004 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:47,004 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:47,004 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:32:47,004 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:32:47,004 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:32:47,005 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:32:47,008 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:32:47,008 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:47,010 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:47,010 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:32:47,011 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:47,012 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:47,012 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:47,013 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:47,066 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3626, Threshold=0.3890, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:32:47,066 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3626
2025-08-04 20:33:01,337 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:01,337 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:33:01,337 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:33:01,337 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:33:01,337 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:33:01,337 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:01,610 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:01,610 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:01,694 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:33:01,708 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:33:01,708 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:01,794 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:01,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:01,800 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:01,806 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:33:01,813 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:01,814 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:33:01,814 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:01,814 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:01,814 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:33:01,823 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:01,826 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:01,829 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:01,831 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:01,837 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:01,840 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:01,842 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:01,845 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:01,848 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:01,851 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:01,853 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:01,863 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:01,863 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:33:01,868 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:33:01,868 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:33:01,874 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:01,874 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:33:01,886 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:01,886 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:33:01,886 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:01,902 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:01,907 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:33:01,913 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:33:01,913 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:01,913 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:01,913 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:01,914 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:01,914 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:01,914 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:33:01,915 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:01,915 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:33:01,915 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:01,916 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:33:01,917 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:33:01,917 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:01,917 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:33:01,917 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:01,917 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:01,917 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:01,918 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:33:01,918 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:33:01,918 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:33:01,918 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:33:01,918 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:33:01,918 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:33:01,918 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:33:01,918 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:33:01,919 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:33:01,919 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:33:01,919 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:33:01,919 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:33:01,919 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:01,920 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:33:01,920 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:01,920 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:01,920 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:01,920 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:33:01,921 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:33:01,921 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:33:01,921 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:33:01,925 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:33:01,925 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:01,927 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:01,927 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:33:01,928 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:01,928 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:01,928 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:01,929 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:01,967 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3639, Threshold=0.3922, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:33:01,967 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3639
2025-08-04 20:33:16,249 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:16,249 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:33:16,250 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:33:16,250 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:33:16,250 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:33:16,250 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:16,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:16,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:16,697 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:33:16,751 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:33:16,752 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:16,887 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:16,895 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:16,895 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:16,901 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:33:16,910 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:16,910 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:33:16,910 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:16,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:16,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:33:16,920 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:16,923 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:16,926 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:16,928 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:16,931 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:16,934 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:16,936 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:16,939 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:16,942 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:16,944 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:16,947 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:16,961 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:16,961 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:33:16,967 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:33:16,967 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:33:16,977 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:16,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:33:16,991 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:16,992 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:33:16,992 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:17,015 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:17,022 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:33:17,033 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:33:17,033 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:17,033 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:17,034 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:17,034 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:17,034 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:17,035 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:33:17,035 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:17,035 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:33:17,035 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:17,037 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:33:17,037 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:33:17,038 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:17,038 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:33:17,038 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:17,038 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:17,038 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:17,039 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:33:17,039 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:33:17,039 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:33:17,039 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:33:17,039 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:33:17,039 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:33:17,040 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:33:17,040 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:33:17,040 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:33:17,041 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:33:17,041 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:33:17,041 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:33:17,041 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:17,041 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:33:17,042 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:17,042 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:17,045 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:17,045 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:33:17,045 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:33:17,046 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:33:17,046 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:33:17,050 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:33:17,050 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:17,051 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:17,051 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:33:17,053 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:17,053 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:17,053 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:17,054 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:17,091 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3486, Threshold=0.3742, Accuracy=0.6894, F1=0.7833, Precision=0.9357, Recall=0.6735
2025-08-04 20:33:17,091 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6894, F1: 0.7833, Prec: 0.9357, Rec: 0.6735, Avg Anomaly Score: 0.3486
2025-08-04 20:33:31,362 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:31,362 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:33:31,362 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:33:31,362 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:33:31,362 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:33:31,362 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:31,759 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:31,759 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:31,849 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:33:31,871 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:33:31,871 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:31,982 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:31,990 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:31,990 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:31,998 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:33:32,007 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:32,007 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:33:32,008 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:32,008 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:32,008 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:33:32,017 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:32,020 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:32,022 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:32,025 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:32,028 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:32,031 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:32,033 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:32,036 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:32,039 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:32,041 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:32,044 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:32,055 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:32,055 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:33:32,060 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:33:32,060 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:33:32,066 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:32,066 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:33:32,079 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:32,079 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:33:32,079 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:32,095 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:32,100 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:33:32,112 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:33:32,115 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:32,115 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:32,115 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:32,116 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:32,116 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:32,117 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:33:32,117 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:32,117 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:33:32,117 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:32,119 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:33:32,119 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:33:32,119 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:32,119 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:33:32,120 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:32,120 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:32,120 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:32,120 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:33:32,120 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:33:32,121 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:33:32,121 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:33:32,121 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:33:32,121 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:33:32,122 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:33:32,122 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:33:32,126 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:33:32,126 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:33:32,126 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:33:32,127 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:33:32,127 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:32,127 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:33:32,127 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:32,128 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:32,128 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:32,128 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:33:32,129 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:33:32,129 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:33:32,129 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:33:32,132 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:33:32,133 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:32,134 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:32,135 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:33:32,136 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:32,136 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:32,136 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:32,138 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:32,176 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3272, Threshold=0.3480, Accuracy=0.6876, F1=0.7820, Precision=0.9341, Recall=0.6724
2025-08-04 20:33:32,176 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6876, F1: 0.7820, Prec: 0.9341, Rec: 0.6724, Avg Anomaly Score: 0.3272
2025-08-04 20:33:49,450 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:49,450 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:33:49,451 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:33:49,451 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:33:49,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:33:49,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:49,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:49,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:49,872 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:33:49,917 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:33:49,917 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:50,036 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:50,043 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:50,044 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:50,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:33:50,062 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:50,063 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:33:50,063 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:50,063 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:50,064 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:33:50,073 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:50,076 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:50,078 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:50,081 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:50,084 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:50,086 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:50,089 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:50,092 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:50,094 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:50,096 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:50,099 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:50,109 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:50,109 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:33:50,114 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:33:50,114 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:33:50,119 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:50,119 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:33:50,128 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:50,129 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:33:50,129 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:50,144 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:50,148 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:33:50,153 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:33:50,153 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:50,153 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:50,154 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:50,154 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:50,154 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:50,154 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:33:50,155 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:50,155 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:33:50,155 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:50,156 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:33:50,156 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:33:50,157 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:50,157 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:33:50,157 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:50,157 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:50,157 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:50,158 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:33:50,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:33:50,158 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:33:50,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:33:50,158 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:33:50,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:33:50,159 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:33:50,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:33:50,159 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:33:50,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:33:50,159 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:33:50,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:33:50,160 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:50,160 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:33:50,160 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:50,160 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:50,160 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:50,161 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:33:50,161 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:33:50,161 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:33:50,161 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:33:50,164 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:33:50,165 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:50,166 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:50,166 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:33:50,168 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:50,168 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:50,168 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:50,169 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:50,203 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3635, Threshold=0.3911, Accuracy=0.6885, F1=0.7826, Precision=0.9349, Recall=0.6730
2025-08-04 20:33:50,204 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6885, F1: 0.7826, Prec: 0.9349, Rec: 0.6730, Avg Anomaly Score: 0.3635
2025-08-04 20:34:01,474 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:01,475 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:34:01,475 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:34:01,475 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:34:01,475 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:34:01,475 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:01,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:01,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:01,878 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:34:01,892 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:34:01,892 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:01,987 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:01,994 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:01,994 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:02,000 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:34:02,008 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:02,008 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:34:02,009 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:02,009 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:02,009 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:34:02,018 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:02,021 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:02,023 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:02,026 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:02,028 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:02,030 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:02,033 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:02,035 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:02,038 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:02,040 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:02,042 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:02,051 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:02,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:34:02,056 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:34:02,057 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:34:02,063 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:02,063 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:34:02,074 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:02,074 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:34:02,074 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:02,088 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:02,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:34:02,098 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:34:02,099 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:02,099 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:02,099 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:02,099 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:02,099 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:02,099 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:34:02,100 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:02,100 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:34:02,100 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:02,101 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:34:02,104 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:34:02,105 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:02,105 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:34:02,105 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:02,105 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:02,105 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:02,106 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:34:02,106 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:34:02,106 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:34:02,106 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:34:02,106 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:34:02,106 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:34:02,106 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:34:02,106 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:34:02,107 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:34:02,107 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:34:02,107 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:34:02,107 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:34:02,107 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:02,107 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:34:02,107 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:02,108 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:02,108 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:02,108 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:34:02,108 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:34:02,108 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:34:02,108 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:34:02,110 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:34:02,110 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:02,112 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:02,112 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:34:02,113 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:02,113 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:02,113 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:02,114 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:02,149 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3591, Threshold=0.3856, Accuracy=0.6885, F1=0.7826, Precision=0.9349, Recall=0.6730
2025-08-04 20:34:02,150 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6885, F1: 0.7826, Prec: 0.9349, Rec: 0.6730, Avg Anomaly Score: 0.3591
2025-08-04 20:34:13,431 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:13,431 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:34:13,432 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:34:13,432 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:34:13,432 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:34:13,432 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:13,771 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:13,771 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:13,864 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:34:13,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:34:13,911 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:14,024 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:14,032 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:14,032 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:14,039 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:34:14,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:14,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:34:14,048 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:14,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:14,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:34:14,057 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:14,060 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:14,062 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:14,064 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:14,067 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:14,069 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:14,072 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:14,075 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:14,078 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:14,080 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:14,082 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:14,096 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:14,096 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:34:14,101 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:34:14,101 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:34:14,107 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:14,107 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:34:14,117 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:14,118 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:34:14,118 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:14,135 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:14,141 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:34:14,150 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:34:14,150 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:14,150 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:14,150 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:14,151 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:14,151 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:14,151 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:34:14,151 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:14,152 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:34:14,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:14,153 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:34:14,153 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:34:14,154 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:14,154 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:34:14,154 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:14,154 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:14,154 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:14,154 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:34:14,155 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:34:14,155 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:34:14,155 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:34:14,155 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:34:14,155 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:34:14,156 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:34:14,156 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:34:14,156 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:34:14,156 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:34:14,157 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:34:14,157 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:34:14,157 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:14,157 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:34:14,158 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:14,158 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:14,161 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:14,161 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:34:14,162 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:34:14,162 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:34:14,162 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:34:14,166 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:34:14,166 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:14,167 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:14,167 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:34:14,169 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:14,169 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:14,169 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:14,170 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:14,208 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3687, Threshold=0.3998, Accuracy=0.6848, F1=0.7800, Precision=0.9318, Recall=0.6708
2025-08-04 20:34:14,208 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6848, F1: 0.7800, Prec: 0.9318, Rec: 0.6708, Avg Anomaly Score: 0.3687
2025-08-04 20:34:19,471 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:19,471 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:34:19,471 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:34:19,472 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:34:19,472 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:34:19,473 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:19,746 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:19,746 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:19,871 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:34:19,887 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:34:19,887 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:19,981 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:19,989 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:19,989 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:19,995 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:34:20,001 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:20,002 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:34:20,003 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:20,003 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:20,003 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:34:20,014 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:20,018 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:20,021 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:20,024 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:20,028 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:20,032 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:20,036 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:20,039 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:20,044 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:20,047 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:20,051 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:20,065 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:20,065 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:34:20,070 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:34:20,071 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:34:20,080 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:20,081 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:34:20,096 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:20,097 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:34:20,097 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:20,115 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:20,120 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:34:20,126 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:34:20,126 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:20,126 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:20,126 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:20,127 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:20,127 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:20,127 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:34:20,127 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:20,128 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:34:20,128 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:20,129 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:34:20,130 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:34:20,130 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:20,130 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:34:20,130 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:20,130 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:20,131 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:20,131 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:34:20,131 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:34:20,131 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:34:20,131 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:34:20,132 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:34:20,132 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:34:20,132 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:34:20,132 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:34:20,133 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:34:20,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:34:20,133 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:34:20,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:34:20,133 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:20,134 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:34:20,134 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:20,134 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:20,135 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:20,137 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:34:20,137 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:34:20,138 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:34:20,138 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:34:20,141 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:34:20,141 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:20,142 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:20,143 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:34:20,144 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 59/400.
2025-08-04 20:34:20,245 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:20,246 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:20,247 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 22 anomalous samples to GAN training data (target: 22).
2025-08-04 20:34:20,248 - ClientAppLogger [Client 7] - INFO - [Client] Round 59: Training GAN with 97 samples (75 normal, 22 anomalous).
2025-08-04 20:34:20,248 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:34:20,360 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0833, Avg D Loss: 0.8676
2025-08-04 20:34:20,360 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0833, Avg D Loss: 0.8676
2025-08-04 20:34:20,360 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:34:20,399 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3548, Threshold=0.3834, Accuracy=0.6839, F1=0.7794, Precision=0.9310, Recall=0.6702
2025-08-04 20:34:20,399 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.7794
2025-08-04 20:34:20,400 - ClientAppLogger [Client 7] - INFO - Fit completed for round 59. Duration: 0.26s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 59, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0833281965599846, 'd_loss': 0.8675823309372381, 'post_fit_local_f1': 0.7793640493186242, 'fit_time_seconds': 0.25574254989624023, 'cpu_percent_fit': 24.2625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 97}
2025-08-04 20:34:20,400 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:34:28,684 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:28,684 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:34:28,685 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:34:28,685 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:34:28,685 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:34:28,685 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:29,025 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:29,026 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:29,116 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:34:29,161 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:34:29,161 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:29,293 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:29,301 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:29,301 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:29,312 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:34:29,321 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:29,321 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:34:29,322 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:29,322 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:29,322 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:34:29,331 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:29,335 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:29,338 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:29,343 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:29,346 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:29,349 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:29,353 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:29,356 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:29,358 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:29,361 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:29,364 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:29,376 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:29,376 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:34:29,381 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:34:29,381 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:34:29,386 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:29,386 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:34:29,395 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:29,395 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:34:29,396 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:29,412 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:29,419 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:34:29,426 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:34:29,426 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:29,426 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:29,426 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:29,426 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:29,427 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:29,430 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:34:29,430 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:29,431 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:34:29,431 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:29,433 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:34:29,433 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:34:29,433 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:29,433 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:34:29,434 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:29,434 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:29,434 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:29,434 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:34:29,434 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:34:29,434 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:34:29,435 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:34:29,435 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:34:29,435 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:34:29,435 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:34:29,435 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:34:29,436 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:34:29,436 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:34:29,436 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:34:29,436 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:34:29,437 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:29,437 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:34:29,437 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:29,437 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:29,441 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:29,441 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:34:29,442 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:34:29,442 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:34:29,442 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:34:29,445 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:34:29,445 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:29,446 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:29,447 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:34:29,448 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:29,448 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:29,448 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:29,449 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:29,487 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3652, Threshold=0.3975, Accuracy=0.6839, F1=0.7794, Precision=0.9310, Recall=0.6702
2025-08-04 20:34:29,487 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6839, F1: 0.7794, Prec: 0.9310, Rec: 0.6702, Avg Anomaly Score: 0.3652
2025-08-04 20:34:34,737 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:34,737 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:34:34,737 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:34:34,737 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:34:34,737 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:34:34,738 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:34,996 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:34,996 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:35,076 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:34:35,088 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:34:35,089 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:35,167 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:35,173 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:35,174 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:35,178 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:34:35,183 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:35,183 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:34:35,184 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:35,184 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:35,184 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:34:35,192 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:35,195 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:35,197 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:35,199 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:35,202 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:35,204 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:35,206 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:35,208 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:35,211 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:35,213 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:35,215 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:35,224 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:35,224 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:34:35,229 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:34:35,229 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:34:35,234 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:35,235 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:34:35,245 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:35,245 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:34:35,245 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:35,260 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:35,264 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:34:35,269 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:34:35,269 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:35,269 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:35,269 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:35,270 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:35,270 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:35,270 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:34:35,270 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:35,270 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:34:35,270 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:35,272 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:34:35,272 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:34:35,272 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:35,273 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:34:35,273 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:35,273 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:35,273 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:35,273 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:34:35,273 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:34:35,273 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:34:35,273 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:34:35,274 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:34:35,274 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:34:35,274 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:34:35,274 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:34:35,274 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:34:35,274 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:34:35,275 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:34:35,275 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:34:35,275 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:35,275 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:34:35,275 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:35,275 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:35,279 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:35,279 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:34:35,280 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:34:35,280 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:34:35,280 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:34:35,282 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:34:35,282 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:35,283 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:35,283 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:34:35,285 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 60/400.
2025-08-04 20:34:35,385 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:35,386 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:35,387 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 22 anomalous samples to GAN training data (target: 22).
2025-08-04 20:34:35,387 - ClientAppLogger [Client 7] - INFO - [Client] Round 60: Training GAN with 98 samples (76 normal, 22 anomalous).
2025-08-04 20:34:35,387 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:34:35,477 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0795, Avg D Loss: 0.8694
2025-08-04 20:34:35,479 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0795, Avg D Loss: 0.8694
2025-08-04 20:34:35,479 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:34:35,510 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3338, Threshold=0.3607, Accuracy=0.6839, F1=0.7794, Precision=0.9310, Recall=0.6702
2025-08-04 20:34:35,510 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.7794
2025-08-04 20:34:35,511 - ClientAppLogger [Client 7] - INFO - Fit completed for round 60. Duration: 0.23s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 60, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0795218204965393, 'd_loss': 0.8694418435194053, 'post_fit_local_f1': 0.7793640493186242, 'fit_time_seconds': 0.22603607177734375, 'cpu_percent_fit': 24.425, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 98}
2025-08-04 20:34:35,511 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:34:40,784 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:40,784 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:34:40,785 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:34:40,785 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:34:40,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:34:40,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:41,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:41,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:41,247 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:34:41,303 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:34:41,303 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:41,443 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:41,450 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:41,450 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:41,456 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:34:41,463 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:41,465 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:34:41,466 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:41,466 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:41,466 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:34:41,478 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:41,482 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:41,484 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:41,490 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:41,494 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:41,496 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:41,499 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:41,501 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:41,504 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:41,506 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:41,509 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:41,518 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:41,519 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:34:41,523 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:34:41,523 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:34:41,528 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:41,528 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:34:41,537 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:41,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:34:41,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:41,553 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:41,559 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:34:41,567 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:34:41,567 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:41,567 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:41,567 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:41,568 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:41,568 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:41,568 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:34:41,568 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:41,569 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:34:41,569 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:41,570 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:34:41,570 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:34:41,571 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:41,571 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:34:41,571 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:41,571 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:41,571 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:41,572 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:34:41,572 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:34:41,572 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:34:41,572 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:34:41,572 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:34:41,572 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:34:41,572 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:34:41,573 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:34:41,573 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:34:41,573 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:34:41,573 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:34:41,573 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:34:41,573 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:41,574 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:34:41,574 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:41,574 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:41,577 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:41,577 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:34:41,578 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:34:41,578 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:34:41,578 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:34:41,582 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:34:41,583 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:41,584 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:41,584 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:34:41,586 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:41,586 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:41,586 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:41,587 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:41,621 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3563, Threshold=0.3855, Accuracy=0.6839, F1=0.7794, Precision=0.9310, Recall=0.6702
2025-08-04 20:34:41,621 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6839, F1: 0.7794, Prec: 0.9310, Rec: 0.6702, Avg Anomaly Score: 0.3563
2025-08-04 20:34:46,873 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:46,873 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:34:46,873 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:34:46,873 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:34:46,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:34:46,874 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:47,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:47,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:47,172 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:34:47,206 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:34:47,206 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:47,295 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:47,300 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:47,301 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:47,305 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:34:47,310 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:47,310 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:34:47,311 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:47,311 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:47,311 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:34:47,319 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:47,322 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:47,324 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:47,326 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:47,328 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:47,330 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:47,333 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:47,335 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:47,338 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:47,339 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:47,342 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:47,350 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:47,350 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:34:47,355 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:34:47,355 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:34:47,359 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:47,359 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:34:47,367 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:47,368 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:34:47,368 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:47,382 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:47,387 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:34:47,395 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:34:47,395 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:47,395 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:47,395 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:47,396 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:47,396 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:47,396 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:34:47,397 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:47,397 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:34:47,397 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:47,398 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:34:47,399 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:34:47,399 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:47,399 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:34:47,399 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:47,399 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:47,400 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:47,400 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:34:47,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:34:47,400 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:34:47,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:34:47,400 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:34:47,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:34:47,401 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:34:47,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:34:47,401 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:34:47,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:34:47,402 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:34:47,402 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:34:47,402 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:47,402 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:34:47,402 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:47,403 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:47,406 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:47,406 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:34:47,407 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:34:47,407 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:34:47,407 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:34:47,412 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:34:47,412 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:47,413 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:47,414 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:34:47,415 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 61/400.
2025-08-04 20:34:47,516 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:47,516 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:47,517 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 23 anomalous samples to GAN training data (target: 23).
2025-08-04 20:34:47,518 - ClientAppLogger [Client 7] - INFO - [Client] Round 61: Training GAN with 100 samples (77 normal, 23 anomalous).
2025-08-04 20:34:47,518 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:34:47,609 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0810, Avg D Loss: 0.8583
2025-08-04 20:34:47,609 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0810, Avg D Loss: 0.8583
2025-08-04 20:34:47,612 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:34:47,643 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3335, Threshold=0.3598, Accuracy=0.6839, F1=0.7794, Precision=0.9310, Recall=0.6702
2025-08-04 20:34:47,643 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.7794
2025-08-04 20:34:47,644 - ClientAppLogger [Client 7] - INFO - Fit completed for round 61. Duration: 0.23s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 61, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.080987826347351, 'd_loss': 0.8582709848880767, 'post_fit_local_f1': 0.7793640493186242, 'fit_time_seconds': 0.22863197326660156, 'cpu_percent_fit': 24.0625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 100}
2025-08-04 20:34:47,644 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:34:52,930 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:52,930 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:34:52,930 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:34:52,931 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:34:52,931 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:34:52,931 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:53,380 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:53,380 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:53,492 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:34:53,541 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:34:53,541 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:53,679 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:53,687 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:53,687 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:53,695 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:34:53,703 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:53,703 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:34:53,704 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:53,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:53,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:34:53,713 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:53,716 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:53,718 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:53,720 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:53,723 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:53,726 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:53,729 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:53,732 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:53,734 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:53,736 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:53,738 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:53,749 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:53,749 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:34:53,754 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:34:53,755 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:34:53,760 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:53,760 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:34:53,769 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:53,769 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:34:53,770 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:53,786 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:53,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:34:53,799 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:34:53,799 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:53,799 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:53,799 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:53,800 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:53,800 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:53,800 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:34:53,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:53,800 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:34:53,801 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:53,802 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:34:53,802 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:34:53,803 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:53,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:34:53,803 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:53,803 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:53,803 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:53,803 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:34:53,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:34:53,804 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:34:53,804 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:34:53,804 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:34:53,804 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:34:53,804 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:34:53,805 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:34:53,805 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:34:53,805 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:34:53,805 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:34:53,806 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:34:53,806 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:53,806 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:34:53,806 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:53,806 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:53,810 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:53,810 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:34:53,811 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:34:53,811 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:34:53,811 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:34:53,814 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:34:53,815 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:53,816 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:53,816 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:34:53,818 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:53,818 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:53,818 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:53,819 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:53,857 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3619, Threshold=0.3905, Accuracy=0.6848, F1=0.7800, Precision=0.9318, Recall=0.6708
2025-08-04 20:34:53,857 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6848, F1: 0.7800, Prec: 0.9318, Rec: 0.6708, Avg Anomaly Score: 0.3619
2025-08-04 20:35:02,124 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:02,124 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:35:02,124 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:35:02,124 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:35:02,125 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:35:02,125 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:02,465 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:02,465 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:02,555 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:35:02,577 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:35:02,577 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:02,680 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:02,686 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:02,686 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:02,691 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:35:02,697 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:02,697 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:35:02,697 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:02,698 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:02,698 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:35:02,707 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:02,710 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:02,712 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:02,715 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:02,717 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:02,720 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:02,723 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:02,726 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:02,728 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:02,730 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:02,733 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:02,743 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:02,743 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:35:02,748 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:35:02,748 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:35:02,754 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:02,754 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:35:02,766 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:02,767 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:35:02,767 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:02,785 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:02,790 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:35:02,794 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:35:02,794 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:02,794 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:02,794 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:02,794 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:02,795 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:02,795 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:35:02,795 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:02,795 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:35:02,796 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:02,797 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:35:02,797 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:35:02,798 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:02,798 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:35:02,798 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:02,799 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:02,799 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:02,799 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:35:02,799 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:35:02,799 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:35:02,799 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:35:02,800 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:35:02,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:35:02,800 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:35:02,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:35:02,800 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:35:02,801 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:35:02,801 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:35:02,801 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:35:02,801 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:02,801 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:35:02,802 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:02,802 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:02,805 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:02,806 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:35:02,806 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:35:02,806 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:35:02,806 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:35:02,810 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:35:02,810 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:02,811 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:02,812 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:35:02,813 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 62/400.
2025-08-04 20:35:02,914 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:02,914 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:02,915 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 23 anomalous samples to GAN training data (target: 23).
2025-08-04 20:35:02,916 - ClientAppLogger [Client 7] - INFO - [Client] Round 62: Training GAN with 101 samples (78 normal, 23 anomalous).
2025-08-04 20:35:02,916 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:03,022 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0826, Avg D Loss: 0.8716
2025-08-04 20:35:03,022 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0826, Avg D Loss: 0.8716
2025-08-04 20:35:03,023 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:03,061 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3969, Threshold=0.4304, Accuracy=0.6848, F1=0.7800, Precision=0.9318, Recall=0.6708
2025-08-04 20:35:03,061 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.7800
2025-08-04 20:35:03,062 - ClientAppLogger [Client 7] - INFO - Fit completed for round 62. Duration: 0.25s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 62, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0826140762555716, 'd_loss': 0.8716132656182392, 'post_fit_local_f1': 0.7800129785853342, 'fit_time_seconds': 0.24850034713745117, 'cpu_percent_fit': 23.6375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 101}
2025-08-04 20:35:03,062 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:35:08,319 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:08,319 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:35:08,319 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:35:08,320 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:35:08,320 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:35:08,320 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:08,659 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:08,660 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:08,759 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:35:08,808 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:35:08,808 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:08,948 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:08,957 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:08,957 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:08,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:35:08,972 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:08,973 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:35:08,973 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:08,973 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:08,974 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:35:08,983 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:08,986 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:08,989 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:08,992 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:08,995 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:08,998 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:09,001 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:09,004 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:09,007 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:09,009 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:09,011 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:09,024 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:09,024 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:35:09,030 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:35:09,031 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:35:09,036 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:09,036 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:35:09,047 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:09,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:35:09,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:09,064 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:09,070 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:35:09,078 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:35:09,078 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:09,078 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:09,078 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:09,078 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:09,079 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:09,079 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:35:09,079 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:09,079 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:35:09,080 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:09,081 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:35:09,081 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:35:09,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:09,082 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:35:09,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:09,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:09,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:09,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:35:09,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:35:09,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:35:09,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:35:09,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:35:09,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:35:09,084 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:35:09,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:35:09,084 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:35:09,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:35:09,084 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:35:09,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:35:09,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:09,085 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:35:09,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:09,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:09,086 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:09,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:35:09,086 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:35:09,086 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:35:09,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:35:09,089 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:35:09,089 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:09,091 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:09,091 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:35:09,092 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:09,092 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:09,092 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:09,093 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:09,129 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3679, Threshold=0.4016, Accuracy=0.6848, F1=0.7800, Precision=0.9318, Recall=0.6708
2025-08-04 20:35:09,129 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6848, F1: 0.7800, Prec: 0.9318, Rec: 0.6708, Avg Anomaly Score: 0.3679
2025-08-04 20:35:14,374 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:14,374 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:35:14,374 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:35:14,374 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:35:14,374 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:35:14,375 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:14,602 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:14,602 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:14,683 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:35:14,703 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:35:14,703 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:14,786 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:14,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:14,791 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:14,796 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:35:14,801 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:14,801 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:35:14,801 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:14,801 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:14,802 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:35:14,810 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:14,813 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:14,815 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:14,817 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:14,819 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:14,821 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:14,823 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:14,826 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:14,828 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:14,830 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:14,832 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:14,841 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:14,841 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:35:14,845 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:35:14,846 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:35:14,850 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:14,850 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:35:14,858 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:14,859 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:35:14,859 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:14,873 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:14,878 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:35:14,883 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:35:14,883 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:14,883 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:14,883 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:14,884 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:14,884 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:14,884 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:35:14,884 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:14,884 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:35:14,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:14,886 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:35:14,886 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:35:14,886 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:14,886 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:35:14,887 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:14,887 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:14,887 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:14,887 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:35:14,887 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:35:14,887 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:35:14,887 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:35:14,887 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:35:14,887 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:35:14,887 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:35:14,888 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:35:14,888 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:35:14,888 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:35:14,888 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:35:14,888 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:35:14,888 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:14,888 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:35:14,889 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:14,889 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:14,889 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:14,889 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:35:14,889 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:35:14,889 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:35:14,890 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:35:14,893 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:35:14,893 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:14,895 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:14,895 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:35:14,896 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 63/400.
2025-08-04 20:35:14,997 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:14,998 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:14,999 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 24 anomalous samples to GAN training data (target: 24).
2025-08-04 20:35:14,999 - ClientAppLogger [Client 7] - INFO - [Client] Round 63: Training GAN with 104 samples (80 normal, 24 anomalous).
2025-08-04 20:35:15,000 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:15,095 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0838, Avg D Loss: 0.8712
2025-08-04 20:35:15,095 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0838, Avg D Loss: 0.8712
2025-08-04 20:35:15,096 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:15,126 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3782, Threshold=0.4126, Accuracy=0.6839, F1=0.7794, Precision=0.9310, Recall=0.6702
2025-08-04 20:35:15,126 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.7794
2025-08-04 20:35:15,127 - ClientAppLogger [Client 7] - INFO - Fit completed for round 63. Duration: 0.23s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 63, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083795552987319, 'd_loss': 0.8712261805167566, 'post_fit_local_f1': 0.7793640493186242, 'fit_time_seconds': 0.23042011260986328, 'cpu_percent_fit': 24.15625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 104}
2025-08-04 20:35:15,127 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:35:20,379 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:20,379 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:35:20,379 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:35:20,379 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:35:20,379 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:35:20,379 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:20,685 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:20,685 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:20,776 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:35:20,823 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:35:20,825 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:20,961 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:20,968 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:20,968 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:20,975 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:35:20,983 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:20,983 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:35:20,984 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:20,984 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:20,985 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:35:20,993 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:20,996 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:20,999 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:21,001 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:21,003 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:21,006 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:21,008 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:21,011 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:21,014 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:21,016 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:21,018 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:21,028 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:21,028 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:35:21,033 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:35:21,033 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:35:21,042 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:21,042 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:35:21,063 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:21,064 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:35:21,064 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:21,082 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:21,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:35:21,092 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:35:21,092 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:21,092 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:21,092 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:21,093 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:21,093 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:21,093 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:35:21,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:21,094 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:35:21,094 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:21,095 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:35:21,096 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:35:21,096 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:21,096 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:35:21,096 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:21,096 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:21,097 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:21,097 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:35:21,097 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:35:21,097 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:35:21,097 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:35:21,097 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:35:21,097 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:35:21,098 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:35:21,098 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:35:21,098 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:35:21,098 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:35:21,099 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:35:21,099 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:35:21,099 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:21,099 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:35:21,099 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:21,099 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:21,100 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:21,100 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:35:21,100 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:35:21,100 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:35:21,100 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:35:21,104 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:35:21,104 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:21,105 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:21,106 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:35:21,107 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:21,107 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:21,107 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:21,108 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:21,142 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3844, Threshold=0.4184, Accuracy=0.6848, F1=0.7800, Precision=0.9318, Recall=0.6708
2025-08-04 20:35:21,142 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6848, F1: 0.7800, Prec: 0.9318, Rec: 0.6708, Avg Anomaly Score: 0.3844
2025-08-04 20:35:32,405 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:32,406 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:35:32,406 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:35:32,406 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:35:32,406 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:35:32,406 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:32,672 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:32,672 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:32,755 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:35:32,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:35:32,768 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:32,854 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:32,859 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:32,860 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:32,864 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:35:32,869 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:32,869 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:35:32,870 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:32,870 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:32,870 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:35:32,880 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:32,883 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:32,885 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:32,887 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:32,890 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:32,892 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:32,895 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:32,897 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:32,900 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:32,902 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:32,905 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:32,914 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:32,914 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:35:32,921 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:35:32,921 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:35:32,928 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:32,928 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:35:32,940 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:32,940 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:35:32,940 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:32,955 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:32,960 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:35:32,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:35:32,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:32,965 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:32,965 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:32,966 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:32,966 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:32,966 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:35:32,966 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:32,967 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:35:32,967 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:32,968 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:35:32,968 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:35:32,969 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:32,969 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:35:32,969 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:32,969 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:32,969 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:32,969 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:35:32,969 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:35:32,970 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:35:32,970 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:35:32,970 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:35:32,970 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:35:32,970 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:35:32,970 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:35:32,970 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:35:32,971 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:35:32,971 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:35:32,971 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:35:32,971 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:32,971 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:35:32,971 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:32,972 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:32,972 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:32,972 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:35:32,972 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:35:32,972 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:35:32,972 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:35:32,974 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:35:32,975 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:32,976 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:32,976 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:35:32,977 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:32,977 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:32,978 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:32,978 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:33,011 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3559, Threshold=0.3905, Accuracy=0.6857, F1=0.7807, Precision=0.9326, Recall=0.6713
2025-08-04 20:35:33,011 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6857, F1: 0.7807, Prec: 0.9326, Rec: 0.6713, Avg Anomaly Score: 0.3559
2025-08-04 20:35:47,283 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:47,283 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:35:47,284 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:35:47,284 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:35:47,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:35:47,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:47,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:47,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:47,751 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:35:47,794 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:35:47,795 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:47,926 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:47,935 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:47,935 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:47,941 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:35:47,947 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:47,947 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:35:47,948 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:47,949 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:47,949 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:35:47,958 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:47,961 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:47,964 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:47,966 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:47,969 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:47,972 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:47,974 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:47,977 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:47,980 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:47,982 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:47,984 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:47,997 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:47,997 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:35:48,002 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:35:48,002 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:35:48,007 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:48,007 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:35:48,015 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:48,016 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:35:48,016 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:48,031 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:48,035 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:35:48,040 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:35:48,040 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:48,041 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:48,041 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:48,041 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:48,041 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:48,042 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:35:48,042 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:48,042 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:35:48,042 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:48,044 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:35:48,044 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:35:48,044 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:48,044 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:35:48,045 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:48,045 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:48,045 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:48,045 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:35:48,045 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:35:48,045 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:35:48,046 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:35:48,046 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:35:48,046 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:35:48,046 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:35:48,046 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:35:48,046 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:35:48,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:35:48,047 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:35:48,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:35:48,047 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:48,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:35:48,047 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:48,048 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:48,052 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:48,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:35:48,052 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:35:48,052 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:35:48,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:35:48,055 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:35:48,055 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:48,057 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:48,057 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:35:48,059 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:48,059 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:48,059 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:48,060 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:48,090 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3702, Threshold=0.4096, Accuracy=0.6867, F1=0.7813, Precision=0.9333, Recall=0.6719
2025-08-04 20:35:48,090 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6867, F1: 0.7813, Prec: 0.9333, Rec: 0.6719, Avg Anomaly Score: 0.3702
2025-08-04 20:35:53,330 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:53,331 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:35:53,331 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:35:53,331 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:35:53,331 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:35:53,331 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:53,563 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:53,563 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:53,644 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:35:53,667 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:35:53,667 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:53,752 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:53,757 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:53,757 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:53,762 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:35:53,769 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:53,769 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:35:53,770 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:53,770 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:53,770 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:35:53,778 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:53,781 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:53,783 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:53,785 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:53,787 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:53,789 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:53,792 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:53,795 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:53,797 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:53,799 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:53,801 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:53,810 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:53,810 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:35:53,815 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:35:53,815 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:35:53,821 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:53,821 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:35:53,831 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:53,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:35:53,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:53,846 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:53,851 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:35:53,855 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:35:53,855 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:53,855 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:53,855 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:53,856 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:53,856 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:53,856 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:35:53,856 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:53,856 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:35:53,857 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:53,858 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:35:53,858 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:35:53,859 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:53,859 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:35:53,859 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:53,859 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:53,859 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:53,859 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:35:53,859 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:35:53,860 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:35:53,860 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:35:53,860 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:35:53,860 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:35:53,860 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:35:53,860 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:35:53,861 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:35:53,861 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:35:53,861 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:35:53,861 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:35:53,861 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:53,861 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:35:53,862 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:53,862 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:53,866 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:53,866 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:35:53,866 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:35:53,866 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:35:53,866 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:35:53,867 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:35:53,867 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:53,869 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:53,869 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:35:53,870 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 66/400.
2025-08-04 20:35:53,971 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:53,971 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:53,972 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 25 anomalous samples to GAN training data (target: 25).
2025-08-04 20:35:53,972 - ClientAppLogger [Client 7] - INFO - [Client] Round 66: Training GAN with 109 samples (84 normal, 25 anomalous).
2025-08-04 20:35:53,972 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:35:54,065 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0829, Avg D Loss: 0.8692
2025-08-04 20:35:54,065 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0829, Avg D Loss: 0.8692
2025-08-04 20:35:54,069 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:35:54,100 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3671, Threshold=0.4035, Accuracy=0.6857, F1=0.7807, Precision=0.9326, Recall=0.6713
2025-08-04 20:35:54,100 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.7807
2025-08-04 20:35:54,100 - ClientAppLogger [Client 7] - INFO - Fit completed for round 66. Duration: 0.23s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 66, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.082860198370907, 'd_loss': 0.8692327873969296, 'post_fit_local_f1': 0.7806619078520441, 'fit_time_seconds': 0.23019170761108398, 'cpu_percent_fit': 24.10625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 109}
2025-08-04 20:35:54,101 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:35:59,372 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:59,372 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:35:59,372 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:35:59,372 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:35:59,372 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:35:59,372 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:59,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:59,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:59,876 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:35:59,928 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:35:59,928 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:00,060 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:00,070 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:00,070 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:00,076 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:36:00,082 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:00,082 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:36:00,083 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:00,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:00,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:36:00,092 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:00,095 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:00,098 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:00,102 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:00,105 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:00,108 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:00,111 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:00,113 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:00,116 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:00,119 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:00,121 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:00,133 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:00,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:36:00,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:36:00,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:36:00,145 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:00,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:36:00,155 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:00,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:36:00,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:00,176 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:00,184 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:36:00,190 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:36:00,191 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:00,191 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:00,191 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:00,191 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:00,191 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:00,192 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:36:00,192 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:00,192 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:36:00,192 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:00,193 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:36:00,194 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:36:00,194 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:00,194 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:36:00,194 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:00,194 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:00,195 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:00,195 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:36:00,195 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:36:00,195 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:36:00,195 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:36:00,195 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:36:00,195 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:36:00,196 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:36:00,196 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:36:00,196 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:36:00,196 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:36:00,196 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:36:00,196 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:36:00,197 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:00,197 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:36:00,197 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:00,197 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:00,198 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:00,198 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:36:00,198 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:36:00,198 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:36:00,198 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:36:00,204 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:36:00,204 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:00,205 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:00,205 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:36:00,206 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:00,207 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:00,207 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:00,207 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:00,240 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3814, Threshold=0.4190, Accuracy=0.6857, F1=0.7807, Precision=0.9326, Recall=0.6713
2025-08-04 20:36:00,240 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6857, F1: 0.7807, Prec: 0.9326, Rec: 0.6713, Avg Anomaly Score: 0.3814
2025-08-04 20:36:05,502 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:05,503 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:36:05,503 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:36:05,503 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:36:05,503 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:36:05,503 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:05,804 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:05,804 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:05,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:36:05,907 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:36:05,907 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:05,999 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:06,007 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:06,008 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:06,016 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:36:06,023 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:06,023 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:36:06,023 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:06,026 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:06,026 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:36:06,034 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:06,037 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:06,040 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:06,042 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:06,045 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:06,047 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:06,053 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:06,056 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:06,059 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:06,063 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:06,068 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:06,080 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:06,080 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:36:06,085 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:36:06,085 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:36:06,091 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:06,091 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:36:06,100 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:06,101 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:36:06,105 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:06,122 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:06,127 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:36:06,132 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:36:06,132 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:06,132 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:06,132 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:06,132 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:06,133 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:06,133 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:36:06,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:06,133 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:36:06,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:06,135 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:36:06,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:36:06,135 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:06,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:36:06,135 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:06,136 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:06,136 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:06,136 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:36:06,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:36:06,137 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:36:06,137 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:36:06,137 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:36:06,137 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:36:06,137 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:36:06,137 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:36:06,138 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:36:06,138 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:36:06,138 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:36:06,138 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:36:06,138 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:06,138 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:36:06,138 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:06,139 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:06,139 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:06,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:36:06,139 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:36:06,139 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:36:06,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:36:06,143 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:36:06,144 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:06,145 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:06,145 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:36:06,147 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 67/400.
2025-08-04 20:36:06,248 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:06,248 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:06,249 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 25 anomalous samples to GAN training data (target: 25).
2025-08-04 20:36:06,251 - ClientAppLogger [Client 7] - INFO - [Client] Round 67: Training GAN with 111 samples (86 normal, 25 anomalous).
2025-08-04 20:36:06,251 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:06,348 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0830, Avg D Loss: 0.8659
2025-08-04 20:36:06,349 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0830, Avg D Loss: 0.8659
2025-08-04 20:36:06,349 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:06,380 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3837, Threshold=0.4194, Accuracy=0.6857, F1=0.7807, Precision=0.9326, Recall=0.6713
2025-08-04 20:36:06,380 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.7807
2025-08-04 20:36:06,381 - ClientAppLogger [Client 7] - INFO - Fit completed for round 67. Duration: 0.23s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 67, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083028893427806, 'd_loss': 0.8658787308512508, 'post_fit_local_f1': 0.7806619078520441, 'fit_time_seconds': 0.23386120796203613, 'cpu_percent_fit': 24.45, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 111}
2025-08-04 20:36:06,381 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:36:14,640 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:14,640 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:36:14,640 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:36:14,641 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:36:14,641 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:36:14,641 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:14,888 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:14,889 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:14,975 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:36:15,004 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:36:15,004 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:15,118 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:15,123 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:15,124 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:15,129 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:36:15,134 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:15,134 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:36:15,135 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:15,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:15,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:36:15,143 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:15,146 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:15,148 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:15,150 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:15,153 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:15,155 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:15,157 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:15,160 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:15,163 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:15,164 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:15,167 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:15,178 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:15,178 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:36:15,184 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:36:15,184 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:36:15,190 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:15,190 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:36:15,201 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:15,201 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:36:15,201 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:15,217 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:15,221 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:36:15,229 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:36:15,229 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:15,229 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:15,230 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:15,230 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:15,230 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:15,230 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:36:15,231 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:15,231 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:36:15,231 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:15,232 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:36:15,233 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:36:15,233 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:15,233 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:36:15,233 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:15,233 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:15,233 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:15,234 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:36:15,234 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:36:15,234 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:36:15,234 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:36:15,234 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:36:15,234 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:36:15,235 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:36:15,235 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:36:15,235 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:36:15,235 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:36:15,236 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:36:15,236 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:36:15,236 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:15,236 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:36:15,236 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:15,237 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:15,237 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:15,237 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:36:15,237 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:36:15,237 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:36:15,237 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:36:15,241 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:36:15,241 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:15,243 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:15,243 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:36:15,244 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:15,244 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:15,244 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:15,245 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:15,283 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3657, Threshold=0.4007, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:36:15,283 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3657
2025-08-04 20:36:29,579 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:29,579 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:36:29,580 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:36:29,580 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:36:29,580 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:36:29,580 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:29,870 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:29,870 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:29,957 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:36:29,984 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:36:29,985 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:30,088 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:30,094 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:30,094 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:30,099 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:36:30,105 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:30,105 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:36:30,105 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:30,105 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:30,106 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:36:30,114 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:30,117 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:30,119 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:30,121 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:30,124 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:30,127 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:30,130 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:30,132 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:30,135 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:30,137 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:30,139 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:30,152 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:30,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:36:30,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:36:30,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:36:30,164 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:30,165 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:36:30,177 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:30,177 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:36:30,177 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:30,193 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:30,197 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:36:30,202 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:36:30,202 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:30,202 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:30,202 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:30,202 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:30,203 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:30,203 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:36:30,203 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:30,203 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:36:30,203 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:30,205 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:36:30,205 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:36:30,205 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:30,206 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:36:30,206 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:30,206 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:30,206 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:30,206 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:36:30,206 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:36:30,207 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:36:30,207 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:36:30,207 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:36:30,207 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:36:30,207 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:36:30,207 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:36:30,208 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:36:30,208 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:36:30,208 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:36:30,208 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:36:30,208 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:30,208 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:36:30,208 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:30,209 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:30,209 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:30,209 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:36:30,209 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:36:30,209 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:36:30,210 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:36:30,212 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:36:30,212 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:30,213 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:30,213 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:36:30,215 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:30,215 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:30,215 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:30,215 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:30,247 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3734, Threshold=0.4150, Accuracy=0.6885, F1=0.7826, Precision=0.9349, Recall=0.6730
2025-08-04 20:36:30,247 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6885, F1: 0.7826, Prec: 0.9349, Rec: 0.6730, Avg Anomaly Score: 0.3734
2025-08-04 20:36:35,501 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:35,501 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:36:35,501 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:36:35,501 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:36:35,501 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:36:35,501 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:35,806 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:35,806 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:35,889 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:36:35,934 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:36:35,934 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:36,049 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:36,055 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:36,055 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:36,060 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:36:36,066 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:36,066 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:36:36,066 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:36,066 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:36,067 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:36:36,076 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:36,080 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:36,083 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:36,086 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:36,089 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:36,092 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:36,094 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:36,096 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:36,100 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:36,102 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:36,104 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:36,114 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:36,114 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:36:36,119 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:36:36,119 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:36:36,124 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:36,124 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:36:36,132 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:36,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:36:36,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:36,147 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:36,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:36:36,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:36:36,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:36,159 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:36,159 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:36,159 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:36,160 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:36,160 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:36:36,160 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:36,160 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:36:36,160 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:36,161 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:36:36,161 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:36:36,162 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:36,162 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:36:36,162 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:36,162 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:36,162 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:36,162 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:36:36,163 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:36:36,163 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:36:36,163 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:36:36,163 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:36:36,163 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:36:36,163 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:36:36,164 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:36:36,164 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:36:36,164 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:36:36,164 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:36:36,164 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:36:36,164 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:36,165 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:36:36,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:36,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:36,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:36,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:36:36,166 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:36:36,166 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:36:36,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:36:36,172 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:36:36,172 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:36,174 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:36,174 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:36:36,175 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 69/400.
2025-08-04 20:36:36,276 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:36,276 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:36,277 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 27 anomalous samples to GAN training data (target: 27).
2025-08-04 20:36:36,278 - ClientAppLogger [Client 7] - INFO - [Client] Round 69: Training GAN with 117 samples (90 normal, 27 anomalous).
2025-08-04 20:36:36,278 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:36:36,378 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.8597
2025-08-04 20:36:36,378 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.8597
2025-08-04 20:36:36,378 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:36:36,410 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3834, Threshold=0.4216, Accuracy=0.6867, F1=0.7813, Precision=0.9333, Recall=0.6719
2025-08-04 20:36:36,410 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.7813
2025-08-04 20:36:36,411 - ClientAppLogger [Client 7] - INFO - Fit completed for round 69. Duration: 0.24s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 69, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0840763538311693, 'd_loss': 0.8597164657890287, 'post_fit_local_f1': 0.781310837118754, 'fit_time_seconds': 0.2353987693786621, 'cpu_percent_fit': 24.15625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 117}
2025-08-04 20:36:36,411 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:36:47,700 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:47,701 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:36:47,701 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:36:47,701 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:36:47,701 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:36:47,701 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:47,964 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:47,964 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:48,054 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:36:48,072 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:36:48,072 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:48,161 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:48,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:48,166 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:48,171 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:36:48,177 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:48,177 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:36:48,177 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:48,177 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:48,178 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:36:48,186 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:48,189 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:48,191 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:48,193 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:48,195 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:48,197 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:48,200 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:48,202 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:48,205 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:48,207 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:48,209 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:48,217 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:48,217 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:36:48,222 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:36:48,222 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:36:48,227 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:48,228 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:36:48,238 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:48,239 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:36:48,239 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:48,253 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:48,257 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:36:48,262 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:36:48,262 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:48,262 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:48,262 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:48,262 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:48,263 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:48,263 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:36:48,263 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:48,263 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:36:48,263 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:48,265 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:36:48,265 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:36:48,265 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:48,265 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:36:48,265 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:48,265 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:48,266 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:48,266 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:36:48,266 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:36:48,266 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:36:48,266 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:36:48,266 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:36:48,266 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:36:48,267 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:36:48,267 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:36:48,267 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:36:48,267 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:36:48,267 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:36:48,267 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:36:48,268 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:48,268 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:36:48,268 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:48,268 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:48,268 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:48,269 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:36:48,269 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:36:48,269 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:36:48,269 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:36:48,271 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:36:48,271 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:48,272 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:48,273 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:36:48,274 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:48,274 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:48,274 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:48,275 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:48,306 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3919, Threshold=0.4368, Accuracy=0.6904, F1=0.7839, Precision=0.9364, Recall=0.6741
2025-08-04 20:36:48,306 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.6904, F1: 0.7839, Prec: 0.9364, Rec: 0.6741, Avg Anomaly Score: 0.3919
2025-08-04 20:37:02,593 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:02,593 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:37:02,593 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:37:02,593 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:37:02,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:37:02,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:02,891 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:02,891 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:02,978 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:37:03,023 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:37:03,023 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:03,155 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:03,160 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:03,160 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:03,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:37:03,171 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:03,171 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:37:03,172 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:03,172 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:03,172 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:37:03,181 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:03,185 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:03,187 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:03,189 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:03,192 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:03,194 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:03,196 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:03,199 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:03,202 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:03,204 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:03,207 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:03,216 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:03,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:37:03,221 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:37:03,221 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:37:03,226 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:03,226 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:37:03,234 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:03,234 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:37:03,235 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:03,248 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:03,253 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:37:03,258 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:37:03,258 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:03,258 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:03,258 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:03,259 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:03,259 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:03,259 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:37:03,259 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:03,259 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:37:03,260 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:03,261 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:37:03,261 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:37:03,261 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:03,262 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:37:03,262 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:03,262 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:03,262 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:03,262 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:37:03,262 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:37:03,262 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:37:03,263 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:37:03,263 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:37:03,263 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:37:03,263 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:37:03,263 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:37:03,263 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:37:03,264 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:37:03,264 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:37:03,264 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:37:03,264 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:03,264 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:37:03,264 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:03,264 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:03,265 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:03,265 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:37:03,265 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:37:03,265 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:37:03,265 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:37:03,269 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:37:03,269 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:03,270 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:03,270 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:37:03,272 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:03,272 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:03,272 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:03,273 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:03,303 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3803, Threshold=0.4321, Accuracy=0.7015, F1=0.7917, Precision=0.9457, Recall=0.6808
2025-08-04 20:37:03,303 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7015, F1: 0.7917, Prec: 0.9457, Rec: 0.6808, Avg Anomaly Score: 0.3803
2025-08-04 20:37:17,576 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:17,576 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:37:17,576 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:37:17,576 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:37:17,577 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:37:17,577 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:17,868 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:17,868 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:17,952 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:37:17,980 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:37:17,980 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:18,078 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:18,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:18,084 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:18,090 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:37:18,097 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:18,098 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:37:18,098 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:18,098 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:18,098 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:37:18,107 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:18,109 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:18,112 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:18,115 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:18,118 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:18,121 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:18,123 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:18,126 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:18,130 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:18,133 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:18,137 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:18,147 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:18,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:37:18,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:37:18,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:37:18,157 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:18,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:37:18,169 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:18,169 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:37:18,170 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:18,184 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:18,189 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:37:18,194 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:37:18,194 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:18,194 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:18,194 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:18,194 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:18,195 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:18,195 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:37:18,195 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:18,195 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:37:18,195 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:18,197 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:37:18,197 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:37:18,197 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:18,197 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:37:18,197 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:18,197 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:18,198 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:18,198 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:37:18,198 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:37:18,198 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:37:18,198 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:37:18,198 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:37:18,198 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:37:18,199 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:37:18,199 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:37:18,199 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:37:18,199 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:37:18,200 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:37:18,200 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:37:18,200 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:18,200 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:37:18,200 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:18,201 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:18,201 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:18,201 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:37:18,201 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:37:18,201 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:37:18,201 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:37:18,206 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:37:18,207 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:18,208 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:18,208 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:37:18,209 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:18,210 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:18,210 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:18,210 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:18,241 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3848, Threshold=0.4413, Accuracy=0.7099, F1=0.7975, Precision=0.9527, Recall=0.6858
2025-08-04 20:37:18,241 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7099, F1: 0.7975, Prec: 0.9527, Rec: 0.6858, Avg Anomaly Score: 0.3848
2025-08-04 20:37:29,513 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:29,513 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:37:29,513 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:37:29,513 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:37:29,514 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:37:29,514 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:29,821 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:29,821 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:29,910 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:37:29,953 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:37:29,953 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:30,093 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:30,099 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:30,099 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:30,106 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:37:30,113 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:30,113 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:37:30,114 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:30,114 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:30,114 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:37:30,124 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:30,127 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:30,129 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:30,132 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:30,134 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:30,137 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:30,139 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:30,142 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:30,144 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:30,147 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:30,149 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:30,159 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:30,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:37:30,165 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:37:30,165 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:37:30,171 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:30,171 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:37:30,182 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:30,182 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:37:30,182 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:30,199 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:30,204 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:37:30,210 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:37:30,210 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:30,210 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:30,210 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:30,211 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:30,211 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:30,211 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:37:30,211 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:30,212 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:37:30,212 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:30,213 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:37:30,213 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:37:30,213 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:30,214 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:37:30,214 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:30,214 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:30,214 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:30,214 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:37:30,214 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:37:30,214 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:37:30,214 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:37:30,214 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:37:30,215 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:37:30,215 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:37:30,215 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:37:30,215 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:37:30,215 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:37:30,216 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:37:30,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:37:30,216 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:30,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:37:30,216 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:30,216 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:30,217 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:30,217 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:37:30,217 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:37:30,217 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:37:30,217 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:37:30,220 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:37:30,221 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:30,222 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:30,222 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:37:30,223 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:30,223 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:30,224 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:30,224 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:30,259 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3606, Threshold=0.4152, Accuracy=0.7108, F1=0.7982, Precision=0.9535, Recall=0.6864
2025-08-04 20:37:30,259 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7108, F1: 0.7982, Prec: 0.9535, Rec: 0.6864, Avg Anomaly Score: 0.3606
2025-08-04 20:37:44,527 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:44,527 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:37:44,527 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:37:44,527 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:37:44,527 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:37:44,528 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:44,828 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:44,828 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:44,912 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:37:44,934 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:37:44,934 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:45,033 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:45,038 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:45,039 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:45,044 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:37:45,049 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:45,050 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:37:45,050 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:45,050 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:45,051 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:37:45,059 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:45,062 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:45,064 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:45,066 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:45,069 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:45,071 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:45,073 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:45,075 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:45,078 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:45,080 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:45,082 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:45,091 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:45,092 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:37:45,096 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:37:45,096 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:37:45,102 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:45,102 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:37:45,110 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:45,111 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:37:45,111 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:45,129 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:45,134 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:37:45,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:37:45,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:45,139 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:45,139 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:45,140 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:45,140 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:45,140 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:37:45,140 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:45,141 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:37:45,141 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:45,142 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:37:45,142 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:37:45,143 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:45,143 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:37:45,143 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:45,143 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:45,143 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:45,144 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:37:45,144 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:37:45,144 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:37:45,144 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:37:45,144 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:37:45,144 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:37:45,145 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:37:45,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:37:45,145 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:37:45,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:37:45,145 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:37:45,146 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:37:45,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:45,146 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:37:45,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:45,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:45,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:45,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:37:45,147 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:37:45,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:37:45,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:37:45,150 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:37:45,150 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:45,152 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:45,152 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:37:45,153 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:45,153 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:45,154 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:45,154 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:45,186 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3760, Threshold=0.4367, Accuracy=0.7146, F1=0.8008, Precision=0.9566, Recall=0.6886
2025-08-04 20:37:45,186 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7146, F1: 0.8008, Prec: 0.9566, Rec: 0.6886, Avg Anomaly Score: 0.3760
2025-08-04 20:37:56,475 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:56,475 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:37:56,475 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:37:56,475 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:37:56,475 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:37:56,475 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:56,779 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:56,779 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:56,864 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:37:56,912 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:37:56,912 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:57,044 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:57,050 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:57,051 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:57,056 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:37:57,062 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:57,063 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:37:57,066 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:57,067 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:57,067 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:37:57,078 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:57,081 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:57,083 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:57,085 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:57,087 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:57,089 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:57,092 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:57,095 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:57,098 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:57,100 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:57,102 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:57,111 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:57,111 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:37:57,116 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:37:57,116 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:37:57,121 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:57,121 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:37:57,130 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:57,131 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:37:57,131 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:57,147 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:57,151 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:37:57,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:37:57,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:57,158 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:57,158 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:57,158 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:57,159 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:57,159 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:37:57,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:57,159 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:37:57,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:57,161 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:37:57,161 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:37:57,161 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:57,161 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:37:57,161 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:57,161 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:57,162 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:57,162 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:37:57,162 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:37:57,162 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:37:57,162 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:37:57,162 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:37:57,162 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:37:57,163 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:37:57,163 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:37:57,163 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:37:57,163 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:37:57,163 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:37:57,164 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:37:57,164 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:57,164 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:37:57,164 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:57,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:57,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:57,165 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:37:57,165 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:37:57,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:37:57,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:37:57,169 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:37:57,169 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:57,171 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:57,171 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:37:57,172 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:57,172 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:57,172 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:57,173 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:57,207 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3815, Threshold=0.4411, Accuracy=0.7155, F1=0.8014, Precision=0.9574, Recall=0.6892
2025-08-04 20:37:57,207 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7155, F1: 0.8014, Prec: 0.9574, Rec: 0.6892, Avg Anomaly Score: 0.3815
2025-08-04 20:38:08,473 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:08,473 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:38:08,474 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:38:08,474 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:38:08,474 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:38:08,474 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:08,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:08,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:08,891 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:38:08,913 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:38:08,914 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:09,013 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:09,021 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:09,021 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:09,028 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:38:09,034 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:09,035 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:38:09,035 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:09,035 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:09,035 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:38:09,045 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:09,049 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:09,051 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:09,053 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:09,056 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:09,058 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:09,061 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:09,064 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:09,067 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:09,069 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:09,072 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:09,087 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:09,088 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:38:09,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:38:09,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:38:09,103 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:09,103 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:38:09,118 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:09,119 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:38:09,119 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:09,137 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:09,143 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:38:09,150 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:38:09,150 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:09,150 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:09,151 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:09,151 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:09,151 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:09,152 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:38:09,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:09,152 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:38:09,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:09,154 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:38:09,154 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:38:09,154 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:09,154 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:38:09,155 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:09,155 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:09,155 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:09,155 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:38:09,155 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:38:09,155 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:38:09,156 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:38:09,156 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:38:09,156 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:38:09,156 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:38:09,157 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:38:09,157 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:38:09,157 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:38:09,157 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:38:09,157 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:38:09,158 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:09,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:38:09,158 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:09,158 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:09,159 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:09,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:38:09,159 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:38:09,159 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:38:09,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:38:09,164 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:38:09,164 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:09,166 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:09,166 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:38:09,168 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:09,168 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:09,168 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:09,169 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:09,207 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3823, Threshold=0.4503, Accuracy=0.7192, F1=0.8040, Precision=0.9605, Recall=0.6914
2025-08-04 20:38:09,207 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7192, F1: 0.8040, Prec: 0.9605, Rec: 0.6914, Avg Anomaly Score: 0.3823
2025-08-04 20:38:23,471 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:23,471 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:38:23,471 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:38:23,472 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:38:23,472 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:38:23,472 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:23,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:23,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:23,882 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:38:23,927 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:38:23,927 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:24,069 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:24,077 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:24,077 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:24,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:38:24,091 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:24,091 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:38:24,092 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:24,092 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:24,092 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:38:24,100 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:24,103 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:24,105 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:24,107 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:24,110 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:24,112 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:24,114 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:24,117 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:24,120 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:24,122 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:24,124 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:24,133 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:24,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:38:24,138 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:38:24,138 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:38:24,143 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:24,143 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:38:24,152 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:24,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:38:24,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:24,168 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:24,173 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:38:24,180 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:38:24,180 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:24,180 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:24,180 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:24,180 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:24,181 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:24,181 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:38:24,181 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:24,181 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:38:24,181 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:24,183 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:38:24,183 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:38:24,183 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:24,184 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:38:24,184 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:24,184 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:24,184 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:24,184 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:38:24,184 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:38:24,185 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:38:24,185 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:38:24,185 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:38:24,185 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:38:24,185 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:38:24,186 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:38:24,186 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:38:24,186 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:38:24,186 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:38:24,187 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:38:24,187 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:24,187 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:38:24,187 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:24,188 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:24,188 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:24,188 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:38:24,188 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:38:24,188 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:38:24,189 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:38:24,194 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:38:24,195 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:24,196 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:24,197 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:38:24,198 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:24,202 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:24,202 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:24,203 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:24,238 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3798, Threshold=0.4504, Accuracy=0.7201, F1=0.8047, Precision=0.9612, Recall=0.6920
2025-08-04 20:38:24,238 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7201, F1: 0.8047, Prec: 0.9612, Rec: 0.6920, Avg Anomaly Score: 0.3798
2025-08-04 20:38:35,517 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:35,517 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:38:35,517 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:38:35,518 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:38:35,518 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:38:35,518 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:35,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:35,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:35,921 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:38:35,937 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:38:35,937 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:36,032 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:36,038 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:36,038 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:36,042 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:38:36,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:36,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:38:36,048 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:36,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:36,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:38:36,057 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:36,060 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:36,062 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:36,064 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:36,067 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:36,069 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:36,071 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:36,074 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:36,077 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:36,079 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:36,081 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:36,092 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:36,092 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:38:36,097 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:38:36,097 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:38:36,107 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:36,107 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:38:36,120 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:36,121 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:38:36,121 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:36,140 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:36,146 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:38:36,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:38:36,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:36,152 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:36,153 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:36,153 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:36,153 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:36,153 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:38:36,154 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:36,154 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:38:36,154 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:36,155 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:38:36,155 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:38:36,156 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:36,156 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:38:36,156 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:36,156 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:36,156 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:36,156 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:38:36,156 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:38:36,157 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:38:36,157 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:38:36,157 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:38:36,157 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:38:36,157 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:38:36,157 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:38:36,158 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:38:36,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:38:36,158 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:38:36,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:38:36,158 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:36,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:38:36,159 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:36,159 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:36,159 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:36,160 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:38:36,160 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:38:36,160 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:38:36,160 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:38:36,164 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:38:36,164 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:36,165 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:36,165 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:38:36,167 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:36,167 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:36,167 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:36,168 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:36,201 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3787, Threshold=0.4535, Accuracy=0.7220, F1=0.8060, Precision=0.9628, Recall=0.6931
2025-08-04 20:38:36,201 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7220, F1: 0.8060, Prec: 0.9628, Rec: 0.6931, Avg Anomaly Score: 0.3787
2025-08-04 20:38:47,459 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:47,459 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:38:47,459 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:38:47,459 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:38:47,459 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:38:47,460 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:47,743 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:47,744 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:47,839 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:38:47,879 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:38:47,879 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:48,007 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:48,014 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:48,014 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:48,022 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:38:48,031 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:48,031 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:38:48,032 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:48,032 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:48,032 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:38:48,042 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:48,045 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:48,047 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:48,050 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:48,052 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:48,055 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:48,057 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:48,060 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:48,063 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:48,065 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:48,068 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:48,081 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:48,081 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:38:48,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:38:48,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:38:48,092 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:48,092 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:38:48,105 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:48,105 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:38:48,105 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:48,122 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:48,128 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:38:48,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:38:48,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:48,136 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:48,137 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:48,137 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:48,137 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:48,137 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:38:48,138 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:48,138 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:38:48,138 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:48,140 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:38:48,140 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:38:48,140 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:48,141 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:38:48,141 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:48,141 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:48,141 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:48,142 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:38:48,142 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:38:48,142 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:38:48,142 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:38:48,143 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:38:48,143 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:38:48,143 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:38:48,144 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:38:48,144 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:38:48,144 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:38:48,145 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:38:48,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:38:48,145 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:48,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:38:48,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:48,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:48,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:48,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:38:48,147 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:38:48,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:38:48,148 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:38:48,152 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:38:48,153 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:48,154 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:48,155 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:38:48,156 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:48,156 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:48,156 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:48,157 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:48,194 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3791, Threshold=0.4517, Accuracy=0.7183, F1=0.8034, Precision=0.9597, Recall=0.6908
2025-08-04 20:38:48,194 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7183, F1: 0.8034, Prec: 0.9597, Rec: 0.6908, Avg Anomaly Score: 0.3791
2025-08-04 20:39:02,467 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:02,467 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:39:02,467 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:39:02,467 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:39:02,468 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:39:02,468 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:02,752 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:02,753 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:02,840 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:39:02,855 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:39:02,855 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:02,953 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:02,959 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:02,960 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:02,964 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:39:02,970 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:02,970 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:39:02,971 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:02,971 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:02,971 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:39:02,979 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:02,982 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:02,984 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:02,986 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:02,989 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:02,991 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:02,994 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:02,996 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:02,999 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:03,001 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:03,003 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:03,015 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:03,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:39:03,019 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:39:03,020 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:39:03,027 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:03,027 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:39:03,041 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:03,042 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:39:03,042 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:03,060 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:03,066 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:39:03,076 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:39:03,077 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:03,077 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:03,077 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:03,077 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:03,077 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:03,078 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:39:03,078 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:03,078 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:39:03,078 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:03,080 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:39:03,080 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:39:03,081 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:03,081 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:39:03,081 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:03,081 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:03,081 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:03,081 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:39:03,082 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:39:03,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:39:03,082 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:39:03,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:39:03,082 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:39:03,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:39:03,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:39:03,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:39:03,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:39:03,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:39:03,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:39:03,084 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:03,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:39:03,084 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:03,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:03,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:03,085 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:39:03,085 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:39:03,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:39:03,085 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:39:03,088 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:39:03,089 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:03,090 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:03,090 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:39:03,092 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:03,092 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:03,092 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:03,093 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:03,128 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3743, Threshold=0.4400, Accuracy=0.7211, F1=0.8053, Precision=0.9620, Recall=0.6925
2025-08-04 20:39:03,128 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7211, F1: 0.8053, Prec: 0.9620, Rec: 0.6925, Avg Anomaly Score: 0.3743
2025-08-04 20:39:08,387 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:08,387 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:39:08,387 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:39:08,387 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:39:08,387 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:39:08,388 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:08,651 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:08,651 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:08,734 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:39:08,776 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:39:08,777 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:08,886 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:08,891 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:08,892 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:08,897 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:39:08,905 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:08,905 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:39:08,905 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:08,906 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:08,906 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:39:08,914 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:08,917 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:08,919 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:08,921 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:08,924 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:08,926 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:08,928 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:08,931 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:08,933 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:08,935 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:08,938 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:08,946 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:08,946 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:39:08,951 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:39:08,951 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:39:08,957 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:08,957 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:39:08,968 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:08,968 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:39:08,968 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:08,982 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:08,987 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:39:08,991 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:39:08,992 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:08,992 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:08,992 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:08,992 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:08,992 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:08,993 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:39:08,993 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:08,993 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:39:08,993 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:08,995 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:39:08,995 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:39:08,995 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:08,995 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:39:08,996 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:08,996 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:08,996 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:08,996 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:39:08,996 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:39:08,996 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:39:08,997 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:39:08,997 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:39:08,997 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:39:08,997 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:39:08,997 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:39:08,997 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:39:08,998 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:39:08,998 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:39:08,998 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:39:08,998 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:08,998 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:39:08,999 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:08,999 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:08,999 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:08,999 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:39:08,999 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:39:09,000 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:39:09,000 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:39:09,004 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:39:09,004 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:09,005 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:09,006 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:39:09,007 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 80/400.
2025-08-04 20:39:09,109 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:09,109 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:09,111 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 31 anomalous samples to GAN training data (target: 31).
2025-08-04 20:39:09,111 - ClientAppLogger [Client 7] - INFO - [Client] Round 80: Training GAN with 137 samples (106 normal, 31 anomalous).
2025-08-04 20:39:09,111 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:39:09,231 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0830, Avg D Loss: 0.8455
2025-08-04 20:39:09,232 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0830, Avg D Loss: 0.8455
2025-08-04 20:39:09,232 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:39:09,266 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3885, Threshold=0.4597, Accuracy=0.7211, F1=0.8053, Precision=0.9620, Recall=0.6925
2025-08-04 20:39:09,266 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8053
2025-08-04 20:39:09,266 - ClientAppLogger [Client 7] - INFO - Fit completed for round 80. Duration: 0.26s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 80, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0830397323970375, 'd_loss': 0.8455283467351956, 'post_fit_local_f1': 0.8053212199870214, 'fit_time_seconds': 0.2592320442199707, 'cpu_percent_fit': 24.55, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 137}
2025-08-04 20:39:09,267 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:39:17,533 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:17,533 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:39:17,533 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:39:17,533 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:39:17,533 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:39:17,534 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:17,816 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:17,816 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:17,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:39:17,924 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:39:17,924 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:18,031 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:18,038 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:18,038 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:18,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:39:18,060 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:18,061 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:39:18,061 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:18,062 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:18,062 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:39:18,071 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:18,074 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:18,077 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:18,079 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:18,083 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:18,085 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:18,087 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:18,090 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:18,093 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:18,095 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:18,097 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:18,108 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:18,109 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:39:18,114 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:39:18,114 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:39:18,122 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:18,122 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:39:18,137 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:18,138 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:39:18,138 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:18,153 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:18,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:39:18,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:39:18,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:18,166 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:18,166 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:18,167 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:18,167 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:18,167 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:39:18,167 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:18,168 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:39:18,168 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:18,169 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:39:18,169 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:39:18,170 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:18,170 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:39:18,170 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:18,170 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:18,170 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:18,171 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:39:18,171 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:39:18,171 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:39:18,171 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:39:18,171 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:39:18,171 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:39:18,172 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:39:18,172 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:39:18,172 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:39:18,172 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:39:18,172 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:39:18,177 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:39:18,177 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:18,177 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:39:18,177 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:18,178 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:18,178 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:18,179 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:39:18,180 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:39:18,180 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:39:18,180 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:39:18,183 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:39:18,183 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:18,185 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:18,185 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:39:18,186 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:18,186 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:18,187 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:18,188 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:18,226 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4000, Threshold=0.4681, Accuracy=0.7192, F1=0.8040, Precision=0.9605, Recall=0.6914
2025-08-04 20:39:18,227 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7192, F1: 0.8040, Prec: 0.9605, Rec: 0.6914, Avg Anomaly Score: 0.4000
2025-08-04 20:39:29,495 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:29,495 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:39:29,495 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:39:29,495 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:39:29,496 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:39:29,496 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:29,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:29,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:29,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:39:29,948 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:39:29,948 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:30,109 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:30,115 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:30,115 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:30,122 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:39:30,134 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:30,134 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:39:30,135 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:30,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:30,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:39:30,146 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:30,149 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:30,153 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:30,156 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:30,160 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:30,162 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:30,165 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:30,169 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:30,173 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:30,176 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:30,180 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:30,193 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:30,193 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:39:30,198 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:39:30,198 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:39:30,203 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:30,203 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:39:30,216 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:30,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:39:30,217 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:30,232 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:30,238 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:39:30,246 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:39:30,246 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:30,246 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:30,246 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:30,247 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:30,247 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:30,247 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:39:30,247 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:30,248 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:39:30,248 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:30,249 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:39:30,249 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:39:30,250 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:30,250 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:39:30,250 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:30,250 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:30,250 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:30,250 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:39:30,251 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:39:30,251 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:39:30,251 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:39:30,251 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:39:30,251 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:39:30,251 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:39:30,252 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:39:30,252 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:39:30,252 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:39:30,253 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:39:30,253 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:39:30,253 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:30,253 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:39:30,254 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:30,254 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:30,254 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:30,254 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:39:30,254 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:39:30,255 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:39:30,255 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:39:30,260 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:39:30,261 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:30,262 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:30,262 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:39:30,264 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:30,264 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:30,264 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:30,265 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:30,297 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3883, Threshold=0.4475, Accuracy=0.7211, F1=0.8053, Precision=0.9620, Recall=0.6925
2025-08-04 20:39:30,297 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7211, F1: 0.8053, Prec: 0.9620, Rec: 0.6925, Avg Anomaly Score: 0.3883
2025-08-04 20:39:41,562 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:41,562 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:39:41,562 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:39:41,562 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:39:41,562 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:39:41,562 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:41,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:41,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:41,919 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:39:41,933 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:39:41,934 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:42,025 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:42,030 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:42,031 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:42,035 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:39:42,041 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:42,041 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:39:42,042 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:42,042 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:42,042 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:39:42,052 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:42,055 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:42,058 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:42,060 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:42,063 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:42,065 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:42,068 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:42,071 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:42,074 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:42,076 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:42,078 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:42,088 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:42,088 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:39:42,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:39:42,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:39:42,100 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:42,100 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:39:42,113 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:42,113 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:39:42,113 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:42,129 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:42,134 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:39:42,141 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:39:42,141 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:42,141 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:42,141 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:42,142 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:42,142 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:42,142 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:39:42,142 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:42,143 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:39:42,143 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:42,145 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:39:42,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:39:42,145 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:42,146 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:39:42,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:42,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:42,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:42,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:39:42,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:39:42,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:39:42,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:39:42,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:39:42,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:39:42,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:39:42,148 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:39:42,148 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:39:42,148 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:39:42,148 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:39:42,149 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:39:42,149 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:42,149 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:39:42,149 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:42,150 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:42,150 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:42,150 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:39:42,150 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:39:42,150 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:39:42,151 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:39:42,153 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:39:42,153 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:42,155 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:42,155 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:39:42,157 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:42,157 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:42,157 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:42,158 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:42,192 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3769, Threshold=0.4295, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:39:42,193 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7229, F1: 0.8066, Prec: 0.9636, Rec: 0.6936, Avg Anomaly Score: 0.3769
2025-08-04 20:39:56,476 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:56,476 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:39:56,476 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:39:56,476 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:39:56,476 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:39:56,477 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:56,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:56,697 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:56,790 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:39:56,838 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:39:56,838 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:56,949 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:56,954 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:56,954 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:56,959 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:39:56,964 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:56,964 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:39:56,965 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:56,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:56,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:39:56,973 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:56,976 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:56,978 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:56,980 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:56,983 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:56,985 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:56,987 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:56,990 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:56,993 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:56,994 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:56,997 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:57,005 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:57,005 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:39:57,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:39:57,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:39:57,015 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:57,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:39:57,025 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:57,025 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:39:57,025 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:57,041 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:57,046 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:39:57,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:39:57,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:57,052 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:57,052 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:57,052 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:57,053 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:57,053 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:39:57,053 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:57,053 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:39:57,053 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:57,055 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:39:57,055 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:39:57,055 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:57,056 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:39:57,056 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:57,056 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:57,056 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:57,056 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:39:57,056 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:39:57,057 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:39:57,057 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:39:57,057 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:39:57,057 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:39:57,058 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:39:57,058 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:39:57,058 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:39:57,058 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:39:57,059 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:39:57,059 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:39:57,059 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:57,059 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:39:57,059 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:57,060 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:57,060 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:57,060 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:39:57,060 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:39:57,060 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:39:57,061 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:39:57,064 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:39:57,064 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:57,066 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:57,066 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:39:57,067 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:57,068 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:57,068 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:57,069 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:57,101 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4077, Threshold=0.4670, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:39:57,102 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7229, F1: 0.8066, Prec: 0.9636, Rec: 0.6936, Avg Anomaly Score: 0.4077
2025-08-04 20:40:02,361 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:02,361 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:40:02,361 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:40:02,361 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:40:02,361 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:40:02,361 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:02,600 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:02,600 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:02,681 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:40:02,703 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:40:02,703 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:02,795 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:02,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:02,801 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:02,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:40:02,815 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:02,816 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:40:02,816 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:02,816 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:02,817 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:40:02,825 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:02,828 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:02,831 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:02,833 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:02,836 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:02,838 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:02,841 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:02,843 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:02,846 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:02,848 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:02,850 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:02,860 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:02,860 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:40:02,865 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:40:02,865 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:40:02,870 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:02,871 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:40:02,881 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:02,882 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:40:02,882 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:02,898 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:02,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:40:02,907 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:40:02,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:02,908 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:02,908 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:02,908 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:02,909 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:02,909 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:40:02,909 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:02,909 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:40:02,910 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:02,911 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:40:02,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:40:02,912 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:02,912 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:40:02,912 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:02,912 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:02,913 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:02,913 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:40:02,913 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:40:02,913 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:40:02,913 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:40:02,913 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:40:02,913 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:40:02,914 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:40:02,914 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:40:02,914 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:40:02,915 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:40:02,915 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:40:02,915 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:40:02,915 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:02,916 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:40:02,916 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:02,916 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:02,916 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:02,917 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:40:02,917 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:40:02,917 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:40:02,917 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:40:02,922 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:40:02,922 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:02,923 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:02,923 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:40:02,925 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 84/400.
2025-08-04 20:40:03,026 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:03,026 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:03,027 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 33 anomalous samples to GAN training data (target: 33).
2025-08-04 20:40:03,028 - ClientAppLogger [Client 7] - INFO - [Client] Round 84: Training GAN with 144 samples (111 normal, 33 anomalous).
2025-08-04 20:40:03,028 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:03,148 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0800, Avg D Loss: 0.8295
2025-08-04 20:40:03,148 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0800, Avg D Loss: 0.8295
2025-08-04 20:40:03,148 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:03,183 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4082, Threshold=0.4750, Accuracy=0.7211, F1=0.8053, Precision=0.9620, Recall=0.6925
2025-08-04 20:40:03,183 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8053
2025-08-04 20:40:03,183 - ClientAppLogger [Client 7] - INFO - Fit completed for round 84. Duration: 0.26s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 84, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0800344467163088, 'd_loss': 0.8295276370313432, 'post_fit_local_f1': 0.8053212199870214, 'fit_time_seconds': 0.2581136226654053, 'cpu_percent_fit': 24.6, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 144}
2025-08-04 20:40:03,184 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:40:11,464 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:11,464 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:40:11,465 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:40:11,465 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:40:11,465 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:40:11,465 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:11,747 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:11,747 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:11,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:40:11,868 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:40:11,868 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:11,971 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:11,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:11,977 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:11,983 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:40:11,989 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:11,989 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:40:11,990 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:11,990 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:11,990 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:40:11,999 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:12,002 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:12,004 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:12,007 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:12,010 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:12,012 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:12,014 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:12,017 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:12,019 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:12,021 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:12,023 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:12,033 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:12,033 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:40:12,038 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:40:12,038 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:40:12,043 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:12,043 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:40:12,052 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:12,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:40:12,053 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:12,068 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:12,073 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:40:12,079 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:40:12,079 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:12,079 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:12,079 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:12,079 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:12,080 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:12,080 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:40:12,080 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:12,080 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:40:12,081 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:12,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:40:12,082 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:40:12,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:12,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:40:12,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:12,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:12,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:12,084 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:40:12,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:40:12,084 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:40:12,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:40:12,084 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:40:12,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:40:12,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:40:12,085 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:40:12,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:40:12,085 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:40:12,086 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:40:12,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:40:12,086 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:12,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:40:12,086 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:12,086 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:12,087 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:12,087 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:40:12,087 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:40:12,087 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:40:12,088 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:40:12,091 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:40:12,091 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:12,093 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:12,093 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:40:12,094 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:12,095 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:12,095 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:12,096 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:12,129 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4107, Threshold=0.4703, Accuracy=0.7211, F1=0.8053, Precision=0.9620, Recall=0.6925
2025-08-04 20:40:12,129 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7211, F1: 0.8053, Prec: 0.9620, Rec: 0.6925, Avg Anomaly Score: 0.4107
2025-08-04 20:40:23,394 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:23,394 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:40:23,394 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:40:23,394 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:40:23,395 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:40:23,395 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:23,680 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:23,680 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:23,766 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:40:23,782 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:40:23,782 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:23,880 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:23,889 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:23,889 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:23,896 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:40:23,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:23,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:40:23,903 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:23,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:23,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:40:23,913 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:23,915 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:23,918 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:23,920 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:23,923 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:23,925 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:23,928 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:23,931 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:23,934 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:23,937 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:23,940 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:23,952 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:23,952 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:40:23,958 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:40:23,958 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:40:23,969 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:23,969 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:40:23,982 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:23,983 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:40:23,983 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:23,998 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:24,003 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:40:24,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:40:24,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:24,010 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:24,010 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:24,010 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:24,011 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:24,011 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:40:24,011 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:24,011 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:40:24,012 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:24,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:40:24,013 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:40:24,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:24,014 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:40:24,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:24,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:24,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:24,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:40:24,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:40:24,015 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:40:24,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:40:24,015 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:40:24,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:40:24,016 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:40:24,016 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:40:24,016 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:40:24,016 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:40:24,016 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:40:24,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:40:24,017 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:24,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:40:24,017 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:24,018 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:24,018 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:24,018 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:40:24,018 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:40:24,019 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:40:24,019 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:40:24,023 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:40:24,023 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:24,025 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:24,025 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:40:24,027 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:24,027 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:24,027 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:24,028 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:24,061 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3881, Threshold=0.4356, Accuracy=0.7220, F1=0.8060, Precision=0.9628, Recall=0.6931
2025-08-04 20:40:24,061 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7220, F1: 0.8060, Prec: 0.9628, Rec: 0.6931, Avg Anomaly Score: 0.3881
2025-08-04 20:40:29,311 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:29,311 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:40:29,311 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:40:29,311 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:40:29,311 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:40:29,311 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:29,568 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:29,569 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:29,653 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:40:29,690 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:40:29,690 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:29,797 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:29,802 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:29,802 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:29,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:40:29,812 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:29,812 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:40:29,813 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:29,813 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:29,813 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:40:29,821 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:29,823 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:29,825 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:29,828 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:29,830 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:29,832 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:29,834 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:29,837 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:29,840 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:29,841 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:29,844 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:29,852 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:29,853 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:40:29,857 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:40:29,858 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:40:29,862 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:29,862 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:40:29,870 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:29,870 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:40:29,870 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:29,884 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:29,889 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:40:29,894 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:40:29,894 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:29,894 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:29,894 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:29,895 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:29,895 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:29,895 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:40:29,895 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:29,895 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:40:29,896 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:29,897 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:40:29,897 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:40:29,897 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:29,898 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:40:29,898 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:29,898 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:29,898 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:29,898 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:40:29,898 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:40:29,898 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:40:29,899 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:40:29,899 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:40:29,899 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:40:29,899 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:40:29,899 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:40:29,900 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:40:29,900 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:40:29,900 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:40:29,900 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:40:29,900 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:29,900 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:40:29,901 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:29,901 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:29,901 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:29,901 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:40:29,902 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:40:29,902 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:40:29,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:40:29,905 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:40:29,905 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:29,907 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:29,907 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:40:29,908 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 86/400.
2025-08-04 20:40:30,009 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:30,009 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:30,010 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 34 anomalous samples to GAN training data (target: 34).
2025-08-04 20:40:30,010 - ClientAppLogger [Client 7] - INFO - [Client] Round 86: Training GAN with 149 samples (115 normal, 34 anomalous).
2025-08-04 20:40:30,011 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:30,132 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0821, Avg D Loss: 0.8274
2025-08-04 20:40:30,132 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0821, Avg D Loss: 0.8274
2025-08-04 20:40:30,133 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:30,172 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4203, Threshold=0.4864, Accuracy=0.7211, F1=0.8053, Precision=0.9620, Recall=0.6925
2025-08-04 20:40:30,172 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8053
2025-08-04 20:40:30,172 - ClientAppLogger [Client 7] - INFO - Fit completed for round 86. Duration: 0.26s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 86, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.082061488196354, 'd_loss': 0.8273636674320939, 'post_fit_local_f1': 0.8053212199870214, 'fit_time_seconds': 0.26421546936035156, 'cpu_percent_fit': 24.46875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 149}
2025-08-04 20:40:30,173 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:40:38,429 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:38,429 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:40:38,429 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:40:38,429 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:40:38,430 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:40:38,430 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:38,694 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:38,694 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:38,775 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:40:38,793 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:40:38,793 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:38,888 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:38,895 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:38,895 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:38,899 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:40:38,905 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:38,905 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:40:38,906 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:38,906 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:38,906 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:40:38,915 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:38,918 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:38,920 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:38,922 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:38,925 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:38,927 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:38,930 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:38,932 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:38,935 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:38,937 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:38,939 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:38,948 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:38,949 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:40:38,953 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:40:38,954 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:40:38,959 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:38,959 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:40:38,969 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:38,970 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:40:38,970 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:38,984 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:38,989 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:40:38,993 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:40:38,994 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:38,994 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:38,994 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:38,994 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:38,994 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:38,995 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:40:38,995 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:38,995 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:40:38,995 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:38,997 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:40:38,997 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:40:38,997 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:38,997 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:40:38,997 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:38,998 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:38,998 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:38,998 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:40:38,998 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:40:38,998 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:40:38,999 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:40:38,999 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:40:38,999 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:40:38,999 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:40:38,999 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:40:39,000 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:40:39,000 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:40:39,000 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:40:39,000 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:40:39,000 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:39,000 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:40:39,001 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:39,001 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:39,001 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:39,001 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:40:39,002 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:40:39,002 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:40:39,002 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:40:39,004 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:40:39,004 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:39,005 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:39,005 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:40:39,007 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:39,007 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:39,007 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:39,008 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:39,043 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4200, Threshold=0.4847, Accuracy=0.7211, F1=0.8053, Precision=0.9620, Recall=0.6925
2025-08-04 20:40:39,043 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7211, F1: 0.8053, Prec: 0.9620, Rec: 0.6925, Avg Anomaly Score: 0.4200
2025-08-04 20:40:44,292 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:44,292 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:40:44,292 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:40:44,292 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:40:44,292 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:40:44,293 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:44,528 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:44,529 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:44,614 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:40:44,651 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:40:44,651 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:44,758 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:44,763 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:44,763 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:44,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:40:44,772 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:44,773 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:40:44,773 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:44,773 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:44,773 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:40:44,781 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:44,784 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:44,787 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:44,789 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:44,792 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:44,794 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:44,796 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:44,799 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:44,802 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:44,804 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:44,806 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:44,815 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:44,815 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:40:44,820 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:40:44,820 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:40:44,824 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:44,824 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:40:44,833 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:44,834 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:40:44,834 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:44,849 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:44,854 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:40:44,859 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:40:44,859 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:44,859 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:44,859 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:44,859 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:44,860 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:44,860 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:40:44,860 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:44,860 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:40:44,860 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:44,862 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:40:44,862 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:40:44,862 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:44,862 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:40:44,862 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:44,862 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:44,863 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:44,863 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:40:44,863 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:40:44,863 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:40:44,863 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:40:44,864 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:40:44,864 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:40:44,864 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:40:44,864 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:40:44,864 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:40:44,865 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:40:44,865 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:40:44,865 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:40:44,865 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:44,865 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:40:44,865 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:44,866 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:44,866 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:44,866 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:40:44,866 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:40:44,866 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:40:44,866 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:40:44,870 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:40:44,870 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:44,871 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:44,871 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:40:44,872 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 87/400.
2025-08-04 20:40:44,973 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:44,973 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:44,976 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 34 anomalous samples to GAN training data (target: 34).
2025-08-04 20:40:44,977 - ClientAppLogger [Client 7] - INFO - [Client] Round 87: Training GAN with 150 samples (116 normal, 34 anomalous).
2025-08-04 20:40:44,977 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:45,097 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0848, Avg D Loss: 0.8447
2025-08-04 20:40:45,098 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0848, Avg D Loss: 0.8447
2025-08-04 20:40:45,098 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:45,131 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4100, Threshold=0.4573, Accuracy=0.7220, F1=0.8060, Precision=0.9628, Recall=0.6931
2025-08-04 20:40:45,131 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8060
2025-08-04 20:40:45,131 - ClientAppLogger [Client 7] - INFO - Fit completed for round 87. Duration: 0.26s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 87, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.084760339419047, 'd_loss': 0.8447185014088948, 'post_fit_local_f1': 0.8059701492537313, 'fit_time_seconds': 0.25866150856018066, 'cpu_percent_fit': 23.75625, 'ram_mb_fit': 1.921875, 'accumulated_train_samples_this_round': 150}
2025-08-04 20:40:45,131 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:40:53,383 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:53,383 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:40:53,383 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:40:53,383 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:40:53,384 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:40:53,384 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:53,644 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:53,644 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:53,732 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:40:53,774 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:40:53,774 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:53,884 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:53,889 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:53,890 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:53,895 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:40:53,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:53,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:40:53,904 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:53,904 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:53,904 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:40:53,912 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:53,915 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:53,917 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:53,919 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:53,921 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:53,923 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:53,926 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:53,928 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:53,931 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:53,933 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:53,935 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:53,944 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:53,944 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:40:53,948 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:40:53,948 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:40:53,954 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:53,954 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:40:53,964 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:53,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:40:53,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:53,980 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:53,985 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:40:53,990 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:40:53,990 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:53,990 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:53,990 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:53,990 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:53,991 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:53,991 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:40:53,991 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:53,991 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:40:53,991 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:53,993 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:40:53,993 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:40:53,993 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:53,993 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:40:53,993 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:53,994 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:53,994 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:53,994 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:40:53,994 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:40:53,994 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:40:53,995 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:40:53,995 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:40:53,995 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:40:53,995 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:40:53,995 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:40:53,995 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:40:53,995 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:40:53,996 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:40:53,996 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:40:53,996 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:53,996 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:40:53,996 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:53,996 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:53,997 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:53,997 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:40:53,997 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:40:53,997 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:40:53,997 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:40:53,998 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:40:53,999 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:54,000 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:54,000 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:40:54,001 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:54,002 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:54,002 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:54,002 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:54,034 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4241, Threshold=0.4807, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:40:54,034 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7229, F1: 0.8066, Prec: 0.9636, Rec: 0.6936, Avg Anomaly Score: 0.4241
2025-08-04 20:41:08,313 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:08,313 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:41:08,314 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:41:08,314 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:41:08,314 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:41:08,314 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:08,560 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:08,560 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:08,646 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:41:08,693 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:41:08,694 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:08,814 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:08,821 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:08,822 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:08,827 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:41:08,836 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:08,836 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:41:08,837 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:08,837 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:08,837 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:41:08,846 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:08,849 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:08,851 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:08,853 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:08,856 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:08,858 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:08,861 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:08,863 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:08,866 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:08,868 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:08,870 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:08,880 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:08,880 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:41:08,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:41:08,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:41:08,890 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:08,890 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:41:08,901 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:08,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:41:08,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:08,918 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:08,923 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:41:08,927 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:41:08,927 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:08,927 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:08,927 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:08,928 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:08,928 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:08,928 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:41:08,928 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:08,929 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:41:08,929 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:08,930 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:41:08,930 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:41:08,931 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:08,931 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:41:08,931 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:08,931 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:08,931 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:08,931 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:41:08,931 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:41:08,932 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:41:08,932 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:41:08,932 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:41:08,932 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:41:08,932 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:41:08,932 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:41:08,933 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:41:08,933 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:41:08,933 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:41:08,933 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:41:08,933 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:08,933 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:41:08,934 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:08,934 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:08,934 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:08,934 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:41:08,935 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:41:08,935 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:41:08,935 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:41:08,939 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:41:08,939 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:08,941 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:08,941 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:41:08,942 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:08,942 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:08,943 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:08,943 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:08,974 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3928, Threshold=0.4369, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:41:08,974 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7229, F1: 0.8066, Prec: 0.9636, Rec: 0.6936, Avg Anomaly Score: 0.3928
2025-08-04 20:41:14,223 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:14,223 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:41:14,223 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:41:14,224 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:41:14,224 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:41:14,224 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:14,503 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:14,503 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:14,585 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:41:14,608 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:41:14,608 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:14,697 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:14,703 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:14,703 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:14,710 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:41:14,716 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:14,716 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:41:14,716 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:14,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:14,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:41:14,725 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:14,728 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:14,730 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:14,733 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:14,735 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:14,737 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:14,740 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:14,742 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:14,745 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:14,747 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:14,749 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:14,758 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:14,758 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:41:14,763 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:41:14,763 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:41:14,768 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:14,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:41:14,777 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:14,777 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:41:14,777 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:14,792 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:14,797 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:41:14,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:41:14,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:14,804 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:14,804 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:14,804 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:14,804 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:14,805 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:41:14,805 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:14,805 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:41:14,805 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:14,806 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:41:14,806 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:41:14,807 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:14,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:41:14,807 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:14,807 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:14,807 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:14,808 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:41:14,808 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:41:14,808 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:41:14,808 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:41:14,808 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:41:14,808 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:41:14,808 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:41:14,808 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:41:14,809 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:41:14,809 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:41:14,809 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:41:14,809 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:41:14,809 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:14,810 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:41:14,810 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:14,810 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:14,810 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:14,810 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:41:14,811 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:41:14,811 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:41:14,811 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:41:14,815 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:41:14,815 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:14,816 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:14,817 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:41:14,818 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 89/400.
2025-08-04 20:41:14,919 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:14,919 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:14,920 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 36 anomalous samples to GAN training data (target: 36).
2025-08-04 20:41:14,921 - ClientAppLogger [Client 7] - INFO - [Client] Round 89: Training GAN with 156 samples (120 normal, 36 anomalous).
2025-08-04 20:41:14,921 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:15,041 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0849, Avg D Loss: 0.8497
2025-08-04 20:41:15,041 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0849, Avg D Loss: 0.8497
2025-08-04 20:41:15,042 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:15,074 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4049, Threshold=0.4463, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:41:15,074 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8066
2025-08-04 20:41:15,075 - ClientAppLogger [Client 7] - INFO - Fit completed for round 89. Duration: 0.26s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 89, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0849310361422027, 'd_loss': 0.8496677178602952, 'post_fit_local_f1': 0.8066190785204412, 'fit_time_seconds': 0.2568228244781494, 'cpu_percent_fit': 24.4625, 'ram_mb_fit': 0.17578125, 'accumulated_train_samples_this_round': 156}
2025-08-04 20:41:15,075 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:41:20,350 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:20,351 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:41:20,351 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:41:20,351 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:41:20,351 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:41:20,351 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:20,642 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:20,642 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:20,729 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:41:20,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:41:20,768 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:20,877 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:20,882 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:20,882 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:20,886 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:41:20,892 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:20,892 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:41:20,892 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:20,892 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:20,893 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:41:20,902 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:20,904 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:20,906 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:20,909 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:20,911 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:20,913 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:20,915 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:20,918 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:20,920 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:20,922 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:20,925 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:20,933 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:20,933 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:41:20,938 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:41:20,938 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:41:20,942 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:20,942 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:41:20,952 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:20,953 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:41:20,953 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:20,968 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:20,973 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:41:20,978 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:41:20,979 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:20,979 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:20,979 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:20,979 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:20,979 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:20,980 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:41:20,980 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:20,980 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:41:20,980 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:20,981 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:41:20,981 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:41:20,982 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:20,982 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:41:20,982 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:20,982 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:20,982 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:20,982 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:41:20,983 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:41:20,983 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:41:20,983 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:41:20,983 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:41:20,983 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:41:20,983 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:41:20,983 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:41:20,984 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:41:20,984 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:41:20,984 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:41:20,984 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:41:20,984 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:20,984 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:41:20,985 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:20,985 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:20,985 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:20,985 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:41:20,985 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:41:20,986 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:41:20,986 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:41:20,989 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:41:20,989 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:20,991 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:20,991 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:41:20,993 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:20,993 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:20,993 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:20,993 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:21,024 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3970, Threshold=0.4328, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:41:21,024 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7229, F1: 0.8066, Prec: 0.9636, Rec: 0.6936, Avg Anomaly Score: 0.3970
2025-08-04 20:41:26,284 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:26,284 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:41:26,284 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:41:26,284 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:41:26,285 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:41:26,285 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:26,545 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:26,545 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:26,625 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:41:26,637 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:41:26,637 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:26,723 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:26,728 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:26,728 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:26,733 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:41:26,738 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:26,738 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:41:26,739 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:26,739 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:26,739 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:41:26,747 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:26,750 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:26,753 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:26,755 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:26,758 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:26,760 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:26,762 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:26,765 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:26,768 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:26,770 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:26,772 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:26,780 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:26,780 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:41:26,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:41:26,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:41:26,791 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:26,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:41:26,801 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:26,802 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:41:26,802 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:26,816 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:26,821 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:41:26,825 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:41:26,825 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:26,825 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:26,826 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:26,826 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:26,826 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:26,827 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:41:26,827 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:26,827 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:41:26,827 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:26,828 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:41:26,828 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:41:26,829 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:26,829 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:41:26,829 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:26,829 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:26,829 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:26,830 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:41:26,830 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:41:26,830 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:41:26,830 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:41:26,830 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:41:26,830 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:41:26,830 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:41:26,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:41:26,831 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:41:26,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:41:26,831 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:41:26,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:41:26,831 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:26,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:41:26,832 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:26,832 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:26,832 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:26,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:41:26,833 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:41:26,833 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:41:26,833 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:41:26,834 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:41:26,835 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:26,836 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:26,836 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:41:26,837 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 90/400.
2025-08-04 20:41:26,938 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:26,938 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:26,939 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 36 anomalous samples to GAN training data (target: 36).
2025-08-04 20:41:26,940 - ClientAppLogger [Client 7] - INFO - [Client] Round 90: Training GAN with 158 samples (122 normal, 36 anomalous).
2025-08-04 20:41:26,940 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:27,057 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0818, Avg D Loss: 0.8279
2025-08-04 20:41:27,057 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0818, Avg D Loss: 0.8279
2025-08-04 20:41:27,057 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:27,089 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4044, Threshold=0.4472, Accuracy=0.7211, F1=0.8053, Precision=0.9620, Recall=0.6925
2025-08-04 20:41:27,089 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8053
2025-08-04 20:41:27,089 - ClientAppLogger [Client 7] - INFO - Fit completed for round 90. Duration: 0.25s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 90, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0817922453337077, 'd_loss': 0.8278961092610903, 'post_fit_local_f1': 0.8053212199870214, 'fit_time_seconds': 0.2517659664154053, 'cpu_percent_fit': 24.3875, 'ram_mb_fit': 0.72265625, 'accumulated_train_samples_this_round': 158}
2025-08-04 20:41:27,089 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:41:32,356 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:32,356 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:41:32,356 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:41:32,356 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:41:32,357 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:41:32,357 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:32,625 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:32,625 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:32,713 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:41:32,750 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:41:32,750 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:32,865 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:32,872 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:32,872 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:32,878 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:41:32,884 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:32,884 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:41:32,885 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:32,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:32,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:41:32,893 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:32,896 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:32,899 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:32,901 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:32,903 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:32,905 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:32,908 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:32,910 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:32,913 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:32,915 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:32,917 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:32,927 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:32,927 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:41:32,932 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:41:32,932 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:41:32,937 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:32,937 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:41:32,945 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:32,946 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:41:32,946 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:32,961 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:32,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:41:32,970 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:41:32,970 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:32,970 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:32,971 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:32,971 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:32,971 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:32,971 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:41:32,972 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:32,972 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:41:32,972 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:32,974 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:41:32,974 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:41:32,974 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:32,974 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:41:32,974 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:32,975 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:32,975 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:32,975 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:41:32,975 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:41:32,975 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:41:32,975 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:41:32,975 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:41:32,975 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:41:32,976 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:41:32,976 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:41:32,976 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:41:32,976 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:41:32,977 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:41:32,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:41:32,977 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:32,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:41:32,977 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:32,978 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:32,978 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:32,978 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:41:32,978 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:41:32,978 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:41:32,979 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:41:32,982 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:41:32,982 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:32,983 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:32,984 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:41:32,985 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:32,985 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:32,985 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:32,986 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:33,018 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4405, Threshold=0.4996, Accuracy=0.7211, F1=0.8053, Precision=0.9620, Recall=0.6925
2025-08-04 20:41:33,018 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7211, F1: 0.8053, Prec: 0.9620, Rec: 0.6925, Avg Anomaly Score: 0.4405
2025-08-04 20:41:38,310 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:38,310 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:41:38,310 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:41:38,311 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:41:38,311 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:41:38,311 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:38,572 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:38,572 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:38,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:41:38,690 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:41:38,690 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:38,772 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:38,777 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:38,777 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:38,782 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:41:38,789 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:38,789 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:41:38,790 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:38,790 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:38,790 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:41:38,798 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:38,800 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:38,803 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:38,805 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:38,808 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:38,810 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:38,812 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:38,815 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:38,818 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:38,819 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:38,822 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:38,831 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:38,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:41:38,835 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:41:38,835 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:41:38,840 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:38,840 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:41:38,849 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:38,850 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:41:38,850 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:38,864 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:38,868 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:41:38,874 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:41:38,874 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:38,874 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:38,874 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:38,874 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:38,874 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:38,875 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:41:38,875 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:38,875 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:41:38,875 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:38,876 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:41:38,876 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:41:38,877 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:38,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:41:38,877 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:38,877 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:38,877 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:38,877 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:41:38,878 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:41:38,878 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:41:38,878 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:41:38,878 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:41:38,878 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:41:38,878 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:41:38,878 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:41:38,878 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:41:38,879 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:41:38,879 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:41:38,879 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:41:38,879 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:38,879 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:41:38,879 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:38,880 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:38,880 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:38,880 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:41:38,880 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:41:38,880 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:41:38,881 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:41:38,882 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:41:38,882 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:38,884 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:38,884 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:41:38,886 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 91/400.
2025-08-04 20:41:38,987 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:38,987 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:38,995 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 36 anomalous samples to GAN training data (target: 36).
2025-08-04 20:41:38,997 - ClientAppLogger [Client 7] - INFO - [Client] Round 91: Training GAN with 159 samples (123 normal, 36 anomalous).
2025-08-04 20:41:38,997 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:39,139 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0841, Avg D Loss: 0.8392
2025-08-04 20:41:39,139 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0841, Avg D Loss: 0.8392
2025-08-04 20:41:39,140 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:39,170 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4063, Threshold=0.4450, Accuracy=0.7220, F1=0.8060, Precision=0.9628, Recall=0.6931
2025-08-04 20:41:39,171 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8060
2025-08-04 20:41:39,171 - ClientAppLogger [Client 7] - INFO - Fit completed for round 91. Duration: 0.29s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 91, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0840762135367727, 'd_loss': 0.8391579059309929, 'post_fit_local_f1': 0.8059701492537313, 'fit_time_seconds': 0.2851378917694092, 'cpu_percent_fit': 22.1, 'ram_mb_fit': 14.6328125, 'accumulated_train_samples_this_round': 159}
2025-08-04 20:41:39,171 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:41:47,436 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:47,439 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:41:47,441 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:41:47,441 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:41:47,441 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:41:47,442 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:47,722 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:47,723 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:47,810 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:41:47,850 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:41:47,851 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:47,967 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:47,974 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:47,975 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:47,982 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:41:47,990 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:47,990 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:41:47,991 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:47,991 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:47,991 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:41:48,000 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:48,003 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:48,005 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:48,007 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:48,010 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:48,012 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:48,015 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:48,017 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:48,020 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:48,022 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:48,024 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:48,034 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:48,034 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:41:48,039 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:41:48,039 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:41:48,044 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:48,044 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:41:48,055 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:48,056 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:41:48,056 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:48,071 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:48,076 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:41:48,081 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:41:48,081 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:48,081 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:48,081 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:48,082 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:48,082 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:48,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:41:48,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:48,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:41:48,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:48,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:41:48,085 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:41:48,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:48,085 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:41:48,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:48,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:48,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:48,086 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:41:48,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:41:48,086 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:41:48,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:41:48,086 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:41:48,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:41:48,087 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:41:48,087 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:41:48,087 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:41:48,088 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:41:48,088 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:41:48,088 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:41:48,088 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:48,088 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:41:48,088 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:48,089 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:48,089 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:48,089 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:41:48,089 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:41:48,089 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:41:48,089 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:41:48,093 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:41:48,093 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:48,094 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:48,094 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:41:48,095 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:48,095 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:48,096 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:48,096 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:48,127 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4303, Threshold=0.4959, Accuracy=0.7220, F1=0.8060, Precision=0.9628, Recall=0.6931
2025-08-04 20:41:48,127 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7220, F1: 0.8060, Prec: 0.9628, Rec: 0.6931, Avg Anomaly Score: 0.4303
2025-08-04 20:42:02,405 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:02,405 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:42:02,405 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:42:02,406 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:42:02,406 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:42:02,406 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:02,662 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:02,662 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:02,745 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:42:02,759 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:42:02,760 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:02,860 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:02,865 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:02,866 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:02,871 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:42:02,876 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:02,876 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:42:02,877 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:02,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:02,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:42:02,885 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:02,888 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:02,890 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:02,892 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:02,895 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:02,897 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:02,899 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:02,902 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:02,905 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:02,906 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:02,909 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:02,919 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:02,919 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:42:02,925 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:42:02,925 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:42:02,931 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:02,931 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:42:02,944 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:02,944 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:42:02,944 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:02,960 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:02,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:42:02,970 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:42:02,971 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:02,971 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:02,971 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:02,971 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:02,972 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:02,972 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:42:02,972 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:02,972 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:42:02,972 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:02,974 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:42:02,974 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:42:02,974 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:02,974 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:42:02,974 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:02,974 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:02,975 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:02,975 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:42:02,975 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:42:02,975 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:42:02,975 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:42:02,975 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:42:02,975 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:42:02,976 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:42:02,976 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:42:02,976 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:42:02,976 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:42:02,976 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:42:02,976 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:42:02,977 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:02,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:42:02,977 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:02,978 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:02,978 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:02,978 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:42:02,978 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:42:02,978 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:42:02,978 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:42:02,981 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:42:02,982 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:02,983 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:02,983 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:42:02,985 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:02,985 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:02,985 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:02,986 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:03,019 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3946, Threshold=0.4456, Accuracy=0.7211, F1=0.8053, Precision=0.9620, Recall=0.6925
2025-08-04 20:42:03,019 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7211, F1: 0.8053, Prec: 0.9620, Rec: 0.6925, Avg Anomaly Score: 0.3946
2025-08-04 20:42:20,283 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:20,283 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:42:20,283 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:42:20,283 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:42:20,283 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:42:20,283 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:20,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:20,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:20,684 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:42:20,730 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:42:20,730 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:20,869 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:20,876 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:20,877 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:20,884 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:42:20,894 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:20,894 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:42:20,895 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:20,895 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:20,895 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:42:20,909 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:20,913 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:20,917 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:20,920 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:20,923 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:20,925 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:20,928 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:20,931 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:20,934 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:20,936 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:20,939 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:20,952 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:20,952 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:42:20,957 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:42:20,958 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:42:20,963 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:20,963 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:42:20,973 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:20,973 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:42:20,974 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:20,989 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:20,993 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:42:20,998 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:42:20,998 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:20,998 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:20,999 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:20,999 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:20,999 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:20,999 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:42:21,000 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:21,000 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:42:21,000 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:21,001 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:42:21,001 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:42:21,002 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:21,002 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:42:21,002 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:21,002 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:21,002 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:21,002 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:42:21,002 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:42:21,002 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:42:21,003 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:42:21,003 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:42:21,003 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:42:21,003 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:42:21,003 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:42:21,004 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:42:21,004 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:42:21,004 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:42:21,004 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:42:21,004 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:21,005 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:42:21,005 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:21,005 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:21,005 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:21,006 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:42:21,006 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:42:21,006 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:42:21,006 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:42:21,011 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:42:21,011 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:21,012 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:21,012 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:42:21,014 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:21,014 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:21,014 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:21,015 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:21,047 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4122, Threshold=0.4527, Accuracy=0.7220, F1=0.8060, Precision=0.9628, Recall=0.6931
2025-08-04 20:42:21,047 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7220, F1: 0.8060, Prec: 0.9628, Rec: 0.6931, Avg Anomaly Score: 0.4122
2025-08-04 20:42:35,315 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:35,315 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:42:35,316 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:42:35,316 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:42:35,316 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:42:35,316 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:35,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:35,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:35,679 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:42:35,694 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:42:35,694 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:35,783 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:35,790 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:35,790 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:35,795 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:42:35,802 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:35,802 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:42:35,802 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:35,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:35,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:42:35,812 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:35,814 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:35,817 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:35,819 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:35,822 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:35,824 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:35,827 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:35,829 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:35,832 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:35,834 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:35,836 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:35,848 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:35,848 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:42:35,853 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:42:35,853 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:42:35,861 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:35,861 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:42:35,875 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:35,875 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:42:35,875 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:35,890 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:35,896 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:42:35,904 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:42:35,904 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:35,904 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:35,904 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:35,905 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:35,905 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:35,906 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:42:35,906 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:35,906 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:42:35,906 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:35,907 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:42:35,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:42:35,908 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:35,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:42:35,908 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:35,908 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:35,908 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:35,909 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:42:35,909 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:42:35,909 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:42:35,909 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:42:35,909 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:42:35,909 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:42:35,910 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:42:35,910 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:42:35,910 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:42:35,910 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:42:35,911 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:42:35,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:42:35,911 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:35,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:42:35,911 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:35,912 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:35,915 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:35,916 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:42:35,916 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:42:35,916 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:42:35,916 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:42:35,918 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:42:35,918 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:35,920 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:35,920 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:42:35,922 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:35,922 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:35,922 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:35,923 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:35,957 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3892, Threshold=0.4210, Accuracy=0.7220, F1=0.8060, Precision=0.9628, Recall=0.6931
2025-08-04 20:42:35,958 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7220, F1: 0.8060, Prec: 0.9628, Rec: 0.6931, Avg Anomaly Score: 0.3892
2025-08-04 20:42:56,234 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:56,234 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:42:56,234 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:42:56,235 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:42:56,235 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:42:56,235 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:56,646 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:56,646 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:56,740 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:42:56,786 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:42:56,786 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:56,938 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:56,947 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:56,947 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:56,956 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:42:56,967 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:56,968 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:42:56,968 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:56,968 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:56,969 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:42:56,981 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:56,984 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:56,987 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:56,989 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:56,993 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:56,996 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:56,999 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:57,002 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:57,005 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:57,007 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:57,010 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:57,022 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:57,023 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:42:57,029 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:42:57,029 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:42:57,034 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:57,034 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:42:57,044 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:57,045 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:42:57,045 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:57,064 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:57,069 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:42:57,077 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:42:57,077 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:57,078 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:57,078 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:57,078 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:57,078 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:57,079 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:42:57,079 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:57,079 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:42:57,079 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:57,080 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:42:57,081 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:42:57,081 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:57,081 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:42:57,081 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:57,081 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:57,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:57,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:42:57,082 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:42:57,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:42:57,082 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:42:57,082 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:42:57,082 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:42:57,083 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:42:57,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:42:57,084 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:42:57,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:42:57,084 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:42:57,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:42:57,084 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:57,084 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:42:57,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:57,085 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:57,088 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:57,089 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:42:57,089 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:42:57,089 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:42:57,089 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:42:57,094 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:42:57,094 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:57,096 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:57,096 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:42:57,097 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:57,097 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:57,098 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:57,099 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:57,142 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4083, Threshold=0.4318, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:42:57,142 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7229, F1: 0.8066, Prec: 0.9636, Rec: 0.6936, Avg Anomaly Score: 0.4083
2025-08-04 20:43:08,399 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:08,399 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:43:08,400 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:43:08,400 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:43:08,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:43:08,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:08,775 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:08,777 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:08,864 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:43:08,881 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:43:08,881 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:08,980 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:08,987 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:08,987 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:08,992 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:43:08,999 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:08,999 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:43:09,000 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:09,000 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:09,000 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:43:09,009 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:09,013 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:09,015 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:09,017 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:09,020 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:09,022 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:09,028 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:09,031 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:09,034 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:09,036 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:09,038 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:09,052 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:09,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:43:09,058 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:43:09,058 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:43:09,069 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:09,069 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:43:09,091 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:09,091 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:43:09,092 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:09,114 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:09,121 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:43:09,130 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:43:09,131 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:09,131 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:09,131 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:09,132 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:09,132 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:09,132 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:43:09,132 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:09,133 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:43:09,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:09,134 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:43:09,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:43:09,135 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:09,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:43:09,135 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:09,135 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:09,136 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:09,136 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:43:09,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:43:09,136 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:43:09,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:43:09,137 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:43:09,137 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:43:09,137 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:43:09,137 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:43:09,138 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:43:09,138 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:43:09,138 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:43:09,138 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:43:09,138 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:09,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:43:09,139 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:09,139 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:09,140 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:09,140 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:43:09,140 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:43:09,140 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:43:09,140 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:43:09,146 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:43:09,146 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:09,148 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:09,148 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:43:09,150 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:09,150 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:09,150 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:09,151 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:09,192 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4423, Threshold=0.4727, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:43:09,192 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7229, F1: 0.8066, Prec: 0.9636, Rec: 0.6936, Avg Anomaly Score: 0.4423
2025-08-04 20:43:14,444 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:14,444 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:43:14,444 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:43:14,445 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:43:14,445 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:43:14,445 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:14,718 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:14,718 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:14,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:43:14,852 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:43:14,852 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:14,970 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:14,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:14,978 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:14,984 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:43:14,991 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:14,991 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:43:14,992 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:14,992 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:14,992 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:43:15,001 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:15,004 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:15,006 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:15,008 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:15,011 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:15,013 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:15,016 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:15,018 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:15,022 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:15,024 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:15,026 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:15,036 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:15,036 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:43:15,041 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:43:15,041 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:43:15,046 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:15,046 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:43:15,057 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:15,057 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:43:15,057 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:15,074 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:15,079 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:43:15,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:43:15,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:15,086 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:15,086 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:15,087 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:15,087 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:15,087 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:43:15,087 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:15,087 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:43:15,088 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:15,089 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:43:15,089 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:43:15,090 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:15,090 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:43:15,090 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:15,090 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:15,090 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:15,091 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:43:15,091 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:43:15,091 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:43:15,091 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:43:15,091 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:43:15,092 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:43:15,092 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:43:15,092 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:43:15,093 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:43:15,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:43:15,093 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:43:15,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:43:15,093 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:15,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:43:15,094 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:15,094 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:15,094 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:15,094 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:43:15,095 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:43:15,095 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:43:15,095 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:43:15,098 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:43:15,099 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:15,100 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:15,100 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:43:15,102 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 97/400.
2025-08-04 20:43:15,204 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:15,204 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:15,206 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 39 anomalous samples to GAN training data (target: 39).
2025-08-04 20:43:15,206 - ClientAppLogger [Client 7] - INFO - [Client] Round 97: Training GAN with 172 samples (133 normal, 39 anomalous).
2025-08-04 20:43:15,206 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:15,364 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0836, Avg D Loss: 0.8324
2025-08-04 20:43:15,365 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0836, Avg D Loss: 0.8324
2025-08-04 20:43:15,365 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:15,401 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4230, Threshold=0.4331, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:43:15,402 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8066
2025-08-04 20:43:15,402 - ClientAppLogger [Client 7] - INFO - Fit completed for round 97. Duration: 0.30s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 97, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083557531999987, 'd_loss': 0.8324067850445592, 'post_fit_local_f1': 0.8066190785204412, 'fit_time_seconds': 0.2995891571044922, 'cpu_percent_fit': 24.5875, 'ram_mb_fit': 6.6171875, 'accumulated_train_samples_this_round': 172}
2025-08-04 20:43:15,402 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:43:23,654 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:23,654 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:43:23,654 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:43:23,654 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:43:23,654 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:43:23,654 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:23,948 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:23,950 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:24,034 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:43:24,049 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:43:24,049 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:24,152 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:24,159 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:24,159 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:24,165 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:43:24,172 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:24,173 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:43:24,173 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:24,173 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:24,174 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:43:24,184 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:24,187 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:24,189 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:24,191 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:24,194 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:24,197 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:24,199 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:24,202 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:24,205 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:24,207 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:24,209 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:24,221 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:24,221 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:43:24,226 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:43:24,226 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:43:24,234 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:24,234 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:43:24,250 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:24,250 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:43:24,250 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:24,266 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:24,271 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:43:24,276 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:43:24,276 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:24,277 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:24,277 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:24,277 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:24,277 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:24,278 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:43:24,278 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:24,278 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:43:24,278 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:24,280 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:43:24,280 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:43:24,280 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:24,280 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:43:24,280 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:24,281 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:24,281 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:24,281 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:43:24,281 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:43:24,281 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:43:24,281 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:43:24,281 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:43:24,282 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:43:24,282 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:43:24,282 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:43:24,282 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:43:24,282 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:43:24,283 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:43:24,283 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:43:24,283 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:24,283 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:43:24,283 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:24,284 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:24,284 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:24,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:43:24,284 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:43:24,284 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:43:24,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:43:24,287 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:43:24,287 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:24,289 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:24,289 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:43:24,291 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:24,292 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:24,292 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:24,293 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:24,331 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4143, Threshold=0.4379, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:43:24,331 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7229, F1: 0.8066, Prec: 0.9636, Rec: 0.6936, Avg Anomaly Score: 0.4143
2025-08-04 20:43:29,586 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:29,586 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:43:29,586 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:43:29,586 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:43:29,586 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:43:29,587 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:29,894 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:29,896 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:29,984 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:43:30,025 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:43:30,025 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:30,186 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:30,193 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:30,193 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:30,199 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:43:30,205 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:30,206 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:43:30,206 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:30,206 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:30,206 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:43:30,215 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:30,223 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:30,225 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:30,227 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:30,231 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:30,233 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:30,236 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:30,238 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:30,241 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:30,243 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:30,246 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:30,257 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:30,258 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:43:30,262 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:43:30,263 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:43:30,270 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:30,270 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:43:30,281 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:30,281 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:43:30,281 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:30,298 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:30,303 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:43:30,309 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:43:30,309 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:30,309 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:30,309 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:30,309 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:30,310 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:30,310 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:43:30,310 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:30,310 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:43:30,310 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:30,312 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:43:30,312 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:43:30,312 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:30,312 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:43:30,312 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:30,312 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:30,313 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:30,313 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:43:30,313 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:43:30,313 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:43:30,313 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:43:30,313 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:43:30,313 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:43:30,314 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:43:30,314 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:43:30,314 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:43:30,314 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:43:30,314 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:43:30,314 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:43:30,315 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:30,315 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:43:30,315 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:30,316 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:30,316 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:30,316 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:43:30,316 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:43:30,316 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:43:30,317 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:43:30,323 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:43:30,323 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:30,324 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:30,325 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:43:30,326 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 98/400.
2025-08-04 20:43:30,428 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:30,428 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:30,429 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 40 anomalous samples to GAN training data (target: 40).
2025-08-04 20:43:30,430 - ClientAppLogger [Client 7] - INFO - [Client] Round 98: Training GAN with 175 samples (135 normal, 40 anomalous).
2025-08-04 20:43:30,430 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:30,578 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0851, Avg D Loss: 0.8247
2025-08-04 20:43:30,578 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0851, Avg D Loss: 0.8247
2025-08-04 20:43:30,579 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:30,611 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4073, Threshold=0.4188, Accuracy=0.7238, F1=0.8073, Precision=0.9643, Recall=0.6942
2025-08-04 20:43:30,611 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8073
2025-08-04 20:43:30,612 - ClientAppLogger [Client 7] - INFO - Fit completed for round 98. Duration: 0.29s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 98, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0850813451494488, 'd_loss': 0.8246620130879538, 'post_fit_local_f1': 0.8072680077871512, 'fit_time_seconds': 0.2854616641998291, 'cpu_percent_fit': 24.76875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 175}
2025-08-04 20:43:30,612 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:43:41,876 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:41,876 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:43:41,877 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:43:41,877 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:43:41,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:43:41,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:42,130 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:42,130 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:42,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:43:42,247 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:43:42,247 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:42,386 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:42,394 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:42,394 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:42,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:43:42,421 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:42,421 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:43:42,422 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:42,422 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:42,422 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:43:42,431 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:42,435 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:42,437 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:42,439 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:42,442 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:42,444 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:42,447 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:42,449 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:42,452 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:42,454 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:42,457 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:42,467 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:42,467 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:43:42,472 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:43:42,472 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:43:42,479 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:42,479 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:43:42,493 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:42,497 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:43:42,497 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:42,514 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:42,519 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:43:42,525 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:43:42,525 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:42,525 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:42,525 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:42,526 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:42,526 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:42,526 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:43:42,526 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:42,527 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:43:42,527 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:42,528 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:43:42,528 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:43:42,529 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:42,529 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:43:42,529 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:42,529 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:42,529 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:42,530 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:43:42,530 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:43:42,530 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:43:42,530 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:43:42,530 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:43:42,530 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:43:42,531 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:43:42,531 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:43:42,531 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:43:42,531 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:43:42,532 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:43:42,532 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:43:42,532 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:42,532 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:43:42,532 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:42,533 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:42,533 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:42,533 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:43:42,533 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:43:42,533 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:43:42,534 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:43:42,541 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:43:42,541 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:42,543 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:42,543 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:43:42,544 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:42,544 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:42,545 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:42,545 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:42,582 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4510, Threshold=0.4735, Accuracy=0.7220, F1=0.8060, Precision=0.9628, Recall=0.6931
2025-08-04 20:43:42,583 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7220, F1: 0.8060, Prec: 0.9628, Rec: 0.6931, Avg Anomaly Score: 0.4510
2025-08-04 20:43:47,830 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:47,830 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:43:47,830 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:43:47,831 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:43:47,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:43:47,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:48,100 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:48,100 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:48,194 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:43:48,236 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:43:48,236 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:48,403 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:48,409 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:48,409 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:48,417 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:43:48,425 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:48,425 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:43:48,425 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:48,426 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:48,426 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:43:48,435 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:48,438 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:48,441 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:48,443 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:48,446 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:48,448 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:48,450 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:48,453 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:48,456 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:48,458 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:48,460 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:48,471 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:48,471 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:43:48,476 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:43:48,476 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:43:48,482 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:48,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:43:48,496 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:48,497 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:43:48,497 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:48,513 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:48,519 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:43:48,526 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:43:48,526 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:48,526 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:48,526 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:48,527 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:48,527 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:48,527 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:43:48,527 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:48,527 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:43:48,527 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:48,529 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:43:48,529 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:43:48,529 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:48,529 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:43:48,529 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:48,530 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:48,530 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:48,530 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:43:48,530 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:43:48,530 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:43:48,530 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:43:48,530 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:43:48,531 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:43:48,531 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:43:48,531 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:43:48,531 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:43:48,531 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:43:48,532 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:43:48,532 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:43:48,532 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:48,532 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:43:48,533 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:48,533 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:48,533 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:48,533 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:43:48,534 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:43:48,534 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:43:48,534 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:43:48,538 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:43:48,539 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:48,540 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:48,540 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:43:48,542 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 99/400.
2025-08-04 20:43:48,643 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:48,643 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:48,644 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 41 anomalous samples to GAN training data (target: 41).
2025-08-04 20:43:48,645 - ClientAppLogger [Client 7] - INFO - [Client] Round 99: Training GAN with 179 samples (138 normal, 41 anomalous).
2025-08-04 20:43:48,645 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:48,793 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0833, Avg D Loss: 0.8179
2025-08-04 20:43:48,793 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0833, Avg D Loss: 0.8179
2025-08-04 20:43:48,793 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:48,829 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4356, Threshold=0.4454, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:43:48,830 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8066
2025-08-04 20:43:48,830 - ClientAppLogger [Client 7] - INFO - Fit completed for round 99. Duration: 0.29s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 99, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0832546416607647, 'd_loss': 0.8178851730996671, 'post_fit_local_f1': 0.8066190785204412, 'fit_time_seconds': 0.28800153732299805, 'cpu_percent_fit': 24.675, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 179}
2025-08-04 20:43:48,830 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:43:57,099 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:57,100 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:43:57,100 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:43:57,100 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:43:57,100 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:43:57,100 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:57,383 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:57,383 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:57,471 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:43:57,487 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:43:57,487 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:57,581 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:57,588 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:57,588 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:57,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:43:57,600 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:57,600 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:43:57,601 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:57,601 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:57,601 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:43:57,610 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:57,613 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:57,616 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:57,618 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:57,621 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:57,623 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:57,626 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:57,628 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:57,631 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:57,632 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:57,635 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:57,645 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:57,645 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:43:57,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:43:57,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:43:57,658 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:57,658 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:43:57,671 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:57,671 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:43:57,671 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:57,688 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:57,693 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:43:57,699 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:43:57,699 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:57,699 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:57,699 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:57,700 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:57,700 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:57,700 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:43:57,700 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:57,700 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:43:57,701 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:57,702 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:43:57,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:43:57,702 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:57,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:43:57,703 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:57,703 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:57,703 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:57,703 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:43:57,703 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:43:57,703 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:43:57,703 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:43:57,704 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:43:57,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:43:57,704 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:43:57,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:43:57,704 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:43:57,705 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:43:57,705 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:43:57,705 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:43:57,705 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:57,705 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:43:57,706 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:57,706 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:57,706 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:57,706 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:43:57,706 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:43:57,707 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:43:57,707 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:43:57,709 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:43:57,709 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:57,710 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:57,710 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:43:57,712 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:57,712 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:57,712 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:57,713 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:57,745 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3885, Threshold=0.3907, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:43:57,745 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7229, F1: 0.8066, Prec: 0.9636, Rec: 0.6936, Avg Anomaly Score: 0.3885
2025-08-04 20:44:09,006 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:09,006 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:44:09,006 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:44:09,006 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:44:09,006 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:44:09,007 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:09,280 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:09,280 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:09,372 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:44:09,413 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:44:09,413 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:09,542 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:09,550 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:09,550 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:09,558 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:44:09,565 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:09,565 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:44:09,566 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:09,566 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:09,566 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:44:09,574 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:09,578 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:09,580 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:09,582 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:09,585 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:09,587 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:09,590 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:09,592 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:09,595 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:09,597 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:09,600 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:09,610 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:09,610 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:44:09,615 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:44:09,615 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:44:09,619 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:09,620 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:44:09,629 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:09,630 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:44:09,630 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:09,646 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:09,652 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:44:09,658 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:44:09,658 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:09,658 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:09,658 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:09,658 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:09,659 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:09,659 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:44:09,659 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:09,659 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:44:09,660 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:09,661 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:44:09,661 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:44:09,662 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:09,662 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:44:09,662 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:09,662 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:09,662 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:09,662 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:44:09,662 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:44:09,662 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:44:09,663 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:44:09,663 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:44:09,663 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:44:09,663 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:44:09,663 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:44:09,664 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:44:09,664 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:44:09,664 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:44:09,664 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:44:09,664 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:09,664 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:44:09,665 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:09,665 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:09,669 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:09,669 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:44:09,669 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:44:09,669 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:44:09,669 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:44:09,672 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:44:09,672 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:09,674 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:09,674 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:44:09,676 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:09,676 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:09,676 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:09,677 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:09,709 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4109, Threshold=0.4164, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:44:09,709 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7229, F1: 0.8066, Prec: 0.9636, Rec: 0.6936, Avg Anomaly Score: 0.4109
2025-08-04 20:44:29,988 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:29,988 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:44:29,988 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:44:29,988 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:44:29,989 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:44:29,989 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:30,239 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:30,242 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:30,326 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:44:30,352 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:44:30,353 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:30,452 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:30,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:30,458 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:30,464 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:44:30,474 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:30,475 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:44:30,475 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:30,475 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:30,476 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:44:30,484 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:30,487 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:30,489 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:30,491 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:30,494 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:30,496 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:30,499 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:30,501 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:30,504 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:30,506 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:30,509 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:30,522 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:30,522 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:44:30,526 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:44:30,527 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:44:30,533 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:30,533 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:44:30,543 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:30,544 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:44:30,544 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:30,563 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:30,568 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:44:30,574 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:44:30,574 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:30,574 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:30,574 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:30,574 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:30,574 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:30,575 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:44:30,575 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:30,575 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:44:30,575 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:30,577 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:44:30,577 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:44:30,577 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:30,577 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:44:30,577 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:30,577 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:30,578 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:30,578 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:44:30,578 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:44:30,578 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:44:30,578 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:44:30,578 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:44:30,579 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:44:30,579 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:44:30,579 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:44:30,579 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:44:30,580 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:44:30,580 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:44:30,580 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:44:30,580 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:30,580 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:44:30,581 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:30,581 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:30,581 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:30,581 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:44:30,581 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:44:30,582 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:44:30,582 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:44:30,587 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:44:30,587 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:30,589 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:30,589 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:44:30,590 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:30,591 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:30,591 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:30,592 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:30,629 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4220, Threshold=0.4257, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:44:30,630 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7229, F1: 0.8066, Prec: 0.9636, Rec: 0.6936, Avg Anomaly Score: 0.4220
2025-08-04 20:44:50,922 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:50,922 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:44:50,922 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:44:50,922 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:44:50,922 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:44:50,923 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:51,312 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:51,312 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:51,417 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:44:51,462 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:44:51,462 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:51,595 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:51,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:51,604 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:51,610 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:44:51,618 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:51,618 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:44:51,619 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:51,619 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:51,619 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:44:51,630 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:51,633 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:51,635 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:51,637 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:51,640 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:51,642 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:51,644 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:51,647 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:51,650 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:51,652 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:51,654 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:51,665 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:51,665 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:44:51,670 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:44:51,670 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:44:51,675 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:51,675 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:44:51,687 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:51,687 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:44:51,687 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:51,704 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:51,710 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:44:51,720 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:44:51,720 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:51,720 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:51,720 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:51,721 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:51,721 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:51,721 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:44:51,721 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:51,721 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:44:51,721 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:51,723 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:44:51,723 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:44:51,723 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:51,724 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:44:51,724 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:51,724 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:51,724 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:51,724 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:44:51,724 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:44:51,725 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:44:51,725 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:44:51,725 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:44:51,725 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:44:51,725 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:44:51,725 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:44:51,726 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:44:51,726 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:44:51,726 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:44:51,726 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:44:51,726 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:51,727 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:44:51,727 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:51,727 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:51,731 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:51,731 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:44:51,731 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:44:51,731 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:44:51,731 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:44:51,736 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:44:51,736 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:51,741 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:51,742 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:44:51,744 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:51,744 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:51,744 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:51,745 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:51,790 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4433, Threshold=0.4545, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:44:51,791 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7229, F1: 0.8066, Prec: 0.9636, Rec: 0.6936, Avg Anomaly Score: 0.4433
2025-08-04 20:45:12,085 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:12,086 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:45:12,086 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:45:12,086 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:45:12,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:45:12,087 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:12,419 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:12,419 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:12,506 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:45:12,522 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:45:12,523 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:12,623 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:12,633 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:12,634 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:12,644 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:45:12,651 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:12,652 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:45:12,653 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:12,653 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:12,653 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:45:12,663 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:12,665 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:12,668 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:12,670 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:12,672 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:12,675 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:12,679 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:12,682 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:12,684 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:12,686 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:12,689 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:12,698 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:12,699 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:45:12,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:45:12,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:45:12,711 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:12,712 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:45:12,725 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:12,726 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:45:12,726 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:12,742 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:12,747 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:45:12,753 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:45:12,753 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:12,753 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:12,753 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:12,753 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:12,754 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:12,754 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:45:12,754 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:12,754 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:45:12,754 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:12,756 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:45:12,756 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:45:12,756 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:12,756 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:45:12,756 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:12,756 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:12,757 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:12,757 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:45:12,757 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:45:12,757 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:45:12,758 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:45:12,758 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:45:12,759 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:45:12,759 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:45:12,760 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:45:12,760 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:45:12,760 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:45:12,761 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:45:12,761 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:45:12,761 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:12,761 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:45:12,761 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:12,762 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:12,765 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:12,765 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:45:12,765 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:45:12,766 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:45:12,766 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:45:12,768 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:45:12,768 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:12,770 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:12,770 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:45:12,771 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:12,771 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:12,771 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:12,772 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:12,807 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4609, Threshold=0.4885, Accuracy=0.7285, F1=0.8105, Precision=0.9682, Recall=0.6970
2025-08-04 20:45:12,808 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7285, F1: 0.8105, Prec: 0.9682, Rec: 0.6970, Avg Anomaly Score: 0.4609
2025-08-04 20:45:33,099 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:33,099 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:45:33,099 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:45:33,099 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:45:33,099 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:45:33,100 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:33,407 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:33,407 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:33,499 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:45:33,521 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:45:33,523 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:33,685 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:33,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:33,696 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:33,706 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:45:33,714 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:33,714 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:45:33,715 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:33,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:33,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:45:33,727 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:33,731 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:33,735 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:33,737 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:33,742 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:33,745 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:33,748 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:33,752 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:33,757 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:33,759 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:33,761 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:33,771 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:33,773 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:45:33,778 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:45:33,778 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:45:33,783 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:33,783 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:45:33,792 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:33,795 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:45:33,795 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:33,813 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:33,817 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:45:33,823 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:45:33,823 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:33,823 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:33,823 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:33,823 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:33,824 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:33,824 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:45:33,824 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:33,824 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:45:33,824 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:33,826 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:45:33,826 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:45:33,826 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:33,827 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:45:33,827 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:33,827 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:33,827 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:33,827 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:45:33,827 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:45:33,828 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:45:33,828 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:45:33,828 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:45:33,828 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:45:33,828 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:45:33,828 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:45:33,829 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:45:33,829 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:45:33,829 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:45:33,829 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:45:33,829 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:33,829 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:45:33,829 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:33,830 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:33,833 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:33,833 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:45:33,834 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:45:33,834 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:45:33,834 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:45:33,839 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:45:33,840 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:33,841 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:33,841 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:45:33,842 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:33,843 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:33,843 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:33,843 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:33,875 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4937, Threshold=0.5209, Accuracy=0.7220, F1=0.8060, Precision=0.9628, Recall=0.6931
2025-08-04 20:45:33,875 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7220, F1: 0.8060, Prec: 0.9628, Rec: 0.6931, Avg Anomaly Score: 0.4937
2025-08-04 20:45:39,138 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:39,138 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:45:39,138 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:45:39,139 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:45:39,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:45:39,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:39,465 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:39,465 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:39,557 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:45:39,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:45:39,596 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:39,706 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:39,715 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:39,716 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:39,728 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:45:39,754 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:39,754 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:45:39,754 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:39,755 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:39,755 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:45:39,765 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:39,769 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:39,771 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:39,774 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:39,777 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:39,780 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:39,784 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:39,787 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:39,791 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:39,794 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:39,798 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:39,808 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:39,808 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:45:39,813 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:45:39,813 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:45:39,819 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:39,820 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:45:39,832 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:39,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:45:39,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:39,848 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:39,853 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:45:39,859 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:45:39,859 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:39,859 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:39,859 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:39,859 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:39,860 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:39,860 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:45:39,860 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:39,860 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:45:39,860 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:39,862 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:45:39,862 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:45:39,863 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:39,863 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:45:39,863 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:39,863 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:39,863 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:39,864 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:45:39,864 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:45:39,864 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:45:39,864 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:45:39,864 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:45:39,864 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:45:39,864 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:45:39,865 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:45:39,865 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:45:39,865 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:45:39,865 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:45:39,865 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:45:39,865 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:39,866 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:45:39,866 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:39,866 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:39,869 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:39,869 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:45:39,869 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:45:39,870 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:45:39,870 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:45:39,879 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:45:39,879 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:39,880 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:39,880 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:45:39,882 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 105/400.
2025-08-04 20:45:39,983 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:39,983 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:39,985 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 44 anomalous samples to GAN training data (target: 44).
2025-08-04 20:45:39,985 - ClientAppLogger [Client 7] - INFO - [Client] Round 105: Training GAN with 193 samples (149 normal, 44 anomalous).
2025-08-04 20:45:39,989 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:40,186 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0898, Avg D Loss: 0.8085
2025-08-04 20:45:40,186 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0898, Avg D Loss: 0.8085
2025-08-04 20:45:40,186 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:40,217 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.3731, Threshold=0.3839, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:45:40,217 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:45:40,218 - ClientAppLogger [Client 7] - INFO - Fit completed for round 105. Duration: 0.34s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 105, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.089787375371073, 'd_loss': 0.8084826141132592, 'post_fit_local_f1': 0.8124594419208306, 'fit_time_seconds': 0.3356935977935791, 'cpu_percent_fit': 24.51875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 193}
2025-08-04 20:45:40,218 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:45:45,479 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:45,479 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:45:45,479 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:45:45,479 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:45:45,479 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:45:45,479 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:45,872 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:45,872 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:45,967 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:45:45,998 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:45:45,998 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:46,158 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:46,168 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:46,168 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:46,179 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:45:46,193 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:46,193 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:45:46,194 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:46,195 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:46,195 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:45:46,205 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:46,209 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:46,211 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:46,214 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:46,217 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:46,219 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:46,222 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:46,225 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:46,229 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:46,231 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:46,235 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:46,249 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:46,249 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:45:46,255 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:45:46,255 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:45:46,261 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:46,261 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:45:46,279 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:46,279 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:45:46,279 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:46,299 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:46,305 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:45:46,313 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:45:46,313 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:46,314 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:46,314 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:46,314 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:46,315 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:46,315 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:45:46,315 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:46,316 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:45:46,316 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:46,317 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:45:46,318 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:45:46,318 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:46,318 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:45:46,319 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:46,319 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:46,319 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:46,320 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:45:46,320 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:45:46,320 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:45:46,320 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:45:46,321 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:45:46,321 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:45:46,321 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:45:46,322 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:45:46,322 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:45:46,322 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:45:46,323 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:45:46,323 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:45:46,323 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:46,323 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:45:46,324 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:46,324 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:46,327 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:46,327 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:45:46,328 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:45:46,329 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:45:46,329 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:45:46,338 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:45:46,338 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:46,340 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:46,340 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:45:46,343 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:46,343 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:46,343 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:46,344 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:46,383 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5065, Threshold=0.5630, Accuracy=0.7220, F1=0.8060, Precision=0.9628, Recall=0.6931
2025-08-04 20:45:46,384 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7220, F1: 0.8060, Prec: 0.9628, Rec: 0.6931, Avg Anomaly Score: 0.5065
2025-08-04 20:45:57,655 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:57,655 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:45:57,655 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:45:57,655 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:45:57,655 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:45:57,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:57,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:57,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:58,070 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:45:58,118 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:45:58,118 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:58,270 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:58,279 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:58,279 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:58,286 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:45:58,292 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:58,292 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:45:58,293 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:58,293 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:58,293 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:45:58,303 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:58,307 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:58,310 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:58,312 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:58,316 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:58,319 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:58,321 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:58,324 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:58,327 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:58,329 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:58,331 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:58,343 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:58,343 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:45:58,348 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:45:58,348 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:45:58,354 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:58,354 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:45:58,366 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:58,366 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:45:58,367 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:58,385 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:58,390 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:45:58,396 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:45:58,397 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:58,397 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:58,397 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:58,397 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:58,398 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:58,398 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:45:58,398 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:58,398 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:45:58,398 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:58,400 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:45:58,400 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:45:58,401 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:58,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:45:58,401 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:58,401 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:58,401 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:58,401 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:45:58,402 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:45:58,402 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:45:58,402 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:45:58,402 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:45:58,402 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:45:58,403 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:45:58,403 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:45:58,403 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:45:58,403 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:45:58,404 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:45:58,404 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:45:58,404 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:58,404 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:45:58,404 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:58,405 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:58,408 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:58,409 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:45:58,409 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:45:58,409 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:45:58,409 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:45:58,413 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:45:58,413 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:58,415 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:58,415 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:45:58,416 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:58,416 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:58,416 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:58,417 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:58,452 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4615, Threshold=0.4975, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 20:45:58,452 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7322, F1: 0.8131, Prec: 0.9713, Rec: 0.6992, Avg Anomaly Score: 0.4615
2025-08-04 20:46:12,724 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:12,724 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:46:12,725 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:46:12,725 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:46:12,725 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:46:12,725 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:13,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:13,134 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:13,235 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:46:13,293 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:46:13,293 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:13,441 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:13,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:13,451 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:13,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:46:13,467 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:13,467 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:46:13,468 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:13,468 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:13,468 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:46:13,478 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:13,481 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:13,484 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:13,487 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:13,490 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:13,493 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:13,495 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:13,498 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:13,500 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:13,502 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:13,505 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:13,516 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:13,516 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:46:13,521 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:46:13,521 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:46:13,531 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:13,531 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:46:13,551 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:13,552 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:46:13,552 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:13,580 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:13,585 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:46:13,591 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:46:13,591 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:13,591 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:13,592 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:13,592 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:13,592 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:13,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:46:13,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:13,593 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:46:13,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:13,594 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:46:13,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:46:13,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:13,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:46:13,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:13,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:13,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:13,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:46:13,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:46:13,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:46:13,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:46:13,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:46:13,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:46:13,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:46:13,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:46:13,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:46:13,598 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:46:13,598 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:46:13,598 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:46:13,598 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:13,598 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:46:13,598 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:13,599 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:13,603 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:13,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:46:13,603 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:46:13,603 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:46:13,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:46:13,608 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:46:13,608 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:13,609 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:13,610 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:46:13,611 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:13,611 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:13,611 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:13,612 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:13,648 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4676, Threshold=0.5050, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:46:13,648 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.4676
2025-08-04 20:46:27,921 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:27,921 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:46:27,921 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:46:27,921 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:46:27,921 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:46:27,921 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:28,222 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:28,222 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:28,309 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:46:28,356 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:46:28,357 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:28,486 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:28,494 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:28,495 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:28,502 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:46:28,509 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:28,509 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:46:28,509 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:28,509 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:28,510 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:46:28,518 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:28,521 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:28,523 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:28,525 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:28,528 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:28,530 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:28,533 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:28,535 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:28,538 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:28,540 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:28,542 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:28,552 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:28,552 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:46:28,557 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:46:28,557 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:46:28,562 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:28,562 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:46:28,571 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:28,571 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:46:28,571 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:28,587 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:28,591 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:46:28,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:46:28,598 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:28,598 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:28,598 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:28,598 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:28,599 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:28,599 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:46:28,599 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:28,599 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:46:28,600 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:28,601 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:46:28,601 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:46:28,601 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:28,602 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:46:28,602 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:28,602 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:28,602 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:28,602 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:46:28,602 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:46:28,602 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:46:28,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:46:28,603 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:46:28,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:46:28,603 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:46:28,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:46:28,604 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:46:28,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:46:28,604 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:46:28,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:46:28,604 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:28,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:46:28,605 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:28,605 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:28,609 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:28,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:46:28,609 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:46:28,609 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:46:28,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:46:28,613 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:46:28,613 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:28,614 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:28,614 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:46:28,616 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:28,616 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:28,616 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:28,617 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:28,652 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4878, Threshold=0.5324, Accuracy=0.7294, F1=0.8112, Precision=0.9690, Recall=0.6975
2025-08-04 20:46:28,652 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7294, F1: 0.8112, Prec: 0.9690, Rec: 0.6975, Avg Anomaly Score: 0.4878
2025-08-04 20:46:42,918 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:42,918 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:46:42,918 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:46:42,918 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:46:42,919 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:46:42,919 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:43,226 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:43,226 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:43,314 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:46:43,340 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:46:43,340 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:43,442 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:43,448 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:43,448 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:43,454 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:46:43,460 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:43,460 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:46:43,460 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:43,460 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:43,461 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:46:43,470 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:43,473 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:43,475 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:43,478 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:43,481 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:43,484 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:43,487 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:43,490 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:43,493 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:43,494 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:43,497 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:43,507 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:43,507 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:46:43,512 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:46:43,512 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:46:43,517 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:43,517 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:46:43,527 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:43,527 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:46:43,527 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:43,546 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:43,551 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:46:43,557 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:46:43,557 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:43,557 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:43,557 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:43,558 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:43,558 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:43,559 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:46:43,559 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:43,559 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:46:43,559 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:43,561 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:46:43,561 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:46:43,561 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:43,561 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:46:43,561 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:43,562 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:43,562 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:43,562 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:46:43,562 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:46:43,562 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:46:43,562 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:46:43,562 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:46:43,562 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:46:43,563 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:46:43,563 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:46:43,563 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:46:43,563 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:46:43,563 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:46:43,564 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:46:43,564 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:43,564 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:46:43,564 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:43,565 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:43,568 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:43,569 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:46:43,569 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:46:43,569 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:46:43,569 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:46:43,573 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:46:43,573 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:43,574 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:43,574 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:46:43,576 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:43,576 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:43,576 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:43,576 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:43,610 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4709, Threshold=0.5112, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:46:43,610 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.4709
2025-08-04 20:46:48,857 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:48,858 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:46:48,858 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:46:48,858 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:46:48,858 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:46:48,858 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:49,116 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:49,116 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:49,200 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:46:49,241 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:46:49,242 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:49,351 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:49,356 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:49,356 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:49,363 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:46:49,370 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:49,371 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:46:49,371 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:49,371 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:49,371 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:46:49,380 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:49,382 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:49,385 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:49,387 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:49,390 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:49,392 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:49,394 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:49,396 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:49,399 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:49,401 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:49,404 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:49,412 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:49,412 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:46:49,417 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:46:49,417 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:46:49,422 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:49,422 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:46:49,433 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:49,434 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:46:49,434 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:49,448 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:49,453 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:46:49,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:46:49,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:49,458 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:49,458 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:49,458 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:49,459 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:49,459 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:46:49,459 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:49,459 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:46:49,459 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:49,461 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:46:49,461 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:46:49,461 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:49,462 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:46:49,462 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:49,462 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:49,462 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:49,462 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:46:49,462 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:46:49,463 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:46:49,463 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:46:49,463 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:46:49,463 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:46:49,463 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:46:49,463 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:46:49,464 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:46:49,464 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:46:49,464 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:46:49,464 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:46:49,464 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:49,464 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:46:49,465 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:49,465 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:49,468 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:49,469 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:46:49,469 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:46:49,469 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:46:49,469 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:46:49,473 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:46:49,473 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:49,475 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:49,475 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:46:49,476 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 110/400.
2025-08-04 20:46:49,578 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:49,578 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:49,579 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 45 anomalous samples to GAN training data (target: 45).
2025-08-04 20:46:49,580 - ClientAppLogger [Client 7] - INFO - [Client] Round 110: Training GAN with 198 samples (153 normal, 45 anomalous).
2025-08-04 20:46:49,583 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:49,747 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0844, Avg D Loss: 0.8007
2025-08-04 20:46:49,747 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0844, Avg D Loss: 0.8007
2025-08-04 20:46:49,748 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:49,780 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4707, Threshold=0.5040, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:46:49,781 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:46:49,781 - ClientAppLogger [Client 7] - INFO - Fit completed for round 110. Duration: 0.30s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 110, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.084412373436822, 'd_loss': 0.8006680359744063, 'post_fit_local_f1': 0.8124594419208306, 'fit_time_seconds': 0.30444812774658203, 'cpu_percent_fit': 24.5875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 198}
2025-08-04 20:46:49,781 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:46:58,036 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:58,036 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:46:58,037 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:46:58,037 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:46:58,037 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:46:58,037 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:58,338 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:58,339 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:58,427 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:46:58,477 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:46:58,477 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:58,592 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:58,598 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:58,598 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:58,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:46:58,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:58,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:46:58,609 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:58,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:58,610 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:46:58,619 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:58,622 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:58,624 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:58,627 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:58,629 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:58,631 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:58,634 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:58,636 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:58,639 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:58,641 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:58,643 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:58,652 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:58,652 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:46:58,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:46:58,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:46:58,661 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:58,662 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:46:58,670 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:58,670 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:46:58,670 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:58,685 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:58,690 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:46:58,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:46:58,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:58,696 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:58,696 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:58,697 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:58,697 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:58,697 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:46:58,698 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:58,698 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:46:58,698 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:58,699 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:46:58,699 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:46:58,700 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:58,700 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:46:58,700 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:58,700 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:58,700 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:58,700 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:46:58,701 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:46:58,701 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:46:58,701 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:46:58,701 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:46:58,701 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:46:58,701 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:46:58,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:46:58,702 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:46:58,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:46:58,702 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:46:58,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:46:58,702 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:58,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:46:58,703 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:58,703 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:58,706 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:58,707 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:46:58,707 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:46:58,707 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:46:58,707 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:46:58,711 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:46:58,711 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:58,712 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:58,712 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:46:58,714 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:58,714 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:58,714 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:58,715 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:58,747 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5098, Threshold=0.5569, Accuracy=0.7229, F1=0.8066, Precision=0.9636, Recall=0.6936
2025-08-04 20:46:58,747 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7229, F1: 0.8066, Prec: 0.9636, Rec: 0.6936, Avg Anomaly Score: 0.5098
2025-08-04 20:47:13,009 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:13,009 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:47:13,010 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:47:13,010 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:47:13,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:47:13,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:13,254 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:13,254 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:13,344 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:47:13,381 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:47:13,381 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:13,489 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:13,494 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:13,495 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:13,500 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:47:13,504 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:13,505 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:47:13,505 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:13,505 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:13,505 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:47:13,514 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:13,516 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:13,519 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:13,521 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:13,523 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:13,525 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:13,528 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:13,530 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:13,533 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:13,535 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:13,537 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:13,545 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:13,545 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:47:13,550 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:47:13,550 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:47:13,554 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:13,555 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:47:13,563 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:13,564 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:47:13,564 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:13,578 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:13,583 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:47:13,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:47:13,591 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:13,591 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:13,591 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:13,591 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:13,591 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:13,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:47:13,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:13,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:47:13,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:13,594 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:47:13,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:47:13,594 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:13,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:47:13,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:13,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:13,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:13,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:47:13,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:47:13,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:47:13,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:47:13,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:47:13,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:47:13,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:47:13,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:47:13,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:47:13,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:47:13,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:47:13,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:47:13,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:13,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:47:13,598 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:13,598 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:13,602 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:13,602 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:47:13,602 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:47:13,602 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:47:13,602 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:47:13,609 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:47:13,609 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:13,610 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:13,611 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:47:13,612 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:13,612 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:13,612 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:13,613 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:13,646 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4800, Threshold=0.5232, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:47:13,646 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.4800
2025-08-04 20:47:33,937 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:33,937 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:47:33,938 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:47:33,938 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:47:33,938 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:47:33,938 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:34,262 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:34,262 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:34,353 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:47:34,396 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:47:34,396 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:34,517 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:34,523 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:34,523 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:34,528 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:47:34,534 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:34,534 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:47:34,535 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:34,535 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:34,535 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:47:34,543 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:34,546 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:34,549 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:34,551 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:34,554 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:34,556 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:34,559 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:34,562 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:34,564 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:34,566 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:34,569 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:34,578 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:34,578 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:47:34,582 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:47:34,582 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:47:34,587 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:34,587 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:47:34,595 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:34,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:47:34,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:34,610 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:34,614 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:47:34,619 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:47:34,620 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:34,620 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:34,620 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:34,620 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:34,620 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:34,620 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:47:34,621 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:34,621 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:47:34,621 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:34,622 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:47:34,622 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:47:34,623 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:34,623 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:47:34,623 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:34,623 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:34,623 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:34,623 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:47:34,623 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:47:34,624 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:47:34,624 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:47:34,624 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:47:34,624 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:47:34,625 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:47:34,625 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:47:34,625 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:47:34,625 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:47:34,625 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:47:34,625 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:47:34,625 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:34,626 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:47:34,626 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:34,626 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:34,630 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:34,630 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:47:34,630 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:47:34,630 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:47:34,630 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:47:34,634 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:47:34,634 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:34,636 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:34,636 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:47:34,637 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:34,637 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:34,637 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:34,638 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:34,669 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4490, Threshold=0.4774, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 20:47:34,670 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7322, F1: 0.8131, Prec: 0.9713, Rec: 0.6992, Avg Anomaly Score: 0.4490
2025-08-04 20:47:45,952 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:45,952 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:47:45,952 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:47:45,952 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:47:45,952 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:47:45,952 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:46,259 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:46,259 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:46,350 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:47:46,380 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:47:46,380 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:46,478 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:46,484 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:46,484 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:46,489 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:47:46,494 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:46,495 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:47:46,495 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:46,495 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:46,495 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:47:46,504 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:46,507 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:46,509 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:46,512 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:46,515 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:46,517 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:46,520 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:46,522 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:46,526 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:46,528 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:46,531 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:46,542 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:46,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:47:46,547 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:47:46,547 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:47:46,553 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:46,553 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:47:46,565 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:46,566 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:47:46,566 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:46,582 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:46,586 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:47:46,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:47:46,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:46,592 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:46,592 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:46,593 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:46,593 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:46,593 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:47:46,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:46,594 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:47:46,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:46,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:47:46,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:47:46,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:46,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:47:46,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:46,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:46,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:46,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:47:46,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:47:46,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:47:46,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:47:46,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:47:46,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:47:46,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:47:46,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:47:46,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:47:46,598 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:47:46,598 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:47:46,598 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:47:46,598 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:46,598 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:47:46,598 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:46,599 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:46,599 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:46,602 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:47:46,602 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:47:46,602 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:47:46,602 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:47:46,607 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:47:46,607 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:46,609 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:46,609 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:47:46,610 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:46,610 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:46,610 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:46,611 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:46,645 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4923, Threshold=0.5454, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:47:46,646 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.4923
2025-08-04 20:48:03,942 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:03,942 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:48:03,942 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:48:03,942 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:48:03,942 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:48:03,942 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:04,303 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:04,303 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:04,396 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:48:04,424 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:48:04,424 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:04,527 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:04,534 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:04,534 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:04,539 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:48:04,546 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:04,546 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:48:04,547 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:04,547 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:04,547 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:48:04,556 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:04,558 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:04,561 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:04,563 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:04,566 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:04,568 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:04,570 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:04,573 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:04,576 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:04,578 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:04,580 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:04,590 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:04,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:48:04,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:48:04,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:48:04,599 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:04,599 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:48:04,609 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:04,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:48:04,610 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:04,627 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:04,634 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:48:04,638 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:48:04,639 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:04,639 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:04,639 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:04,639 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:04,640 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:04,640 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:48:04,640 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:04,641 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:48:04,641 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:04,642 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:48:04,642 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:48:04,643 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:04,643 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:48:04,643 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:04,643 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:04,644 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:04,644 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:48:04,644 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:48:04,644 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:48:04,644 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:48:04,645 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:48:04,645 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:48:04,645 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:48:04,645 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:48:04,645 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:48:04,645 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:48:04,646 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:48:04,646 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:48:04,646 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:04,646 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:48:04,646 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:04,647 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:04,650 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:04,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:48:04,650 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:48:04,650 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:48:04,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:48:04,655 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:48:04,655 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:04,656 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:04,656 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:48:04,658 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:04,658 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:04,658 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:04,659 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:04,691 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5247, Threshold=0.5850, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:48:04,692 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5247
2025-08-04 20:48:15,969 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:15,969 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:48:15,969 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:48:15,969 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:48:15,969 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:48:15,969 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:16,294 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:16,295 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:16,393 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:48:16,437 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:48:16,437 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:16,565 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:16,571 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:16,571 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:16,577 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:48:16,583 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:16,583 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:48:16,584 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:16,584 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:16,584 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:48:16,592 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:16,595 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:16,597 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:16,599 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:16,602 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:16,604 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:16,606 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:16,609 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:16,611 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:16,613 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:16,615 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:16,625 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:16,625 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:48:16,630 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:48:16,630 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:48:16,635 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:16,635 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:48:16,644 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:16,646 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:48:16,646 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:16,662 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:16,667 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:48:16,672 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:48:16,672 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:16,672 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:16,672 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:16,673 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:16,673 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:16,673 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:48:16,673 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:16,674 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:48:16,674 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:16,675 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:48:16,675 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:48:16,676 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:16,676 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:48:16,676 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:16,676 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:16,676 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:16,676 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:48:16,677 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:48:16,677 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:48:16,677 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:48:16,677 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:48:16,677 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:48:16,677 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:48:16,677 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:48:16,678 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:48:16,678 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:48:16,678 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:48:16,678 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:48:16,678 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:16,679 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:48:16,679 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:16,679 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:16,683 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:16,683 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:48:16,683 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:48:16,683 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:48:16,684 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:48:16,687 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:48:16,688 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:16,689 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:16,689 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:48:16,690 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:16,691 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:16,691 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:16,691 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:16,724 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5582, Threshold=0.6191, Accuracy=0.7248, F1=0.8079, Precision=0.9651, Recall=0.6948
2025-08-04 20:48:16,724 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7248, F1: 0.8079, Prec: 0.9651, Rec: 0.6948, Avg Anomaly Score: 0.5582
2025-08-04 20:48:28,013 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:28,013 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:48:28,013 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:48:28,013 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:48:28,013 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:48:28,013 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:28,352 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:28,353 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:28,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:48:28,474 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:48:28,474 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:28,582 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:28,588 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:28,589 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:28,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:48:28,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:28,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:48:28,603 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:28,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:28,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:48:28,614 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:28,617 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:28,620 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:28,622 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:28,625 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:28,627 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:28,630 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:28,633 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:28,635 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:28,638 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:28,640 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:28,651 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:28,651 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:48:28,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:48:28,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:48:28,660 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:28,660 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:48:28,670 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:28,670 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:48:28,670 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:28,685 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:28,689 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:48:28,694 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:48:28,694 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:28,694 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:28,694 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:28,694 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:28,695 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:28,695 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:48:28,695 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:28,695 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:48:28,695 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:28,696 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:48:28,697 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:48:28,697 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:28,697 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:48:28,697 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:28,697 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:28,697 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:28,698 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:48:28,698 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:48:28,698 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:48:28,698 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:48:28,698 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:48:28,698 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:48:28,698 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:48:28,698 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:48:28,699 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:48:28,699 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:48:28,699 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:48:28,699 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:48:28,699 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:28,699 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:48:28,700 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:28,700 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:28,700 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:28,700 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:48:28,701 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:48:28,701 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:48:28,701 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:48:28,704 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:48:28,704 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:28,706 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:28,706 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:48:28,707 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:28,707 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:28,708 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:28,708 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:28,740 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4670, Threshold=0.5161, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:48:28,740 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.4670
2025-08-04 20:48:43,039 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:43,039 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:48:43,039 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:48:43,039 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:48:43,039 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:48:43,039 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:43,324 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:43,325 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:43,418 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:48:43,461 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:48:43,461 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:43,583 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:43,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:43,590 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:43,599 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:48:43,607 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:43,608 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:48:43,608 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:43,608 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:43,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:48:43,617 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:43,620 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:43,623 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:43,625 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:43,628 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:43,630 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:43,632 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:43,635 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:43,638 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:43,639 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:43,642 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:43,652 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:43,652 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:48:43,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:48:43,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:48:43,663 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:43,663 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:48:43,672 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:43,673 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:48:43,673 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:43,689 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:43,693 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:48:43,699 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:48:43,699 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:43,699 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:43,699 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:43,700 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:43,700 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:43,700 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:48:43,700 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:43,701 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:48:43,701 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:43,702 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:48:43,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:48:43,703 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:43,703 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:48:43,703 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:43,703 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:43,703 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:43,704 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:48:43,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:48:43,704 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:48:43,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:48:43,704 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:48:43,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:48:43,704 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:48:43,705 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:48:43,705 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:48:43,705 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:48:43,705 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:48:43,705 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:48:43,705 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:43,706 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:48:43,706 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:43,706 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:43,710 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:43,710 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:48:43,710 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:48:43,711 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:48:43,711 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:48:43,715 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:48:43,715 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:43,717 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:43,717 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:48:43,718 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:43,718 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:43,718 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:43,719 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:43,759 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4875, Threshold=0.5332, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 20:48:43,760 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7331, F1: 0.8138, Prec: 0.9721, Rec: 0.6998, Avg Anomaly Score: 0.4875
2025-08-04 20:48:49,012 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:49,012 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:48:49,012 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:48:49,012 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:48:49,012 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:48:49,012 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:49,248 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:49,248 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:49,334 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:48:49,361 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:48:49,362 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:49,448 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:49,453 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:49,453 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:49,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:48:49,466 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:49,466 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:48:49,467 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:49,467 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:49,467 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:48:49,476 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:49,479 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:49,481 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:49,483 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:49,486 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:49,488 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:49,491 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:49,493 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:49,496 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:49,498 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:49,500 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:49,509 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:49,509 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:48:49,513 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:48:49,514 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:48:49,518 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:49,518 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:48:49,526 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:49,527 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:48:49,527 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:49,543 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:49,548 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:48:49,553 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:48:49,553 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:49,553 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:49,553 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:49,553 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:49,554 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:49,554 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:48:49,554 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:49,554 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:48:49,554 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:49,556 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:48:49,556 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:48:49,556 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:49,557 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:48:49,557 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:49,557 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:49,557 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:49,557 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:48:49,558 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:48:49,558 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:48:49,558 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:48:49,558 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:48:49,558 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:48:49,558 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:48:49,559 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:48:49,559 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:48:49,559 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:48:49,559 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:48:49,559 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:48:49,559 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:49,560 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:48:49,560 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:49,560 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:49,564 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:49,564 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:48:49,564 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:48:49,565 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:48:49,565 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:48:49,569 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:48:49,569 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:49,570 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:49,570 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:48:49,572 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 118/400.
2025-08-04 20:48:49,673 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:49,673 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:49,675 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 48 anomalous samples to GAN training data (target: 48).
2025-08-04 20:48:49,675 - ClientAppLogger [Client 7] - INFO - [Client] Round 118: Training GAN with 210 samples (162 normal, 48 anomalous).
2025-08-04 20:48:49,679 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:48:49,842 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0833, Avg D Loss: 0.7937
2025-08-04 20:48:49,843 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0833, Avg D Loss: 0.7937
2025-08-04 20:48:49,843 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:48:49,873 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4889, Threshold=0.5430, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:48:49,874 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:48:49,874 - ClientAppLogger [Client 7] - INFO - Fit completed for round 118. Duration: 0.30s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 118, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083296589170183, 'd_loss': 0.7936587302457718, 'post_fit_local_f1': 0.8124594419208306, 'fit_time_seconds': 0.3020179271697998, 'cpu_percent_fit': 24.58125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 210}
2025-08-04 20:48:49,874 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:48:55,128 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:55,128 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:48:55,128 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:48:55,128 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:48:55,128 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:48:55,128 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:55,415 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:55,415 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:55,504 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:48:55,549 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:48:55,550 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:55,677 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:55,683 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:55,683 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:55,688 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:48:55,693 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:55,693 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:48:55,693 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:55,694 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:55,694 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:48:55,702 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:55,705 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:55,707 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:55,710 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:55,712 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:55,714 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:55,717 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:55,719 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:55,722 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:55,724 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:55,726 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:55,736 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:55,736 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:48:55,741 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:48:55,741 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:48:55,745 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:55,746 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:48:55,754 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:55,754 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:48:55,754 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:55,769 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:55,773 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:48:55,779 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:48:55,779 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:55,779 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:55,779 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:55,780 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:55,780 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:55,780 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:48:55,780 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:55,781 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:48:55,781 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:55,782 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:48:55,782 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:48:55,783 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:55,783 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:48:55,783 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:55,783 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:55,783 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:55,783 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:48:55,783 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:48:55,784 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:48:55,784 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:48:55,784 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:48:55,784 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:48:55,784 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:48:55,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:48:55,785 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:48:55,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:48:55,785 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:48:55,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:48:55,786 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:55,786 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:48:55,786 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:55,786 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:55,790 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:55,790 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:48:55,790 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:48:55,791 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:48:55,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:48:55,794 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:48:55,794 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:55,796 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:55,796 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:48:55,798 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:55,798 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:55,798 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:55,799 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:55,832 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5172, Threshold=0.5729, Accuracy=0.7276, F1=0.8099, Precision=0.9674, Recall=0.6964
2025-08-04 20:48:55,832 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7276, F1: 0.8099, Prec: 0.9674, Rec: 0.6964, Avg Anomaly Score: 0.5172
2025-08-04 20:49:07,106 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:07,106 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:49:07,107 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:49:07,107 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:49:07,107 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:49:07,107 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:07,470 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:07,470 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:07,565 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:49:07,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:49:07,594 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:07,730 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:07,736 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:07,736 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:07,742 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:49:07,748 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:07,748 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:49:07,748 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:07,749 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:07,749 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:49:07,757 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:07,760 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:07,762 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:07,764 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:07,767 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:07,769 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:07,771 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:07,774 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:07,777 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:07,778 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:07,780 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:07,789 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:07,789 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:49:07,794 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:49:07,794 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:49:07,799 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:07,799 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:49:07,812 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:07,812 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:49:07,812 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:07,827 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:07,831 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:49:07,837 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:49:07,837 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:07,838 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:07,838 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:07,838 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:07,838 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:07,838 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:49:07,839 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:07,839 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:49:07,839 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:07,841 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:49:07,841 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:49:07,841 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:07,841 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:49:07,841 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:07,842 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:07,842 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:07,842 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:49:07,842 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:49:07,842 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:49:07,842 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:49:07,843 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:49:07,843 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:49:07,843 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:49:07,843 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:49:07,844 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:49:07,844 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:49:07,844 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:49:07,844 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:49:07,844 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:07,845 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:49:07,845 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:07,845 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:07,849 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:07,849 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:49:07,849 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:49:07,850 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:49:07,850 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:49:07,854 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:49:07,855 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:07,856 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:07,856 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:49:07,857 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:07,857 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:07,857 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:07,858 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:07,891 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4971, Threshold=0.5486, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 20:49:07,891 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7322, F1: 0.8131, Prec: 0.9713, Rec: 0.6992, Avg Anomaly Score: 0.4971
2025-08-04 20:49:25,170 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:25,170 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:49:25,170 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:49:25,170 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:49:25,170 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:49:25,170 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:25,487 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:25,487 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:25,586 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:49:25,631 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:49:25,631 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:25,761 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:25,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:25,769 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:25,776 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:49:25,783 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:25,784 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:49:25,784 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:25,784 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:25,784 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:49:25,794 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:25,797 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:25,799 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:25,801 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:25,804 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:25,806 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:25,809 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:25,811 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:25,814 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:25,816 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:25,818 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:25,828 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:25,828 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:49:25,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:49:25,833 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:49:25,838 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:25,839 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:49:25,848 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:25,849 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:49:25,849 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:25,865 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:25,871 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:49:25,878 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:49:25,878 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:25,879 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:25,879 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:25,879 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:25,879 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:25,879 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:49:25,880 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:25,880 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:49:25,880 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:25,881 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:49:25,881 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:49:25,882 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:25,882 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:49:25,882 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:25,882 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:25,882 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:25,883 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:49:25,883 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:49:25,883 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:49:25,883 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:49:25,883 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:49:25,883 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:49:25,884 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:49:25,884 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:49:25,884 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:49:25,884 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:49:25,884 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:49:25,884 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:49:25,885 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:25,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:49:25,885 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:25,885 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:25,889 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:25,889 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:49:25,889 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:49:25,890 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:49:25,890 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:49:25,894 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:49:25,894 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:25,895 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:25,895 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:49:25,897 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:25,897 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:25,897 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:25,898 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:25,935 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5157, Threshold=0.5683, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:49:25,935 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5157
2025-08-04 20:49:37,217 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:37,217 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:49:37,217 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:49:37,218 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:49:37,218 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:49:37,218 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:37,510 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:37,510 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:37,599 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:49:37,630 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:49:37,630 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:37,733 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:37,742 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:37,742 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:37,750 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:49:37,772 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:37,772 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:49:37,773 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:37,773 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:37,773 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:49:37,782 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:37,785 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:37,787 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:37,789 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:37,792 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:37,794 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:37,797 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:37,799 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:37,802 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:37,804 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:37,806 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:37,818 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:37,818 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:49:37,823 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:49:37,824 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:49:37,830 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:37,830 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:49:37,845 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:37,846 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:49:37,846 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:37,863 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:37,870 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:49:37,879 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:49:37,880 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:37,880 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:37,880 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:37,880 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:37,881 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:37,881 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:49:37,881 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:37,881 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:49:37,881 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:37,883 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:49:37,883 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:49:37,883 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:37,884 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:49:37,884 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:37,884 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:37,884 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:37,884 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:49:37,884 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:49:37,885 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:49:37,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:49:37,885 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:49:37,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:49:37,885 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:49:37,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:49:37,886 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:49:37,886 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:49:37,886 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:49:37,886 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:49:37,886 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:37,887 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:49:37,887 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:37,887 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:37,891 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:37,891 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:49:37,891 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:49:37,891 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:49:37,891 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:49:37,900 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:49:37,900 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:37,902 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:37,902 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:49:37,904 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:37,904 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:37,904 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:37,905 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:37,941 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4565, Threshold=0.4868, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:49:37,941 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.4565
2025-08-04 20:49:43,213 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:43,213 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:49:43,213 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:49:43,213 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:49:43,213 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:49:43,213 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:43,481 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:43,481 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:43,573 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:49:43,616 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:49:43,616 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:43,724 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:43,730 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:43,730 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:43,735 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:49:43,741 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:43,741 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:49:43,741 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:43,742 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:43,742 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:49:43,751 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:43,754 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:43,757 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:43,759 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:43,761 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:43,764 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:43,766 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:43,769 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:43,772 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:43,773 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:43,776 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:43,786 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:43,786 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:49:43,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:49:43,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:49:43,796 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:43,796 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:49:43,806 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:43,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:49:43,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:43,823 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:43,828 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:49:43,834 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:49:43,834 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:43,834 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:43,834 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:43,835 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:43,835 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:43,835 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:49:43,835 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:43,836 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:49:43,836 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:43,837 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:49:43,837 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:49:43,838 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:43,838 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:49:43,838 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:43,838 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:43,838 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:43,838 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:49:43,838 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:49:43,839 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:49:43,839 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:49:43,839 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:49:43,839 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:49:43,839 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:49:43,840 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:49:43,840 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:49:43,840 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:49:43,840 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:49:43,841 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:49:43,841 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:43,841 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:49:43,841 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:43,841 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:43,845 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:43,845 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:49:43,845 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:49:43,845 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:49:43,846 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:49:43,850 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:49:43,850 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:43,851 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:43,852 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:49:43,853 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 122/400.
2025-08-04 20:49:43,954 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:43,954 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:43,956 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 49 anomalous samples to GAN training data (target: 49).
2025-08-04 20:49:43,956 - ClientAppLogger [Client 7] - INFO - [Client] Round 122: Training GAN with 215 samples (166 normal, 49 anomalous).
2025-08-04 20:49:43,960 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:44,129 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0828, Avg D Loss: 0.7829
2025-08-04 20:49:44,129 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0828, Avg D Loss: 0.7829
2025-08-04 20:49:44,129 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:44,162 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5203, Threshold=0.5925, Accuracy=0.7276, F1=0.8099, Precision=0.9674, Recall=0.6964
2025-08-04 20:49:44,162 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8099
2025-08-04 20:49:44,163 - ClientAppLogger [Client 7] - INFO - Fit completed for round 122. Duration: 0.31s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 122, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0828438460549643, 'd_loss': 0.7829206934086114, 'post_fit_local_f1': 0.8098637248539909, 'fit_time_seconds': 0.30954670906066895, 'cpu_percent_fit': 24.8375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 215}
2025-08-04 20:49:44,163 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:49:49,418 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:49,418 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:49:49,418 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:49:49,418 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:49:49,418 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:49:49,419 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:49,776 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:49,776 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:49,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:49:49,906 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:49:49,907 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:50,033 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:50,040 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:50,040 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:50,047 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:49:50,056 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:50,057 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:49:50,057 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:50,057 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:50,058 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:49:50,068 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:50,071 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:50,073 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:50,075 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:50,078 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:50,080 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:50,083 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:50,086 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:50,089 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:50,091 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:50,094 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:50,108 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:50,108 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:49:50,113 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:49:50,113 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:49:50,119 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:50,119 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:49:50,132 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:50,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:49:50,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:50,150 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:50,155 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:49:50,161 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:49:50,161 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:50,161 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:50,162 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:50,162 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:50,162 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:50,162 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:49:50,162 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:50,163 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:49:50,163 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:50,164 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:49:50,164 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:49:50,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:50,165 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:49:50,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:50,165 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:50,166 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:50,166 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:49:50,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:49:50,166 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:49:50,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:49:50,166 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:49:50,167 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:49:50,167 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:49:50,167 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:49:50,167 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:49:50,168 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:49:50,168 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:49:50,168 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:49:50,168 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:50,168 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:49:50,168 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:50,169 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:50,172 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:50,172 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:49:50,172 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:49:50,172 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:49:50,172 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:49:50,179 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:49:50,179 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:50,180 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:50,181 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:49:50,182 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:50,182 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:50,183 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:50,183 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:50,217 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5265, Threshold=0.5944, Accuracy=0.7220, F1=0.8060, Precision=0.9628, Recall=0.6931
2025-08-04 20:49:50,217 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7220, F1: 0.8060, Prec: 0.9628, Rec: 0.6931, Avg Anomaly Score: 0.5265
2025-08-04 20:49:55,478 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:55,479 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:49:55,479 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:49:55,479 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:49:55,479 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:49:55,479 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:55,810 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:55,810 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:55,904 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:49:55,945 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:49:55,946 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:56,069 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:56,076 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:56,076 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:56,081 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:49:56,088 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:56,088 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:49:56,089 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:56,089 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:56,089 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:49:56,098 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:56,101 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:56,103 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:56,107 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:56,111 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:56,114 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:56,117 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:56,120 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:56,123 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:56,125 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:56,129 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:56,141 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:56,141 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:49:56,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:49:56,148 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:49:56,155 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:56,155 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:49:56,168 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:56,168 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:49:56,168 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:56,192 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:56,199 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:49:56,208 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:49:56,208 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:56,208 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:56,208 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:56,209 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:56,209 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:56,209 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:49:56,210 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:56,210 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:49:56,210 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:56,212 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:49:56,213 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:49:56,213 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:56,214 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:49:56,214 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:56,214 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:56,215 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:56,215 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:49:56,215 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:49:56,215 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:49:56,215 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:49:56,216 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:49:56,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:49:56,216 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:49:56,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:49:56,217 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:49:56,217 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:49:56,217 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:49:56,217 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:49:56,217 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:56,217 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:49:56,218 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:56,218 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:56,218 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:56,219 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:49:56,219 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:49:56,220 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:49:56,220 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:49:56,226 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:49:56,226 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:56,227 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:56,227 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:49:56,229 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 123/400.
2025-08-04 20:49:56,330 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:56,330 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:56,331 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 50 anomalous samples to GAN training data (target: 50).
2025-08-04 20:49:56,332 - ClientAppLogger [Client 7] - INFO - [Client] Round 123: Training GAN with 218 samples (168 normal, 50 anomalous).
2025-08-04 20:49:56,332 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:56,555 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0833, Avg D Loss: 0.7843
2025-08-04 20:49:56,557 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0833, Avg D Loss: 0.7843
2025-08-04 20:49:56,557 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:56,617 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5069, Threshold=0.5759, Accuracy=0.7266, F1=0.8092, Precision=0.9667, Recall=0.6959
2025-08-04 20:49:56,617 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8092
2025-08-04 20:49:56,617 - ClientAppLogger [Client 7] - INFO - Fit completed for round 123. Duration: 0.39s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 123, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083299719303026, 'd_loss': 0.7842759952085828, 'post_fit_local_f1': 0.8092147955872809, 'fit_time_seconds': 0.3882424831390381, 'cpu_percent_fit': 23.475, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 218}
2025-08-04 20:49:56,618 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:50:04,901 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:04,901 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:50:04,901 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:50:04,901 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:50:04,901 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:50:04,901 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:05,251 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:05,251 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:05,339 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:50:05,370 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:50:05,371 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:05,469 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:05,477 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:05,478 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:05,484 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:50:05,491 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:05,491 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:50:05,491 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:05,491 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:05,492 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:50:05,501 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:05,504 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:05,506 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:05,508 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:05,511 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:05,513 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:05,516 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:05,518 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:05,521 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:05,523 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:05,525 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:05,535 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:05,535 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:50:05,540 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:50:05,540 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:50:05,545 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:05,545 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:50:05,556 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:05,556 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:50:05,556 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:05,577 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:05,584 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:50:05,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:50:05,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:05,596 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:05,596 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:05,596 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:05,596 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:05,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:50:05,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:05,597 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:50:05,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:05,599 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:50:05,599 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:50:05,599 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:05,600 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:50:05,600 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:05,600 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:05,600 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:05,600 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:50:05,601 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:50:05,601 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:50:05,601 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:50:05,601 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:50:05,601 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:50:05,602 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:50:05,602 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:50:05,602 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:50:05,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:50:05,603 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:50:05,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:50:05,603 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:05,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:50:05,604 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:05,604 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:05,604 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:05,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:50:05,604 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:50:05,605 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:50:05,605 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:50:05,609 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:50:05,609 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:05,610 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:05,611 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:50:05,612 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:05,612 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:05,612 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:05,613 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:05,651 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5433, Threshold=0.6125, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:50:05,651 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5433
2025-08-04 20:50:10,917 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:10,917 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:50:10,917 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:50:10,917 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:50:10,917 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:50:10,917 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:11,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:11,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:11,303 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:50:11,346 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:50:11,346 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:11,465 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:11,471 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:11,471 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:11,476 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:50:11,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:11,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:50:11,483 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:11,484 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:11,484 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:50:11,492 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:11,496 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:11,498 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:11,500 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:11,503 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:11,505 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:11,508 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:11,511 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:11,514 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:11,516 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:11,518 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:11,527 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:11,527 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:50:11,532 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:50:11,532 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:50:11,537 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:11,539 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:50:11,549 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:11,549 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:50:11,549 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:11,565 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:11,569 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:50:11,574 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:50:11,575 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:11,575 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:11,575 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:11,575 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:11,575 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:11,576 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:50:11,576 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:11,576 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:50:11,576 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:11,578 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:50:11,578 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:50:11,578 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:11,578 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:50:11,578 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:11,578 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:11,579 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:11,579 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:50:11,579 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:50:11,579 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:50:11,579 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:50:11,579 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:50:11,579 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:50:11,579 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:50:11,579 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:50:11,580 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:50:11,580 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:50:11,580 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:50:11,580 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:50:11,580 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:11,580 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:50:11,581 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:11,581 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:11,581 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:11,581 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:50:11,581 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:50:11,581 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:50:11,582 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:50:11,585 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:50:11,585 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:11,586 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:11,587 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:50:11,588 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 124/400.
2025-08-04 20:50:11,689 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:11,690 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:11,691 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 50 anomalous samples to GAN training data (target: 50).
2025-08-04 20:50:11,691 - ClientAppLogger [Client 7] - INFO - [Client] Round 124: Training GAN with 218 samples (168 normal, 50 anomalous).
2025-08-04 20:50:11,691 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:50:11,853 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0837, Avg D Loss: 0.7957
2025-08-04 20:50:11,854 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0837, Avg D Loss: 0.7957
2025-08-04 20:50:11,854 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:50:11,891 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5005, Threshold=0.5559, Accuracy=0.7294, F1=0.8112, Precision=0.9690, Recall=0.6975
2025-08-04 20:50:11,892 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8112
2025-08-04 20:50:11,892 - ClientAppLogger [Client 7] - INFO - Fit completed for round 124. Duration: 0.30s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 124, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083676500276688, 'd_loss': 0.7957239211152454, 'post_fit_local_f1': 0.8111615833874107, 'fit_time_seconds': 0.3038806915283203, 'cpu_percent_fit': 24.7, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 218}
2025-08-04 20:50:11,892 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:50:17,141 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:17,142 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:50:17,142 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:50:17,142 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:50:17,142 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:50:17,142 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:17,393 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:17,393 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:17,473 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:50:17,496 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:50:17,496 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:17,589 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:17,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:17,595 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:17,600 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:50:17,605 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:17,606 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:50:17,606 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:17,607 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:17,607 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:50:17,615 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:17,618 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:17,620 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:17,622 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:17,625 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:17,627 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:17,630 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:17,632 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:17,635 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:17,637 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:17,639 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:17,648 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:17,648 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:50:17,653 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:50:17,654 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:50:17,660 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:17,660 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:50:17,674 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:17,674 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:50:17,675 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:17,691 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:17,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:50:17,701 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:50:17,701 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:17,701 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:17,701 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:17,701 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:17,702 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:17,702 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:50:17,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:17,702 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:50:17,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:17,704 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:50:17,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:50:17,704 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:17,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:50:17,704 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:17,704 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:17,705 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:17,705 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:50:17,705 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:50:17,705 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:50:17,705 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:50:17,705 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:50:17,705 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:50:17,706 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:50:17,706 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:50:17,706 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:50:17,706 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:50:17,706 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:50:17,707 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:50:17,707 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:17,707 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:50:17,707 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:17,708 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:17,708 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:17,708 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:50:17,708 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:50:17,708 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:50:17,708 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:50:17,711 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:50:17,711 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:17,712 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:17,713 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:50:17,714 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:17,714 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:17,715 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:17,715 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:17,748 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5226, Threshold=0.5899, Accuracy=0.7266, F1=0.8091, Precision=0.9674, Recall=0.6953
2025-08-04 20:50:17,748 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7266, F1: 0.8091, Prec: 0.9674, Rec: 0.6953, Avg Anomaly Score: 0.5226
2025-08-04 20:50:29,019 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:29,019 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:50:29,019 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:50:29,019 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:50:29,020 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:50:29,020 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:29,302 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:29,302 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:29,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:50:29,444 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:50:29,444 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:29,571 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:29,579 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:29,580 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:29,586 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:50:29,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:29,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:50:29,594 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:29,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:29,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:50:29,603 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:29,606 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:29,608 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:29,610 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:29,613 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:29,615 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:29,618 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:29,621 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:29,624 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:29,626 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:29,629 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:29,637 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:29,637 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:50:29,642 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:50:29,643 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:50:29,647 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:29,647 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:50:29,656 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:29,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:50:29,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:29,672 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:29,677 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:50:29,682 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:50:29,682 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:29,682 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:29,682 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:29,683 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:29,683 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:29,683 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:50:29,683 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:29,684 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:50:29,684 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:29,686 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:50:29,686 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:50:29,686 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:29,687 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:50:29,687 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:29,687 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:29,687 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:29,687 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:50:29,688 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:50:29,688 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:50:29,688 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:50:29,688 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:50:29,688 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:50:29,689 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:50:29,689 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:50:29,689 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:50:29,689 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:50:29,689 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:50:29,690 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:50:29,690 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:29,690 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:50:29,690 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:29,691 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:29,691 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:29,691 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:50:29,692 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:50:29,692 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:50:29,692 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:50:29,696 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:50:29,697 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:29,699 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:29,699 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:50:29,701 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 125/400.
2025-08-04 20:50:29,803 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:29,803 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:29,804 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 50 anomalous samples to GAN training data (target: 50).
2025-08-04 20:50:29,804 - ClientAppLogger [Client 7] - INFO - [Client] Round 125: Training GAN with 218 samples (168 normal, 50 anomalous).
2025-08-04 20:50:29,805 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:50:29,976 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0833, Avg D Loss: 0.7849
2025-08-04 20:50:29,976 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0833, Avg D Loss: 0.7849
2025-08-04 20:50:29,976 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:50:30,011 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4926, Threshold=0.5431, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:50:30,011 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:50:30,011 - ClientAppLogger [Client 7] - INFO - Fit completed for round 125. Duration: 0.31s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 125, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083331928996865, 'd_loss': 0.7848799378500073, 'post_fit_local_f1': 0.8124594419208306, 'fit_time_seconds': 0.30984950065612793, 'cpu_percent_fit': 24.55625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 218}
2025-08-04 20:50:30,011 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:50:35,268 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:35,268 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:50:35,268 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:50:35,268 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:50:35,268 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:50:35,268 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:35,570 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:35,570 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:35,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:50:35,703 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:50:35,704 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:35,881 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:35,890 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:35,890 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:35,898 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:50:35,909 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:35,910 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:50:35,910 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:35,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:35,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:50:35,924 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:35,928 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:35,931 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:35,935 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:35,938 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:35,941 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:35,944 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:35,947 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:35,950 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:35,953 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:35,955 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:35,965 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:35,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:50:35,970 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:50:35,972 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:50:35,977 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:35,978 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:50:35,989 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:35,990 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:50:35,990 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:36,007 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:36,012 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:50:36,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:50:36,018 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:36,018 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:36,018 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:36,018 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:36,019 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:36,019 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:50:36,019 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:36,019 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:50:36,020 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:36,021 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:50:36,021 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:50:36,022 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:36,022 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:50:36,022 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:36,022 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:36,023 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:36,023 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:50:36,023 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:50:36,023 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:50:36,024 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:50:36,024 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:50:36,024 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:50:36,024 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:50:36,024 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:50:36,025 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:50:36,025 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:50:36,025 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:50:36,026 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:50:36,026 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:36,026 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:50:36,026 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:36,027 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:36,027 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:36,027 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:50:36,027 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:50:36,028 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:50:36,028 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:50:36,034 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:50:36,034 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:36,036 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:36,036 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:50:36,038 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:36,038 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:36,038 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:36,038 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:36,073 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5291, Threshold=0.5907, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:50:36,073 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5291
2025-08-04 20:50:41,323 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:41,323 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:50:41,323 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:50:41,324 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:50:41,324 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:50:41,324 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:41,579 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:41,579 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:41,661 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:50:41,704 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:50:41,705 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:41,817 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:41,823 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:41,823 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:41,829 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:50:41,836 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:41,836 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:50:41,836 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:41,836 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:41,837 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:50:41,845 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:41,848 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:41,850 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:41,852 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:41,855 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:41,857 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:41,860 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:41,862 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:41,865 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:41,867 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:41,869 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:41,878 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:41,878 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:50:41,883 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:50:41,883 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:50:41,887 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:41,887 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:50:41,895 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:41,896 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:50:41,896 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:41,911 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:41,915 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:50:41,920 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:50:41,920 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:41,920 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:41,920 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:41,921 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:41,921 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:41,921 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:50:41,921 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:41,922 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:50:41,922 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:41,923 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:50:41,923 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:50:41,923 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:41,924 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:50:41,924 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:41,924 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:41,924 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:41,924 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:50:41,924 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:50:41,924 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:50:41,925 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:50:41,925 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:50:41,925 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:50:41,925 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:50:41,925 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:50:41,925 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:50:41,926 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:50:41,926 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:50:41,926 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:50:41,926 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:41,926 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:50:41,927 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:41,927 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:41,927 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:41,927 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:50:41,927 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:50:41,927 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:50:41,928 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:50:41,931 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:50:41,932 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:41,933 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:41,933 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:50:41,934 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 126/400.
2025-08-04 20:50:42,035 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:42,036 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:42,037 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 51 anomalous samples to GAN training data (target: 51).
2025-08-04 20:50:42,037 - ClientAppLogger [Client 7] - INFO - [Client] Round 126: Training GAN with 221 samples (170 normal, 51 anomalous).
2025-08-04 20:50:42,037 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:50:42,205 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7852
2025-08-04 20:50:42,205 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7852
2025-08-04 20:50:42,205 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:50:42,238 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4996, Threshold=0.5509, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:50:42,238 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:50:42,238 - ClientAppLogger [Client 7] - INFO - Fit completed for round 126. Duration: 0.30s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 126, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083870512651642, 'd_loss': 0.7851938955384681, 'post_fit_local_f1': 0.8124594419208306, 'fit_time_seconds': 0.3036346435546875, 'cpu_percent_fit': 24.98125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 221}
2025-08-04 20:50:42,238 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:50:47,491 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:47,492 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:50:47,492 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:50:47,492 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:50:47,492 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:50:47,492 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:47,760 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:47,761 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:47,844 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:50:47,878 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:50:47,879 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:47,989 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:47,995 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:47,996 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:48,003 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:50:48,014 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:48,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:50:48,017 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:48,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:48,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:50:48,027 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:48,030 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:48,032 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:48,035 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:48,037 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:48,040 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:48,042 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:48,045 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:48,047 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:48,050 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:48,052 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:48,062 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:48,062 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:50:48,068 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:50:48,068 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:50:48,073 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:48,073 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:50:48,085 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:48,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:50:48,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:48,103 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:48,108 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:50:48,115 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:50:48,115 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:48,115 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:48,115 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:48,116 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:48,116 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:48,116 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:50:48,116 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:48,117 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:50:48,117 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:48,119 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:50:48,119 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:50:48,120 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:48,120 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:50:48,120 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:48,121 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:48,121 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:48,121 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:50:48,121 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:50:48,121 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:50:48,122 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:50:48,122 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:50:48,122 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:50:48,122 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:50:48,122 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:50:48,122 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:50:48,123 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:50:48,123 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:50:48,123 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:50:48,123 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:48,123 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:50:48,124 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:48,124 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:48,124 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:48,124 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:50:48,124 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:50:48,125 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:50:48,125 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:50:48,129 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:50:48,129 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:48,130 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:48,130 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:50:48,132 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:48,132 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:48,132 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:48,133 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:48,167 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5198, Threshold=0.5883, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:50:48,168 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5198
2025-08-04 20:50:56,415 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:56,415 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:50:56,416 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:50:56,416 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:50:56,416 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:50:56,416 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:56,669 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:56,669 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:56,753 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:50:56,797 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:50:56,797 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:56,904 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:56,909 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:56,909 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:56,913 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:50:56,918 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:56,919 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:50:56,919 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:56,919 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:56,919 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:50:56,927 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:56,930 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:56,932 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:56,934 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:56,937 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:56,939 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:56,941 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:56,944 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:56,947 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:56,948 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:56,950 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:56,959 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:56,959 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:50:56,964 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:50:56,964 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:50:56,968 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:56,968 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:50:56,976 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:56,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:50:56,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:56,992 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:56,997 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:50:57,006 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:50:57,006 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:57,008 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:57,008 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:57,009 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:57,009 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:57,009 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:50:57,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:57,010 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:50:57,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:57,011 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:50:57,012 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:50:57,012 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:57,012 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:50:57,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:57,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:57,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:57,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:50:57,013 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:50:57,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:50:57,013 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:50:57,013 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:50:57,014 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:50:57,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:50:57,014 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:50:57,014 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:50:57,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:50:57,015 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:50:57,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:50:57,015 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:57,015 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:50:57,016 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:57,016 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:57,019 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:57,020 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:50:57,020 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:50:57,020 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:50:57,020 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:50:57,025 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:50:57,025 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:57,027 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:57,027 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:50:57,028 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 127/400.
2025-08-04 20:50:57,130 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:57,130 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:57,131 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 51 anomalous samples to GAN training data (target: 51).
2025-08-04 20:50:57,132 - ClientAppLogger [Client 7] - INFO - [Client] Round 127: Training GAN with 222 samples (171 normal, 51 anomalous).
2025-08-04 20:50:57,135 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:50:57,309 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0844, Avg D Loss: 0.7842
2025-08-04 20:50:57,309 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0844, Avg D Loss: 0.7842
2025-08-04 20:50:57,309 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:50:57,343 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5006, Threshold=0.5645, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:50:57,343 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:50:57,343 - ClientAppLogger [Client 7] - INFO - Fit completed for round 127. Duration: 0.31s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 127, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0843590467899764, 'd_loss': 0.7841709025271305, 'post_fit_local_f1': 0.8124594419208306, 'fit_time_seconds': 0.3149449825286865, 'cpu_percent_fit': 24.54375, 'ram_mb_fit': 2.7890625, 'accumulated_train_samples_this_round': 222}
2025-08-04 20:50:57,344 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:51:05,605 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:05,606 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:51:05,606 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:51:05,606 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:51:05,606 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:51:05,606 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:05,904 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:05,905 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:05,991 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:51:06,020 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:51:06,020 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:06,158 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:06,167 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:06,167 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:06,174 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:51:06,184 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:06,184 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:51:06,184 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:06,185 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:06,185 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:51:06,196 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:06,200 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:06,205 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:06,209 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:06,213 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:06,217 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:06,220 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:06,222 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:06,225 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:06,228 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:06,232 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:06,249 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:06,249 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:51:06,255 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:51:06,255 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:51:06,266 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:06,266 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:51:06,289 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:06,289 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:51:06,289 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:06,312 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:06,319 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:51:06,328 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:51:06,328 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:06,328 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:06,328 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:06,331 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:06,332 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:06,332 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:51:06,332 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:06,332 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:51:06,333 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:06,334 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:51:06,334 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:51:06,335 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:06,337 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:51:06,338 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:06,338 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:06,338 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:06,338 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:51:06,338 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:51:06,338 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:51:06,339 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:51:06,339 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:51:06,339 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:51:06,340 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:51:06,340 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:51:06,340 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:51:06,340 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:51:06,341 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:51:06,341 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:51:06,341 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:06,344 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:51:06,345 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:06,346 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:06,346 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:06,346 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:51:06,346 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:51:06,347 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:51:06,347 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:51:06,358 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:51:06,358 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:06,359 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:06,359 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:51:06,362 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:06,365 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:06,365 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:06,366 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:06,403 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5223, Threshold=0.5907, Accuracy=0.7304, F1=0.8118, Precision=0.9698, Recall=0.6981
2025-08-04 20:51:06,404 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7304, F1: 0.8118, Prec: 0.9698, Rec: 0.6981, Avg Anomaly Score: 0.5223
2025-08-04 20:51:14,664 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:14,664 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:51:14,664 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:51:14,664 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:51:14,664 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:51:14,664 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:14,958 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:14,959 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:15,044 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:51:15,092 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:51:15,092 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:15,211 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:15,217 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:15,217 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:15,222 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:51:15,229 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:15,229 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:51:15,230 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:15,230 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:15,230 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:51:15,238 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:15,241 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:15,243 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:15,245 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:15,248 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:15,250 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:15,252 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:15,255 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:15,258 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:15,259 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:15,261 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:15,270 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:15,270 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:51:15,275 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:51:15,275 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:51:15,279 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:15,280 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:51:15,289 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:15,289 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:51:15,290 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:15,305 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:15,309 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:51:15,314 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:51:15,314 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:15,314 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:15,314 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:15,315 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:15,315 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:15,315 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:51:15,315 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:15,316 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:51:15,316 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:15,318 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:51:15,321 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:51:15,321 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:15,321 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:51:15,324 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:15,324 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:15,325 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:15,325 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:51:15,325 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:51:15,325 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:51:15,325 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:51:15,325 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:51:15,325 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:51:15,326 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:51:15,326 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:51:15,326 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:51:15,327 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:51:15,327 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:51:15,327 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:51:15,327 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:15,327 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:51:15,328 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:15,328 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:15,332 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:15,332 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:51:15,332 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:51:15,332 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:51:15,332 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:51:15,339 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:51:15,339 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:15,340 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:15,340 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:51:15,341 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 128/400.
2025-08-04 20:51:15,443 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:15,443 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:15,444 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 52 anomalous samples to GAN training data (target: 52).
2025-08-04 20:51:15,445 - ClientAppLogger [Client 7] - INFO - [Client] Round 128: Training GAN with 226 samples (174 normal, 52 anomalous).
2025-08-04 20:51:15,445 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:51:15,637 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7842
2025-08-04 20:51:15,637 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7842
2025-08-04 20:51:15,638 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:51:15,670 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5141, Threshold=0.5716, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:51:15,670 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:51:15,671 - ClientAppLogger [Client 7] - INFO - Fit completed for round 128. Duration: 0.33s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 128, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0838515775393596, 'd_loss': 0.7842337124115598, 'post_fit_local_f1': 0.8124594419208306, 'fit_time_seconds': 0.3290390968322754, 'cpu_percent_fit': 24.675, 'ram_mb_fit': 3.16796875, 'accumulated_train_samples_this_round': 226}
2025-08-04 20:51:15,671 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:51:20,935 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:20,936 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:51:20,936 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:51:20,936 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:51:20,936 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:51:20,936 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:21,287 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:21,287 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:21,391 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:51:21,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:51:21,446 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:21,589 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:21,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:21,596 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:21,602 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:51:21,608 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:21,608 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:51:21,608 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:21,608 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:21,608 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:51:21,618 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:21,621 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:21,623 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:21,625 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:21,628 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:21,630 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:21,632 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:21,635 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:21,638 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:21,640 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:21,642 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:21,652 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:21,652 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:51:21,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:51:21,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:51:21,663 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:21,664 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:51:21,675 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:21,675 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:51:21,675 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:21,695 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:21,701 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:51:21,710 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:51:21,710 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:21,710 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:21,711 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:21,711 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:21,711 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:21,712 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:51:21,712 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:21,712 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:51:21,712 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:21,714 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:51:21,714 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:51:21,715 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:21,715 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:51:21,715 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:21,716 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:21,716 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:21,716 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:51:21,716 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:51:21,717 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:51:21,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:51:21,717 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:51:21,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:51:21,717 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:51:21,718 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:51:21,718 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:51:21,718 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:51:21,718 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:51:21,719 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:51:21,719 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:21,719 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:51:21,719 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:21,719 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:21,720 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:21,720 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:51:21,720 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:51:21,720 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:51:21,721 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:51:21,724 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:51:21,724 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:21,726 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:21,726 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:51:21,728 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:21,728 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:21,729 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:21,729 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:21,766 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5166, Threshold=0.5768, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:51:21,766 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5166
2025-08-04 20:51:30,031 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:30,031 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:51:30,031 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:51:30,031 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:51:30,032 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:51:30,032 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:30,357 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:30,357 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:30,471 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:51:30,519 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:51:30,520 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:30,646 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:30,655 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:30,655 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:30,661 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:51:30,666 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:30,666 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:51:30,667 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:30,667 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:30,667 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:51:30,675 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:30,678 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:30,680 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:30,683 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:30,686 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:30,688 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:30,690 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:30,693 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:30,696 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:30,698 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:30,700 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:30,709 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:30,709 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:51:30,714 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:51:30,714 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:51:30,719 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:30,719 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:51:30,729 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:30,730 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:51:30,730 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:30,746 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:30,752 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:51:30,759 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:51:30,759 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:30,759 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:30,759 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:30,760 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:30,760 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:30,760 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:51:30,760 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:30,761 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:51:30,761 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:30,763 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:51:30,763 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:51:30,763 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:30,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:51:30,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:30,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:30,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:30,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:51:30,765 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:51:30,765 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:51:30,765 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:51:30,766 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:51:30,766 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:51:30,767 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:51:30,767 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:51:30,767 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:51:30,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:51:30,768 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:51:30,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:51:30,768 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:30,769 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:51:30,769 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:30,769 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:30,770 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:30,770 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:51:30,771 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:51:30,771 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:51:30,771 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:51:30,776 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:51:30,776 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:30,778 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:30,778 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:51:30,780 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 129/400.
2025-08-04 20:51:30,881 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:30,881 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:30,882 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 52 anomalous samples to GAN training data (target: 52).
2025-08-04 20:51:30,883 - ClientAppLogger [Client 7] - INFO - [Client] Round 129: Training GAN with 227 samples (175 normal, 52 anomalous).
2025-08-04 20:51:30,883 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:51:31,068 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0848, Avg D Loss: 0.7757
2025-08-04 20:51:31,068 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0848, Avg D Loss: 0.7757
2025-08-04 20:51:31,068 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:51:31,099 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5067, Threshold=0.5733, Accuracy=0.7294, F1=0.8112, Precision=0.9690, Recall=0.6975
2025-08-04 20:51:31,099 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8112
2025-08-04 20:51:31,099 - ClientAppLogger [Client 7] - INFO - Fit completed for round 129. Duration: 0.32s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 129, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0847668080602975, 'd_loss': 0.7757483080095132, 'post_fit_local_f1': 0.8111615833874107, 'fit_time_seconds': 0.31951308250427246, 'cpu_percent_fit': 24.59375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 227}
2025-08-04 20:51:31,099 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:51:39,384 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:39,385 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:51:39,385 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:51:39,385 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:51:39,385 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:51:39,385 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:39,751 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:39,751 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:39,846 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:51:39,898 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:51:39,898 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:40,024 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:40,030 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:40,031 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:40,036 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:51:40,041 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:40,041 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:51:40,041 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:40,042 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:40,042 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:51:40,050 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:40,052 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:40,054 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:40,057 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:40,060 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:40,062 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:40,065 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:40,067 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:40,070 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:40,071 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:40,074 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:40,082 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:40,082 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:51:40,086 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:51:40,087 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:51:40,091 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:40,091 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:51:40,102 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:40,103 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:51:40,103 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:40,117 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:40,122 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:51:40,127 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:51:40,127 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:40,127 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:40,127 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:40,128 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:40,128 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:40,128 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:51:40,128 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:40,129 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:51:40,129 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:40,130 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:51:40,130 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:51:40,131 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:40,131 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:51:40,131 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:40,131 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:40,131 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:40,131 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:51:40,131 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:51:40,132 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:51:40,132 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:51:40,132 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:51:40,132 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:51:40,132 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:51:40,132 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:51:40,132 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:51:40,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:51:40,133 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:51:40,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:51:40,133 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:40,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:51:40,134 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:40,134 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:40,134 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:40,134 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:51:40,134 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:51:40,135 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:51:40,135 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:51:40,138 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:51:40,139 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:40,140 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:40,140 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:51:40,141 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:40,142 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:40,142 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:40,142 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:40,175 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5166, Threshold=0.5815, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:51:40,175 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5166
2025-08-04 20:51:54,487 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:54,487 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:51:54,487 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:51:54,487 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:51:54,487 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:51:54,487 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:54,916 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:54,916 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:55,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:51:55,044 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:51:55,045 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:55,147 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:55,154 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:55,154 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:55,160 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:51:55,165 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:55,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:51:55,166 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:55,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:55,167 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:51:55,175 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:55,178 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:55,180 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:55,183 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:55,185 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:55,188 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:55,190 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:55,193 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:55,195 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:55,197 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:55,200 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:55,208 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:55,208 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:51:55,213 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:51:55,213 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:51:55,218 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:55,218 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:51:55,227 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:55,227 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:51:55,227 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:55,241 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:55,246 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:51:55,251 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:51:55,252 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:55,252 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:55,252 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:55,252 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:55,253 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:55,253 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:51:55,253 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:55,253 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:51:55,253 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:55,255 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:51:55,255 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:51:55,255 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:55,255 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:51:55,256 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:55,256 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:55,256 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:55,256 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:51:55,256 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:51:55,256 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:51:55,256 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:51:55,257 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:51:55,257 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:51:55,257 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:51:55,257 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:51:55,257 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:51:55,258 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:51:55,258 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:51:55,258 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:51:55,258 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:55,258 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:51:55,258 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:55,259 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:55,259 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:55,259 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:51:55,259 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:51:55,260 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:51:55,260 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:51:55,264 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:51:55,265 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:55,266 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:55,266 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:51:55,267 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:55,267 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:55,267 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:55,268 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:55,300 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4885, Threshold=0.5339, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:51:55,300 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.4885
2025-08-04 20:52:00,569 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:00,570 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:52:00,570 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:52:00,570 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:52:00,570 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:52:00,570 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:00,881 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:00,881 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:00,968 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:52:01,008 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:52:01,008 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:01,128 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:01,134 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:01,134 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:01,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:52:01,144 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:01,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:52:01,145 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:01,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:01,146 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:52:01,154 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:01,158 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:01,161 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:01,163 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:01,166 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:01,168 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:01,171 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:01,173 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:01,176 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:01,178 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:01,180 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:01,189 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:01,189 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:52:01,194 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:52:01,194 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:52:01,198 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:01,198 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:52:01,206 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:01,207 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:52:01,207 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:01,221 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:01,225 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:52:01,230 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:52:01,231 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:01,231 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:01,231 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:01,231 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:01,231 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:01,232 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:52:01,232 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:01,232 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:52:01,232 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:01,233 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:52:01,233 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:52:01,234 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:01,234 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:52:01,234 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:01,234 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:01,234 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:01,234 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:52:01,235 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:52:01,235 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:52:01,235 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:52:01,235 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:52:01,235 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:52:01,235 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:52:01,235 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:52:01,236 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:52:01,236 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:52:01,236 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:52:01,236 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:52:01,236 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:01,236 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:52:01,236 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:01,237 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:01,237 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:01,237 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:52:01,237 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:52:01,238 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:52:01,238 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:52:01,241 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:52:01,241 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:01,242 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:01,243 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:52:01,244 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 131/400.
2025-08-04 20:52:01,345 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:01,345 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:01,346 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 53 anomalous samples to GAN training data (target: 53).
2025-08-04 20:52:01,346 - ClientAppLogger [Client 7] - INFO - [Client] Round 131: Training GAN with 231 samples (178 normal, 53 anomalous).
2025-08-04 20:52:01,347 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:01,539 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0866, Avg D Loss: 0.7926
2025-08-04 20:52:01,539 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0866, Avg D Loss: 0.7926
2025-08-04 20:52:01,540 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:01,573 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4919, Threshold=0.5377, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:52:01,573 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:52:01,573 - ClientAppLogger [Client 7] - INFO - Fit completed for round 131. Duration: 0.33s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 131, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.086568917650165, 'd_loss': 0.7925547199331837, 'post_fit_local_f1': 0.8124594419208306, 'fit_time_seconds': 0.32933473587036133, 'cpu_percent_fit': 24.86875, 'ram_mb_fit': 0.4921875, 'accumulated_train_samples_this_round': 231}
2025-08-04 20:52:01,574 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:52:06,878 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:06,878 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:52:06,878 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:52:06,878 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:52:06,879 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:52:06,879 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:07,244 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:07,244 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:07,331 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:52:07,353 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:52:07,354 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:07,439 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:07,445 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:07,445 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:07,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:52:07,456 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:07,456 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:52:07,457 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:07,457 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:07,457 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:52:07,466 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:07,468 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:07,471 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:07,473 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:07,475 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:07,478 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:07,480 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:07,483 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:07,486 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:07,487 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:07,490 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:07,501 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:07,501 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:52:07,506 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:52:07,506 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:52:07,512 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:07,512 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:52:07,521 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:07,522 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:52:07,522 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:07,537 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:07,541 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:52:07,547 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:52:07,547 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:07,547 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:07,547 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:07,547 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:07,548 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:07,548 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:52:07,548 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:07,548 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:52:07,548 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:07,550 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:52:07,550 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:52:07,550 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:07,551 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:52:07,551 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:07,551 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:07,551 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:07,551 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:52:07,551 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:52:07,552 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:52:07,552 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:52:07,552 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:52:07,552 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:52:07,552 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:52:07,553 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:52:07,553 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:52:07,553 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:52:07,553 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:52:07,554 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:52:07,554 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:07,554 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:52:07,554 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:07,555 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:07,555 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:07,555 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:52:07,555 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:52:07,555 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:52:07,555 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:52:07,559 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:52:07,560 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:07,561 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:07,562 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:52:07,563 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:07,563 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:07,564 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:07,564 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:07,599 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5143, Threshold=0.5744, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:52:07,599 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5143
2025-08-04 20:52:12,871 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:12,871 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:52:12,872 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:52:12,872 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:52:12,872 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:52:12,872 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:13,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:13,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:13,224 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:52:13,266 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:52:13,267 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:13,382 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:13,387 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:13,387 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:13,392 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:52:13,398 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:13,399 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:52:13,399 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:13,399 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:13,399 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:52:13,408 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:13,410 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:13,413 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:13,415 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:13,417 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:13,420 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:13,422 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:13,424 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:13,427 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:13,429 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:13,431 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:13,441 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:13,442 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:52:13,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:52:13,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:52:13,452 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:13,452 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:52:13,463 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:13,463 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:52:13,464 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:13,480 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:13,485 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:52:13,490 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:52:13,490 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:13,490 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:13,490 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:13,491 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:13,491 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:13,491 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:52:13,491 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:13,491 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:52:13,492 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:13,493 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:52:13,493 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:52:13,493 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:13,493 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:52:13,494 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:13,494 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:13,494 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:13,494 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:52:13,494 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:52:13,494 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:52:13,494 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:52:13,495 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:52:13,495 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:52:13,495 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:52:13,495 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:52:13,495 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:52:13,496 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:52:13,496 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:52:13,496 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:52:13,496 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:13,496 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:52:13,496 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:13,497 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:13,497 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:13,497 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:52:13,497 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:52:13,497 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:52:13,498 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:52:13,501 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:52:13,501 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:13,503 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:13,503 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:52:13,504 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 132/400.
2025-08-04 20:52:13,605 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:13,605 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:13,610 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 54 anomalous samples to GAN training data (target: 54).
2025-08-04 20:52:13,611 - ClientAppLogger [Client 7] - INFO - [Client] Round 132: Training GAN with 235 samples (181 normal, 54 anomalous).
2025-08-04 20:52:13,611 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:13,799 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0845, Avg D Loss: 0.7916
2025-08-04 20:52:13,800 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0845, Avg D Loss: 0.7916
2025-08-04 20:52:13,800 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:13,834 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5337, Threshold=0.6023, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:52:13,835 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:52:13,835 - ClientAppLogger [Client 7] - INFO - Fit completed for round 132. Duration: 0.33s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 132, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0845061905840607, 'd_loss': 0.7916341990612923, 'post_fit_local_f1': 0.8124594419208306, 'fit_time_seconds': 0.3304307460784912, 'cpu_percent_fit': 24.46875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 235}
2025-08-04 20:52:13,835 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:52:19,139 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:19,140 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:52:19,140 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:52:19,140 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:52:19,140 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:52:19,140 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:19,506 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:19,506 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:19,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:52:19,616 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:52:19,617 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:19,709 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:19,715 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:19,716 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:19,721 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:52:19,728 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:19,728 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:52:19,728 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:19,728 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:19,728 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:52:19,737 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:19,740 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:19,742 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:19,744 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:19,747 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:19,749 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:19,752 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:19,754 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:19,757 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:19,759 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:19,761 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:19,771 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:19,771 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:52:19,776 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:52:19,776 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:52:19,781 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:19,781 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:52:19,793 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:19,794 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:52:19,794 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:19,810 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:19,815 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:52:19,821 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:52:19,821 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:19,821 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:19,821 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:19,821 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:19,822 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:19,822 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:52:19,822 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:19,822 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:52:19,822 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:19,824 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:52:19,824 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:52:19,824 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:19,824 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:52:19,824 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:19,825 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:19,825 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:19,825 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:52:19,825 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:52:19,825 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:52:19,825 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:52:19,825 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:52:19,826 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:52:19,826 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:52:19,826 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:52:19,826 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:52:19,826 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:52:19,826 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:52:19,827 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:52:19,827 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:19,827 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:52:19,827 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:19,827 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:19,828 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:19,828 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:52:19,828 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:52:19,828 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:52:19,828 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:52:19,832 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:52:19,832 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:19,833 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:19,834 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:52:19,835 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:19,835 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:19,835 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:19,836 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:19,870 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5343, Threshold=0.5977, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:52:19,870 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5343
2025-08-04 20:52:37,175 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:37,175 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:52:37,175 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:52:37,175 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:52:37,175 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:52:37,175 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:37,532 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:37,532 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:37,625 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:52:37,665 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:52:37,665 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:37,790 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:37,798 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:37,798 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:37,804 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:52:37,811 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:37,811 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:52:37,812 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:37,812 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:37,812 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:52:37,821 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:37,824 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:37,826 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:37,828 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:37,831 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:37,833 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:37,836 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:37,838 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:37,841 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:37,843 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:37,846 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:37,856 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:37,856 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:52:37,861 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:52:37,861 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:52:37,866 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:37,866 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:52:37,876 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:37,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:52:37,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:37,893 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:37,898 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:52:37,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:52:37,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:37,903 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:37,903 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:37,904 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:37,904 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:37,904 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:52:37,904 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:37,905 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:52:37,905 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:37,906 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:52:37,906 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:52:37,906 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:37,907 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:52:37,907 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:37,907 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:37,907 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:37,907 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:52:37,907 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:52:37,908 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:52:37,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:52:37,908 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:52:37,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:52:37,908 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:52:37,909 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:52:37,909 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:52:37,909 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:52:37,909 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:52:37,909 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:52:37,910 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:37,910 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:52:37,910 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:37,910 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:37,910 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:37,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:52:37,911 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:52:37,911 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:52:37,911 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:52:37,915 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:52:37,915 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:37,917 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:37,917 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:52:37,918 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:37,919 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:37,919 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:37,920 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:37,955 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5725, Threshold=0.6436, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:52:37,955 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5725
2025-08-04 20:52:43,210 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:43,210 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:52:43,210 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:52:43,210 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:52:43,210 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:52:43,210 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:43,486 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:43,486 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:43,569 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:52:43,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:52:43,592 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:43,680 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:43,686 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:43,686 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:43,691 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:52:43,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:43,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:52:43,696 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:43,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:43,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:52:43,705 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:43,707 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:43,709 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:43,712 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:43,715 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:43,717 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:43,719 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:43,721 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:43,724 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:43,726 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:43,728 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:43,737 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:43,738 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:52:43,742 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:52:43,742 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:52:43,747 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:43,747 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:52:43,757 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:43,757 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:52:43,757 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:43,772 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:43,776 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:52:43,781 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:52:43,781 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:43,781 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:43,782 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:43,782 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:43,782 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:43,782 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:52:43,783 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:43,783 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:52:43,783 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:43,784 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:52:43,784 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:52:43,785 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:43,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:52:43,785 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:43,785 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:43,785 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:43,785 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:52:43,785 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:52:43,786 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:52:43,786 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:52:43,786 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:52:43,786 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:52:43,786 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:52:43,786 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:52:43,787 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:52:43,787 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:52:43,787 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:52:43,787 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:52:43,787 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:43,787 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:52:43,787 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:43,788 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:43,788 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:43,788 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:52:43,788 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:52:43,788 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:52:43,788 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:52:43,792 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:52:43,792 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:43,793 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:43,793 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:52:43,795 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 134/400.
2025-08-04 20:52:43,896 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:43,896 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:43,897 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 55 anomalous samples to GAN training data (target: 55).
2025-08-04 20:52:43,898 - ClientAppLogger [Client 7] - INFO - [Client] Round 134: Training GAN with 239 samples (184 normal, 55 anomalous).
2025-08-04 20:52:43,898 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:44,094 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0845, Avg D Loss: 0.7917
2025-08-04 20:52:44,094 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0845, Avg D Loss: 0.7917
2025-08-04 20:52:44,094 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:44,126 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5022, Threshold=0.5487, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:52:44,126 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:52:44,126 - ClientAppLogger [Client 7] - INFO - Fit completed for round 134. Duration: 0.33s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 134, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0845160626966086, 'd_loss': 0.7916967416657563, 'post_fit_local_f1': 0.8124594419208306, 'fit_time_seconds': 0.33156323432922363, 'cpu_percent_fit': 24.65, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 239}
2025-08-04 20:52:44,127 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:52:49,423 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:49,424 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:52:49,424 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:52:49,424 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:52:49,424 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:52:49,424 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:49,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:49,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:49,852 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:52:49,901 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:52:49,901 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:50,026 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:50,035 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:50,035 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:50,042 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:52:50,051 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:50,051 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:52:50,051 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:50,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:50,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:52:50,061 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:50,063 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:50,065 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:50,067 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:50,070 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:50,072 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:50,075 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:50,077 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:50,080 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:50,082 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:50,084 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:50,094 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:50,094 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:52:50,099 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:52:50,099 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:52:50,104 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:50,104 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:52:50,114 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:50,114 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:52:50,114 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:50,130 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:50,136 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:52:50,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:52:50,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:50,145 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:50,145 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:50,146 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:50,146 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:50,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:52:50,146 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:50,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:52:50,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:50,148 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:52:50,148 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:52:50,149 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:50,149 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:52:50,149 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:50,149 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:50,149 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:50,150 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:52:50,150 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:52:50,150 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:52:50,150 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:52:50,150 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:52:50,150 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:52:50,151 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:52:50,151 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:52:50,151 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:52:50,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:52:50,152 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:52:50,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:52:50,152 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:50,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:52:50,153 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:50,153 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:50,153 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:50,154 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:52:50,154 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:52:50,154 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:52:50,154 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:52:50,161 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:52:50,161 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:50,162 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:50,163 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:52:50,164 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:50,164 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:50,164 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:50,165 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:50,202 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5105, Threshold=0.5617, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:52:50,202 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5105
2025-08-04 20:52:55,470 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:55,470 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:52:55,470 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:52:55,470 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:52:55,470 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:52:55,471 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:55,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:55,791 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:55,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:52:55,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:52:55,902 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:56,013 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:56,021 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:56,021 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:56,027 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:52:56,033 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:56,034 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:52:56,034 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:56,034 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:56,035 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:52:56,043 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:56,046 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:56,048 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:56,050 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:56,053 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:56,055 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:56,057 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:56,060 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:56,063 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:56,064 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:56,067 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:56,077 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:56,077 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:52:56,082 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:52:56,082 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:52:56,087 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:56,088 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:52:56,097 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:56,098 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:52:56,098 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:56,113 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:56,118 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:52:56,124 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:52:56,124 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:56,124 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:56,124 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:56,125 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:56,125 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:56,125 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:52:56,125 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:56,126 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:52:56,126 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:56,127 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:52:56,127 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:52:56,128 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:56,128 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:52:56,128 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:56,128 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:56,128 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:56,128 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:52:56,128 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:52:56,129 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:52:56,129 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:52:56,129 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:52:56,129 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:52:56,129 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:52:56,129 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:52:56,130 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:52:56,130 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:52:56,130 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:52:56,130 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:52:56,130 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:56,130 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:52:56,131 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:56,131 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:56,131 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:56,132 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:52:56,132 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:52:56,132 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:52:56,132 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:52:56,138 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:52:56,139 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:56,140 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:56,140 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:52:56,141 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 135/400.
2025-08-04 20:52:56,243 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:56,243 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:56,245 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 55 anomalous samples to GAN training data (target: 55).
2025-08-04 20:52:56,245 - ClientAppLogger [Client 7] - INFO - [Client] Round 135: Training GAN with 240 samples (185 normal, 55 anomalous).
2025-08-04 20:52:56,245 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:56,445 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0832, Avg D Loss: 0.7755
2025-08-04 20:52:56,445 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0832, Avg D Loss: 0.7755
2025-08-04 20:52:56,445 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:56,479 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5164, Threshold=0.5856, Accuracy=0.7304, F1=0.8118, Precision=0.9698, Recall=0.6981
2025-08-04 20:52:56,479 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8118
2025-08-04 20:52:56,480 - ClientAppLogger [Client 7] - INFO - Fit completed for round 135. Duration: 0.34s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 135, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.083171211878459, 'd_loss': 0.7754849366346995, 'post_fit_local_f1': 0.8118105126541207, 'fit_time_seconds': 0.3382439613342285, 'cpu_percent_fit': 25.05, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 240}
2025-08-04 20:52:56,480 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:53:01,762 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:01,762 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:53:01,762 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:53:01,762 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:53:01,762 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:53:01,763 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:02,077 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:02,078 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:02,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:53:02,199 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:53:02,199 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:02,337 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:02,345 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:02,345 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:02,351 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:53:02,361 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:02,362 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:53:02,362 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:02,362 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:02,363 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:53:02,371 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:02,374 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:02,377 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:02,379 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:02,382 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:02,384 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:02,386 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:02,389 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:02,392 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:02,394 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:02,396 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:02,409 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:02,410 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:53:02,416 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:53:02,416 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:53:02,424 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:02,425 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:53:02,443 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:02,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:53:02,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:02,460 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:02,466 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:53:02,475 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:53:02,476 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:02,476 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:02,476 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:02,477 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:02,477 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:02,477 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:53:02,477 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:02,478 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:53:02,478 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:02,479 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:53:02,479 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:53:02,480 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:02,480 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:53:02,480 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:02,480 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:02,481 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:02,481 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:53:02,481 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:53:02,482 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:53:02,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:53:02,482 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:53:02,482 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:53:02,483 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:53:02,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:53:02,483 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:53:02,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:53:02,484 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:53:02,484 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:53:02,484 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:02,484 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:53:02,484 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:02,485 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:02,485 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:02,485 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:53:02,485 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:53:02,485 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:53:02,486 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:53:02,491 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:53:02,491 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:02,493 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:02,493 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:53:02,495 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:02,495 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:02,495 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:02,496 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:02,533 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5167, Threshold=0.5813, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:53:02,533 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5167
2025-08-04 20:53:13,803 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:13,803 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:53:13,803 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:53:13,803 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:53:13,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:53:13,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:14,130 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:14,130 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:14,220 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:53:14,260 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:53:14,260 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:14,368 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:14,376 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:14,376 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:14,382 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:53:14,392 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:14,392 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:53:14,393 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:14,393 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:14,393 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:53:14,403 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:14,406 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:14,408 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:14,410 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:14,413 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:14,415 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:14,418 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:14,421 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:14,424 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:14,426 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:14,428 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:14,438 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:14,439 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:53:14,444 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:53:14,444 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:53:14,452 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:14,453 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:53:14,472 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:14,472 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:53:14,473 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:14,490 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:14,497 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:53:14,505 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:53:14,506 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:14,506 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:14,506 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:14,506 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:14,507 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:14,507 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:53:14,507 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:14,507 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:53:14,507 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:14,509 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:53:14,509 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:53:14,509 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:14,509 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:53:14,510 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:14,510 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:14,510 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:14,510 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:53:14,510 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:53:14,510 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:53:14,510 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:53:14,511 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:53:14,511 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:53:14,511 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:53:14,511 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:53:14,512 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:53:14,512 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:53:14,512 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:53:14,512 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:53:14,512 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:14,513 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:53:14,513 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:14,513 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:14,513 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:14,514 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:53:14,514 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:53:14,514 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:53:14,514 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:53:14,522 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:53:14,522 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:14,523 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:14,524 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:53:14,525 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:14,525 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:14,525 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:14,526 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:14,566 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5461, Threshold=0.6107, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:53:14,567 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5461
2025-08-04 20:53:34,848 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:34,849 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:53:34,849 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:53:34,849 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:53:34,849 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:53:34,849 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:35,227 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:35,227 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:35,320 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:53:35,363 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:53:35,363 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:35,518 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:35,529 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:35,530 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:35,541 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:53:35,553 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:35,553 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:53:35,554 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:35,554 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:35,554 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:53:35,565 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:35,568 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:35,571 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:35,573 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:35,576 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:35,578 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:35,581 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:35,584 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:35,587 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:35,589 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:35,592 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:35,603 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:35,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:53:35,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:53:35,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:53:35,615 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:35,615 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:53:35,631 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:35,631 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:53:35,632 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:35,652 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:35,658 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:53:35,665 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:53:35,666 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:35,666 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:35,666 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:35,666 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:35,667 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:35,667 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:53:35,667 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:35,667 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:53:35,667 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:35,669 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:53:35,669 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:53:35,669 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:35,670 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:53:35,670 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:35,670 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:35,670 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:35,670 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:53:35,671 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:53:35,671 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:53:35,671 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:53:35,671 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:53:35,671 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:53:35,672 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:53:35,672 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:53:35,672 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:53:35,672 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:53:35,672 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:53:35,673 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:53:35,673 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:35,673 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:53:35,673 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:35,673 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:35,674 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:35,674 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:53:35,674 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:53:35,675 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:53:35,675 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:53:35,682 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:53:35,682 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:35,684 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:35,684 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:53:35,685 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:35,688 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:35,688 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:35,689 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:35,733 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5453, Threshold=0.6051, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:53:35,733 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5453
2025-08-04 20:53:40,976 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:40,976 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:53:40,977 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:53:40,977 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:53:40,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:53:40,977 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:41,263 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:41,263 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:41,349 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:53:41,387 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:53:41,387 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:41,477 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:41,484 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:41,484 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:41,490 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:53:41,498 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:41,498 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:53:41,498 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:41,498 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:41,499 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:53:41,507 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:41,510 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:41,512 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:41,514 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:41,517 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:41,520 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:41,522 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:41,525 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:41,528 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:41,529 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:41,532 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:41,542 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:41,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:53:41,547 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:53:41,547 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:53:41,552 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:41,553 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:53:41,564 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:41,564 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:53:41,564 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:41,578 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:41,583 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:53:41,588 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:53:41,588 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:41,588 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:41,589 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:41,589 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:41,589 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:41,589 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:53:41,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:41,590 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:53:41,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:41,591 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:53:41,591 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:53:41,591 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:41,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:53:41,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:41,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:41,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:41,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:53:41,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:53:41,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:53:41,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:53:41,593 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:53:41,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:53:41,593 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:53:41,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:53:41,594 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:53:41,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:53:41,594 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:53:41,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:53:41,594 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:41,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:53:41,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:41,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:41,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:41,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:53:41,595 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:53:41,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:53:41,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:53:41,597 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:53:41,597 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:41,598 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:41,598 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:53:41,600 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 138/400.
2025-08-04 20:53:41,701 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:41,701 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:41,703 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 56 anomalous samples to GAN training data (target: 56).
2025-08-04 20:53:41,703 - ClientAppLogger [Client 7] - INFO - [Client] Round 138: Training GAN with 244 samples (188 normal, 56 anomalous).
2025-08-04 20:53:41,703 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:53:41,902 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0826, Avg D Loss: 0.7865
2025-08-04 20:53:41,902 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0826, Avg D Loss: 0.7865
2025-08-04 20:53:41,902 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:53:41,934 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5249, Threshold=0.5895, Accuracy=0.7304, F1=0.8118, Precision=0.9698, Recall=0.6981
2025-08-04 20:53:41,934 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8118
2025-08-04 20:53:41,934 - ClientAppLogger [Client 7] - INFO - Fit completed for round 138. Duration: 0.33s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 138, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.082584232580466, 'd_loss': 0.7864655766330781, 'post_fit_local_f1': 0.8118105126541207, 'fit_time_seconds': 0.33463263511657715, 'cpu_percent_fit': 24.8375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 244}
2025-08-04 20:53:41,935 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:53:56,210 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:56,210 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:53:56,210 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:53:56,210 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:53:56,210 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:53:56,210 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:56,499 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:56,499 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:56,600 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:53:56,644 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:53:56,644 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:56,780 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:56,787 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:56,787 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:56,794 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:53:56,802 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:56,802 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:53:56,803 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:56,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:56,803 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:53:56,812 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:56,816 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:56,818 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:56,820 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:56,823 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:56,825 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:56,828 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:56,831 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:56,834 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:56,836 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:56,838 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:56,850 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:56,850 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:53:56,855 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:53:56,855 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:53:56,860 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:56,860 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:53:56,871 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:56,872 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:53:56,872 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:56,888 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:56,893 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:53:56,900 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:53:56,900 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:56,900 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:56,900 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:56,901 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:56,901 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:56,901 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:53:56,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:56,902 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:53:56,902 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:56,903 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:53:56,904 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:53:56,904 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:56,904 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:53:56,904 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:56,905 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:56,905 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:56,905 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:53:56,905 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:53:56,906 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:53:56,906 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:53:56,906 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:53:56,906 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:53:56,907 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:53:56,907 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:53:56,907 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:53:56,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:53:56,908 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:53:56,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:53:56,908 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:56,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:53:56,909 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:56,909 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:56,909 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:56,909 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:53:56,910 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:53:56,910 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:53:56,910 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:53:56,914 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:53:56,914 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:56,916 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:56,917 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:53:56,918 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:56,919 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:56,919 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:56,920 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:56,976 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5363, Threshold=0.6012, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:53:56,976 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5363
2025-08-04 20:54:14,261 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:14,262 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:54:14,262 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:54:14,262 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:54:14,262 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:54:14,262 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:14,691 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:14,691 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:14,801 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:54:14,829 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:54:14,830 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:15,038 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:15,049 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:15,049 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:15,058 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:54:15,069 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:15,072 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:54:15,073 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:15,074 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:15,074 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:54:15,086 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:15,090 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:15,092 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:15,096 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:15,100 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:15,103 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:15,106 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:15,110 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:15,114 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:15,116 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:15,118 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:15,133 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:15,133 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:54:15,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:54:15,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:54:15,147 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:15,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:54:15,161 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:15,164 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:54:15,164 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:15,189 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:15,198 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:54:15,211 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:54:15,211 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:15,211 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:15,211 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:15,212 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:15,212 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:15,213 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:54:15,213 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:15,213 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:54:15,214 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:15,215 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:54:15,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:54:15,217 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:15,217 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:54:15,218 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:15,218 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:15,218 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:15,218 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:54:15,219 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:54:15,219 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:54:15,219 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:54:15,219 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:54:15,219 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:54:15,220 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:54:15,220 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:54:15,221 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:54:15,221 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:54:15,221 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:54:15,222 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:54:15,222 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:15,222 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:54:15,223 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:15,223 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:15,224 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:15,224 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:54:15,224 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:54:15,225 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:54:15,225 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:54:15,233 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:54:15,233 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:15,234 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:15,235 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:54:15,236 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:15,236 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:15,236 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:15,237 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:15,277 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5725, Threshold=0.6463, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:54:15,277 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5725
2025-08-04 20:54:20,551 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:20,551 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:54:20,551 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:54:20,551 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:54:20,551 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:54:20,551 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:20,876 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:20,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:20,965 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:54:21,013 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:54:21,013 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:21,151 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:21,158 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:21,159 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:21,166 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:54:21,173 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:21,174 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:54:21,174 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:21,174 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:21,175 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:54:21,185 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:21,188 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:21,190 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:21,192 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:21,195 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:21,197 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:21,200 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:21,203 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:21,206 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:21,208 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:21,210 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:21,219 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:21,220 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:54:21,225 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:54:21,225 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:54:21,231 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:21,231 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:54:21,244 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:21,244 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:54:21,245 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:21,262 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:21,268 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:54:21,282 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:54:21,283 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:21,283 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:21,283 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:21,283 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:21,283 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:21,284 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:54:21,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:21,284 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:54:21,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:21,286 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:54:21,286 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:54:21,287 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:21,287 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:54:21,287 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:21,287 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:21,287 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:21,287 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:54:21,288 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:54:21,288 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:54:21,288 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:54:21,288 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:54:21,288 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:54:21,289 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:54:21,289 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:54:21,289 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:54:21,289 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:54:21,290 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:54:21,290 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:54:21,290 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:21,290 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:54:21,291 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:21,291 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:21,291 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:21,291 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:54:21,292 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:54:21,292 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:54:21,292 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:54:21,301 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:54:21,301 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:21,303 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:21,303 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:54:21,305 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 140/400.
2025-08-04 20:54:21,406 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:21,406 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:21,407 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 57 anomalous samples to GAN training data (target: 57).
2025-08-04 20:54:21,408 - ClientAppLogger [Client 7] - INFO - [Client] Round 140: Training GAN with 249 samples (192 normal, 57 anomalous).
2025-08-04 20:54:21,408 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:54:21,630 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0849, Avg D Loss: 0.7965
2025-08-04 20:54:21,630 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0849, Avg D Loss: 0.7965
2025-08-04 20:54:21,630 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:54:21,667 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5128, Threshold=0.5570, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:54:21,667 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8125
2025-08-04 20:54:21,668 - ClientAppLogger [Client 7] - INFO - Fit completed for round 140. Duration: 0.36s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 140, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.084854203821665, 'd_loss': 0.7964935216319609, 'post_fit_local_f1': 0.8124594419208306, 'fit_time_seconds': 0.36298036575317383, 'cpu_percent_fit': 24.78125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 249}
2025-08-04 20:54:21,668 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:54:32,948 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:32,948 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:54:32,949 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:54:32,949 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:54:32,949 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:54:32,949 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:33,302 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:33,302 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:33,408 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:54:33,464 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:54:33,465 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:33,683 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:33,693 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:33,693 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:33,708 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:54:33,718 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:33,718 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:54:33,719 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:33,720 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:33,720 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:54:33,733 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:33,737 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:33,740 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:33,743 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:33,746 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:33,749 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:33,752 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:33,755 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:33,758 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:33,760 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:33,764 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:33,782 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:33,783 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:54:33,788 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:54:33,789 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:54:33,799 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:33,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:54:33,831 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:33,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:54:33,832 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:33,856 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:33,865 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:54:33,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:54:33,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:33,877 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:33,877 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:33,878 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:33,878 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:33,878 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:54:33,879 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:33,879 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:54:33,879 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:33,881 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:54:33,881 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:54:33,881 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:33,881 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:54:33,882 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:33,882 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:33,882 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:33,882 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:54:33,882 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:54:33,883 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:54:33,883 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:54:33,883 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:54:33,883 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:54:33,884 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:54:33,884 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:54:33,884 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:54:33,884 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:54:33,885 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:54:33,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:54:33,885 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:33,885 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:54:33,890 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:33,891 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:33,891 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:33,892 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:54:33,892 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:54:33,892 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:54:33,893 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:54:33,899 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:54:33,900 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:33,906 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:33,909 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:54:33,913 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:33,913 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:33,913 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:33,915 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:33,983 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5298, Threshold=0.5875, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:54:33,983 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5298
2025-08-04 20:54:54,269 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:54,269 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:54:54,269 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:54:54,269 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:54:54,270 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:54:54,270 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:54,728 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:54,731 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:54,838 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:54:54,893 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:54:54,893 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:55,099 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:55,109 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:55,110 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:55,118 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:54:55,126 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:55,126 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:54:55,126 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:55,126 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:55,127 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:54:55,136 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:55,139 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:55,141 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:55,144 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:55,147 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:55,150 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:55,152 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:55,155 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:55,158 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:55,160 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:55,163 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:55,175 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:55,176 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:54:55,181 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:54:55,181 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:54:55,188 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:55,189 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:54:55,215 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:55,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:54:55,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:55,236 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:55,241 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:54:55,248 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:54:55,249 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:55,249 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:55,249 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:55,249 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:55,250 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:55,250 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:54:55,250 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:55,250 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:54:55,250 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:55,252 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:54:55,252 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:54:55,252 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:55,253 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:54:55,253 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:55,253 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:55,253 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:55,253 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:54:55,254 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:54:55,254 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:54:55,254 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:54:55,254 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:54:55,254 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:54:55,255 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:54:55,255 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:54:55,255 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:54:55,256 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:54:55,257 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:54:55,257 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:54:55,257 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:55,257 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:54:55,258 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:55,258 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:55,258 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:55,258 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:54:55,259 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:54:55,259 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:54:55,259 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:54:55,265 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:54:55,265 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:55,267 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:55,267 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:54:55,268 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:55,269 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:55,269 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:55,270 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:55,304 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5602, Threshold=0.6216, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:54:55,305 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5602
2025-08-04 20:55:15,603 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:15,603 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:55:15,603 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:55:15,603 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:55:15,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:55:15,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:16,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:16,018 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:16,114 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:55:16,141 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:55:16,142 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:16,317 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:16,326 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:16,327 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:16,335 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:55:16,344 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:16,345 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:55:16,346 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:16,346 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:16,346 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:55:16,356 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:16,359 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:16,361 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:16,363 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:16,366 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:16,369 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:16,372 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:16,374 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:16,377 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:16,380 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:16,384 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:16,395 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:16,396 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:55:16,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:55:16,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:55:16,409 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:16,409 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:55:16,422 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:16,423 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:55:16,423 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:16,439 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:16,445 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:55:16,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:55:16,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:16,452 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:16,452 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:16,452 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:16,453 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:16,453 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:55:16,453 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:16,453 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:55:16,453 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:16,455 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:55:16,455 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:55:16,455 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:16,455 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:55:16,455 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:16,456 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:16,456 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:16,456 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:55:16,456 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:55:16,456 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:55:16,456 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:55:16,456 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:55:16,457 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:55:16,457 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:55:16,457 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:55:16,457 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:55:16,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:55:16,458 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:55:16,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:55:16,458 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:16,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:55:16,458 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:16,459 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:16,459 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:16,459 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:55:16,459 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:55:16,459 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:55:16,460 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:55:16,464 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:55:16,464 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:16,466 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:16,466 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:55:16,467 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:16,468 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:16,468 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:16,468 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:16,502 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5446, Threshold=0.6056, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:55:16,502 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5446
2025-08-04 20:55:36,794 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:36,795 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:55:36,795 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:55:36,795 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:55:36,795 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:55:36,795 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:37,195 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:37,196 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:37,288 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:55:37,336 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:55:37,336 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:37,468 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:37,476 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:37,476 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:37,483 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:55:37,489 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:37,489 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:55:37,489 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:37,490 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:37,490 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:55:37,498 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:37,501 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:37,503 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:37,506 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:37,508 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:37,511 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:37,514 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:37,516 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:37,520 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:37,521 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:37,525 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:37,536 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:37,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:55:37,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:55:37,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:55:37,548 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:37,548 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:55:37,559 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:37,560 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:55:37,560 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:37,575 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:37,580 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:55:37,588 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:55:37,588 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:37,589 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:37,589 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:37,589 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:37,589 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:37,589 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:55:37,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:37,590 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:55:37,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:37,591 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:55:37,591 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:55:37,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:37,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:55:37,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:37,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:37,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:37,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:55:37,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:55:37,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:55:37,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:55:37,593 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:55:37,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:55:37,593 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:55:37,593 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:55:37,594 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:55:37,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:55:37,594 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:55:37,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:55:37,594 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:37,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:55:37,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:37,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:37,595 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:37,595 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:55:37,595 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:55:37,596 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:55:37,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:55:37,604 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:55:37,604 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:37,606 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:37,606 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:55:37,607 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:37,607 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:37,607 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:37,608 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:37,646 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4786, Threshold=0.5113, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:55:37,646 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.4786
2025-08-04 20:55:42,916 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:42,916 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:55:42,916 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:55:42,917 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:55:42,917 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:55:42,917 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:43,271 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:43,272 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:43,362 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:55:43,384 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:55:43,384 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:43,496 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:43,502 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:43,503 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:43,508 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:55:43,513 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:43,513 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:55:43,514 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:43,514 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:43,514 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:55:43,523 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:43,526 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:43,528 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:43,530 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:43,533 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:43,535 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:43,537 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:43,539 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:43,542 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:43,544 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:43,546 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:43,556 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:43,556 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:55:43,560 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:55:43,561 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:55:43,566 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:43,566 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:55:43,574 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:43,575 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:55:43,575 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:43,591 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:43,597 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:55:43,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:55:43,603 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:43,603 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:43,603 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:43,604 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:43,604 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:43,604 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:55:43,605 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:43,605 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:55:43,605 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:43,606 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:55:43,606 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:55:43,607 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:43,607 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:55:43,607 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:43,607 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:43,607 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:43,607 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:55:43,607 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:55:43,607 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:55:43,607 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:55:43,608 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:55:43,608 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:55:43,608 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:55:43,608 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:55:43,608 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:55:43,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:55:43,609 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:55:43,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:55:43,609 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:43,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:55:43,609 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:43,609 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:43,610 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:43,610 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:55:43,610 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:55:43,610 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:55:43,610 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:55:43,616 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:55:43,616 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:43,617 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:43,617 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:55:43,619 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 144/400.
2025-08-04 20:55:43,720 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:43,720 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:43,721 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 58 anomalous samples to GAN training data (target: 58).
2025-08-04 20:55:43,722 - ClientAppLogger [Client 7] - INFO - [Client] Round 144: Training GAN with 252 samples (194 normal, 58 anomalous).
2025-08-04 20:55:43,722 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:55:43,911 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0846, Avg D Loss: 0.7861
2025-08-04 20:55:43,911 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0846, Avg D Loss: 0.7861
2025-08-04 20:55:43,911 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:55:43,944 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5277, Threshold=0.5838, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 20:55:43,944 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8138
2025-08-04 20:55:43,944 - ClientAppLogger [Client 7] - INFO - Fit completed for round 144. Duration: 0.33s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 144, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0845687616439097, 'd_loss': 0.7861155028381045, 'post_fit_local_f1': 0.8137573004542504, 'fit_time_seconds': 0.32536840438842773, 'cpu_percent_fit': 24.8, 'ram_mb_fit': 4.546875, 'accumulated_train_samples_this_round': 252}
2025-08-04 20:55:43,944 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:55:55,215 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:55,215 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:55:55,215 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:55:55,215 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:55:55,215 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:55:55,216 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:55,629 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:55,630 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:55,734 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:55:55,790 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:55:55,790 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:55,968 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:55,976 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:55,976 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:55,985 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:55:56,002 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:56,003 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:55:56,004 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:56,004 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:56,005 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:55:56,016 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:56,021 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,024 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:56,026 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:56,029 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:56,032 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:56,035 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,038 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:56,041 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:56,044 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:56,047 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:56,067 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:56,067 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:55:56,073 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:55:56,073 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:55:56,083 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:56,083 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:55:56,102 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:56,102 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:55:56,102 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:56,122 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:56,128 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:55:56,140 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:55:56,140 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:56,140 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:56,140 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:56,141 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:56,141 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:56,141 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:55:56,141 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:56,142 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:55:56,145 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:56,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:55:56,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:55:56,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:56,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:55:56,148 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:56,148 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:56,148 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:56,148 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:55:56,149 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:55:56,149 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:55:56,149 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:55:56,149 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:55:56,149 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:55:56,150 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:55:56,150 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:55:56,151 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:55:56,151 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:55:56,151 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:55:56,151 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:55:56,151 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:56,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:55:56,152 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:56,152 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:56,153 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:56,153 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:55:56,153 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:55:56,153 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:55:56,153 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:55:56,165 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:55:56,166 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:56,168 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:56,169 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:55:56,171 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:56,172 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:56,173 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:56,174 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:56,221 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5789, Threshold=0.6516, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 20:55:56,222 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7322, F1: 0.8131, Prec: 0.9713, Rec: 0.6992, Avg Anomaly Score: 0.5789
2025-08-04 20:56:07,499 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:07,499 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:56:07,500 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:56:07,500 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:56:07,500 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:56:07,500 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:07,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:07,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:08,016 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:56:08,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:56:08,052 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:08,175 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:08,185 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:08,185 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:08,198 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:56:08,231 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:08,231 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:56:08,232 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:08,232 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:08,232 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:56:08,242 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:08,246 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:08,249 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:08,251 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:08,254 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:08,257 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:08,260 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:08,263 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:08,266 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:08,269 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:08,272 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:08,285 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:08,286 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:56:08,291 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:56:08,291 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:56:08,299 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:08,299 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:56:08,315 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:08,315 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:56:08,316 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:08,336 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:08,343 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:56:08,359 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:56:08,360 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:08,360 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:08,360 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:08,360 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:08,361 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:08,361 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:56:08,362 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:08,362 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:56:08,363 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:08,364 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:56:08,365 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:56:08,365 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:08,365 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:56:08,365 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:08,366 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:08,366 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:08,366 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:56:08,367 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:56:08,367 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:56:08,367 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:56:08,367 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:56:08,367 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:56:08,368 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:56:08,368 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:56:08,368 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:56:08,369 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:56:08,369 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:56:08,369 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:56:08,369 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:08,369 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:56:08,373 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:08,374 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:08,374 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:08,375 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:56:08,376 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:56:08,377 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:56:08,377 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:56:08,379 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:56:08,380 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:08,383 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:08,384 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:56:08,386 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:08,387 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:08,387 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:08,388 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:08,447 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5061, Threshold=0.5369, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 20:56:08,448 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7331, F1: 0.8138, Prec: 0.9721, Rec: 0.6998, Avg Anomaly Score: 0.5061
2025-08-04 20:56:25,730 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:25,730 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:56:25,731 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:56:25,731 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:56:25,731 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:56:25,731 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:26,118 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:26,119 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:26,217 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:56:26,266 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:56:26,267 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:26,429 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:26,440 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:26,440 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:26,450 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:56:26,458 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:26,459 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:56:26,460 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:26,460 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:26,460 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:56:26,470 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:26,473 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:26,475 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:26,478 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:26,481 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:26,483 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:26,489 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:26,495 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:26,500 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:26,502 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:26,505 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:26,519 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:26,519 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:56:26,524 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:56:26,525 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:56:26,532 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:26,532 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:56:26,550 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:26,550 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:56:26,550 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:26,569 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:26,575 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:56:26,583 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:56:26,583 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:26,583 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:26,583 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:26,584 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:26,584 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:26,584 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:56:26,584 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:26,585 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:56:26,585 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:26,586 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:56:26,587 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:56:26,587 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:26,587 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:56:26,588 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:26,588 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:26,588 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:26,588 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:56:26,588 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:56:26,588 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:56:26,589 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:56:26,589 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:56:26,589 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:56:26,589 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:56:26,589 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:56:26,590 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:56:26,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:56:26,590 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:56:26,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:56:26,591 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:26,591 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:56:26,591 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:26,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:26,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:26,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:56:26,592 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:56:26,592 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:56:26,592 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:56:26,599 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:56:26,599 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:26,601 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:26,601 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:56:26,603 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:26,604 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:26,604 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:26,605 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:26,653 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5614, Threshold=0.6282, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 20:56:26,653 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7322, F1: 0.8131, Prec: 0.9713, Rec: 0.6992, Avg Anomaly Score: 0.5614
2025-08-04 20:56:46,938 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:46,939 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:56:46,939 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:56:46,939 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:56:46,939 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:56:46,939 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:47,351 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:47,351 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:47,445 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:56:47,473 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:56:47,473 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:47,612 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:47,620 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:47,621 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:47,629 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:56:47,636 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:47,637 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:56:47,638 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:47,638 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:47,638 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:56:47,647 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:47,653 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:47,655 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:47,658 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:47,661 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:47,663 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:47,666 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:47,669 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:47,672 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:47,674 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:47,677 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:47,690 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:47,690 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:56:47,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:56:47,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:56:47,704 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:47,706 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:56:47,724 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:47,724 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:56:47,724 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:47,741 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:47,747 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:56:47,759 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:56:47,759 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:47,759 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:47,759 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:47,760 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:47,760 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:47,760 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:56:47,760 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:47,761 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:56:47,761 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:47,762 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:56:47,762 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:56:47,763 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:47,763 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:56:47,763 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:47,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:47,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:47,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:56:47,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:56:47,765 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:56:47,765 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:56:47,765 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:56:47,765 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:56:47,766 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:56:47,766 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:56:47,767 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:56:47,767 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:56:47,767 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:56:47,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:56:47,768 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:47,768 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:56:47,768 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:47,768 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:47,769 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:47,769 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:56:47,769 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:56:47,769 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:56:47,769 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:56:47,777 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:56:47,777 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:47,779 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:47,779 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:56:47,781 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:47,781 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:47,781 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:47,782 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:47,825 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4771, Threshold=0.5030, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:56:47,826 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.4771
2025-08-04 20:57:05,107 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:05,107 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:57:05,107 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:57:05,108 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:57:05,108 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:57:05,108 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:05,420 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:05,420 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:05,516 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:57:05,563 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:57:05,564 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:05,721 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:05,728 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:05,728 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:05,735 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:57:05,745 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:05,745 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:57:05,746 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:05,746 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:05,746 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:57:05,756 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:05,759 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:05,762 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:05,765 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:05,768 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:05,770 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:05,773 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:05,775 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:05,778 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:05,780 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:05,783 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:05,795 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:05,795 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:57:05,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:57:05,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:57:05,809 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:05,810 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:57:05,828 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:05,828 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:57:05,829 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:05,847 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:05,854 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:57:05,861 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:57:05,861 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:05,862 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:05,862 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:05,862 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:05,863 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:05,863 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:57:05,863 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:05,864 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:57:05,864 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:05,866 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:57:05,866 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:57:05,867 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:05,867 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:57:05,867 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:05,867 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:05,867 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:05,868 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:57:05,868 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:57:05,868 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:57:05,868 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:57:05,868 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:57:05,868 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:57:05,869 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:57:05,869 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:57:05,870 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:57:05,870 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:57:05,870 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:57:05,870 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:57:05,870 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:05,871 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:57:05,871 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:05,871 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:05,875 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:05,875 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:57:05,875 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:57:05,875 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:57:05,876 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:57:05,884 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:57:05,884 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:05,886 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:05,886 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:57:05,888 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:05,888 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:05,889 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:05,889 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:05,936 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5328, Threshold=0.5825, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 20:57:05,937 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7322, F1: 0.8131, Prec: 0.9713, Rec: 0.6992, Avg Anomaly Score: 0.5328
2025-08-04 20:57:11,195 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:11,195 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:57:11,195 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:57:11,196 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:57:11,196 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:57:11,196 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:11,546 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:11,546 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:11,631 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:57:11,654 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:57:11,654 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:11,750 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:11,756 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:11,756 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:11,761 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:57:11,780 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:11,781 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:57:11,781 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:11,781 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:11,782 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:57:11,790 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:11,794 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:11,796 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:11,798 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:11,801 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:11,803 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:11,805 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:11,808 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:11,811 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:11,813 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:11,815 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:11,825 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:11,825 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:57:11,830 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:57:11,830 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:57:11,836 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:11,836 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:57:11,847 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:11,847 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:57:11,847 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:11,862 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:11,867 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:57:11,871 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:57:11,872 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:11,872 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:11,872 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:11,872 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:11,872 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:11,872 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:57:11,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:11,873 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:57:11,873 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:11,874 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:57:11,875 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:57:11,875 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:11,875 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:57:11,875 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:11,875 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:11,875 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:11,875 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:57:11,876 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:57:11,876 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:57:11,876 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:57:11,876 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:57:11,876 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:57:11,876 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:57:11,876 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:57:11,877 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:57:11,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:57:11,877 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:57:11,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:57:11,877 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:11,877 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:57:11,878 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:11,878 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:11,882 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:11,882 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:57:11,882 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:57:11,882 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:57:11,882 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:57:11,884 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:57:11,884 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:11,885 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:11,886 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:57:11,887 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 149/400.
2025-08-04 20:57:11,988 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:11,988 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:11,992 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 60 anomalous samples to GAN training data (target: 60).
2025-08-04 20:57:11,993 - ClientAppLogger [Client 7] - INFO - [Client] Round 149: Training GAN with 263 samples (203 normal, 60 anomalous).
2025-08-04 20:57:11,993 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:12,228 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0839, Avg D Loss: 0.7790
2025-08-04 20:57:12,232 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0839, Avg D Loss: 0.7790
2025-08-04 20:57:12,232 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:12,269 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5105, Threshold=0.5490, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 20:57:12,269 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8138
2025-08-04 20:57:12,269 - ClientAppLogger [Client 7] - INFO - Fit completed for round 149. Duration: 0.38s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 149, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0838664057590206, 'd_loss': 0.779033906990131, 'post_fit_local_f1': 0.8137573004542504, 'fit_time_seconds': 0.3821585178375244, 'cpu_percent_fit': 24.4375, 'ram_mb_fit': 5.03515625, 'accumulated_train_samples_this_round': 263}
2025-08-04 20:57:12,269 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:57:26,556 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:26,557 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:57:26,557 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:57:26,557 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:57:26,557 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:57:26,557 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:26,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:26,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:27,010 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:57:27,048 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:57:27,048 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:27,278 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:27,291 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:27,292 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:27,303 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:57:27,315 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:27,315 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:57:27,316 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:27,316 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:27,316 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:57:27,327 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:27,331 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:27,335 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:27,338 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:27,342 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:27,345 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:27,349 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:27,352 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:27,357 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:27,360 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:27,364 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:27,376 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:27,376 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:57:27,382 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:57:27,382 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:57:27,387 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:27,388 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:57:27,403 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:27,403 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:57:27,404 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:27,425 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:27,431 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:57:27,438 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:57:27,438 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:27,438 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:27,439 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:27,439 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:27,439 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:27,440 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:57:27,440 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:27,440 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:57:27,440 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:27,442 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:57:27,442 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:57:27,443 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:27,443 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:57:27,443 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:27,443 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:27,444 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:27,444 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:57:27,444 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:57:27,444 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:57:27,444 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:57:27,444 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:57:27,444 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:57:27,445 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:57:27,445 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:57:27,445 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:57:27,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:57:27,446 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:57:27,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:57:27,446 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:27,447 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:57:27,447 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:27,447 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:27,451 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:27,451 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:57:27,451 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:57:27,452 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:57:27,453 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:57:27,459 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:57:27,460 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:27,461 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:27,462 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:57:27,463 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:27,464 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:27,464 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:27,465 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:27,508 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5409, Threshold=0.5920, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 20:57:27,508 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7331, F1: 0.8138, Prec: 0.9721, Rec: 0.6998, Avg Anomaly Score: 0.5409
2025-08-04 20:57:47,821 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:47,821 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:57:47,821 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:57:47,822 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:57:47,822 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:57:47,822 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:48,162 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:48,162 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:48,249 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:57:48,273 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:57:48,273 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:48,394 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:48,401 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:48,401 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:48,408 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:57:48,434 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:48,434 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:57:48,435 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:48,435 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:48,435 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:57:48,444 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:48,447 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:48,449 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:48,451 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:48,454 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:48,456 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:48,459 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:48,462 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:48,465 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:48,467 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:48,469 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:48,480 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:48,480 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:57:48,486 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:57:48,486 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:57:48,492 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:48,492 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:57:48,504 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:48,505 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:57:48,505 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:48,522 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:48,528 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:57:48,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:57:48,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:48,537 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:48,537 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:48,538 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:48,538 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:48,538 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:57:48,539 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:48,539 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:57:48,539 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:48,541 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:57:48,541 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:57:48,541 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:48,542 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:57:48,542 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:48,542 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:48,542 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:48,542 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:57:48,543 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:57:48,543 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:57:48,543 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:57:48,543 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:57:48,543 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:57:48,544 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:57:48,544 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:57:48,545 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:57:48,545 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:57:48,545 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:57:48,545 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:57:48,546 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:48,546 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:57:48,546 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:48,546 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:48,550 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:48,550 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:57:48,551 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:57:48,551 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:57:48,551 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:57:48,563 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:57:48,564 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:48,565 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:48,565 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:57:48,567 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:48,567 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:48,567 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:48,568 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:48,607 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5457, Threshold=0.6017, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 20:57:48,607 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7331, F1: 0.8138, Prec: 0.9721, Rec: 0.6998, Avg Anomaly Score: 0.5457
2025-08-04 20:58:05,893 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:05,893 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:58:05,893 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:58:05,893 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:58:05,893 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:58:05,894 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:06,293 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:06,293 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:06,389 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:58:06,435 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:58:06,435 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:06,596 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:06,604 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:06,604 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:06,611 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:58:06,620 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:06,620 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:58:06,621 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:06,621 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:06,621 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:58:06,634 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:06,637 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:06,640 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:06,643 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:06,647 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:06,650 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:06,654 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:06,658 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:06,662 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:06,665 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:06,669 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:06,682 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:06,683 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:58:06,688 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:58:06,688 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:58:06,696 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:06,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:58:06,712 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:06,713 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:58:06,713 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:06,731 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:06,737 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:58:06,742 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:58:06,743 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:06,743 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:06,743 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:06,743 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:06,744 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:06,744 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:58:06,744 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:06,745 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:58:06,745 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:06,746 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:58:06,747 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:58:06,747 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:06,747 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:58:06,747 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:06,748 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:06,748 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:06,748 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:58:06,748 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:58:06,748 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:58:06,748 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:58:06,749 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:58:06,749 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:58:06,749 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:58:06,749 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:58:06,750 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:58:06,750 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:58:06,750 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:58:06,751 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:58:06,751 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:06,751 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:58:06,751 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:06,752 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:06,752 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:06,752 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:58:06,753 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:58:06,753 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:58:06,753 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:58:06,760 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:58:06,761 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:06,762 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:06,762 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:58:06,764 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:06,764 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:06,764 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:06,765 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:06,810 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5220, Threshold=0.5709, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 20:58:06,810 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7331, F1: 0.8138, Prec: 0.9721, Rec: 0.6998, Avg Anomaly Score: 0.5220
2025-08-04 20:58:27,115 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:27,116 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:58:27,116 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:58:27,116 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:58:27,116 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:58:27,116 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:27,496 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:27,496 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:27,594 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:58:27,640 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:58:27,640 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:27,829 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:27,836 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:27,836 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:27,843 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:58:27,854 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:27,854 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:58:27,855 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:27,855 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:27,855 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:58:27,866 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:27,869 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:27,872 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:27,874 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:27,878 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:27,880 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:27,882 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:27,885 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:27,888 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:27,890 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:27,892 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:27,903 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:27,903 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:58:27,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:58:27,908 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:58:27,914 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:27,914 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:58:27,929 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:27,930 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:58:27,930 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:27,947 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:27,953 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:58:27,960 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:58:27,961 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:27,961 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:27,961 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:27,961 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:27,962 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:27,962 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:58:27,962 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:27,962 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:58:27,962 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:27,964 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:58:27,964 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:58:27,964 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:27,964 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:58:27,965 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:27,966 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:27,966 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:27,966 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:58:27,966 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:58:27,966 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:58:27,967 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:58:27,967 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:58:27,967 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:58:27,967 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:58:27,968 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:58:27,968 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:58:27,968 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:58:27,969 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:58:27,969 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:58:27,969 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:27,969 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:58:27,969 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:27,970 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:27,973 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:27,974 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:58:27,974 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:58:27,974 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:58:27,974 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:58:27,982 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:58:27,982 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:27,983 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:27,983 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:58:27,985 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:27,985 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:27,985 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:27,986 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:28,023 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5751, Threshold=0.6425, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 20:58:28,024 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7322, F1: 0.8131, Prec: 0.9713, Rec: 0.6992, Avg Anomaly Score: 0.5751
2025-08-04 20:58:45,311 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:45,312 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:58:45,312 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:58:45,312 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:58:45,312 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:58:45,312 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:45,684 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:45,684 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:45,781 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:58:45,833 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:58:45,833 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:45,994 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:46,002 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:46,002 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:46,009 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:58:46,016 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:46,016 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:58:46,017 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:46,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:46,017 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:58:46,027 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:46,029 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:46,032 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:46,034 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:46,037 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:46,039 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:46,042 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:46,044 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:46,048 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:46,050 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:46,052 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:46,065 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:46,066 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:58:46,071 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:58:46,071 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:58:46,077 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:46,078 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:58:46,092 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:46,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:58:46,093 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:46,111 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:46,118 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:58:46,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:58:46,139 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:46,140 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:46,140 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:46,140 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:46,141 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:46,141 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:58:46,141 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:46,141 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:58:46,142 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:46,144 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:58:46,146 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:58:46,146 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:46,146 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:58:46,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:46,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:46,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:46,147 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:58:46,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:58:46,148 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:58:46,148 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:58:46,148 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:58:46,149 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:58:46,149 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:58:46,149 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:58:46,150 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:58:46,150 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:58:46,151 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:58:46,151 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:58:46,151 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:46,151 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:58:46,151 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:46,152 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:46,152 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:46,152 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:58:46,153 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:58:46,153 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:58:46,153 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:58:46,162 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:58:46,162 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:46,165 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:46,165 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:58:46,167 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:46,167 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:46,167 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:46,168 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:46,212 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.4783, Threshold=0.5112, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 20:58:46,212 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7322, F1: 0.8131, Prec: 0.9713, Rec: 0.6992, Avg Anomaly Score: 0.4783
2025-08-04 20:59:06,512 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:06,512 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:59:06,513 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:59:06,513 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:59:06,513 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:59:06,513 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:06,857 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:06,858 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:06,947 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:59:06,975 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:59:06,975 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:07,097 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:07,104 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:07,104 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:07,111 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:59:07,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:07,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:59:07,147 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:07,147 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:07,148 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:59:07,157 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:07,159 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:07,162 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:07,164 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:07,167 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:07,169 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:07,172 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:07,174 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:07,178 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:07,180 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:07,183 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:07,194 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:07,194 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:59:07,200 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:59:07,200 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:59:07,208 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:07,209 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:59:07,220 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:07,220 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:59:07,220 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:07,236 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:07,241 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:59:07,248 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:59:07,248 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:07,248 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:07,249 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:07,249 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:07,249 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:07,249 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:59:07,250 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:07,250 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:59:07,250 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:07,251 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:59:07,252 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:59:07,252 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:07,252 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:59:07,252 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:07,253 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:07,253 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:07,253 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:59:07,253 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:59:07,253 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:59:07,253 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:59:07,253 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:59:07,254 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:59:07,254 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:59:07,254 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:59:07,254 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:59:07,254 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:59:07,255 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:59:07,255 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:59:07,255 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:07,255 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:59:07,255 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:07,256 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:07,256 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:07,256 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:59:07,256 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:59:07,256 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:59:07,256 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:59:07,264 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:59:07,264 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:07,265 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:07,266 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:59:07,267 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:07,267 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:07,267 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:07,268 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:07,302 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5372, Threshold=0.5916, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 20:59:07,302 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7331, F1: 0.8138, Prec: 0.9721, Rec: 0.6998, Avg Anomaly Score: 0.5372
2025-08-04 20:59:12,561 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:12,561 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:59:12,562 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:59:12,562 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:59:12,562 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:59:12,562 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:12,923 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:12,923 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:13,008 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:59:13,052 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:59:13,052 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:13,162 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:13,167 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:13,167 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:13,173 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:59:13,188 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:13,188 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:59:13,188 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:13,189 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:13,189 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:59:13,197 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:13,200 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:13,203 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:13,205 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:13,208 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:13,210 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:13,212 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:13,215 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:13,218 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:13,220 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:13,222 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:13,231 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:13,231 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:59:13,236 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:59:13,236 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:59:13,242 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:13,242 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:59:13,253 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:13,253 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:59:13,253 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:13,268 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:13,272 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:59:13,276 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:59:13,277 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:13,277 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:13,277 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:13,277 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:13,278 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:13,278 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:59:13,278 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:13,278 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:59:13,278 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:13,280 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:59:13,280 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:59:13,280 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:13,280 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:59:13,280 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:13,281 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:13,281 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:13,281 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:59:13,281 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:59:13,281 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:59:13,281 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:59:13,281 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:59:13,282 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:59:13,282 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:59:13,282 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:59:13,282 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:59:13,282 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:59:13,283 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:59:13,283 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:59:13,283 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:13,283 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:59:13,283 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:13,284 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:13,284 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:13,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:59:13,284 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:59:13,284 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:59:13,284 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:59:13,292 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:59:13,292 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:13,293 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:13,294 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:59:13,295 - ClientAppLogger [Client 7] - INFO - [Client] Fit started for round 155/400.
2025-08-04 20:59:13,396 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:13,396 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:13,398 - ClientAppLogger [Client 7] - INFO - [Client] Semi-supervised: Added 64 anomalous samples to GAN training data (target: 64).
2025-08-04 20:59:13,398 - ClientAppLogger [Client 7] - INFO - [Client] Round 155: Training GAN with 279 samples (215 normal, 64 anomalous).
2025-08-04 20:59:13,399 - ClientAppLogger [Client 7] - INFO - [Client] Starting GAN training...
2025-08-04 20:59:13,626 - ClientAppLogger [Client 7] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0855, Avg D Loss: 0.7880
2025-08-04 20:59:13,626 - ClientAppLogger [Client 7] - INFO - GAN Training completed. Avg G Loss: 2.0855, Avg D Loss: 0.7880
2025-08-04 20:59:13,627 - ClientAppLogger [Client 7] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:59:13,664 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5078, Threshold=0.5396, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 20:59:13,664 - ClientAppLogger [Client 7] - INFO - [Client] Post-fit local evaluation F1: 0.8138
2025-08-04 20:59:13,664 - ClientAppLogger [Client 7] - INFO - Fit completed for round 155. Duration: 0.37s. Metrics: {'cpu_cores_available': 4, 'client_cid_for_attributes': '7', 'server_round': 155, 'allocated_cores_for_pytorch': 4, 'profile_name': 'Mid-Range Edge', 'g_loss': 2.0854685936350124, 'd_loss': 0.787958301480953, 'post_fit_local_f1': 0.8137573004542504, 'fit_time_seconds': 0.3692142963409424, 'cpu_percent_fit': 24.675, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 279}
2025-08-04 20:59:13,665 - ClientAppLogger [Client 7] - INFO - [Client] get_parameters called
2025-08-04 20:59:24,962 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:24,963 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:59:24,963 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:59:24,963 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:59:24,963 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:59:24,963 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:25,279 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:25,279 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:25,366 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:59:25,388 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:59:25,389 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:25,517 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:25,522 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:25,523 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:25,529 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:59:25,537 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:25,538 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:59:25,538 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:25,538 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:25,538 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:59:25,548 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:25,551 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:25,554 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:25,556 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:25,559 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:25,561 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:25,564 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:25,567 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:25,570 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:25,572 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:25,574 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:25,584 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:25,584 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:59:25,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:59:25,590 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:59:25,596 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:25,596 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:59:25,608 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:25,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:59:25,609 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:25,630 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:25,636 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:59:25,642 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:59:25,642 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:25,642 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:25,642 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:25,643 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:25,643 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:25,643 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:59:25,643 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:25,644 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:59:25,644 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:25,645 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:59:25,645 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:59:25,646 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:25,646 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:59:25,646 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:25,646 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:25,646 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:25,646 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:59:25,647 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:59:25,647 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:59:25,647 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:59:25,647 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:59:25,647 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:59:25,647 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:59:25,647 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:59:25,648 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:59:25,648 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:59:25,648 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:59:25,648 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:59:25,648 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:25,649 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:59:25,649 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:25,649 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:25,649 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:25,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:59:25,650 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:59:25,650 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:59:25,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:59:25,657 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:59:25,657 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:25,659 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:25,659 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:59:25,661 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:25,661 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:25,661 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:25,662 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:25,700 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5300, Threshold=0.5793, Accuracy=0.7322, F1=0.8131, Precision=0.9713, Recall=0.6992
2025-08-04 20:59:25,700 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7322, F1: 0.8131, Prec: 0.9713, Rec: 0.6992, Avg Anomaly Score: 0.5300
2025-08-04 20:59:36,990 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:36,991 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:59:36,991 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:59:36,991 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:59:36,991 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:59:36,991 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:37,352 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:37,352 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:37,446 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:59:37,490 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:59:37,490 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:37,637 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:37,644 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:37,644 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:37,650 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:59:37,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:37,656 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:59:37,657 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:37,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:37,657 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:59:37,667 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:37,671 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:37,674 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:37,676 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:37,683 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:37,686 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:37,688 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:37,691 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:37,694 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:37,696 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:37,702 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:37,712 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:37,713 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:59:37,717 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:59:37,718 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:59:37,723 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:37,723 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:59:37,733 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:37,734 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:59:37,734 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:37,749 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:37,754 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:59:37,758 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:59:37,759 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:37,759 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:37,759 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:37,759 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:37,760 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:37,760 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:59:37,760 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:37,760 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:59:37,761 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:37,762 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:59:37,762 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:59:37,763 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:37,763 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:59:37,763 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:37,763 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:37,763 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:37,763 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:59:37,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:59:37,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:59:37,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:59:37,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:59:37,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:59:37,764 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:59:37,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:59:37,765 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:59:37,765 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:59:37,765 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:59:37,765 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:59:37,765 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:37,766 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:59:37,766 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:37,766 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:37,769 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:37,770 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:59:37,770 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:59:37,770 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:59:37,770 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:59:37,776 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:59:37,777 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:37,778 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:37,778 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:59:37,780 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:37,780 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:37,780 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:37,781 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:37,814 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5080, Threshold=0.5688, Accuracy=0.7313, F1=0.8125, Precision=0.9705, Recall=0.6987
2025-08-04 20:59:37,814 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7313, F1: 0.8125, Prec: 0.9705, Rec: 0.6987, Avg Anomaly Score: 0.5080
2025-08-04 20:59:52,102 - ClientAppLogger [Client 7] - INFO - ClientApp starting for partition_id: 7. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:52,102 - ClientAppLogger [Client 7] - INFO - ALLOCATED_CORES='4' found. Setting PyTorch threads to 4.
2025-08-04 20:59:52,102 - ClientAppLogger [Client 7] - INFO - Called torch.set_num_threads(4). Current PyTorch intra-op threads: 4. Client will operate with 4 core(s).
2025-08-04 20:59:52,102 - ClientAppLogger [Client 7] - INFO - Loading data for partition 7/10...
2025-08-04 20:59:52,102 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting load_data function.
2025-08-04 20:59:52,102 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:52,460 - ClientAppLogger [Client 7] - INFO - [LoadData 7] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:52,460 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:52,545 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Numeric conversion completed.
2025-08-04 20:59:52,571 - ClientAppLogger [Client 7] - INFO - [LoadData 7] NA values filled.
2025-08-04 20:59:52,571 - ClientAppLogger [Client 7] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:52,689 - ClientAppLogger [Client 7] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:52,696 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:52,696 - ClientAppLogger [Client 7] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:52,702 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Scaler fitting process completed.
2025-08-04 20:59:52,709 - ClientAppLogger [Client 7] - INFO - [LoadData 7] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:52,709 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting semi-supervised data splitting logic.
2025-08-04 20:59:52,710 - ClientAppLogger [Client 7] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:52,710 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:52,710 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting anomaly reduction logic.
2025-08-04 20:59:52,719 - ClientAppLogger [Client 7] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:52,722 - ClientAppLogger [Client 7] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:52,724 - ClientAppLogger [Client 7] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:52,726 - ClientAppLogger [Client 7] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:52,729 - ClientAppLogger [Client 7] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:52,732 - ClientAppLogger [Client 7] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:52,735 - ClientAppLogger [Client 7] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:52,738 - ClientAppLogger [Client 7] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:52,741 - ClientAppLogger [Client 7] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:52,743 - ClientAppLogger [Client 7] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:52,747 - ClientAppLogger [Client 7] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:52,758 - ClientAppLogger [Client 7] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:52,758 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Anomaly reduction logic completed.
2025-08-04 20:59:52,763 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Normal and anomaly indices shuffled.
2025-08-04 20:59:52,764 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating unlabeled training base.
2025-08-04 20:59:52,770 - ClientAppLogger [Client 7] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:52,770 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating labeled pool.
2025-08-04 20:59:52,779 - ClientAppLogger [Client 7] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:52,779 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Labeled pool creation completed.
2025-08-04 20:59:52,779 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:52,795 - ClientAppLogger [Client 7] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:52,800 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Combining data for final AE training set.
2025-08-04 20:59:52,804 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Final AE training data combination completed.
2025-08-04 20:59:52,804 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:52,804 - ClientAppLogger [Client 7] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:52,804 - ClientAppLogger [Client 7] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:52,805 - ClientAppLogger [Client 7] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:52,805 - ClientAppLogger [Client 7] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:52,805 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] START of partitioning block.
2025-08-04 20:59:52,805 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:52,806 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 1: Full indices created.
2025-08-04 20:59:52,806 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:52,807 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 2: Full indices shuffled.
2025-08-04 20:59:52,807 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Full indices shuffled.
2025-08-04 20:59:52,808 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:52,808 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Remainder distribution completed.
2025-08-04 20:59:52,808 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:52,808 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:52,808 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:52,809 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 6: Start indices calculated. train_start=53194
2025-08-04 20:59:52,809 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Start indices calculated. Train_start=53194, Val_start=4989, Test_start=5314
2025-08-04 20:59:52,809 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 7: End indices calculated. train_end=54213
2025-08-04 20:59:52,809 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: End indices calculated. Train_end=54213, Val_end=7140, Test_end=5419
2025-08-04 20:59:52,809 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 8: Partition-specific indices extracted. Num train indices: 1019
2025-08-04 20:59:52,809 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Specific indices extracted. Train idx: 1019, Val idx: 2151, Test idx: 105
2025-08-04 20:59:52,810 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9a: Train data sliced for partition. X_train_part_full shape: (1019, 17)
2025-08-04 20:59:52,810 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Train data sliced. Shape: (1019, 17)
2025-08-04 20:59:52,810 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9b: Validation data sliced for partition. X_val_part shape: (2151, 17)
2025-08-04 20:59:52,810 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Validation data sliced. Shape: (2151, 17)
2025-08-04 20:59:52,811 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 9c: Test data sliced for partition. X_test_part shape: (105, 17)
2025-08-04 20:59:52,811 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Partitioning: Test data sliced. Shape: (105, 17)
2025-08-04 20:59:52,811 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:52,811 - ClientAppLogger [Client 7] - INFO - [LoadData 7] Creating TonIoTDataset objects.
2025-08-04 20:59:52,811 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:52,812 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:52,815 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:52,815 - ClientAppLogger [Client 7] - INFO - [LoadData 7] TonIoTDataset objects created.
2025-08-04 20:59:52,816 - ClientAppLogger [Client 7] - INFO - Partition 7 (Static Datasets): Train Potential 1019, Val 2151, Test 105
2025-08-04 20:59:52,816 - ClientAppLogger [Client 7] - INFO - [Partitioning Debug 7] END of partitioning block, returning datasets.
2025-08-04 20:59:52,816 - ClientAppLogger [Client 7] - INFO - [LoadData 7] load_data function completed.
2025-08-04 20:59:52,822 - ClientAppLogger [Client 7] - INFO - Data loaded for partition 7: Train samples: 1019, Val samples: 2151
2025-08-04 20:59:52,822 - ClientAppLogger [Client 7] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:52,823 - ClientAppLogger [Client 7] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:52,823 - ClientAppLogger [Client 7] - INFO - [Client] Initialized. Device: cpu. Operating with 4 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 4.
2025-08-04 20:59:52,825 - ClientAppLogger [Client 7] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:52,825 - ClientAppLogger [Client 7] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:52,825 - ClientAppLogger [Client 7] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:52,826 - ClientAppLogger [Client 7] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:52,859 - ClientAppLogger [Client 7] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=2151, Avg Anomaly Score (all samples)=0.5139, Threshold=0.5561, Accuracy=0.7331, F1=0.8138, Precision=0.9721, Recall=0.6998
2025-08-04 20:59:52,860 - ClientAppLogger [Client 7] - INFO - [Client] Evaluation finished. Samples: 2151, Acc: 0.7331, F1: 0.8138, Prec: 0.9721, Rec: 0.6998, Avg Anomaly Score: 0.5139
