2025-08-04 20:30:05,855 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:05,855 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:30:05,855 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:30:05,855 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:30:05,855 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:30:05,856 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:06,112 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:06,112 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:06,199 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:30:06,239 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:30:06,240 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:06,375 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:06,384 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:06,384 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:06,391 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:30:06,448 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:06,448 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:30:06,449 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:06,449 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:06,450 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:30:06,464 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:06,469 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:06,472 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:06,474 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:06,477 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:06,479 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:06,483 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:06,487 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:06,490 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:06,492 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:06,495 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:06,507 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:06,507 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:30:06,513 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:30:06,513 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:30:06,519 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:06,519 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:30:06,534 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:06,535 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:30:06,535 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:06,556 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:06,564 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:30:06,579 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:30:06,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:06,580 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:06,580 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:06,580 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:06,581 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:06,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:30:06,581 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:06,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:30:06,581 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:06,583 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:30:06,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:30:06,584 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:06,584 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:30:06,584 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:06,584 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:06,584 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:06,585 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:30:06,585 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:30:06,585 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:30:06,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:30:06,586 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:30:06,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:30:06,586 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:30:06,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:30:06,586 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:30:06,587 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:30:06,587 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:30:06,587 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:30:06,587 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:06,587 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:30:06,587 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:06,588 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:06,588 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:06,588 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:30:06,588 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:30:06,588 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:30:06,588 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:30:06,594 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:30:06,595 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:06,596 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:06,597 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:30:06,598 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:06,598 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:06,599 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:06,599 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:06,608 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3678, Threshold=0.3843, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:30:06,609 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3678
2025-08-04 20:30:20,867 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:20,867 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:30:20,867 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:30:20,868 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:30:20,868 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:30:20,868 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:21,112 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:21,112 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:21,197 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:30:21,228 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:30:21,228 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:21,340 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:21,348 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:21,348 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:21,382 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:30:21,411 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:21,411 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:30:21,412 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:21,412 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:21,412 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:30:21,424 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:21,427 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:21,429 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:21,431 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:21,434 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:21,436 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:21,439 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:21,442 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:21,444 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:21,446 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:21,449 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:21,460 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:21,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:30:21,465 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:30:21,465 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:30:21,472 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:21,472 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:30:21,484 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:21,485 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:30:21,485 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:21,502 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:21,508 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:30:21,516 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:30:21,516 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:21,516 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:21,516 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:21,517 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:21,517 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:21,517 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:30:21,517 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:21,518 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:30:21,518 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:21,519 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:30:21,520 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:30:21,520 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:21,520 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:30:21,520 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:21,520 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:21,521 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:21,521 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:30:21,521 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:30:21,521 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:30:21,521 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:30:21,522 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:30:21,522 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:30:21,522 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:30:21,522 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:30:21,522 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:30:21,522 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:30:21,523 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:30:21,523 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:30:21,523 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:21,523 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:30:21,523 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:21,524 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:21,524 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:21,524 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:30:21,525 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:30:21,525 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:30:21,525 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:30:21,533 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:30:21,533 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:21,535 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:21,535 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:30:21,537 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:21,537 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:21,537 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:21,538 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:21,548 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3577, Threshold=0.3739, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:30:21,548 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3577
2025-08-04 20:30:32,809 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:32,809 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:30:32,809 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:30:32,809 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:30:32,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:30:32,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:33,110 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:33,110 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:33,195 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:30:33,241 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:30:33,241 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:33,395 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:33,407 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:33,408 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:33,416 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:30:33,424 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:33,424 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:30:33,424 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:33,425 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:33,425 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:30:33,435 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:33,439 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:33,441 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:33,443 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:33,446 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:33,449 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:33,452 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:33,455 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:33,458 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:33,460 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:33,462 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:33,476 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:33,476 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:30:33,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:30:33,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:30:33,486 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:33,486 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:30:33,498 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:33,498 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:30:33,498 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:33,520 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:33,526 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:30:33,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:30:33,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:33,547 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:33,547 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:33,548 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:33,549 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:33,550 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:30:33,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:33,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:30:33,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:33,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:30:33,553 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:30:33,554 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:33,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:30:33,554 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:33,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:33,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:33,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:30:33,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:30:33,557 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:30:33,557 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:30:33,557 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:30:33,557 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:30:33,558 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:30:33,558 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:30:33,558 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:30:33,558 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:30:33,559 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:30:33,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:30:33,560 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:33,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:30:33,561 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:33,561 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:33,562 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:33,562 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:30:33,562 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:30:33,562 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:30:33,562 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:30:33,572 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:30:33,572 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:33,574 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:33,576 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:30:33,578 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:33,578 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:33,578 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:33,579 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:33,588 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3671, Threshold=0.3846, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:30:33,588 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3671
2025-08-04 20:30:47,857 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:30:47,858 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:30:47,858 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:30:47,858 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:30:47,858 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:30:47,858 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:30:48,128 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:30:48,129 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:30:48,218 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:30:48,267 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:30:48,267 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:30:48,398 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:30:48,405 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:30:48,405 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:30:48,411 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:30:48,424 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:30:48,424 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:30:48,425 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:30:48,425 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:30:48,426 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:30:48,435 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:30:48,438 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:48,441 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:30:48,443 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:30:48,446 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:30:48,448 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:30:48,452 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:30:48,454 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:30:48,457 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:30:48,459 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:30:48,462 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:30:48,476 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:30:48,476 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:30:48,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:30:48,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:30:48,492 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:30:48,492 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:30:48,506 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:30:48,507 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:30:48,507 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:30:48,525 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:30:48,532 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:30:48,540 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:30:48,540 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:30:48,540 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:30:48,540 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:30:48,541 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:30:48,541 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:30:48,541 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:30:48,541 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:30:48,542 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:30:48,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:30:48,543 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:30:48,543 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:30:48,544 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:30:48,544 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:30:48,544 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:30:48,545 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:30:48,545 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:30:48,545 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:30:48,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:30:48,545 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:30:48,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:30:48,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:30:48,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:30:48,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:30:48,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:30:48,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:30:48,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:30:48,548 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:30:48,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:30:48,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:30:48,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:30:48,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:30:48,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:30:48,550 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:30:48,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:30:48,550 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:30:48,550 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:30:48,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:30:48,561 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:30:48,561 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:30:48,563 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:30:48,563 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:30:48,565 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:30:48,565 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:30:48,565 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:30:48,566 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:30:48,575 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3577, Threshold=0.3747, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:30:48,575 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3577
2025-08-04 20:31:05,848 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:05,848 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:05,848 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:05,848 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:31:05,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:31:05,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:06,131 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:06,132 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:06,214 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:31:06,250 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:31:06,250 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:06,353 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:06,363 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:06,364 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:06,370 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:31:06,380 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:06,380 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:31:06,381 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:06,381 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:06,381 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:31:06,391 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:06,394 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:06,396 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:06,398 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:06,401 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:06,404 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:06,406 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:06,409 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:06,412 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:06,414 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:06,416 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:06,429 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:06,430 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:31:06,434 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:31:06,435 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:31:06,440 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:06,440 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:31:06,450 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:06,450 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:31:06,450 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:06,467 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:06,472 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:31:06,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:31:06,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:06,482 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:06,482 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:06,482 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:06,482 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:06,483 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:31:06,483 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:06,483 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:31:06,484 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:06,485 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:31:06,485 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:31:06,486 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:06,486 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:31:06,486 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:06,486 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:06,487 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:06,487 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:31:06,487 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:31:06,487 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:31:06,487 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:31:06,487 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:31:06,487 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:31:06,488 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:31:06,488 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:31:06,488 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:31:06,488 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:31:06,488 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:31:06,489 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:31:06,489 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:06,489 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:31:06,489 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:06,490 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:06,490 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:06,490 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:31:06,490 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:31:06,490 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:31:06,490 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:31:06,495 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:31:06,495 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:06,497 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:06,497 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:06,498 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:06,499 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:06,499 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:06,500 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:06,508 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3654, Threshold=0.3814, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:31:06,508 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3654
2025-08-04 20:31:23,782 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:23,790 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:23,790 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:23,790 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:31:23,791 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:31:23,791 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:24,016 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:24,016 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:24,102 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:31:24,132 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:31:24,132 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:24,235 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:24,240 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:24,240 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:24,264 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:31:24,286 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:24,286 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:31:24,287 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:24,287 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:24,287 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:31:24,296 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:24,299 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:24,301 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:24,303 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:24,306 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:24,308 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:24,312 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:24,315 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:24,318 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:24,320 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:24,322 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:24,334 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:24,334 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:31:24,340 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:31:24,340 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:31:24,352 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:24,352 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:31:24,369 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:24,369 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:31:24,369 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:24,386 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:24,391 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:31:24,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:31:24,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:24,396 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:24,396 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:24,397 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:24,397 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:24,398 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:31:24,398 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:24,398 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:31:24,398 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:24,400 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:31:24,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:31:24,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:24,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:31:24,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:24,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:24,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:24,402 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:31:24,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:31:24,402 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:31:24,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:31:24,402 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:31:24,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:31:24,402 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:31:24,403 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:31:24,403 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:31:24,403 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:31:24,403 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:31:24,403 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:31:24,403 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:24,404 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:31:24,404 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:24,404 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:24,404 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:24,404 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:31:24,404 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:31:24,405 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:31:24,405 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:31:24,411 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:31:24,411 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:24,412 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:24,412 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:24,413 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:24,414 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:24,414 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:24,415 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:24,423 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3677, Threshold=0.3846, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:31:24,423 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3677
2025-08-04 20:31:35,691 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:35,691 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:35,691 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:35,692 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:31:35,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:31:35,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:35,948 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:35,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:36,036 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:31:36,078 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:31:36,079 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:36,213 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:36,220 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:36,220 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:36,227 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:31:36,234 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:36,234 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:31:36,235 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:36,235 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:36,235 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:31:36,244 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:36,247 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:36,250 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:36,252 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:36,255 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:36,257 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:36,260 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:36,262 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:36,265 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:36,267 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:36,269 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:36,280 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:36,280 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:31:36,285 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:31:36,285 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:31:36,290 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:36,290 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:31:36,299 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:36,299 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:31:36,299 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:36,316 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:36,321 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:31:36,330 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:31:36,330 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:36,330 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:36,330 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:36,331 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:36,331 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:36,331 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:31:36,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:36,332 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:31:36,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:36,334 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:31:36,334 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:31:36,334 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:36,335 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:31:36,335 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:36,335 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:36,335 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:36,335 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:31:36,335 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:31:36,336 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:31:36,336 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:31:36,336 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:31:36,336 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:31:36,336 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:31:36,336 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:31:36,337 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:31:36,337 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:31:36,337 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:31:36,337 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:31:36,337 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:36,337 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:31:36,338 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:36,338 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:36,338 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:36,338 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:31:36,338 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:31:36,339 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:31:36,339 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:31:36,346 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:31:36,346 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:36,348 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:36,348 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:36,349 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:36,349 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:36,349 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:36,350 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:36,366 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3459, Threshold=0.3600, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:31:36,366 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3459
2025-08-04 20:31:47,647 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:31:47,647 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:31:47,647 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:31:47,648 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:31:47,648 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:31:47,648 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:31:47,892 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:31:47,892 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:31:47,975 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:31:48,011 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:31:48,012 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:31:48,118 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:31:48,125 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:31:48,125 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:31:48,131 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:31:48,141 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:31:48,141 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:31:48,142 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:31:48,142 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:31:48,142 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:31:48,152 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:31:48,155 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:48,158 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:31:48,160 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:31:48,163 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:31:48,165 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:31:48,168 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:31:48,170 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:31:48,173 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:31:48,175 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:31:48,178 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:31:48,188 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:31:48,188 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:31:48,193 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:31:48,193 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:31:48,198 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:31:48,198 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:31:48,208 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:31:48,208 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:31:48,208 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:31:48,232 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:31:48,237 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:31:48,243 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:31:48,243 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:31:48,244 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:31:48,244 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:31:48,244 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:31:48,244 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:31:48,244 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:31:48,245 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:31:48,245 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:31:48,245 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:31:48,246 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:31:48,246 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:31:48,247 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:31:48,247 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:31:48,247 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:31:48,247 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:31:48,247 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:31:48,247 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:31:48,248 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:31:48,248 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:31:48,248 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:31:48,248 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:31:48,248 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:31:48,249 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:31:48,249 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:31:48,249 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:31:48,249 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:31:48,249 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:31:48,249 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:31:48,249 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:31:48,249 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:31:48,250 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:31:48,250 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:31:48,250 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:31:48,250 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:31:48,250 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:31:48,250 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:31:48,251 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:31:48,255 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:31:48,255 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:31:48,257 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:31:48,257 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:31:48,259 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:31:48,259 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:31:48,259 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:31:48,260 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:31:48,267 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3667, Threshold=0.3828, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:31:48,267 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3667
2025-08-04 20:32:05,560 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:05,560 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:05,561 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:05,561 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:32:05,561 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:32:05,561 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:05,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:05,826 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:05,914 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:32:05,958 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:32:05,958 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:06,074 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:06,081 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:06,081 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:06,088 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:32:06,094 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:06,094 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:32:06,094 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:06,094 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:06,095 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:32:06,103 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:06,106 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:06,109 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:06,111 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:06,114 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:06,116 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:06,118 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:06,121 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:06,123 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:06,125 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:06,127 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:06,137 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:06,137 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:32:06,142 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:32:06,142 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:32:06,146 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:06,146 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:32:06,155 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:06,155 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:32:06,156 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:06,171 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:06,176 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:32:06,185 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:32:06,185 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:06,186 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:06,186 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:06,186 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:06,186 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:06,187 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:32:06,187 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:06,187 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:32:06,187 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:06,189 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:32:06,189 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:32:06,189 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:06,189 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:32:06,190 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:06,190 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:06,190 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:06,190 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:32:06,190 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:32:06,191 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:32:06,191 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:32:06,191 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:32:06,191 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:32:06,191 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:32:06,191 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:32:06,191 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:32:06,192 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:32:06,192 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:32:06,192 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:32:06,192 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:06,192 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:32:06,192 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:06,193 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:06,193 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:06,193 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:32:06,193 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:32:06,193 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:32:06,193 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:32:06,200 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:32:06,200 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:06,201 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:06,202 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:06,203 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:06,203 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:06,203 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:06,204 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:06,211 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3705, Threshold=0.3857, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:32:06,211 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3705
2025-08-04 20:32:17,479 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:17,479 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:17,480 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:17,480 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:32:17,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:32:17,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:17,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:17,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:17,870 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:32:17,907 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:32:17,908 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:18,009 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:18,016 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:18,016 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:18,021 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:32:18,027 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:18,027 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:32:18,027 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:18,028 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:18,028 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:32:18,038 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:18,041 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:18,044 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:18,046 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:18,048 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:18,050 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:18,052 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:18,055 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:18,057 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:18,059 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:18,061 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:18,071 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:18,071 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:32:18,077 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:32:18,077 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:32:18,083 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:18,083 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:32:18,094 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:18,094 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:32:18,095 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:18,110 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:18,114 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:32:18,122 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:32:18,122 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:18,123 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:18,123 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:18,123 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:18,123 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:18,123 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:32:18,124 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:18,124 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:32:18,124 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:18,125 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:32:18,125 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:32:18,126 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:18,126 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:32:18,126 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:18,126 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:18,127 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:18,127 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:32:18,127 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:32:18,127 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:32:18,127 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:32:18,127 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:32:18,127 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:32:18,128 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:32:18,128 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:32:18,128 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:32:18,128 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:32:18,128 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:32:18,128 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:32:18,128 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:18,129 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:32:18,129 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:18,129 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:18,129 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:18,129 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:32:18,130 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:32:18,130 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:32:18,130 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:32:18,136 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:32:18,136 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:18,137 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:18,138 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:18,139 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:18,139 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:18,139 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:18,140 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:18,156 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3640, Threshold=0.3779, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:32:18,156 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3640
2025-08-04 20:32:29,420 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:29,420 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:29,421 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:29,421 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:32:29,421 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:32:29,421 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:29,713 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:29,713 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:29,799 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:32:29,841 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:32:29,842 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:29,992 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:29,999 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:29,999 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:30,006 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:32:30,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:30,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:32:30,013 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:30,014 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:30,014 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:32:30,023 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:30,026 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:30,028 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:30,031 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:30,033 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:30,035 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:30,038 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:30,040 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:30,043 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:30,045 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:30,048 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:30,060 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:30,060 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:32:30,066 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:32:30,066 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:32:30,071 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:30,071 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:32:30,081 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:30,082 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:32:30,082 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:30,100 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:30,105 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:32:30,114 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:32:30,114 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:30,114 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:30,114 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:30,114 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:30,115 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:30,115 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:32:30,115 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:30,115 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:32:30,116 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:30,117 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:32:30,117 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:32:30,118 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:30,118 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:32:30,118 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:30,118 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:30,119 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:30,119 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:32:30,119 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:32:30,119 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:32:30,119 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:32:30,119 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:32:30,119 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:32:30,120 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:32:30,120 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:32:30,120 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:32:30,120 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:32:30,120 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:32:30,120 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:32:30,121 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:30,121 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:32:30,121 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:30,121 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:30,122 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:30,122 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:32:30,122 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:32:30,122 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:32:30,122 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:32:30,131 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:32:30,131 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:30,132 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:30,132 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:30,134 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:30,134 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:30,134 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:30,134 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:30,151 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3732, Threshold=0.3894, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:32:30,151 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3732
2025-08-04 20:32:44,416 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:32:44,416 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:32:44,416 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:32:44,416 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:32:44,416 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:32:44,416 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:32:44,698 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:32:44,699 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:32:44,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:32:44,820 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:32:44,821 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:32:44,916 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:32:44,922 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:32:44,922 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:32:44,927 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:32:44,932 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:32:44,933 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:32:44,933 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:32:44,933 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:32:44,933 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:32:44,942 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:32:44,945 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:44,947 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:32:44,949 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:32:44,952 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:32:44,954 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:32:44,956 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:32:44,959 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:32:44,961 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:32:44,963 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:32:44,965 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:32:44,975 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:32:44,975 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:32:44,980 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:32:44,980 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:32:44,984 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:32:44,984 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:32:44,994 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:32:44,994 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:32:44,994 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:32:45,013 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:32:45,018 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:32:45,024 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:32:45,024 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:32:45,025 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:32:45,025 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:32:45,025 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:32:45,025 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:32:45,026 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:32:45,026 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:32:45,026 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:32:45,026 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:32:45,028 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:32:45,028 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:32:45,028 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:32:45,028 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:32:45,028 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:32:45,029 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:32:45,029 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:32:45,029 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:32:45,029 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:32:45,029 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:32:45,029 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:32:45,029 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:32:45,029 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:32:45,030 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:32:45,030 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:32:45,030 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:32:45,030 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:32:45,030 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:32:45,030 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:32:45,031 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:32:45,031 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:32:45,031 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:32:45,031 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:32:45,031 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:32:45,031 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:32:45,032 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:32:45,032 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:32:45,032 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:32:45,035 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:32:45,036 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:32:45,037 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:32:45,037 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:32:45,038 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:32:45,038 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:32:45,039 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:32:45,039 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:32:45,055 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3857, Threshold=0.4032, Accuracy=0.6476, F1=0.7582, Precision=0.9206, Recall=0.6444
2025-08-04 20:32:45,056 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6476, F1: 0.7582, Prec: 0.9206, Rec: 0.6444, Avg Anomaly Score: 0.3857
2025-08-04 20:33:02,339 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:02,339 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:02,340 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:02,340 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:33:02,340 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:33:02,340 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:02,633 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:02,633 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:02,723 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:33:02,768 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:33:02,769 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:02,892 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:02,899 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:02,899 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:02,908 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:33:02,916 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:02,917 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:33:02,917 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:02,917 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:02,918 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:33:02,927 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:02,930 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:02,933 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:02,935 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:02,938 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:02,940 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:02,943 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:02,945 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:02,948 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:02,950 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:02,954 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:02,965 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:02,965 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:33:02,970 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:33:02,971 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:33:02,976 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:02,976 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:33:02,986 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:02,986 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:33:02,987 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:03,006 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:03,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:33:03,024 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:33:03,024 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:03,024 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:03,024 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:03,025 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:03,025 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:03,025 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:33:03,025 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:03,025 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:33:03,025 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:03,027 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:33:03,027 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:33:03,028 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:03,028 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:33:03,028 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:03,028 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:03,029 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:03,029 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:33:03,029 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:33:03,029 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:33:03,029 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:33:03,029 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:33:03,029 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:33:03,030 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:33:03,030 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:33:03,030 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:33:03,030 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:33:03,030 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:33:03,030 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:33:03,030 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:03,030 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:33:03,031 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:03,031 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:03,031 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:03,032 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:33:03,032 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:33:03,032 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:33:03,032 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:33:03,039 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:33:03,039 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:03,040 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:03,040 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:33:03,042 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:03,042 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:03,042 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:03,043 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:03,052 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3853, Threshold=0.4045, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:33:03,052 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3853
2025-08-04 20:33:14,384 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:14,384 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:14,384 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:14,385 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:33:14,385 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:33:14,385 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:14,626 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:14,627 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:14,716 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:33:14,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:33:14,754 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:14,862 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:14,868 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:14,868 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:14,875 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:33:14,886 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:14,886 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:33:14,887 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:14,887 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:14,887 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:33:14,896 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:14,899 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:14,901 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:14,903 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:14,905 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:14,907 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:14,910 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:14,913 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:14,915 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:14,917 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:14,919 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:14,930 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:14,930 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:33:14,935 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:33:14,935 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:33:14,939 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:14,940 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:33:14,948 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:14,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:33:14,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:14,977 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:14,982 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:33:14,987 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:33:14,987 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:14,987 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:14,987 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:14,988 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:14,988 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:14,988 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:33:14,988 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:14,989 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:33:14,989 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:14,990 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:33:14,990 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:33:14,991 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:14,991 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:33:14,991 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:14,991 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:14,991 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:14,991 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:33:14,992 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:33:14,992 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:33:14,992 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:33:14,992 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:33:14,992 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:33:14,992 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:33:14,992 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:33:14,993 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:33:14,993 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:33:14,993 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:33:14,993 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:33:14,993 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:14,993 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:33:14,994 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:14,994 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:14,994 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:14,994 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:33:14,994 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:33:14,994 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:33:14,995 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:33:14,998 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:33:14,999 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:15,000 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:15,000 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:33:15,001 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:15,001 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:15,001 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:15,002 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:15,010 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3702, Threshold=0.3885, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:33:15,010 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3702
2025-08-04 20:33:29,282 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:29,282 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:29,282 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:29,282 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:33:29,282 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:33:29,283 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:29,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:29,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:29,642 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:33:29,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:33:29,668 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:29,758 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:29,764 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:29,764 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:29,769 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:33:29,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:29,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:33:29,776 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:29,776 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:29,776 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:33:29,785 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:29,788 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:29,790 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:29,792 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:29,795 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:29,797 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:29,799 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:29,802 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:29,804 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:29,806 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:29,808 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:29,819 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:29,819 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:33:29,824 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:33:29,824 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:33:29,829 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:29,829 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:33:29,839 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:29,840 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:33:29,840 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:29,856 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:29,861 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:33:29,866 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:33:29,866 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:29,867 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:29,867 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:29,867 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:29,867 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:29,868 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:33:29,868 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:29,868 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:33:29,868 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:29,870 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:33:29,870 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:33:29,870 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:29,870 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:33:29,870 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:29,871 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:29,871 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:29,871 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:33:29,871 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:33:29,871 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:33:29,871 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:33:29,871 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:33:29,872 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:33:29,872 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:33:29,872 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:33:29,872 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:33:29,872 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:33:29,872 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:33:29,872 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:33:29,872 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:29,873 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:33:29,873 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:29,873 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:29,873 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:29,873 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:33:29,874 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:33:29,874 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:33:29,874 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:33:29,878 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:33:29,878 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:29,879 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:29,879 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:33:29,881 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:29,881 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:29,881 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:29,882 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:29,890 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3476, Threshold=0.3649, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:33:29,890 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3476
2025-08-04 20:33:47,177 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:47,177 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:47,178 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:47,178 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:33:47,178 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:33:47,178 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:47,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:47,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:47,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:33:47,609 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:33:47,609 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:47,722 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:47,730 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:47,730 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:47,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:33:47,746 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:47,746 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:33:47,747 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:47,747 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:47,747 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:33:47,755 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:47,758 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:47,760 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:47,762 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:47,765 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:47,767 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:47,770 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:47,772 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:47,775 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:47,776 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:47,779 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:47,789 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:47,789 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:33:47,794 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:33:47,794 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:33:47,799 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:47,800 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:33:47,812 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:47,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:33:47,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:47,832 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:47,838 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:33:47,853 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:33:47,853 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:47,853 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:47,853 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:47,854 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:47,854 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:47,854 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:33:47,855 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:47,855 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:33:47,855 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:47,856 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:33:47,857 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:33:47,857 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:47,857 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:33:47,857 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:47,857 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:47,858 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:47,858 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:33:47,858 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:33:47,858 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:33:47,858 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:33:47,858 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:33:47,858 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:33:47,859 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:33:47,859 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:33:47,859 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:33:47,859 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:33:47,859 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:33:47,859 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:33:47,860 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:47,860 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:33:47,860 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:47,860 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:47,861 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:47,861 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:33:47,861 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:33:47,861 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:33:47,861 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:33:47,868 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:33:47,868 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:47,870 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:47,870 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:33:47,871 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:47,871 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:47,871 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:47,872 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:47,882 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3862, Threshold=0.4084, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:33:47,882 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3862
2025-08-04 20:33:59,162 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:33:59,163 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:33:59,163 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:33:59,163 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:33:59,163 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:33:59,164 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:33:59,470 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:33:59,470 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:33:59,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:33:59,603 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:33:59,604 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:33:59,726 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:33:59,733 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:33:59,733 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:33:59,740 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:33:59,750 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:33:59,750 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:33:59,751 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:33:59,751 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:33:59,751 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:33:59,761 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:33:59,764 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:59,766 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:33:59,769 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:33:59,771 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:33:59,773 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:33:59,776 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:33:59,778 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:33:59,781 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:33:59,783 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:33:59,785 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:33:59,795 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:33:59,796 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:33:59,801 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:33:59,801 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:33:59,807 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:33:59,807 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:33:59,818 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:33:59,818 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:33:59,818 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:33:59,833 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:33:59,838 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:33:59,843 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:33:59,843 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:33:59,843 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:33:59,843 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:33:59,844 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:33:59,844 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:33:59,844 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:33:59,844 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:33:59,845 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:33:59,845 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:33:59,846 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:33:59,846 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:33:59,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:33:59,847 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:33:59,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:33:59,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:33:59,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:33:59,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:33:59,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:33:59,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:33:59,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:33:59,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:33:59,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:33:59,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:33:59,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:33:59,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:33:59,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:33:59,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:33:59,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:33:59,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:33:59,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:33:59,850 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:33:59,850 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:33:59,850 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:33:59,851 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:33:59,851 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:33:59,851 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:33:59,851 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:33:59,860 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:33:59,860 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:33:59,861 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:33:59,861 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:33:59,862 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:33:59,862 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:33:59,863 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:33:59,863 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:33:59,871 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3823, Threshold=0.4040, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:33:59,871 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3823
2025-08-04 20:34:11,144 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:11,145 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:34:11,145 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:34:11,145 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:34:11,145 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:34:11,145 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:11,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:11,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:11,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:34:11,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:34:11,583 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:11,676 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:11,684 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:11,684 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:11,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:34:11,700 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:11,700 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:34:11,701 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:11,701 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:11,701 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:34:11,710 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:11,712 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:11,715 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:11,717 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:11,719 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:11,721 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:11,724 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:11,727 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:11,729 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:11,731 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:11,733 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:11,743 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:11,743 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:34:11,748 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:34:11,748 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:34:11,753 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:11,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:34:11,762 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:11,762 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:34:11,762 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:11,779 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:11,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:34:11,790 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:34:11,790 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:11,791 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:11,791 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:11,791 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:11,791 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:11,792 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:34:11,792 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:11,792 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:34:11,792 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:11,794 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:34:11,794 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:34:11,794 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:11,794 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:34:11,794 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:11,794 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:11,795 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:11,795 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:34:11,795 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:34:11,795 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:34:11,795 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:34:11,795 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:34:11,795 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:34:11,796 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:34:11,796 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:34:11,796 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:34:11,796 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:34:11,796 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:34:11,796 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:34:11,796 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:11,797 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:34:11,797 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:11,797 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:11,797 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:11,797 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:34:11,798 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:34:11,798 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:34:11,798 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:34:11,804 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:34:11,804 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:11,805 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:11,806 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:11,807 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:11,807 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:11,807 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:11,808 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:11,815 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3920, Threshold=0.4193, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:34:11,815 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3920
2025-08-04 20:34:26,084 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:26,084 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:34:26,084 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:34:26,084 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:34:26,085 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:34:26,085 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:26,366 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:26,367 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:26,453 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:34:26,487 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:34:26,488 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:26,600 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:26,607 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:26,607 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:26,614 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:34:26,625 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:26,625 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:34:26,626 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:26,626 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:26,626 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:34:26,636 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:26,639 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:26,641 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:26,643 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:26,646 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:26,648 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:26,651 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:26,654 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:26,656 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:26,658 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:26,661 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:26,672 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:26,672 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:34:26,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:34:26,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:34:26,685 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:26,685 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:34:26,696 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:26,696 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:34:26,697 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:26,713 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:26,718 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:34:26,725 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:34:26,725 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:26,725 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:26,725 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:26,725 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:26,726 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:26,726 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:34:26,726 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:26,726 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:34:26,726 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:26,728 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:34:26,728 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:34:26,728 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:26,728 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:34:26,728 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:26,728 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:26,729 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:26,729 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:34:26,729 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:34:26,729 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:34:26,729 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:34:26,729 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:34:26,730 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:34:26,730 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:34:26,730 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:34:26,730 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:34:26,730 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:34:26,730 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:34:26,730 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:34:26,731 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:26,731 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:34:26,731 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:26,731 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:26,732 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:26,732 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:34:26,732 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:34:26,732 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:34:26,732 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:34:26,738 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:34:26,738 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:26,739 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:26,740 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:26,741 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:26,741 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:26,741 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:26,742 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:26,750 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3883, Threshold=0.4162, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:34:26,750 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3883
2025-08-04 20:34:38,012 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:38,012 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:34:38,012 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:34:38,012 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:34:38,012 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:34:38,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:38,281 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:38,282 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:38,368 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:34:38,410 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:34:38,410 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:38,531 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:38,539 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:38,539 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:38,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:34:38,555 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:38,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:34:38,556 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:38,559 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:38,559 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:34:38,569 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:38,572 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:38,574 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:38,577 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:38,580 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:38,582 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:38,585 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:38,587 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:38,590 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:38,592 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:38,595 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:38,606 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:38,606 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:34:38,612 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:34:38,612 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:34:38,617 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:38,617 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:34:38,632 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:38,632 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:34:38,633 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:38,650 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:38,655 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:34:38,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:34:38,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:38,682 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:38,682 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:38,682 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:38,684 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:38,684 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:34:38,684 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:38,684 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:34:38,684 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:38,686 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:34:38,686 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:34:38,687 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:38,687 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:34:38,687 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:38,687 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:38,687 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:38,687 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:34:38,688 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:34:38,688 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:34:38,688 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:34:38,688 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:34:38,688 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:34:38,688 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:34:38,688 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:34:38,689 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:34:38,689 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:34:38,689 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:34:38,689 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:34:38,689 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:38,689 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:34:38,690 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:38,690 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:38,690 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:38,690 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:34:38,690 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:34:38,690 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:34:38,691 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:34:38,697 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:34:38,697 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:38,698 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:38,698 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:38,700 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:38,700 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:38,700 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:38,701 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:38,712 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3795, Threshold=0.4070, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:34:38,712 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3795
2025-08-04 20:34:53,033 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:34:53,033 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:34:53,033 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:34:53,034 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:34:53,034 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:34:53,034 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:34:53,467 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:34:53,468 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:34:53,564 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:34:53,604 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:34:53,604 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:34:53,715 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:34:53,722 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:34:53,722 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:34:53,727 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:34:53,736 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:34:53,736 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:34:53,737 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:34:53,737 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:34:53,737 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:34:53,746 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:34:53,749 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:53,751 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:34:53,753 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:34:53,756 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:34:53,758 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:34:53,761 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:34:53,764 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:34:53,766 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:34:53,768 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:34:53,771 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:34:53,780 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:34:53,780 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:34:53,786 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:34:53,786 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:34:53,790 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:34:53,790 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:34:53,803 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:34:53,803 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:34:53,803 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:34:53,835 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:34:53,840 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:34:53,844 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:34:53,844 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:34:53,844 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:34:53,844 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:34:53,845 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:34:53,845 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:34:53,845 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:34:53,846 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:34:53,846 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:34:53,846 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:34:53,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:34:53,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:34:53,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:34:53,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:34:53,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:34:53,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:34:53,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:34:53,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:34:53,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:34:53,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:34:53,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:34:53,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:34:53,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:34:53,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:34:53,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:34:53,850 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:34:53,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:34:53,850 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:34:53,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:34:53,850 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:34:53,851 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:34:53,851 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:34:53,851 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:34:53,851 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:34:53,851 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:34:53,852 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:34:53,852 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:34:53,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:34:53,857 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:34:53,857 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:34:53,859 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:34:53,859 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:34:53,860 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:34:53,860 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:34:53,861 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:34:53,861 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:34:53,869 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3858, Threshold=0.4131, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:34:53,869 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3858
2025-08-04 20:35:11,164 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:11,164 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:11,164 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:11,164 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:35:11,164 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:35:11,164 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:11,430 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:11,430 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:11,522 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:35:11,564 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:35:11,564 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:11,677 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:11,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:11,682 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:11,687 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:35:11,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:11,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:35:11,693 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:11,693 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:11,693 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:35:11,701 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:11,704 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:11,706 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:11,708 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:11,711 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:11,713 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:11,716 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:11,719 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:11,721 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:11,723 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:11,726 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:11,735 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:11,735 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:35:11,740 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:35:11,740 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:35:11,744 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:11,744 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:35:11,752 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:11,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:35:11,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:11,768 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:11,773 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:35:11,779 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:35:11,779 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:11,779 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:11,779 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:11,779 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:11,780 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:11,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:35:11,780 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:11,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:35:11,780 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:11,782 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:35:11,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:35:11,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:11,783 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:35:11,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:11,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:11,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:11,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:35:11,783 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:35:11,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:35:11,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:35:11,784 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:35:11,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:35:11,784 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:35:11,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:35:11,784 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:35:11,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:35:11,784 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:35:11,785 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:35:11,785 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:11,785 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:35:11,785 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:11,785 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:11,785 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:11,786 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:35:11,786 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:35:11,786 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:35:11,786 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:35:11,792 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:35:11,792 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:11,793 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:11,793 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:11,794 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:11,795 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:11,795 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:11,795 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:11,815 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3916, Threshold=0.4198, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:35:11,817 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3916
2025-08-04 20:35:23,108 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:23,108 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:23,109 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:23,109 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:35:23,109 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:35:23,109 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:23,389 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:23,389 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:23,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:35:23,513 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:35:23,513 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:23,605 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:23,610 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:23,610 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:23,615 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:35:23,621 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:23,621 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:35:23,622 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:23,622 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:23,622 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:35:23,630 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:23,633 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:23,635 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:23,637 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:23,640 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:23,642 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:23,645 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:23,647 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:23,650 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:23,652 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:23,654 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:23,664 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:23,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:35:23,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:35:23,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:35:23,673 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:23,674 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:35:23,682 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:23,683 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:35:23,683 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:23,698 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:23,702 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:35:23,707 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:35:23,707 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:23,707 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:23,707 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:23,707 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:23,708 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:23,708 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:35:23,708 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:23,708 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:35:23,708 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:23,710 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:35:23,710 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:35:23,710 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:23,710 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:35:23,711 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:23,711 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:23,711 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:23,711 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:35:23,711 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:35:23,711 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:35:23,711 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:35:23,711 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:35:23,711 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:35:23,712 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:35:23,712 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:35:23,712 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:35:23,712 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:35:23,712 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:35:23,712 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:35:23,712 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:23,713 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:35:23,713 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:23,713 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:23,713 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:23,713 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:35:23,714 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:35:23,714 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:35:23,714 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:35:23,718 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:35:23,718 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:23,720 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:23,720 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:23,721 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:23,721 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:23,721 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:23,722 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:23,737 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4098, Threshold=0.4393, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:35:23,738 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.4098
2025-08-04 20:35:35,012 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:35,012 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:35,012 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:35,012 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:35:35,012 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:35:35,012 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:35,371 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:35,371 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:35,467 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:35:35,514 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:35:35,514 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:35,640 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:35,647 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:35,647 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:35,653 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:35:35,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:35,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:35:35,660 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:35,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:35,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:35:35,670 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:35,674 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:35,676 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:35,679 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:35,681 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:35,683 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:35,686 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:35,688 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:35,691 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:35,693 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:35,695 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:35,705 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:35,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:35:35,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:35:35,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:35:35,714 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:35,714 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:35:35,723 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:35,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:35:35,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:35,741 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:35,745 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:35:35,754 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:35:35,754 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:35,754 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:35,754 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:35,755 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:35,755 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:35,755 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:35:35,755 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:35,755 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:35:35,756 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:35,757 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:35:35,757 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:35:35,757 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:35,758 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:35:35,758 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:35,758 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:35,758 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:35,758 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:35:35,758 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:35:35,758 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:35:35,759 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:35:35,759 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:35:35,759 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:35:35,759 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:35:35,759 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:35:35,759 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:35:35,760 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:35:35,760 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:35:35,760 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:35:35,760 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:35,760 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:35:35,760 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:35,761 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:35,761 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:35,761 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:35:35,761 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:35:35,761 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:35:35,761 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:35:35,768 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:35:35,768 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:35,769 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:35,769 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:35,771 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:35,771 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:35,771 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:35,772 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:35,780 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3780, Threshold=0.4068, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:35:35,780 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3780
2025-08-04 20:35:47,067 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:47,068 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:47,068 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:47,068 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:35:47,068 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:35:47,068 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:47,338 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:47,338 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:47,426 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:35:47,456 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:35:47,456 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:47,568 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:47,577 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:47,580 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:47,587 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:35:47,596 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:47,599 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:35:47,600 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:47,600 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:47,600 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:35:47,611 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:47,614 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:47,616 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:47,618 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:47,621 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:47,623 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:47,626 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:47,628 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:47,631 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:47,633 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:47,635 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:47,645 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:47,645 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:35:47,651 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:35:47,651 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:35:47,656 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:47,657 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:35:47,668 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:47,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:35:47,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:47,685 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:47,690 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:35:47,699 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:35:47,700 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:47,700 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:47,700 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:47,700 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:47,701 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:47,701 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:35:47,701 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:47,701 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:35:47,701 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:47,703 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:35:47,703 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:35:47,704 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:47,704 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:35:47,704 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:47,704 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:47,704 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:47,704 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:35:47,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:35:47,705 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:35:47,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:35:47,705 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:35:47,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:35:47,705 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:35:47,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:35:47,706 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:35:47,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:35:47,706 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:35:47,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:35:47,706 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:47,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:35:47,707 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:47,707 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:47,707 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:47,707 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:35:47,707 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:35:47,708 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:35:47,708 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:35:47,711 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:35:47,711 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:47,712 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:47,713 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:47,714 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:47,714 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:47,714 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:47,715 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:47,723 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3930, Threshold=0.4253, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:35:47,723 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3930
2025-08-04 20:35:58,994 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:35:58,994 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:35:58,995 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:35:58,995 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:35:58,995 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:35:58,995 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:35:59,247 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:35:59,248 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:35:59,337 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:35:59,380 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:35:59,380 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:35:59,565 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:35:59,573 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:35:59,573 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:35:59,585 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:35:59,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:35:59,599 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:35:59,599 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:35:59,599 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:35:59,600 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:35:59,609 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:35:59,612 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:59,614 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:35:59,617 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:35:59,620 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:35:59,622 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:35:59,625 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:35:59,628 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:35:59,631 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:35:59,634 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:35:59,636 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:35:59,649 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:35:59,649 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:35:59,655 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:35:59,655 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:35:59,662 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:35:59,662 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:35:59,679 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:35:59,679 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:35:59,679 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:35:59,699 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:35:59,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:35:59,716 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:35:59,716 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:35:59,716 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:35:59,716 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:35:59,717 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:35:59,717 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:35:59,717 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:35:59,717 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:35:59,718 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:35:59,718 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:35:59,719 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:35:59,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:35:59,720 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:35:59,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:35:59,720 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:35:59,720 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:35:59,720 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:35:59,720 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:35:59,721 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:35:59,721 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:35:59,721 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:35:59,721 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:35:59,721 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:35:59,721 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:35:59,722 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:35:59,722 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:35:59,722 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:35:59,722 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:35:59,722 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:35:59,723 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:35:59,723 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:35:59,723 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:35:59,723 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:35:59,723 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:35:59,723 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:35:59,724 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:35:59,724 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:35:59,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:35:59,732 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:35:59,732 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:35:59,734 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:35:59,734 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:35:59,736 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:35:59,737 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:35:59,737 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:35:59,738 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:35:59,746 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4059, Threshold=0.4370, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:35:59,747 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.4059
2025-08-04 20:36:17,006 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:17,006 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:17,006 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:17,007 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:36:17,007 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:36:17,007 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:17,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:17,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:17,369 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:36:17,417 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:36:17,418 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:17,547 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:17,553 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:17,553 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:17,559 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:36:17,566 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:17,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:36:17,567 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:17,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:17,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:36:17,576 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:17,579 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:17,581 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:17,583 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:17,586 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:17,588 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:17,591 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:17,593 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:17,596 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:17,598 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:17,600 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:17,610 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:17,611 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:36:17,616 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:36:17,616 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:36:17,622 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:17,622 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:36:17,633 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:17,633 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:36:17,634 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:17,652 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:17,657 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:36:17,663 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:36:17,663 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:17,663 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:17,663 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:17,664 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:17,664 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:17,664 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:36:17,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:17,664 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:36:17,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:17,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:36:17,666 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:36:17,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:17,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:36:17,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:17,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:17,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:17,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:36:17,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:36:17,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:36:17,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:36:17,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:36:17,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:36:17,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:36:17,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:36:17,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:36:17,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:36:17,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:36:17,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:36:17,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:17,670 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:36:17,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:17,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:17,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:17,670 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:36:17,671 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:36:17,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:36:17,671 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:36:17,677 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:36:17,678 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:17,679 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:17,679 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:17,680 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:17,680 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:17,681 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:17,681 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:17,689 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3869, Threshold=0.4151, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:36:17,689 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3869
2025-08-04 20:36:28,954 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:28,954 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:28,954 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:28,955 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:36:28,955 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:36:28,955 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:29,246 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:29,246 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:29,337 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:36:29,383 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:36:29,384 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:29,520 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:29,527 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:29,527 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:29,535 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:36:29,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:29,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:36:29,546 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:29,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:29,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:36:29,556 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:29,559 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:29,561 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:29,564 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:29,566 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:29,569 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:29,571 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:29,574 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:29,577 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:29,579 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:29,582 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:29,596 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:29,597 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:36:29,605 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:36:29,605 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:36:29,611 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:29,611 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:36:29,624 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:29,624 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:36:29,624 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:29,645 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:29,652 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:36:29,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:36:29,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:29,669 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:29,669 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:29,670 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:29,670 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:29,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:36:29,670 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:29,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:36:29,671 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:29,672 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:36:29,672 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:36:29,673 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:29,673 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:36:29,673 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:29,673 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:29,673 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:29,673 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:36:29,673 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:36:29,674 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:36:29,674 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:36:29,674 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:36:29,674 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:36:29,674 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:36:29,675 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:36:29,675 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:36:29,675 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:36:29,675 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:36:29,675 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:36:29,675 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:29,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:36:29,676 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:29,676 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:29,676 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:29,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:36:29,676 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:36:29,677 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:36:29,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:36:29,687 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:36:29,687 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:29,688 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:29,689 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:29,690 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:29,691 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:29,691 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:29,691 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:29,700 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3957, Threshold=0.4299, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:36:29,700 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.3957
2025-08-04 20:36:46,974 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:36:46,974 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:36:46,974 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:36:46,974 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:36:46,974 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:36:46,974 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:36:47,239 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:36:47,239 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:36:47,329 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:36:47,361 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:36:47,361 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:36:47,477 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:36:47,486 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:36:47,486 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:36:47,497 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:36:47,524 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:36:47,525 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:36:47,525 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:36:47,525 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:36:47,526 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:36:47,534 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:36:47,537 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:47,539 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:36:47,542 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:36:47,545 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:36:47,547 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:36:47,550 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:36:47,552 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:36:47,555 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:36:47,557 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:36:47,560 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:36:47,570 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:36:47,571 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:36:47,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:36:47,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:36:47,581 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:36:47,582 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:36:47,595 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:36:47,596 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:36:47,596 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:36:47,613 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:36:47,619 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:36:47,630 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:36:47,630 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:36:47,630 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:36:47,630 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:36:47,631 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:36:47,631 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:36:47,631 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:36:47,631 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:36:47,632 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:36:47,632 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:36:47,633 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:36:47,633 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:36:47,634 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:36:47,634 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:36:47,634 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:36:47,634 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:36:47,634 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:36:47,634 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:36:47,635 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:36:47,635 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:36:47,635 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:36:47,635 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:36:47,635 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:36:47,636 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:36:47,636 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:36:47,636 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:36:47,636 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:36:47,636 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:36:47,636 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:36:47,636 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:36:47,637 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:36:47,637 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:36:47,637 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:36:47,637 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:36:47,638 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:36:47,638 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:36:47,638 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:36:47,638 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:36:47,643 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:36:47,643 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:36:47,644 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:36:47,644 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:36:47,646 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:36:47,646 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:36:47,646 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:36:47,647 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:36:47,655 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4145, Threshold=0.4513, Accuracy=0.6286, F1=0.7451, Precision=0.9048, Recall=0.6333
2025-08-04 20:36:47,655 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6286, F1: 0.7451, Prec: 0.9048, Rec: 0.6333, Avg Anomaly Score: 0.4145
2025-08-04 20:37:01,924 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:01,924 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:01,925 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:01,925 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:37:01,925 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:37:01,925 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:02,231 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:02,232 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:02,322 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:37:02,367 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:37:02,367 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:02,525 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:02,532 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:02,532 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:02,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:37:02,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:02,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:37:02,549 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:02,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:02,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:37:02,558 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:02,561 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:02,563 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:02,565 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:02,568 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:02,570 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:02,573 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:02,575 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:02,578 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:02,580 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:02,582 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:02,593 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:02,593 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:37:02,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:37:02,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:37:02,604 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:02,604 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:37:02,617 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:02,617 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:37:02,618 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:02,634 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:02,638 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:37:02,651 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:37:02,652 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:02,652 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:02,652 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:02,652 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:02,653 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:02,653 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:37:02,654 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:02,655 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:37:02,655 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:02,657 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:37:02,657 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:37:02,657 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:02,658 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:37:02,658 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:02,658 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:02,658 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:02,658 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:37:02,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:37:02,659 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:37:02,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:37:02,659 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:37:02,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:37:02,659 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:37:02,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:37:02,660 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:37:02,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:37:02,660 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:37:02,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:37:02,660 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:02,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:37:02,661 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:02,661 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:02,661 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:02,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:37:02,661 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:37:02,661 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:37:02,662 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:37:02,673 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:37:02,673 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:02,675 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:02,675 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:02,676 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:02,676 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:02,676 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:02,677 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:02,685 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4015, Threshold=0.4373, Accuracy=0.6667, F1=0.7712, Precision=0.9365, Recall=0.6556
2025-08-04 20:37:02,685 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6667, F1: 0.7712, Prec: 0.9365, Rec: 0.6556, Avg Anomaly Score: 0.4015
2025-08-04 20:37:16,971 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:16,971 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:16,971 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:16,971 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:37:16,972 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:37:16,972 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:17,253 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:17,253 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:17,343 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:37:17,379 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:37:17,379 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:17,475 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:17,482 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:17,482 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:17,489 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:37:17,500 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:17,500 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:37:17,501 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:17,501 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:17,501 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:37:17,510 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:17,513 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:17,515 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:17,517 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:17,520 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:17,522 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:17,524 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:17,526 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:17,529 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:17,531 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:17,533 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:17,544 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:17,544 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:37:17,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:37:17,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:37:17,554 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:17,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:37:17,563 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:17,563 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:37:17,564 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:17,580 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:17,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:37:17,592 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:37:17,592 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:17,592 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:17,592 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:17,593 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:17,593 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:17,593 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:37:17,593 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:17,593 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:37:17,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:17,595 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:37:17,595 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:37:17,596 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:17,596 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:37:17,596 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:17,596 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:17,596 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:17,596 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:37:17,597 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:37:17,597 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:37:17,597 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:37:17,597 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:37:17,597 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:37:17,597 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:37:17,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:37:17,598 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:37:17,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:37:17,598 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:37:17,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:37:17,598 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:17,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:37:17,599 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:17,599 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:17,599 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:17,599 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:37:17,599 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:37:17,600 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:37:17,600 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:37:17,605 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:37:17,605 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:17,606 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:17,606 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:17,608 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:17,608 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:17,608 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:17,608 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:17,624 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4061, Threshold=0.4461, Accuracy=0.6667, F1=0.7712, Precision=0.9365, Recall=0.6556
2025-08-04 20:37:17,624 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6667, F1: 0.7712, Prec: 0.9365, Rec: 0.6556, Avg Anomaly Score: 0.4061
2025-08-04 20:37:28,895 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:28,895 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:28,895 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:28,896 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:37:28,896 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:37:28,896 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:29,158 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:29,158 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:29,250 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:37:29,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:37:29,295 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:29,425 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:29,432 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:29,432 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:29,438 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:37:29,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:29,444 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:37:29,444 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:29,444 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:29,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:37:29,453 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:29,456 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:29,458 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:29,461 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:29,463 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:29,466 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:29,468 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:29,471 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:29,474 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:29,476 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:29,479 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:29,489 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:29,490 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:37:29,495 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:37:29,495 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:37:29,500 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:29,500 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:37:29,509 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:29,509 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:37:29,509 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:29,526 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:29,532 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:37:29,540 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:37:29,540 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:29,540 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:29,540 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:29,541 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:29,541 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:29,541 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:37:29,541 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:29,542 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:37:29,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:29,543 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:37:29,544 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:37:29,544 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:29,544 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:37:29,544 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:29,545 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:29,545 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:29,545 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:37:29,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:37:29,545 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:37:29,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:37:29,545 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:37:29,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:37:29,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:37:29,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:37:29,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:37:29,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:37:29,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:37:29,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:37:29,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:29,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:37:29,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:29,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:29,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:29,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:37:29,548 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:37:29,548 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:37:29,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:37:29,552 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:37:29,552 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:29,553 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:29,553 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:29,555 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:29,555 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:29,555 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:29,556 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:29,564 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3804, Threshold=0.4214, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:37:29,565 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.3804
2025-08-04 20:37:43,838 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:43,839 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:43,839 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:43,839 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:37:43,839 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:37:43,839 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:44,053 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:44,053 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:44,136 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:37:44,158 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:37:44,158 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:44,256 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:44,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:44,261 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:44,266 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:37:44,271 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:44,271 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:37:44,272 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:44,272 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:44,272 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:37:44,280 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:44,283 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:44,285 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:44,288 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:44,290 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:44,293 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:44,295 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:44,298 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:44,300 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:44,302 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:44,304 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:44,314 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:44,314 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:37:44,319 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:37:44,319 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:37:44,323 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:44,323 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:37:44,332 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:44,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:37:44,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:44,348 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:44,352 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:37:44,359 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:37:44,359 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:44,359 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:44,359 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:44,360 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:44,360 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:44,360 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:37:44,360 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:44,360 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:37:44,361 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:44,362 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:37:44,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:37:44,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:44,363 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:37:44,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:44,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:44,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:44,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:37:44,364 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:37:44,364 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:37:44,364 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:37:44,364 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:37:44,364 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:37:44,364 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:37:44,364 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:37:44,365 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:37:44,365 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:37:44,365 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:37:44,365 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:37:44,365 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:44,365 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:37:44,366 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:44,366 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:44,366 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:44,366 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:37:44,366 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:37:44,367 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:37:44,367 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:37:44,370 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:37:44,370 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:44,371 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:44,371 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:44,373 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:44,373 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:44,373 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:44,373 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:44,381 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3965, Threshold=0.4432, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:37:44,385 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.3965
2025-08-04 20:37:55,652 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:37:55,652 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:37:55,652 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:37:55,652 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:37:55,652 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:37:55,652 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:37:55,981 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:37:55,981 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:37:56,070 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:37:56,113 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:37:56,114 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:37:56,241 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:37:56,248 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:37:56,248 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:37:56,254 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:37:56,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:37:56,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:37:56,262 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:37:56,262 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:37:56,262 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:37:56,271 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:37:56,274 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:56,276 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:37:56,278 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:37:56,281 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:37:56,284 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:37:56,287 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:37:56,289 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:37:56,293 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:37:56,296 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:37:56,299 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:37:56,311 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:37:56,311 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:37:56,318 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:37:56,318 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:37:56,324 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:37:56,324 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:37:56,334 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:37:56,334 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:37:56,334 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:37:56,351 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:37:56,356 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:37:56,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:37:56,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:37:56,362 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:37:56,362 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:37:56,362 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:37:56,363 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:37:56,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:37:56,363 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:37:56,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:37:56,363 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:37:56,365 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:37:56,365 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:37:56,365 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:37:56,366 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:37:56,366 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:37:56,366 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:37:56,366 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:37:56,366 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:37:56,366 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:37:56,366 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:37:56,367 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:37:56,367 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:37:56,367 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:37:56,367 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:37:56,367 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:37:56,367 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:37:56,368 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:37:56,368 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:37:56,368 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:37:56,368 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:37:56,368 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:37:56,368 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:37:56,369 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:37:56,369 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:37:56,369 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:37:56,369 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:37:56,369 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:37:56,369 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:37:56,374 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:37:56,374 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:37:56,376 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:37:56,376 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:37:56,377 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:37:56,378 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:37:56,378 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:37:56,378 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:37:56,386 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4020, Threshold=0.4522, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:37:56,386 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4020
2025-08-04 20:38:07,673 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:07,673 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:38:07,673 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:38:07,676 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:38:07,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:38:07,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:07,922 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:07,922 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:08,008 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:38:08,054 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:38:08,054 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:08,167 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:08,172 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:08,173 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:08,179 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:38:08,187 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:08,187 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:38:08,187 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:08,188 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:08,188 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:38:08,196 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:08,199 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:08,201 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:08,203 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:08,206 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:08,208 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:08,210 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:08,213 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:08,216 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:08,218 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:08,220 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:08,230 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:08,230 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:38:08,235 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:38:08,235 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:38:08,242 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:08,242 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:38:08,253 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:08,253 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:38:08,253 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:08,268 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:08,273 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:38:08,278 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:38:08,278 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:08,278 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:08,278 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:08,278 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:08,279 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:08,279 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:38:08,279 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:08,279 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:38:08,279 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:08,281 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:38:08,281 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:38:08,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:08,282 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:38:08,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:08,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:08,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:08,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:38:08,282 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:38:08,283 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:38:08,283 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:38:08,283 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:38:08,283 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:38:08,283 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:38:08,283 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:38:08,283 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:38:08,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:38:08,284 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:38:08,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:38:08,284 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:08,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:38:08,284 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:08,284 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:08,285 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:08,285 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:38:08,285 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:38:08,285 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:38:08,285 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:38:08,293 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:38:08,293 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:08,294 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:08,294 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:38:08,296 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:08,296 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:08,296 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:08,297 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:08,305 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4027, Threshold=0.4547, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:38:08,306 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4027
2025-08-04 20:38:22,595 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:22,595 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:38:22,595 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:38:22,595 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:38:22,596 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:38:22,596 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:22,891 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:22,891 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:22,978 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:38:23,016 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:38:23,016 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:23,103 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:23,108 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:23,108 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:23,113 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:38:23,118 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:23,119 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:38:23,119 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:23,119 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:23,119 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:38:23,127 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:23,130 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:23,132 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:23,134 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:23,137 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:23,139 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:23,142 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:23,145 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:23,147 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:23,149 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:23,151 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:23,160 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:23,161 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:38:23,165 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:38:23,165 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:38:23,169 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:23,169 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:38:23,178 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:23,179 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:38:23,179 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:23,195 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:23,200 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:38:23,208 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:38:23,208 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:23,208 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:23,208 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:23,208 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:23,209 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:23,209 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:38:23,209 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:23,209 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:38:23,209 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:23,211 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:38:23,211 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:38:23,211 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:23,211 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:38:23,212 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:23,212 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:23,212 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:23,212 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:38:23,212 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:38:23,212 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:38:23,212 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:38:23,213 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:38:23,213 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:38:23,213 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:38:23,213 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:38:23,213 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:38:23,213 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:38:23,214 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:38:23,214 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:38:23,214 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:23,214 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:38:23,214 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:23,215 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:23,215 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:23,215 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:38:23,215 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:38:23,215 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:38:23,215 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:38:23,221 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:38:23,221 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:23,222 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:23,222 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:38:23,224 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:23,224 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:23,224 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:23,225 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:23,233 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4001, Threshold=0.4544, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:38:23,233 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4001
2025-08-04 20:38:34,504 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:34,504 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:38:34,504 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:38:34,504 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:38:34,504 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:38:34,504 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:34,765 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:34,765 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:34,851 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:38:34,883 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:38:34,883 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:34,975 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:34,979 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:34,980 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:34,985 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:38:34,995 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:34,996 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:38:34,996 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:34,996 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:34,997 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:38:35,005 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:35,008 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:35,010 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:35,012 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:35,015 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:35,018 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:35,020 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:35,022 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:35,025 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:35,027 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:35,029 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:35,038 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:35,039 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:38:35,043 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:38:35,043 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:38:35,047 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:35,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:38:35,056 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:35,056 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:38:35,056 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:35,071 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:35,076 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:38:35,080 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:38:35,080 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:35,081 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:35,081 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:35,081 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:35,081 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:35,081 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:38:35,082 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:35,082 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:38:35,082 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:35,083 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:38:35,083 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:38:35,084 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:35,084 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:38:35,084 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:35,084 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:35,085 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:35,085 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:38:35,085 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:38:35,085 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:38:35,086 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:38:35,086 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:38:35,086 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:38:35,086 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:38:35,086 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:38:35,086 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:38:35,087 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:38:35,087 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:38:35,087 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:38:35,087 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:35,087 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:38:35,087 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:35,088 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:35,088 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:35,088 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:38:35,088 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:38:35,088 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:38:35,088 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:38:35,090 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:38:35,090 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:35,091 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:35,092 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:38:35,093 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:35,093 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:35,093 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:35,094 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:35,110 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3994, Threshold=0.4557, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:38:35,110 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.3994
2025-08-04 20:38:46,386 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:38:46,386 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:38:46,386 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:38:46,387 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:38:46,387 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:38:46,387 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:38:46,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:38:46,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:38:46,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:38:46,822 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:38:46,822 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:38:46,933 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:38:46,939 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:38:46,939 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:38:46,944 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:38:46,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:38:46,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:38:46,949 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:38:46,950 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:38:46,950 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:38:46,957 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:38:46,960 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:46,962 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:38:46,964 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:38:46,967 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:38:46,969 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:38:46,972 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:38:46,974 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:38:46,977 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:38:46,978 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:38:46,980 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:38:46,989 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:38:46,989 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:38:46,994 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:38:46,994 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:38:46,998 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:38:46,999 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:38:47,008 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:38:47,008 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:38:47,008 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:38:47,023 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:38:47,028 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:38:47,034 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:38:47,034 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:38:47,034 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:38:47,034 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:38:47,035 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:38:47,035 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:38:47,035 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:38:47,035 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:38:47,036 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:38:47,036 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:38:47,037 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:38:47,037 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:38:47,037 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:38:47,038 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:38:47,038 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:38:47,038 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:38:47,038 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:38:47,038 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:38:47,038 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:38:47,038 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:38:47,039 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:38:47,039 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:38:47,039 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:38:47,039 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:38:47,039 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:38:47,039 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:38:47,039 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:38:47,040 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:38:47,040 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:38:47,040 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:38:47,040 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:38:47,040 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:38:47,040 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:38:47,040 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:38:47,041 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:38:47,041 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:38:47,041 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:38:47,041 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:38:47,047 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:38:47,048 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:38:47,049 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:38:47,049 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:38:47,050 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:38:47,050 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:38:47,050 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:38:47,051 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:38:47,066 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3985, Threshold=0.4532, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:38:47,066 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.3985
2025-08-04 20:39:01,354 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:01,354 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:01,354 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:01,354 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:39:01,354 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:39:01,354 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:01,675 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:01,675 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:01,765 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:39:01,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:39:01,808 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:01,930 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:01,936 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:01,936 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:01,941 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:39:01,948 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:01,948 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:39:01,949 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:01,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:01,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:39:01,957 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:01,960 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:01,962 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:01,965 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:01,968 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:01,970 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:01,972 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:01,974 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:01,977 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:01,980 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:01,982 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:01,993 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:01,994 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:39:02,001 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:39:02,001 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:39:02,006 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:02,006 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:39:02,016 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:02,016 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:39:02,017 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:02,032 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:02,037 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:39:02,042 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:39:02,042 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:02,042 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:02,042 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:02,042 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:02,043 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:02,043 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:39:02,043 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:02,043 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:39:02,043 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:02,045 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:39:02,045 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:39:02,045 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:02,045 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:39:02,045 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:02,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:02,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:02,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:39:02,046 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:39:02,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:39:02,046 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:39:02,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:39:02,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:39:02,047 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:39:02,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:39:02,047 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:39:02,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:39:02,047 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:39:02,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:39:02,047 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:02,048 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:39:02,048 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:02,048 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:02,048 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:02,048 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:39:02,049 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:39:02,049 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:39:02,049 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:39:02,052 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:39:02,052 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:02,054 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:02,054 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:02,055 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:02,055 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:02,056 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:02,056 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:02,064 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3922, Threshold=0.4429, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:39:02,064 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.3922
2025-08-04 20:39:16,332 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:16,332 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:16,332 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:16,332 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:39:16,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:39:16,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:16,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:16,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:16,750 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:39:16,804 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:39:16,804 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:16,936 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:16,941 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:16,941 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:16,946 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:39:16,952 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:16,952 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:39:16,953 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:16,953 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:16,953 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:39:16,961 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:16,964 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:16,966 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:16,968 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:16,972 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:16,974 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:16,976 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:16,979 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:16,982 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:16,984 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:16,987 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:16,996 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:16,996 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:39:17,001 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:39:17,001 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:39:17,006 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:17,006 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:39:17,014 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:17,015 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:39:17,015 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:17,031 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:17,037 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:39:17,042 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:39:17,042 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:17,042 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:17,042 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:17,043 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:17,043 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:17,043 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:39:17,043 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:17,044 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:39:17,044 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:17,045 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:39:17,045 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:39:17,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:17,046 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:39:17,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:17,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:17,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:17,047 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:39:17,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:39:17,047 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:39:17,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:39:17,047 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:39:17,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:39:17,048 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:39:17,048 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:39:17,048 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:39:17,048 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:39:17,048 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:39:17,048 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:39:17,048 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:17,049 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:39:17,049 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:17,049 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:17,049 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:17,049 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:39:17,050 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:39:17,050 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:39:17,050 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:39:17,058 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:39:17,058 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:17,059 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:17,059 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:17,061 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:17,061 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:17,061 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:17,062 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:17,070 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4195, Threshold=0.4695, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:39:17,070 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4195
2025-08-04 20:39:28,342 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:28,342 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:28,342 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:28,342 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:39:28,342 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:39:28,343 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:28,644 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:28,644 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:28,727 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:39:28,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:39:28,753 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:28,849 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:28,856 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:28,856 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:28,861 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:39:28,869 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:28,869 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:39:28,870 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:28,870 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:28,870 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:39:28,879 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:28,882 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:28,884 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:28,886 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:28,889 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:28,891 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:28,894 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:28,897 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:28,900 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:28,902 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:28,904 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:28,914 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:28,914 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:39:28,918 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:39:28,919 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:39:28,924 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:28,924 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:39:28,932 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:28,932 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:39:28,932 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:28,948 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:28,953 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:39:28,959 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:39:28,959 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:28,959 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:28,959 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:28,960 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:28,960 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:28,960 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:39:28,960 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:28,961 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:39:28,961 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:28,962 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:39:28,963 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:39:28,963 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:28,963 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:39:28,963 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:28,964 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:28,964 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:28,964 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:39:28,964 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:39:28,964 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:39:28,964 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:39:28,964 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:39:28,964 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:39:28,965 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:39:28,965 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:39:28,965 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:39:28,965 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:39:28,965 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:39:28,965 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:39:28,965 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:28,965 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:39:28,966 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:28,966 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:28,966 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:28,966 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:39:28,966 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:39:28,966 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:39:28,967 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:39:28,971 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:39:28,971 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:28,973 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:28,973 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:28,974 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:28,974 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:28,974 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:28,975 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:28,982 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4066, Threshold=0.4507, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:39:28,983 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4066
2025-08-04 20:39:40,252 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:40,252 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:40,252 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:40,252 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:39:40,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:39:40,253 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:40,516 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:40,516 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:40,600 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:39:40,639 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:39:40,639 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:40,735 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:40,740 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:40,740 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:40,746 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:39:40,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:40,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:39:40,754 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:40,754 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:40,754 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:39:40,763 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:40,767 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:40,773 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:40,775 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:40,778 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:40,781 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:40,786 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:40,789 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:40,792 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:40,794 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:40,796 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:40,806 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:40,806 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:39:40,811 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:39:40,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:39:40,816 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:40,816 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:39:40,825 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:40,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:39:40,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:40,841 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:40,846 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:39:40,853 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:39:40,854 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:40,854 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:40,854 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:40,854 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:40,854 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:40,855 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:39:40,855 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:40,855 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:39:40,855 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:40,857 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:39:40,857 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:39:40,857 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:40,857 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:39:40,858 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:40,858 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:40,858 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:40,858 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:39:40,858 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:39:40,858 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:39:40,858 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:39:40,858 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:39:40,858 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:39:40,859 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:39:40,859 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:39:40,859 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:39:40,859 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:39:40,859 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:39:40,859 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:39:40,860 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:40,860 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:39:40,860 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:40,860 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:40,860 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:40,860 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:39:40,861 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:39:40,861 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:39:40,861 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:39:40,864 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:39:40,865 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:40,867 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:40,867 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:40,868 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:40,869 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:40,869 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:40,870 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:40,877 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3940, Threshold=0.4352, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:39:40,878 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.3940
2025-08-04 20:39:55,145 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:39:55,145 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:39:55,145 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:39:55,145 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:39:55,145 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:39:55,145 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:39:55,423 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:39:55,423 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:39:55,508 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:39:55,538 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:39:55,538 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:39:55,626 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:39:55,630 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:39:55,631 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:39:55,637 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:39:55,643 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:39:55,643 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:39:55,644 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:39:55,644 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:39:55,644 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:39:55,652 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:39:55,656 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:55,658 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:39:55,661 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:39:55,663 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:39:55,666 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:39:55,668 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:39:55,671 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:39:55,673 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:39:55,675 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:39:55,678 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:39:55,688 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:39:55,688 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:39:55,693 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:39:55,693 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:39:55,697 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:39:55,697 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:39:55,706 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:39:55,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:39:55,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:39:55,723 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:39:55,727 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:39:55,733 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:39:55,733 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:39:55,733 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:39:55,734 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:39:55,734 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:39:55,734 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:39:55,734 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:39:55,735 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:39:55,735 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:39:55,735 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:39:55,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:39:55,737 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:39:55,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:39:55,737 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:39:55,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:39:55,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:39:55,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:39:55,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:39:55,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:39:55,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:39:55,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:39:55,739 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:39:55,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:39:55,739 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:39:55,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:39:55,739 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:39:55,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:39:55,740 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:39:55,740 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:39:55,740 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:39:55,740 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:39:55,740 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:39:55,741 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:39:55,741 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:39:55,741 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:39:55,741 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:39:55,741 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:39:55,742 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:39:55,745 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:39:55,745 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:39:55,747 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:39:55,747 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:39:55,748 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:39:55,749 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:39:55,749 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:39:55,750 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:39:55,758 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4266, Threshold=0.4721, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:39:55,758 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4266
2025-08-04 20:40:13,051 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:13,051 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:13,052 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:13,052 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:40:13,052 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:40:13,052 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:13,342 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:13,342 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:13,428 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:40:13,465 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:40:13,465 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:13,589 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:13,596 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:13,596 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:13,601 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:40:13,607 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:13,607 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:40:13,607 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:13,607 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:13,608 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:40:13,616 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:13,619 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:13,621 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:13,623 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:13,626 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:13,628 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:13,631 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:13,636 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:13,639 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:13,641 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:13,644 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:13,656 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:13,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:40:13,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:40:13,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:40:13,665 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:13,666 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:40:13,674 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:13,674 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:40:13,674 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:13,689 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:13,694 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:40:13,700 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:40:13,700 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:13,700 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:13,700 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:13,701 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:13,701 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:13,701 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:40:13,701 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:13,701 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:40:13,702 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:13,703 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:40:13,703 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:40:13,704 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:13,704 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:40:13,704 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:13,704 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:13,704 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:13,704 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:40:13,704 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:40:13,704 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:40:13,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:40:13,705 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:40:13,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:40:13,705 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:40:13,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:40:13,705 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:40:13,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:40:13,706 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:40:13,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:40:13,706 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:13,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:40:13,706 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:13,707 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:13,707 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:13,707 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:40:13,707 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:40:13,707 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:40:13,707 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:40:13,713 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:40:13,713 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:13,715 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:13,715 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:13,716 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:13,716 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:13,716 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:13,717 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:13,724 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4296, Threshold=0.4750, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:40:13,726 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4296
2025-08-04 20:40:25,038 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:25,039 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:25,039 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:25,039 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:40:25,039 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:40:25,039 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:25,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:25,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:25,416 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:40:25,454 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:40:25,454 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:25,554 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:25,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:25,560 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:25,566 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:40:25,575 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:25,575 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:40:25,575 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:25,575 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:25,575 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:40:25,584 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:25,587 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:25,589 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:25,592 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:25,595 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:25,597 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:25,599 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:25,602 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:25,605 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:25,606 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:25,608 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:25,617 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:25,617 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:40:25,622 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:40:25,622 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:40:25,626 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:25,627 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:40:25,634 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:25,635 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:40:25,635 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:25,650 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:25,654 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:40:25,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:40:25,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:25,660 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:25,660 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:25,660 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:25,660 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:25,660 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:40:25,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:25,661 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:40:25,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:25,663 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:40:25,663 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:40:25,663 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:25,663 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:40:25,664 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:25,664 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:25,664 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:25,664 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:40:25,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:40:25,664 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:40:25,665 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:40:25,665 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:40:25,665 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:40:25,665 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:40:25,665 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:40:25,665 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:40:25,665 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:40:25,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:40:25,666 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:40:25,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:25,666 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:40:25,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:25,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:25,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:25,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:40:25,667 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:40:25,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:40:25,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:40:25,673 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:40:25,673 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:25,675 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:25,675 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:25,676 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:25,676 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:25,676 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:25,677 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:25,685 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4056, Threshold=0.4434, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:40:25,685 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4056
2025-08-04 20:40:30,957 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:30,957 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:30,957 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:30,957 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:40:30,957 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:40:30,957 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:31,223 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:31,223 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:31,309 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:40:31,347 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:40:31,347 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:31,453 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:31,459 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:31,459 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:31,464 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:40:31,468 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:31,468 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:40:31,469 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:31,469 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:31,469 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:40:31,478 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:31,481 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:31,483 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:31,485 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:31,488 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:31,490 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:31,492 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:31,495 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:31,497 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:31,499 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:31,501 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:31,510 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:31,510 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:40:31,515 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:40:31,515 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:40:31,519 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:31,519 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:40:31,526 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:31,527 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:40:31,527 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:31,541 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:31,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:40:31,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:40:31,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:31,552 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:31,552 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:31,553 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:31,553 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:31,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:40:31,553 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:31,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:40:31,553 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:31,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:40:31,555 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:40:31,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:31,555 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:40:31,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:31,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:31,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:31,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:40:31,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:40:31,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:40:31,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:40:31,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:40:31,557 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:40:31,557 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:40:31,557 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:40:31,557 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:40:31,557 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:40:31,557 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:40:31,557 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:40:31,557 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:31,558 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:40:31,558 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:31,558 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:31,558 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:31,558 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:40:31,558 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:40:31,559 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:40:31,559 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:40:31,564 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:40:31,564 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:31,566 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:31,566 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:31,567 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 86/400.
2025-08-04 20:40:31,672 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:31,672 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:31,681 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 3 anomalous samples to GAN training data (target: 3).
2025-08-04 20:40:31,683 - ClientAppLogger [Client 6] - INFO - [Client] Round 86: Training GAN with 16 samples (13 normal, 3 anomalous).
2025-08-04 20:40:31,683 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:34,229 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0823, Avg D Loss: 0.8575
2025-08-04 20:40:34,229 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0823, Avg D Loss: 0.8575
2025-08-04 20:40:34,229 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:34,237 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3907, Threshold=0.4279, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:40:34,237 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:40:34,238 - ClientAppLogger [Client 6] - INFO - Fit completed for round 86. Duration: 2.67s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 86, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0823469161987305, 'd_loss': 0.8574600696563721, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 2.6701276302337646, 'cpu_percent_fit': 3.825, 'ram_mb_fit': 160.1796875, 'accumulated_train_samples_this_round': 16}
2025-08-04 20:40:34,238 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:40:39,530 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:39,530 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:39,530 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:39,530 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:40:39,531 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:40:39,531 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:40,038 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:40,040 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:40,137 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:40:40,184 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:40:40,184 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:40,322 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:40,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:40,332 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:40,341 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:40:40,355 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:40,355 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:40:40,356 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:40,356 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:40,356 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:40:40,369 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:40,372 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:40,374 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:40,377 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:40,380 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:40,383 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:40,387 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:40,390 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:40,393 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:40,395 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:40,398 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:40,409 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:40,410 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:40:40,417 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:40:40,417 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:40:40,425 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:40,425 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:40:40,438 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:40,439 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:40:40,439 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:40,461 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:40,466 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:40:40,472 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:40:40,473 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:40,473 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:40,473 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:40,473 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:40,474 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:40,474 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:40:40,474 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:40,475 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:40:40,475 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:40,477 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:40:40,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:40:40,477 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:40,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:40:40,478 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:40,478 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:40,478 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:40,478 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:40:40,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:40:40,478 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:40:40,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:40:40,478 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:40:40,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:40:40,479 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:40:40,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:40:40,479 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:40:40,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:40:40,480 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:40:40,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:40:40,480 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:40,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:40:40,480 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:40,481 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:40,481 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:40,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:40:40,481 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:40:40,481 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:40:40,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:40:40,485 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:40:40,485 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:40,486 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:40,486 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:40,488 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:40,488 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:40,488 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:40,489 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:40,497 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4405, Threshold=0.4907, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:40:40,497 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4405
2025-08-04 20:40:45,753 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:45,753 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:45,753 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:45,753 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:40:45,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:40:45,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:45,988 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:45,988 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:46,072 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:40:46,115 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:40:46,115 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:46,235 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:46,241 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:46,241 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:46,247 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:40:46,255 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:46,255 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:40:46,255 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:46,255 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:46,255 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:40:46,265 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:46,268 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:46,270 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:46,272 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:46,275 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:46,277 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:46,280 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:46,282 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:46,285 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:46,287 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:46,290 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:46,298 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:46,298 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:40:46,303 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:40:46,303 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:40:46,309 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:46,309 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:40:46,320 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:46,320 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:40:46,321 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:46,335 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:46,340 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:40:46,345 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:40:46,345 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:46,346 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:46,346 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:46,346 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:46,347 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:46,347 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:40:46,347 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:46,347 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:40:46,348 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:46,349 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:40:46,349 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:40:46,350 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:46,350 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:40:46,350 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:46,350 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:46,350 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:46,351 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:40:46,351 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:40:46,351 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:40:46,351 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:40:46,351 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:40:46,351 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:40:46,351 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:40:46,352 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:40:46,352 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:40:46,352 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:40:46,352 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:40:46,352 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:40:46,352 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:46,353 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:40:46,353 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:46,353 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:46,353 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:46,353 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:40:46,354 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:40:46,354 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:40:46,354 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:40:46,357 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:40:46,357 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:46,359 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:46,359 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:46,360 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 87/400.
2025-08-04 20:40:46,461 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:46,461 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:46,462 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:40:46,463 - ClientAppLogger [Client 6] - INFO - [Client] Round 87: Training GAN with 18 samples (14 normal, 4 anomalous).
2025-08-04 20:40:46,463 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:40:46,488 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0824, Avg D Loss: 0.8484
2025-08-04 20:40:46,488 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0824, Avg D Loss: 0.8484
2025-08-04 20:40:46,489 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:40:46,496 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4326, Threshold=0.4833, Accuracy=0.6667, F1=0.7712, Precision=0.9365, Recall=0.6556
2025-08-04 20:40:46,496 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7712
2025-08-04 20:40:46,497 - ClientAppLogger [Client 6] - INFO - Fit completed for round 87. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 87, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.082433271408081, 'd_loss': 0.8484367191791534, 'post_fit_local_f1': 0.7712418300653595, 'fit_time_seconds': 0.13665533065795898, 'cpu_percent_fit': 12.4, 'ram_mb_fit': 1.0625, 'accumulated_train_samples_this_round': 18}
2025-08-04 20:40:46,497 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:40:54,804 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:40:54,805 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:40:54,805 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:40:54,806 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:40:54,807 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:40:54,807 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:40:55,262 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:40:55,262 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:40:55,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:40:55,419 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:40:55,419 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:40:55,588 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:40:55,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:40:55,595 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:40:55,600 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:40:55,607 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:40:55,607 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:40:55,608 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:40:55,608 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:40:55,608 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:40:55,617 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:40:55,619 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:55,622 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:40:55,624 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:40:55,627 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:40:55,629 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:40:55,632 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:40:55,634 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:40:55,638 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:40:55,640 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:40:55,642 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:40:55,652 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:40:55,653 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:40:55,658 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:40:55,658 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:40:55,663 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:40:55,663 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:40:55,674 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:40:55,674 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:40:55,675 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:40:55,691 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:40:55,696 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:40:55,704 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:40:55,704 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:40:55,704 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:40:55,704 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:40:55,705 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:40:55,705 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:40:55,705 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:40:55,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:40:55,706 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:40:55,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:40:55,707 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:40:55,707 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:40:55,708 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:40:55,708 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:40:55,708 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:40:55,708 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:40:55,708 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:40:55,709 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:40:55,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:40:55,709 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:40:55,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:40:55,709 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:40:55,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:40:55,710 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:40:55,710 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:40:55,710 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:40:55,710 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:40:55,710 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:40:55,710 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:40:55,710 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:40:55,711 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:40:55,711 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:40:55,711 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:40:55,712 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:40:55,712 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:40:55,712 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:40:55,712 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:40:55,712 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:40:55,723 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:40:55,723 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:40:55,725 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:40:55,725 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:40:55,726 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:40:55,727 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:40:55,727 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:40:55,727 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:40:55,736 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4433, Threshold=0.4881, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:40:55,736 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4433
2025-08-04 20:41:10,021 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:10,021 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:10,021 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:10,021 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:41:10,022 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:41:10,022 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:10,372 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:10,372 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:10,459 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:41:10,486 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:41:10,487 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:10,640 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:10,648 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:10,648 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:10,655 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:41:10,663 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:10,663 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:41:10,664 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:10,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:10,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:41:10,675 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:10,678 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:10,681 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:10,683 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:10,686 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:10,688 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:10,691 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:10,694 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:10,697 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:10,699 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:10,702 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:10,714 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:10,714 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:41:10,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:41:10,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:41:10,725 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:10,725 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:41:10,738 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:10,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:41:10,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:10,760 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:10,768 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:41:10,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:41:10,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:10,776 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:10,776 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:10,776 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:10,776 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:10,777 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:41:10,777 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:10,777 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:41:10,777 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:10,779 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:41:10,779 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:41:10,779 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:10,780 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:41:10,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:10,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:10,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:10,781 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:41:10,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:41:10,782 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:41:10,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:41:10,782 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:41:10,783 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:41:10,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:41:10,783 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:41:10,784 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:41:10,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:41:10,784 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:41:10,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:41:10,784 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:10,785 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:41:10,786 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:10,786 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:10,787 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:10,787 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:41:10,787 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:41:10,787 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:41:10,788 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:41:10,794 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:41:10,794 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:10,795 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:10,796 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:10,797 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:10,797 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:10,798 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:10,799 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:10,808 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4102, Threshold=0.4453, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:41:10,808 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4102
2025-08-04 20:41:16,059 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:16,059 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:16,060 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:16,060 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:41:16,060 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:41:16,060 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:16,381 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:16,381 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:16,468 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:41:16,514 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:41:16,514 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:16,652 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:16,658 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:16,658 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:16,665 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:41:16,675 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:16,675 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:41:16,676 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:16,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:16,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:41:16,686 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:16,689 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:16,691 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:16,694 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:16,697 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:16,699 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:16,702 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:16,705 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:16,708 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:16,710 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:16,712 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:16,723 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:16,723 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:41:16,729 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:41:16,729 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:41:16,735 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:16,736 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:41:16,747 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:16,748 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:41:16,748 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:16,763 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:16,768 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:41:16,774 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:41:16,774 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:16,774 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:16,774 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:16,774 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:16,775 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:16,775 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:41:16,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:16,775 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:41:16,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:16,777 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:41:16,777 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:41:16,777 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:16,778 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:41:16,778 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:16,778 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:16,778 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:16,779 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:41:16,779 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:41:16,779 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:41:16,779 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:41:16,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:41:16,780 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:41:16,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:41:16,780 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:41:16,781 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:41:16,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:41:16,781 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:41:16,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:41:16,781 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:16,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:41:16,782 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:16,782 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:16,782 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:16,783 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:41:16,783 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:41:16,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:41:16,783 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:41:16,787 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:41:16,787 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:16,789 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:16,789 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:16,790 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 89/400.
2025-08-04 20:41:16,892 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:16,892 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:16,893 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:41:16,894 - ClientAppLogger [Client 6] - INFO - [Client] Round 89: Training GAN with 18 samples (14 normal, 4 anomalous).
2025-08-04 20:41:16,894 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:16,920 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0812, Avg D Loss: 0.8577
2025-08-04 20:41:16,920 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0812, Avg D Loss: 0.8577
2025-08-04 20:41:16,921 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:16,932 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4260, Threshold=0.4684, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:41:16,932 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:41:16,933 - ClientAppLogger [Client 6] - INFO - Fit completed for round 89. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 89, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.081234908103943, 'd_loss': 0.8577113389968872, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.14200115203857422, 'cpu_percent_fit': 12.275, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 18}
2025-08-04 20:41:16,933 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:41:22,223 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:22,223 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:22,223 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:22,223 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:41:22,223 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:41:22,223 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:22,703 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:22,703 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:22,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:41:22,846 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:41:22,846 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:22,972 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:22,982 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:22,982 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:22,991 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:41:23,004 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:23,004 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:41:23,005 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:23,005 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:23,005 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:41:23,016 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:23,019 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:23,022 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:23,024 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:23,028 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:23,030 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:23,033 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:23,036 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:23,040 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:23,042 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:23,045 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:23,057 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:23,057 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:41:23,063 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:41:23,065 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:41:23,075 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:23,078 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:41:23,095 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:23,095 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:41:23,096 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:23,114 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:23,121 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:41:23,127 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:41:23,127 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:23,127 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:23,128 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:23,128 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:23,129 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:23,130 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:41:23,130 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:23,130 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:41:23,130 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:23,132 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:41:23,132 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:41:23,133 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:23,133 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:41:23,133 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:23,133 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:23,133 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:23,134 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:41:23,134 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:41:23,134 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:41:23,134 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:41:23,134 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:41:23,134 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:41:23,134 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:41:23,135 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:41:23,135 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:41:23,135 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:41:23,135 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:41:23,135 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:41:23,135 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:23,136 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:41:23,136 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:23,136 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:23,136 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:23,136 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:41:23,137 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:41:23,137 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:41:23,137 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:41:23,140 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:41:23,140 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:23,141 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:23,141 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:23,143 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:23,143 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:23,143 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:23,144 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:23,154 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4133, Threshold=0.4425, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:41:23,154 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4133
2025-08-04 20:41:28,403 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:28,403 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:28,404 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:28,404 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:41:28,404 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:41:28,404 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:28,690 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:28,690 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:28,773 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:41:28,820 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:41:28,820 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:28,938 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:28,943 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:28,943 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:28,948 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:41:28,953 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:28,953 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:41:28,954 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:28,954 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:28,954 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:41:28,963 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:28,965 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:28,968 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:28,970 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:28,973 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:28,975 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:28,978 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:28,980 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:28,983 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:28,985 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:28,987 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:28,996 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:28,996 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:41:29,001 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:41:29,001 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:41:29,006 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:29,006 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:41:29,014 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:29,015 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:41:29,015 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:29,030 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:29,034 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:41:29,041 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:41:29,041 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:29,041 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:29,041 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:29,042 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:29,042 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:29,042 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:41:29,042 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:29,043 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:41:29,043 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:29,044 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:41:29,044 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:41:29,045 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:29,045 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:41:29,045 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:29,045 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:29,045 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:29,045 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:41:29,045 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:41:29,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:41:29,046 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:41:29,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:41:29,046 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:41:29,046 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:41:29,046 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:41:29,047 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:41:29,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:41:29,047 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:41:29,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:41:29,047 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:29,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:41:29,048 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:29,048 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:29,048 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:29,048 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:41:29,048 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:41:29,048 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:41:29,049 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:41:29,055 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:41:29,055 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:29,056 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:29,056 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:29,058 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 90/400.
2025-08-04 20:41:29,159 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:29,159 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:29,160 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:41:29,160 - ClientAppLogger [Client 6] - INFO - [Client] Round 90: Training GAN with 18 samples (14 normal, 4 anomalous).
2025-08-04 20:41:29,160 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:29,186 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0805, Avg D Loss: 0.8598
2025-08-04 20:41:29,186 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0805, Avg D Loss: 0.8598
2025-08-04 20:41:29,186 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:29,194 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4256, Threshold=0.4644, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:41:29,194 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:41:29,194 - ClientAppLogger [Client 6] - INFO - Fit completed for round 90. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 90, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.080487370491028, 'd_loss': 0.8597840428352356, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.1361851692199707, 'cpu_percent_fit': 12.45, 'ram_mb_fit': 0.31640625, 'accumulated_train_samples_this_round': 18}
2025-08-04 20:41:29,194 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:41:34,458 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:34,458 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:34,458 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:34,458 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:41:34,459 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:41:34,459 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:35,009 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:35,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:35,104 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:41:35,143 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:41:35,145 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:35,323 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:35,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:35,333 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:35,347 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:41:35,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:35,365 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:41:35,366 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:35,366 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:35,367 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:41:35,380 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:35,385 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:35,388 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:35,391 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:35,394 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:35,396 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:35,399 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:35,402 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:35,405 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:35,407 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:35,409 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:35,421 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:35,421 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:41:35,427 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:41:35,427 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:41:35,435 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:35,435 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:41:35,448 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:35,449 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:41:35,449 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:35,466 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:35,472 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:41:35,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:41:35,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:35,481 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:35,481 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:35,482 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:35,483 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:35,483 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:41:35,483 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:35,484 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:41:35,484 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:35,486 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:41:35,486 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:41:35,487 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:35,487 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:41:35,487 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:35,488 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:35,488 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:35,488 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:41:35,488 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:41:35,489 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:41:35,489 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:41:35,489 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:41:35,490 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:41:35,490 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:41:35,490 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:41:35,490 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:41:35,491 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:41:35,491 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:41:35,491 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:41:35,492 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:35,492 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:41:35,492 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:35,493 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:35,493 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:35,493 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:41:35,493 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:41:35,494 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:41:35,494 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:41:35,498 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:41:35,499 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:35,500 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:35,500 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:35,502 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:35,502 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:35,503 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:35,503 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:35,517 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4604, Threshold=0.5062, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:41:35,517 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4604
2025-08-04 20:41:40,782 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:40,782 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:40,782 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:40,782 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:41:40,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:41:40,783 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:41,083 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:41,083 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:41,164 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:41:41,206 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:41:41,207 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:41,326 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:41,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:41,332 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:41,337 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:41:41,342 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:41,342 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:41:41,342 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:41,343 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:41,343 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:41:41,352 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:41,355 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:41,358 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:41,360 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:41,363 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:41,365 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:41,368 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:41,370 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:41,373 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:41,375 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:41,377 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:41,386 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:41,387 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:41:41,392 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:41:41,392 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:41:41,397 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:41,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:41:41,407 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:41,407 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:41:41,408 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:41,424 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:41,429 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:41:41,434 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:41:41,434 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:41,434 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:41,434 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:41,435 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:41,435 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:41,435 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:41:41,435 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:41,435 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:41:41,436 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:41,437 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:41:41,437 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:41:41,437 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:41,437 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:41:41,438 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:41,438 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:41,438 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:41,438 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:41:41,438 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:41:41,438 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:41:41,438 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:41:41,438 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:41:41,438 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:41:41,439 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:41:41,439 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:41:41,439 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:41:41,439 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:41:41,439 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:41:41,439 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:41:41,439 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:41,439 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:41:41,440 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:41,440 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:41,440 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:41,440 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:41:41,440 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:41:41,440 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:41:41,441 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:41:41,444 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:41:41,444 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:41,445 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:41,445 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:41,446 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 91/400.
2025-08-04 20:41:41,547 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:41,547 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:41,549 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:41:41,549 - ClientAppLogger [Client 6] - INFO - [Client] Round 91: Training GAN with 19 samples (15 normal, 4 anomalous).
2025-08-04 20:41:41,549 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:41:41,574 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0792, Avg D Loss: 0.8403
2025-08-04 20:41:41,574 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0792, Avg D Loss: 0.8403
2025-08-04 20:41:41,574 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:41:41,582 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4350, Threshold=0.4803, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:41:41,582 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:41:41,583 - ClientAppLogger [Client 6] - INFO - Fit completed for round 91. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 91, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.079203248023987, 'd_loss': 0.8402622520923615, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.13623952865600586, 'cpu_percent_fit': 10.575, 'ram_mb_fit': 8.11328125, 'accumulated_train_samples_this_round': 19}
2025-08-04 20:41:41,583 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:41:49,846 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:41:49,846 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:41:49,846 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:41:49,846 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:41:49,847 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:41:49,847 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:41:50,241 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:41:50,241 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:41:50,342 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:41:50,389 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:41:50,389 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:41:50,517 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:41:50,525 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:41:50,525 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:41:50,532 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:41:50,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:41:50,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:41:50,549 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:41:50,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:41:50,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:41:50,560 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:41:50,563 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:50,566 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:41:50,568 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:41:50,570 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:41:50,573 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:41:50,576 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:41:50,579 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:41:50,583 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:41:50,586 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:41:50,589 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:41:50,601 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:41:50,603 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:41:50,609 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:41:50,609 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:41:50,616 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:41:50,616 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:41:50,631 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:41:50,633 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:41:50,633 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:41:50,651 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:41:50,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:41:50,665 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:41:50,665 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:41:50,665 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:41:50,665 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:41:50,665 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:41:50,666 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:41:50,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:41:50,666 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:41:50,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:41:50,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:41:50,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:41:50,671 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:41:50,672 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:41:50,675 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:41:50,675 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:41:50,675 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:41:50,675 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:41:50,676 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:41:50,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:41:50,676 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:41:50,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:41:50,676 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:41:50,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:41:50,677 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:41:50,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:41:50,677 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:41:50,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:41:50,677 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:41:50,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:41:50,677 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:41:50,678 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:41:50,678 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:41:50,681 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:41:50,681 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:41:50,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:41:50,682 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:41:50,682 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:41:50,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:41:50,690 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:41:50,690 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:41:50,696 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:41:50,696 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:41:50,698 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:41:50,698 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:41:50,698 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:41:50,699 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:41:50,708 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4512, Threshold=0.5008, Accuracy=0.6667, F1=0.7712, Precision=0.9365, Recall=0.6556
2025-08-04 20:41:50,708 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6667, F1: 0.7712, Prec: 0.9365, Rec: 0.6556, Avg Anomaly Score: 0.4512
2025-08-04 20:42:04,991 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:04,991 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:42:04,992 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:42:04,992 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:42:04,992 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:42:04,992 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:05,412 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:05,412 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:05,509 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:42:05,558 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:42:05,559 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:05,694 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:05,701 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:05,701 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:05,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:42:05,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:05,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:42:05,720 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:05,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:05,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:42:05,730 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:05,733 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:05,735 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:05,737 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:05,740 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:05,743 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:05,746 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:05,750 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:05,753 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:05,754 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:05,757 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:05,769 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:05,769 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:42:05,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:42:05,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:42:05,780 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:05,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:42:05,792 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:05,792 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:42:05,792 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:05,809 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:05,814 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:42:05,819 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:42:05,819 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:05,819 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:05,819 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:05,820 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:05,820 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:05,820 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:42:05,820 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:05,820 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:42:05,821 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:05,822 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:42:05,822 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:42:05,822 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:05,823 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:42:05,823 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:05,823 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:05,823 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:05,823 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:42:05,823 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:42:05,823 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:42:05,824 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:42:05,824 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:42:05,824 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:42:05,824 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:42:05,824 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:42:05,824 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:42:05,824 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:42:05,825 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:42:05,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:42:05,825 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:05,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:42:05,825 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:05,826 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:05,826 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:05,826 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:42:05,826 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:42:05,826 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:42:05,826 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:42:05,833 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:42:05,833 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:05,835 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:05,835 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:42:05,836 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:05,836 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:05,836 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:05,837 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:05,847 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4120, Threshold=0.4518, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:42:05,848 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4120
2025-08-04 20:42:23,145 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:23,145 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:42:23,145 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:42:23,146 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:42:23,146 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:42:23,146 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:23,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:23,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:23,534 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:42:23,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:42:23,581 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:23,702 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:23,710 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:23,710 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:23,716 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:42:23,723 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:23,723 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:42:23,723 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:23,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:23,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:42:23,733 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:23,736 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:23,738 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:23,740 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:23,743 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:23,746 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:23,748 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:23,751 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:23,754 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:23,756 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:23,758 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:23,769 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:23,769 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:42:23,774 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:42:23,774 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:42:23,779 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:23,779 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:42:23,789 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:23,789 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:42:23,789 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:23,806 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:23,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:42:23,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:42:23,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:23,817 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:23,817 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:23,818 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:23,818 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:23,818 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:42:23,818 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:23,818 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:42:23,819 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:23,820 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:42:23,820 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:42:23,821 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:23,821 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:42:23,821 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:23,821 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:23,821 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:23,821 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:42:23,822 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:42:23,822 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:42:23,822 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:42:23,822 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:42:23,822 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:42:23,822 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:42:23,822 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:42:23,823 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:42:23,823 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:42:23,823 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:42:23,823 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:42:23,823 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:23,823 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:42:23,824 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:23,824 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:23,824 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:23,824 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:42:23,824 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:42:23,824 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:42:23,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:42:23,828 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:42:23,828 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:23,829 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:23,830 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:42:23,831 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:23,831 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:23,832 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:23,832 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:23,840 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4292, Threshold=0.4628, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:42:23,840 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4292
2025-08-04 20:42:38,135 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:38,135 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:42:38,135 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:42:38,136 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:42:38,136 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:42:38,136 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:38,585 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:38,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:38,679 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:42:38,734 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:42:38,734 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:38,900 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:38,906 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:38,906 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:38,912 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:42:38,920 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:38,920 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:42:38,921 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:38,921 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:38,921 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:42:38,931 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:38,934 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:38,936 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:38,939 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:38,942 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:38,944 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:38,948 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:38,951 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:38,954 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:38,956 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:38,960 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:38,971 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:38,971 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:42:38,976 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:42:38,976 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:42:38,981 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:38,982 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:42:38,993 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:38,994 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:42:38,994 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:39,010 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:39,015 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:42:39,022 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:42:39,022 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:39,022 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:39,022 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:39,023 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:39,023 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:39,023 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:42:39,023 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:39,023 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:42:39,023 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:39,025 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:42:39,025 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:42:39,025 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:39,025 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:42:39,025 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:39,026 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:39,026 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:39,026 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:42:39,026 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:42:39,026 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:42:39,026 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:42:39,026 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:42:39,027 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:42:39,027 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:42:39,027 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:42:39,027 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:42:39,027 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:42:39,027 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:42:39,027 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:42:39,028 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:39,028 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:42:39,028 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:39,028 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:39,029 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:39,029 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:42:39,029 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:42:39,029 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:42:39,029 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:42:39,036 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:42:39,037 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:39,038 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:39,038 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:42:39,039 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:39,039 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:39,040 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:39,040 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:39,048 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4040, Threshold=0.4320, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:42:39,049 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4040
2025-08-04 20:42:56,330 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:42:56,330 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:42:56,330 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:42:56,330 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:42:56,331 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:42:56,331 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:42:56,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:42:56,665 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:42:56,754 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:42:56,803 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:42:56,803 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:42:56,975 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:42:56,984 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:42:56,984 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:42:56,991 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:42:56,998 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:42:56,998 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:42:56,999 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:42:56,999 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:42:56,999 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:42:57,010 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:42:57,014 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:57,017 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:42:57,020 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:42:57,025 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:42:57,027 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:42:57,031 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:42:57,033 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:42:57,037 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:42:57,038 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:42:57,041 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:42:57,052 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:42:57,052 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:42:57,057 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:42:57,057 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:42:57,063 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:42:57,063 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:42:57,074 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:42:57,075 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:42:57,075 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:42:57,095 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:42:57,101 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:42:57,111 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:42:57,111 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:42:57,111 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:42:57,111 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:42:57,111 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:42:57,112 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:42:57,112 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:42:57,112 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:42:57,112 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:42:57,112 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:42:57,114 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:42:57,114 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:42:57,115 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:42:57,115 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:42:57,115 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:42:57,115 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:42:57,116 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:42:57,116 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:42:57,116 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:42:57,116 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:42:57,116 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:42:57,116 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:42:57,117 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:42:57,117 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:42:57,117 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:42:57,117 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:42:57,117 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:42:57,117 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:42:57,118 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:42:57,118 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:42:57,118 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:42:57,118 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:42:57,119 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:42:57,119 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:42:57,119 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:42:57,119 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:42:57,120 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:42:57,120 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:42:57,130 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:42:57,130 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:42:57,131 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:42:57,131 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:42:57,133 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:42:57,133 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:42:57,133 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:42:57,134 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:42:57,142 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4231, Threshold=0.4430, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:42:57,142 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4231
2025-08-04 20:43:02,388 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:02,389 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:02,389 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:02,389 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:43:02,389 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:43:02,389 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:02,657 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:02,657 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:02,741 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:43:02,778 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:43:02,779 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:02,901 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:02,909 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:02,909 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:02,913 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:43:02,919 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:02,920 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:43:02,920 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:02,920 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:02,920 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:43:02,929 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:02,932 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:02,935 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:02,937 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:02,940 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:02,942 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:02,945 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:02,947 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:02,950 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:02,952 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:02,954 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:02,963 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:02,963 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:43:02,968 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:43:02,968 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:43:02,973 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:02,973 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:43:02,982 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:02,982 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:43:02,982 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:02,998 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:03,003 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:43:03,009 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:43:03,009 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:03,009 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:03,009 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:03,010 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:03,010 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:03,010 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:43:03,011 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:03,011 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:43:03,011 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:03,012 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:43:03,012 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:43:03,013 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:03,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:43:03,013 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:03,013 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:03,013 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:03,013 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:43:03,014 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:43:03,014 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:43:03,014 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:43:03,014 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:43:03,014 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:43:03,014 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:43:03,014 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:43:03,014 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:43:03,015 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:43:03,015 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:43:03,015 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:43:03,015 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:03,015 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:43:03,015 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:03,016 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:03,016 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:03,016 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:43:03,016 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:43:03,016 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:43:03,016 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:43:03,024 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:43:03,024 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:03,025 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:03,026 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:03,027 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 96/400.
2025-08-04 20:43:03,129 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:03,129 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:03,131 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:43:03,135 - ClientAppLogger [Client 6] - INFO - [Client] Round 96: Training GAN with 19 samples (15 normal, 4 anomalous).
2025-08-04 20:43:03,135 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:03,166 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0806, Avg D Loss: 0.8522
2025-08-04 20:43:03,166 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0806, Avg D Loss: 0.8522
2025-08-04 20:43:03,166 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:03,174 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4298, Threshold=0.4608, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:43:03,174 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:43:03,175 - ClientAppLogger [Client 6] - INFO - Fit completed for round 96. Duration: 0.15s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 96, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0805970191955567, 'd_loss': 0.8521858215332031, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.14760351181030273, 'cpu_percent_fit': 9.48125, 'ram_mb_fit': 6.30859375, 'accumulated_train_samples_this_round': 19}
2025-08-04 20:43:03,175 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:43:08,442 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:08,442 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:08,443 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:08,443 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:43:08,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:43:08,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:08,833 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:08,834 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:08,922 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:43:08,963 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:43:08,963 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:09,136 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:09,144 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:09,145 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:09,153 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:43:09,162 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:09,162 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:43:09,163 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:09,163 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:09,163 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:43:09,173 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:09,176 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:09,179 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:09,181 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:09,186 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:09,189 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:09,192 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:09,195 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:09,199 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:09,201 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:09,203 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:09,216 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:09,216 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:43:09,223 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:43:09,223 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:43:09,230 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:09,230 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:43:09,243 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:09,243 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:43:09,243 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:09,261 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:09,266 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:43:09,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:43:09,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:09,277 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:09,277 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:09,278 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:09,278 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:09,278 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:43:09,279 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:09,279 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:43:09,279 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:09,281 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:43:09,281 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:43:09,281 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:09,282 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:43:09,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:09,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:09,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:09,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:43:09,282 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:43:09,283 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:43:09,283 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:43:09,283 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:43:09,283 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:43:09,283 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:43:09,283 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:43:09,284 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:43:09,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:43:09,284 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:43:09,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:43:09,284 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:09,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:43:09,285 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:09,285 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:09,285 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:09,285 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:43:09,286 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:43:09,286 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:43:09,286 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:43:09,293 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:43:09,294 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:09,295 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:09,295 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:09,296 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:09,297 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:09,297 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:09,297 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:09,306 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4591, Threshold=0.4857, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:43:09,306 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4591
2025-08-04 20:43:14,567 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:14,567 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:14,567 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:14,567 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:43:14,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:43:14,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:14,863 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:14,863 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:14,948 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:43:14,992 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:43:14,993 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:15,128 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:15,135 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:15,135 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:15,141 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:43:15,148 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:15,148 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:43:15,150 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:15,150 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:15,150 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:43:15,161 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:15,163 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:15,166 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:15,168 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:15,170 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:15,172 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:15,175 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:15,177 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:15,180 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:15,182 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:15,184 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:15,194 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:15,194 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:43:15,199 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:43:15,199 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:43:15,204 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:15,204 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:43:15,214 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:15,214 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:43:15,214 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:15,230 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:15,235 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:43:15,240 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:43:15,241 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:15,241 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:15,241 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:15,241 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:15,241 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:15,242 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:43:15,242 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:15,242 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:43:15,242 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:15,244 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:43:15,244 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:43:15,244 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:15,245 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:43:15,245 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:15,245 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:15,245 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:15,245 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:43:15,245 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:43:15,245 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:43:15,246 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:43:15,246 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:43:15,246 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:43:15,246 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:43:15,246 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:43:15,246 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:43:15,247 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:43:15,247 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:43:15,247 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:43:15,247 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:15,247 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:43:15,248 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:15,248 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:15,248 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:15,248 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:43:15,248 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:43:15,249 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:43:15,249 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:43:15,253 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:43:15,253 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:15,254 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:15,254 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:15,256 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 97/400.
2025-08-04 20:43:15,357 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:15,357 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:15,359 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:43:15,363 - ClientAppLogger [Client 6] - INFO - [Client] Round 97: Training GAN with 19 samples (15 normal, 4 anomalous).
2025-08-04 20:43:15,363 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:15,389 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0840, Avg D Loss: 0.8574
2025-08-04 20:43:15,389 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0840, Avg D Loss: 0.8574
2025-08-04 20:43:15,389 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:15,397 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4475, Threshold=0.4805, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:43:15,397 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:43:15,398 - ClientAppLogger [Client 6] - INFO - Fit completed for round 97. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 97, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.084015440940857, 'd_loss': 0.8574243247509002, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.14182066917419434, 'cpu_percent_fit': 10.64375, 'ram_mb_fit': 0.12890625, 'accumulated_train_samples_this_round': 19}
2025-08-04 20:43:15,398 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:43:23,659 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:23,659 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:23,659 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:23,659 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:43:23,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:43:23,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:23,950 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:23,950 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:24,031 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:43:24,058 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:43:24,058 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:24,206 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:24,213 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:24,213 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:24,218 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:43:24,226 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:24,226 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:43:24,227 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:24,227 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:24,227 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:43:24,236 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:24,240 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:24,243 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:24,245 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:24,247 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:24,249 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:24,252 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:24,255 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:24,257 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:24,260 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:24,262 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:24,272 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:24,272 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:43:24,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:43:24,278 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:43:24,283 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:24,283 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:43:24,296 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:24,297 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:43:24,297 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:24,314 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:24,320 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:43:24,329 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:43:24,329 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:24,329 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:24,329 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:24,329 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:24,330 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:24,330 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:43:24,330 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:24,331 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:43:24,331 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:24,332 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:43:24,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:43:24,333 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:24,333 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:43:24,333 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:24,333 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:24,333 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:24,334 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:43:24,334 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:43:24,334 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:43:24,334 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:43:24,334 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:43:24,335 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:43:24,335 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:43:24,335 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:43:24,335 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:43:24,335 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:43:24,335 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:43:24,335 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:43:24,335 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:24,336 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:43:24,336 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:24,336 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:24,336 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:24,336 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:43:24,337 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:43:24,337 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:43:24,337 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:43:24,341 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:43:24,341 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:24,342 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:24,342 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:24,344 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:24,344 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:24,344 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:24,345 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:24,352 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4291, Threshold=0.4505, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:43:24,353 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4291
2025-08-04 20:43:29,615 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:29,615 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:29,616 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:29,616 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:43:29,616 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:43:29,616 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:29,934 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:29,934 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:30,017 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:43:30,032 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:43:30,032 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:30,137 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:30,144 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:30,144 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:30,150 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:43:30,156 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:30,156 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:43:30,156 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:30,156 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:30,157 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:43:30,166 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:30,169 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:30,171 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:30,173 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:30,176 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:30,178 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:30,181 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:30,184 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:30,187 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:30,192 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:30,195 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:30,207 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:30,207 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:43:30,212 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:43:30,212 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:43:30,217 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:30,220 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:43:30,229 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:30,229 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:43:30,229 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:30,249 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:30,254 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:43:30,260 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:43:30,260 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:30,261 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:30,261 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:30,261 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:30,261 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:30,261 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:43:30,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:30,262 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:43:30,262 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:30,264 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:43:30,264 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:43:30,264 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:30,264 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:43:30,264 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:30,264 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:30,264 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:30,265 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:43:30,265 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:43:30,265 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:43:30,265 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:43:30,265 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:43:30,265 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:43:30,266 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:43:30,266 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:43:30,266 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:43:30,266 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:43:30,266 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:43:30,266 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:43:30,267 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:30,267 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:43:30,267 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:30,267 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:30,267 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:30,268 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:43:30,268 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:43:30,268 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:43:30,268 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:43:30,272 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:43:30,272 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:30,273 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:30,273 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:30,275 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 98/400.
2025-08-04 20:43:30,376 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:30,379 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:30,380 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:43:30,380 - ClientAppLogger [Client 6] - INFO - [Client] Round 98: Training GAN with 19 samples (15 normal, 4 anomalous).
2025-08-04 20:43:30,380 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:30,404 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0805, Avg D Loss: 0.8317
2025-08-04 20:43:30,404 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0805, Avg D Loss: 0.8317
2025-08-04 20:43:30,405 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:30,412 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4338, Threshold=0.4668, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:43:30,412 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:43:30,412 - ClientAppLogger [Client 6] - INFO - Fit completed for round 98. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 98, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.080534648895264, 'd_loss': 0.8316811800003052, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.13750147819519043, 'cpu_percent_fit': 11.95, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 19}
2025-08-04 20:43:30,412 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:43:41,677 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:41,677 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:41,678 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:41,678 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:43:41,678 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:43:41,678 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:41,966 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:41,966 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:42,057 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:43:42,103 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:43:42,104 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:42,236 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:42,247 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:42,248 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:42,255 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:43:42,263 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:42,263 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:43:42,264 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:42,264 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:42,264 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:43:42,274 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:42,277 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:42,279 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:42,281 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:42,284 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:42,286 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:42,289 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:42,291 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:42,295 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:42,297 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:42,299 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:42,311 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:42,311 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:43:42,317 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:43:42,317 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:43:42,322 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:42,322 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:43:42,335 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:42,336 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:43:42,336 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:42,356 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:42,363 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:43:42,370 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:43:42,370 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:42,371 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:42,371 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:42,371 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:42,371 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:42,372 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:43:42,372 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:42,372 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:43:42,372 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:42,374 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:43:42,374 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:43:42,375 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:42,375 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:43:42,375 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:42,375 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:42,375 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:42,375 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:43:42,375 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:43:42,376 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:43:42,376 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:43:42,376 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:43:42,376 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:43:42,376 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:43:42,377 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:43:42,377 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:43:42,377 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:43:42,377 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:43:42,377 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:43:42,378 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:42,378 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:43:42,378 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:42,378 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:42,379 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:42,379 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:43:42,379 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:43:42,379 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:43:42,380 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:43:42,384 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:43:42,384 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:42,386 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:42,386 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:42,387 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:42,388 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:42,388 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:42,389 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:42,398 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4667, Threshold=0.4862, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:43:42,398 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4667
2025-08-04 20:43:47,674 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:47,675 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:47,675 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:47,675 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:43:47,675 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:43:47,675 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:47,935 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:47,935 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:48,020 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:43:48,063 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:43:48,063 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:48,183 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:48,188 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:48,189 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:48,194 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:43:48,201 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:48,201 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:43:48,202 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:48,202 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:48,202 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:43:48,211 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:48,214 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:48,217 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:48,219 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:48,222 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:48,224 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:48,227 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:48,229 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:48,232 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:48,234 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:48,236 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:48,247 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:48,248 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:43:48,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:43:48,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:43:48,258 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:48,259 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:43:48,269 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:48,269 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:43:48,269 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:48,285 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:48,290 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:43:48,298 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:43:48,298 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:48,299 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:48,299 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:48,299 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:48,300 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:48,300 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:43:48,300 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:48,300 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:43:48,300 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:48,302 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:43:48,302 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:43:48,303 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:48,303 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:43:48,303 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:48,303 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:48,303 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:48,303 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:43:48,303 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:43:48,304 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:43:48,304 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:43:48,304 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:43:48,304 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:43:48,304 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:43:48,304 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:43:48,304 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:43:48,305 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:43:48,305 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:43:48,305 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:43:48,305 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:48,305 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:43:48,306 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:48,306 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:48,306 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:48,306 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:43:48,306 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:43:48,307 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:43:48,307 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:43:48,315 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:43:48,316 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:48,317 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:48,318 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:48,319 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 99/400.
2025-08-04 20:43:48,421 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:48,421 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:48,423 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:43:48,423 - ClientAppLogger [Client 6] - INFO - [Client] Round 99: Training GAN with 19 samples (15 normal, 4 anomalous).
2025-08-04 20:43:48,423 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:43:48,451 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0668, Avg D Loss: 0.8231
2025-08-04 20:43:48,452 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0668, Avg D Loss: 0.8231
2025-08-04 20:43:48,452 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:43:48,460 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4382, Threshold=0.4624, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:43:48,460 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:43:48,460 - ClientAppLogger [Client 6] - INFO - Fit completed for round 99. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 99, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0667516469955443, 'd_loss': 0.8231049180030823, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.14111709594726562, 'cpu_percent_fit': 10.9875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 19}
2025-08-04 20:43:48,461 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:43:56,723 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:43:56,723 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:43:56,723 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:43:56,723 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:43:56,723 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:43:56,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:43:56,979 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:43:56,979 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:43:57,062 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:43:57,085 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:43:57,085 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:43:57,187 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:43:57,196 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:43:57,196 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:43:57,203 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:43:57,211 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:43:57,212 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:43:57,212 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:43:57,212 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:43:57,212 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:43:57,221 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:43:57,224 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:57,226 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:43:57,229 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:43:57,231 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:43:57,234 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:43:57,236 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:43:57,239 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:43:57,242 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:43:57,244 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:43:57,246 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:43:57,256 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:43:57,256 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:43:57,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:43:57,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:43:57,266 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:43:57,266 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:43:57,276 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:43:57,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:43:57,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:43:57,294 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:43:57,300 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:43:57,308 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:43:57,308 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:43:57,308 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:43:57,308 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:43:57,309 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:43:57,309 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:43:57,309 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:43:57,309 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:43:57,309 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:43:57,310 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:43:57,311 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:43:57,312 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:43:57,312 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:43:57,312 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:43:57,313 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:43:57,313 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:43:57,313 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:43:57,313 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:43:57,313 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:43:57,314 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:43:57,314 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:43:57,314 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:43:57,314 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:43:57,314 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:43:57,314 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:43:57,315 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:43:57,315 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:43:57,315 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:43:57,315 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:43:57,316 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:43:57,316 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:43:57,316 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:43:57,317 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:43:57,317 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:43:57,317 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:43:57,317 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:43:57,317 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:43:57,317 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:43:57,321 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:43:57,321 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:43:57,323 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:43:57,323 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:43:57,325 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:43:57,325 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:43:57,325 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:43:57,326 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:43:57,335 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3997, Threshold=0.4054, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:43:57,335 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.3997
2025-08-04 20:44:11,641 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:11,641 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:44:11,641 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:44:11,641 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:44:11,641 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:44:11,641 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:12,141 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:12,141 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:12,246 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:44:12,294 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:44:12,294 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:12,424 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:12,430 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:12,430 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:12,436 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:44:12,442 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:12,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:44:12,443 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:12,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:12,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:44:12,453 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:12,456 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:12,459 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:12,461 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:12,466 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:12,468 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:12,471 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:12,474 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:12,477 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:12,479 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:12,482 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:12,491 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:12,492 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:44:12,497 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:44:12,497 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:44:12,502 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:12,502 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:44:12,513 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:12,513 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:44:12,513 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:12,531 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:12,535 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:44:12,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:44:12,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:12,542 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:12,542 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:12,543 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:12,543 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:12,543 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:44:12,543 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:12,544 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:44:12,544 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:12,545 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:44:12,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:44:12,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:12,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:44:12,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:12,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:12,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:12,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:44:12,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:44:12,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:44:12,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:44:12,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:44:12,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:44:12,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:44:12,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:44:12,548 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:44:12,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:44:12,548 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:44:12,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:44:12,548 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:12,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:44:12,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:12,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:12,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:12,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:44:12,550 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:44:12,550 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:44:12,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:44:12,557 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:44:12,557 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:12,558 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:12,558 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:12,560 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:12,560 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:12,560 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:12,561 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:12,569 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4235, Threshold=0.4319, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:44:12,569 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4235
2025-08-04 20:44:32,862 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:32,862 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:44:32,862 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:44:32,862 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:44:32,862 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:44:32,862 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:33,241 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:33,241 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:33,329 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:44:33,357 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:44:33,357 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:33,461 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:33,467 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:33,467 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:33,471 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:44:33,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:33,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:44:33,479 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:33,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:33,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:44:33,488 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:33,491 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:33,493 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:33,495 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:33,498 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:33,500 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:33,502 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:33,505 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:33,507 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:33,509 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:33,512 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:33,521 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:33,521 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:44:33,526 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:44:33,527 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:44:33,531 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:33,531 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:44:33,542 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:33,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:44:33,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:33,559 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:33,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:44:33,571 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:44:33,571 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:33,571 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:33,572 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:33,572 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:33,572 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:33,572 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:44:33,572 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:33,573 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:44:33,573 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:33,574 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:44:33,574 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:44:33,575 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:33,575 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:44:33,575 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:33,575 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:33,575 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:33,575 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:44:33,575 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:44:33,576 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:44:33,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:44:33,576 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:44:33,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:44:33,576 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:44:33,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:44:33,576 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:44:33,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:44:33,577 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:44:33,577 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:44:33,577 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:33,577 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:44:33,577 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:33,578 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:33,578 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:33,578 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:44:33,578 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:44:33,578 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:44:33,578 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:44:33,581 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:44:33,581 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:33,582 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:33,582 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:33,583 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:33,583 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:33,583 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:33,584 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:33,591 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4345, Threshold=0.4392, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:44:33,591 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4345
2025-08-04 20:44:38,850 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:38,850 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:44:38,850 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:44:38,850 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:44:38,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:44:38,851 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:39,121 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:39,121 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:39,203 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:44:39,244 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:44:39,244 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:39,354 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:39,360 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:39,360 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:39,365 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:44:39,371 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:39,371 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:44:39,372 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:39,372 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:39,372 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:44:39,380 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:39,383 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:39,385 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:39,387 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:39,389 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:39,392 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:39,395 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:39,397 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:39,400 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:39,402 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:39,405 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:39,414 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:39,414 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:44:39,419 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:44:39,419 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:44:39,424 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:39,424 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:44:39,434 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:39,435 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:44:39,435 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:39,450 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:39,455 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:44:39,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:44:39,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:39,460 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:39,460 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:39,461 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:39,461 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:39,461 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:44:39,461 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:39,462 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:44:39,462 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:39,463 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:44:39,463 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:44:39,464 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:39,464 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:44:39,464 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:39,464 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:39,464 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:39,465 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:44:39,465 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:44:39,465 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:44:39,465 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:44:39,465 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:44:39,465 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:44:39,465 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:44:39,466 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:44:39,466 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:44:39,466 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:44:39,466 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:44:39,466 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:44:39,466 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:39,466 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:44:39,467 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:39,467 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:39,467 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:39,467 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:44:39,467 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:44:39,468 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:44:39,468 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:44:39,475 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:44:39,475 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:39,477 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:39,477 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:39,479 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 102/400.
2025-08-04 20:44:39,580 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:39,580 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:39,581 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:44:39,581 - ClientAppLogger [Client 6] - INFO - [Client] Round 102: Training GAN with 20 samples (16 normal, 4 anomalous).
2025-08-04 20:44:39,582 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:44:39,607 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0704, Avg D Loss: 0.8087
2025-08-04 20:44:39,607 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0704, Avg D Loss: 0.8087
2025-08-04 20:44:39,607 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:44:39,615 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4351, Threshold=0.4546, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:44:39,615 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:44:39,615 - ClientAppLogger [Client 6] - INFO - Fit completed for round 102. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 102, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.070385527610779, 'd_loss': 0.808709192276001, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13636136054992676, 'cpu_percent_fit': 12.43125, 'ram_mb_fit': 0.125, 'accumulated_train_samples_this_round': 20}
2025-08-04 20:44:39,615 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:44:50,900 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:50,900 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:44:50,901 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:44:50,901 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:44:50,901 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:44:50,901 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:51,386 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:51,387 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:51,475 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:44:51,523 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:44:51,523 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:51,706 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:51,714 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:51,714 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:51,721 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:44:51,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:51,740 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:44:51,740 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:51,740 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:51,741 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:44:51,753 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:51,757 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:51,760 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:51,764 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:51,768 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:51,771 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:51,774 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:51,776 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:51,779 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:51,782 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:51,785 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:51,795 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:51,795 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:44:51,800 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:44:51,800 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:44:51,806 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:51,806 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:44:51,816 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:51,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:44:51,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:51,833 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:51,837 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:44:51,842 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:44:51,842 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:51,842 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:51,842 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:51,843 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:51,843 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:51,843 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:44:51,843 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:51,843 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:44:51,844 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:51,845 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:44:51,845 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:44:51,845 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:51,845 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:44:51,846 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:51,846 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:51,846 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:51,846 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:44:51,846 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:44:51,846 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:44:51,846 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:44:51,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:44:51,847 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:44:51,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:44:51,847 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:44:51,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:44:51,847 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:44:51,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:44:51,847 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:44:51,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:51,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:44:51,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:51,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:51,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:51,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:44:51,849 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:44:51,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:44:51,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:44:51,859 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:44:51,859 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:51,860 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:51,861 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:51,863 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:44:51,863 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:51,863 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:51,863 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:44:51,871 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4566, Threshold=0.4665, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:44:51,871 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4566
2025-08-04 20:44:57,115 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:44:57,116 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:44:57,116 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:44:57,116 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:44:57,116 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:44:57,116 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:44:57,373 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:44:57,374 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:44:57,455 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:44:57,468 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:44:57,468 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:44:57,563 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:44:57,570 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:44:57,570 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:44:57,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:44:57,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:44:57,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:44:57,599 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:44:57,599 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:44:57,599 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:44:57,608 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:44:57,611 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:57,613 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:44:57,615 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:44:57,617 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:44:57,620 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:44:57,622 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:44:57,625 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:44:57,628 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:44:57,629 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:44:57,632 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:44:57,642 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:44:57,642 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:44:57,647 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:44:57,647 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:44:57,652 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:44:57,652 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:44:57,661 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:44:57,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:44:57,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:44:57,677 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:44:57,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:44:57,686 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:44:57,686 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:44:57,686 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:44:57,686 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:44:57,686 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:44:57,687 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:44:57,687 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:44:57,687 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:44:57,687 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:44:57,687 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:44:57,689 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:44:57,689 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:44:57,689 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:44:57,689 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:44:57,689 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:44:57,689 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:44:57,690 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:44:57,690 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:44:57,690 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:44:57,690 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:44:57,690 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:44:57,690 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:44:57,691 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:44:57,691 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:44:57,691 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:44:57,691 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:44:57,691 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:44:57,691 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:44:57,691 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:44:57,691 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:44:57,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:44:57,692 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:44:57,692 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:44:57,692 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:44:57,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:44:57,692 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:44:57,693 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:44:57,693 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:44:57,697 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:44:57,697 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:44:57,698 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:44:57,698 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:44:57,699 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 103/400.
2025-08-04 20:44:57,800 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:44:57,800 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:44:57,801 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:44:57,802 - ClientAppLogger [Client 6] - INFO - [Client] Round 103: Training GAN with 20 samples (16 normal, 4 anomalous).
2025-08-04 20:44:57,802 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:44:57,827 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0700, Avg D Loss: 0.8055
2025-08-04 20:44:57,827 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0700, Avg D Loss: 0.8055
2025-08-04 20:44:57,828 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:44:57,836 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4451, Threshold=0.4661, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:44:57,838 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:44:57,839 - ClientAppLogger [Client 6] - INFO - Fit completed for round 103. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 103, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.069959807395935, 'd_loss': 0.8055247843265534, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13920021057128906, 'cpu_percent_fit': 11.31875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 20}
2025-08-04 20:44:57,839 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:45:12,140 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:12,141 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:12,141 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:12,141 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:45:12,141 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:45:12,141 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:12,500 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:12,501 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:12,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:45:12,645 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:45:12,645 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:12,777 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:12,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:12,783 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:12,787 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:45:12,792 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:12,792 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:45:12,793 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:12,793 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:12,793 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:45:12,802 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:12,805 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:12,807 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:12,810 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:12,813 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:12,815 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:12,817 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:12,820 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:12,822 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:12,824 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:12,826 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:12,835 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:12,835 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:45:12,839 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:45:12,839 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:45:12,844 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:12,844 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:45:12,852 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:12,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:45:12,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:12,867 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:12,872 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:45:12,877 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:45:12,877 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:12,877 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:12,877 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:12,878 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:12,878 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:12,878 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:45:12,878 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:12,878 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:45:12,878 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:12,880 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:45:12,880 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:45:12,880 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:12,880 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:45:12,880 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:12,881 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:12,881 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:12,881 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:45:12,881 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:45:12,881 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:45:12,881 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:45:12,881 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:45:12,881 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:45:12,882 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:45:12,882 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:45:12,882 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:45:12,882 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:45:12,882 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:45:12,882 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:45:12,882 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:12,882 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:45:12,883 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:12,883 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:12,883 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:12,883 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:45:12,883 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:45:12,883 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:45:12,883 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:45:12,887 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:45:12,888 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:12,889 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:12,889 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:12,890 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:12,890 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:12,891 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:12,891 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:12,898 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4739, Threshold=0.4917, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:45:12,899 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.4739
2025-08-04 20:45:18,145 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:18,145 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:18,145 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:18,145 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:45:18,145 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:45:18,146 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:18,440 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:18,440 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:18,522 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:45:18,566 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:45:18,566 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:18,689 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:18,695 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:18,695 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:18,700 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:45:18,708 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:18,708 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:45:18,708 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:18,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:18,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:45:18,717 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:18,720 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:18,722 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:18,724 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:18,726 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:18,729 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:18,731 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:18,733 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:18,736 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:18,738 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:18,740 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:18,749 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:18,750 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:45:18,754 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:45:18,754 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:45:18,760 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:18,760 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:45:18,773 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:18,774 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:45:18,774 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:18,790 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:18,794 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:45:18,800 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:45:18,800 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:18,800 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:18,800 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:18,801 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:18,801 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:18,801 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:45:18,801 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:18,802 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:45:18,802 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:18,803 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:45:18,803 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:45:18,804 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:18,804 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:45:18,804 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:18,804 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:18,804 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:18,804 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:45:18,805 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:45:18,805 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:45:18,805 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:45:18,805 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:45:18,805 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:45:18,805 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:45:18,805 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:45:18,806 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:45:18,806 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:45:18,806 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:45:18,806 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:45:18,806 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:18,806 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:45:18,806 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:18,807 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:18,807 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:18,807 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:45:18,807 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:45:18,807 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:45:18,807 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:45:18,811 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:45:18,812 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:18,813 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:18,813 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:18,814 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 104/400.
2025-08-04 20:45:18,915 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:18,915 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:18,917 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:45:18,917 - ClientAppLogger [Client 6] - INFO - [Client] Round 104: Training GAN with 20 samples (16 normal, 4 anomalous).
2025-08-04 20:45:18,917 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:18,944 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0687, Avg D Loss: 0.8026
2025-08-04 20:45:18,944 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0687, Avg D Loss: 0.8026
2025-08-04 20:45:18,944 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:18,952 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4509, Threshold=0.4690, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:45:18,952 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:45:18,953 - ClientAppLogger [Client 6] - INFO - Fit completed for round 104. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 104, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0686886072158814, 'd_loss': 0.8025517106056214, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13794827461242676, 'cpu_percent_fit': 11.65625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 20}
2025-08-04 20:45:18,953 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:45:30,216 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:30,216 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:30,216 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:30,216 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:45:30,216 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:45:30,216 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:30,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:30,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:30,562 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:45:30,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:45:30,587 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:30,687 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:30,693 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:30,694 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:30,699 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:45:30,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:30,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:45:30,710 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:30,710 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:30,710 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:45:30,719 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:30,722 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:30,724 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:30,727 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:30,729 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:30,732 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:30,734 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:30,736 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:30,739 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:30,741 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:30,744 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:30,753 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:30,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:45:30,758 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:45:30,758 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:45:30,765 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:30,765 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:45:30,777 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:30,777 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:45:30,778 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:30,795 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:30,801 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:45:30,807 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:45:30,807 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:30,807 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:30,807 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:30,808 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:30,808 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:30,808 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:45:30,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:30,809 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:45:30,809 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:30,810 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:45:30,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:45:30,811 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:30,811 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:45:30,811 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:30,811 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:30,811 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:30,811 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:45:30,811 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:45:30,812 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:45:30,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:45:30,812 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:45:30,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:45:30,812 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:45:30,813 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:45:30,813 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:45:30,813 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:45:30,813 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:45:30,813 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:45:30,814 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:30,814 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:45:30,814 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:30,814 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:30,815 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:30,815 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:45:30,815 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:45:30,815 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:45:30,815 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:45:30,821 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:45:30,821 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:30,823 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:30,823 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:30,825 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:30,825 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:30,825 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:30,826 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:30,834 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5104, Threshold=0.5312, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:45:30,834 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5104
2025-08-04 20:45:39,090 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:39,090 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:39,090 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:39,090 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:45:39,090 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:45:39,091 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:39,433 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:39,433 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:39,522 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:45:39,569 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:45:39,570 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:39,715 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:39,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:39,725 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:39,734 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:45:39,759 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:39,759 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:45:39,760 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:39,760 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:39,760 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:45:39,770 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:39,774 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:39,776 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:39,779 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:39,782 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:39,786 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:39,789 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:39,793 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:39,797 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:39,799 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:39,801 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:39,812 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:39,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:45:39,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:45:39,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:45:39,823 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:39,823 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:45:39,835 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:39,835 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:45:39,836 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:39,851 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:39,855 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:45:39,861 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:45:39,861 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:39,861 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:39,861 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:39,861 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:39,862 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:39,862 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:45:39,862 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:39,862 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:45:39,863 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:39,864 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:45:39,864 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:45:39,865 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:39,865 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:45:39,865 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:39,865 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:39,865 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:39,865 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:45:39,865 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:45:39,865 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:45:39,866 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:45:39,866 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:45:39,866 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:45:39,866 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:45:39,869 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:45:39,869 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:45:39,869 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:45:39,870 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:45:39,870 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:45:39,870 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:39,870 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:45:39,870 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:39,870 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:39,871 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:39,871 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:45:39,871 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:45:39,871 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:45:39,871 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:45:39,877 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:45:39,877 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:39,878 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:39,878 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:39,880 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 105/400.
2025-08-04 20:45:39,981 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:39,981 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:39,982 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 4 anomalous samples to GAN training data (target: 4).
2025-08-04 20:45:39,983 - ClientAppLogger [Client 6] - INFO - [Client] Round 105: Training GAN with 20 samples (16 normal, 4 anomalous).
2025-08-04 20:45:39,983 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:40,011 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0725, Avg D Loss: 0.8009
2025-08-04 20:45:40,011 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0725, Avg D Loss: 0.8009
2025-08-04 20:45:40,011 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:40,025 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4526, Threshold=0.4708, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:45:40,025 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:45:40,026 - ClientAppLogger [Client 6] - INFO - Fit completed for round 105. Duration: 0.15s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 105, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0725205659866335, 'd_loss': 0.8009092450141907, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.1451711654663086, 'cpu_percent_fit': 11.29375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 20}
2025-08-04 20:45:40,026 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:45:48,297 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:48,298 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:48,298 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:48,298 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:45:48,299 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:45:48,299 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:48,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:48,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:48,643 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:45:48,679 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:45:48,679 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:48,766 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:48,772 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:48,772 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:48,777 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:45:48,785 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:48,785 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:45:48,785 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:48,785 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:48,786 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:45:48,793 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:48,796 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:48,798 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:48,800 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:48,803 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:48,805 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:48,807 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:48,810 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:48,812 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:48,814 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:48,816 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:48,825 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:48,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:45:48,830 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:45:48,830 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:45:48,836 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:48,836 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:45:48,847 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:48,847 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:45:48,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:48,861 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:48,865 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:45:48,869 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:45:48,869 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:48,870 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:48,870 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:48,870 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:48,870 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:48,870 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:45:48,870 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:48,871 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:45:48,871 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:48,872 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:45:48,872 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:45:48,872 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:48,872 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:45:48,873 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:48,873 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:48,873 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:48,873 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:45:48,873 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:45:48,873 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:45:48,873 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:45:48,873 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:45:48,873 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:45:48,874 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:45:48,874 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:45:48,874 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:45:48,874 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:45:48,874 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:45:48,874 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:45:48,874 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:48,874 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:45:48,875 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:48,875 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:48,875 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:48,875 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:45:48,875 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:45:48,876 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:45:48,876 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:45:48,882 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:45:48,882 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:48,883 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:48,883 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:48,884 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:45:48,885 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:48,885 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:48,885 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:45:48,893 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5268, Threshold=0.5663, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:45:48,893 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5268
2025-08-04 20:45:54,145 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:45:54,145 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:45:54,145 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:45:54,145 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:45:54,146 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:45:54,146 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:45:54,398 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:45:54,398 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:45:54,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:45:54,523 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:45:54,523 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:45:54,637 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:45:54,643 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:45:54,643 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:45:54,648 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:45:54,655 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:45:54,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:45:54,656 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:45:54,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:45:54,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:45:54,665 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:45:54,668 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:54,670 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:45:54,672 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:45:54,675 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:45:54,677 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:45:54,680 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:45:54,682 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:45:54,685 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:45:54,687 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:45:54,689 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:45:54,698 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:45:54,698 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:45:54,702 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:45:54,703 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:45:54,708 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:45:54,708 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:45:54,719 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:45:54,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:45:54,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:45:54,734 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:45:54,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:45:54,742 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:45:54,743 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:45:54,743 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:45:54,743 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:45:54,743 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:45:54,743 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:45:54,744 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:45:54,744 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:45:54,744 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:45:54,744 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:45:54,746 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:45:54,746 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:45:54,746 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:45:54,746 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:45:54,746 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:45:54,746 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:45:54,746 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:45:54,747 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:45:54,747 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:45:54,747 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:45:54,747 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:45:54,747 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:45:54,747 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:45:54,747 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:45:54,748 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:45:54,748 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:45:54,748 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:45:54,748 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:45:54,748 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:45:54,748 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:45:54,748 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:45:54,748 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:45:54,749 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:45:54,749 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:45:54,749 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:45:54,749 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:45:54,749 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:45:54,749 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:45:54,753 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:45:54,753 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:45:54,754 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:45:54,754 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:45:54,755 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 106/400.
2025-08-04 20:45:54,856 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:45:54,856 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:45:54,858 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:45:54,858 - ClientAppLogger [Client 6] - INFO - [Client] Round 106: Training GAN with 22 samples (17 normal, 5 anomalous).
2025-08-04 20:45:54,858 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:45:54,882 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0688, Avg D Loss: 0.7985
2025-08-04 20:45:54,882 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0688, Avg D Loss: 0.7985
2025-08-04 20:45:54,883 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:45:54,890 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4986, Threshold=0.5487, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:45:54,890 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:45:54,890 - ClientAppLogger [Client 6] - INFO - Fit completed for round 106. Duration: 0.13s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 106, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0687519788742064, 'd_loss': 0.7984946668148041, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13459229469299316, 'cpu_percent_fit': 12.94375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 22}
2025-08-04 20:45:54,890 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:46:00,159 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:00,159 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:00,159 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:00,159 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:46:00,159 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:46:00,159 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:00,374 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:00,375 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:00,463 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:46:00,484 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:46:00,484 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:00,580 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:00,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:00,586 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:00,592 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:46:00,614 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:00,614 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:46:00,615 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:00,615 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:00,615 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:46:00,624 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:00,627 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:00,629 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:00,632 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:00,634 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:00,636 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:00,639 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:00,641 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:00,644 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:00,646 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:00,649 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:00,659 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:00,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:46:00,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:46:00,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:46:00,669 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:00,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:46:00,682 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:00,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:46:00,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:00,698 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:00,702 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:46:00,708 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:46:00,708 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:00,708 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:00,708 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:00,708 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:00,709 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:00,709 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:46:00,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:00,709 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:46:00,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:00,711 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:46:00,711 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:46:00,711 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:00,711 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:46:00,711 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:00,711 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:00,712 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:00,712 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:46:00,712 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:46:00,712 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:46:00,712 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:46:00,712 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:46:00,712 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:46:00,712 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:46:00,713 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:46:00,713 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:46:00,713 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:46:00,713 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:46:00,713 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:46:00,713 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:00,713 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:46:00,714 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:00,714 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:00,714 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:00,714 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:46:00,714 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:46:00,714 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:46:00,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:46:00,720 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:46:00,720 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:00,721 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:00,721 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:00,723 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:00,723 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:00,723 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:00,724 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:00,732 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4727, Threshold=0.4971, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:46:00,732 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4727
2025-08-04 20:46:15,012 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:15,013 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:15,013 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:15,013 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:46:15,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:46:15,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:15,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:15,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:15,380 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:46:15,425 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:46:15,425 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:15,549 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:15,555 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:15,555 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:15,562 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:46:15,570 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:15,570 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:46:15,570 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:15,570 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:15,570 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:46:15,579 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:15,582 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:15,584 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:15,586 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:15,589 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:15,591 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:15,594 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:15,597 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:15,599 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:15,601 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:15,604 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:15,613 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:15,613 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:46:15,618 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:46:15,618 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:46:15,624 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:15,624 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:46:15,636 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:15,636 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:46:15,636 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:15,651 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:15,657 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:46:15,662 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:46:15,662 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:15,663 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:15,663 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:15,663 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:15,663 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:15,663 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:46:15,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:15,664 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:46:15,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:15,665 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:46:15,666 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:46:15,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:15,666 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:46:15,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:15,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:15,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:15,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:46:15,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:46:15,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:46:15,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:46:15,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:46:15,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:46:15,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:46:15,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:46:15,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:46:15,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:46:15,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:46:15,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:46:15,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:15,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:46:15,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:15,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:15,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:15,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:46:15,670 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:46:15,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:46:15,670 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:46:15,674 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:46:15,674 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:15,675 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:15,675 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:15,676 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:15,676 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:15,676 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:15,677 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:15,685 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4797, Threshold=0.5039, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:46:15,685 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4797
2025-08-04 20:46:20,936 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:20,936 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:20,936 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:20,936 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:46:20,936 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:46:20,936 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:21,176 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:21,176 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:21,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:46:21,297 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:46:21,297 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:21,392 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:21,398 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:21,398 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:21,404 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:46:21,416 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:21,416 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:46:21,417 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:21,417 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:21,417 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:46:21,425 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:21,428 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:21,430 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:21,433 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:21,435 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:21,437 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:21,440 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:21,442 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:21,445 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:21,447 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:21,449 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:21,458 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:21,458 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:46:21,463 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:46:21,463 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:46:21,468 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:21,468 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:46:21,477 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:21,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:46:21,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:21,493 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:21,498 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:46:21,503 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:46:21,503 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:21,503 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:21,503 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:21,504 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:21,504 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:21,504 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:46:21,505 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:21,505 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:46:21,505 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:21,507 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:46:21,507 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:46:21,507 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:21,507 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:46:21,507 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:21,507 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:21,508 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:21,508 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:46:21,508 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:46:21,508 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:46:21,508 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:46:21,508 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:46:21,508 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:46:21,509 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:46:21,509 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:46:21,509 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:46:21,509 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:46:21,509 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:46:21,509 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:46:21,509 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:21,510 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:46:21,510 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:21,510 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:21,510 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:21,510 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:46:21,511 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:46:21,511 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:46:21,511 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:46:21,514 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:46:21,515 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:21,516 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:21,516 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:21,518 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 108/400.
2025-08-04 20:46:21,619 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:21,619 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:21,620 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:46:21,620 - ClientAppLogger [Client 6] - INFO - [Client] Round 108: Training GAN with 22 samples (17 normal, 5 anomalous).
2025-08-04 20:46:21,621 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:46:21,646 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0619, Avg D Loss: 0.8068
2025-08-04 20:46:21,647 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0619, Avg D Loss: 0.8068
2025-08-04 20:46:21,647 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:46:21,655 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4913, Threshold=0.5195, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:46:21,656 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:46:21,656 - ClientAppLogger [Client 6] - INFO - Fit completed for round 108. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 108, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.061907196044922, 'd_loss': 0.806759524345398, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13835692405700684, 'cpu_percent_fit': 11.7, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 22}
2025-08-04 20:46:21,656 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:46:29,935 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:29,935 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:29,935 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:29,936 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:46:29,936 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:46:29,936 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:30,187 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:30,187 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:30,268 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:46:30,281 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:46:30,281 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:30,378 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:30,384 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:30,385 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:30,390 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:46:30,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:30,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:46:30,396 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:30,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:30,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:46:30,405 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:30,408 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:30,410 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:30,413 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:30,416 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:30,418 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:30,420 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:30,423 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:30,426 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:30,428 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:30,430 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:30,440 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:30,440 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:46:30,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:46:30,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:46:30,451 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:30,451 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:46:30,460 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:30,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:46:30,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:30,476 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:30,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:46:30,485 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:46:30,486 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:30,486 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:30,486 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:30,486 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:30,487 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:30,487 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:46:30,487 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:30,487 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:46:30,487 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:30,489 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:46:30,489 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:46:30,490 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:30,490 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:46:30,490 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:30,490 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:30,490 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:30,491 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:46:30,491 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:46:30,491 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:46:30,491 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:46:30,491 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:46:30,491 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:46:30,492 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:46:30,492 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:46:30,492 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:46:30,492 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:46:30,493 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:46:30,493 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:46:30,493 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:30,493 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:46:30,493 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:30,494 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:30,494 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:30,494 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:46:30,494 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:46:30,494 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:46:30,494 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:46:30,496 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:46:30,496 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:30,498 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:30,498 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:30,499 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:30,499 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:30,500 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:30,500 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:30,508 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5034, Threshold=0.5348, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:46:30,508 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.5034
2025-08-04 20:46:44,792 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:44,792 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:44,793 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:44,793 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:46:44,793 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:46:44,794 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:45,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:45,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:46:45,130 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:46:45,172 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:46:45,172 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:46:45,288 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:46:45,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:46:45,296 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:46:45,301 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:46:45,307 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:46:45,308 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:46:45,308 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:46:45,308 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:46:45,308 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:46:45,318 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:46:45,321 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:45,323 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:46:45,327 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:46:45,330 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:46:45,332 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:46:45,334 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:46:45,337 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:46:45,340 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:46:45,342 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:46:45,344 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:46:45,354 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:46:45,354 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:46:45,359 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:46:45,359 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:46:45,364 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:46:45,364 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:46:45,374 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:46:45,374 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:46:45,374 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:46:45,390 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:46:45,394 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:46:45,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:46:45,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:46:45,402 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:46:45,402 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:46:45,402 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:46:45,402 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:46:45,403 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:46:45,403 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:46:45,403 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:46:45,403 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:46:45,405 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:46:45,405 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:46:45,405 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:46:45,405 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:46:45,405 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:46:45,406 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:46:45,406 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:46:45,406 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:46:45,406 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:46:45,406 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:46:45,406 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:46:45,407 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:46:45,407 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:46:45,407 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:46:45,407 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:46:45,407 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:46:45,407 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:46:45,407 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:46:45,408 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:46:45,408 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:46:45,408 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:46:45,408 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:46:45,408 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:46:45,409 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:46:45,409 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:46:45,409 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:46:45,409 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:46:45,409 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:46:45,413 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:46:45,413 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:46:45,414 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:46:45,415 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:46:45,416 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:46:45,416 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:46:45,416 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:46:45,417 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:46:45,425 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4842, Threshold=0.5114, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:46:45,425 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4842
2025-08-04 20:46:59,714 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:46:59,715 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:46:59,715 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:46:59,715 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:46:59,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:46:59,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:46:59,937 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:46:59,937 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:00,019 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:47:00,056 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:47:00,056 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:00,168 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:00,175 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:00,176 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:00,182 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:47:00,204 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:00,205 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:47:00,205 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:00,206 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:00,206 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:47:00,215 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:00,218 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:00,220 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:00,222 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:00,226 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:00,228 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:00,231 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:00,234 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:00,236 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:00,238 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:00,241 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:00,251 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:00,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:47:00,256 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:47:00,257 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:47:00,263 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:00,264 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:47:00,274 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:00,275 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:47:00,275 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:00,290 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:00,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:47:00,300 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:47:00,300 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:00,300 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:00,300 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:00,301 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:00,301 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:00,301 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:47:00,301 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:00,301 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:47:00,301 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:00,303 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:47:00,303 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:47:00,303 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:00,303 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:47:00,303 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:00,304 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:00,304 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:00,304 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:47:00,304 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:47:00,304 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:47:00,304 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:47:00,304 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:47:00,305 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:47:00,305 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:47:00,305 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:47:00,305 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:47:00,305 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:47:00,305 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:47:00,306 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:47:00,306 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:00,306 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:47:00,306 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:00,306 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:00,306 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:00,307 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:47:00,307 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:47:00,307 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:47:00,307 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:47:00,316 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:47:00,316 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:00,318 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:00,318 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:00,319 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:00,319 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:00,320 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:00,320 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:00,329 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5281, Threshold=0.5603, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:47:00,329 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5281
2025-08-04 20:47:05,585 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:05,586 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:05,586 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:05,586 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:47:05,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:47:05,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:05,823 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:05,823 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:05,903 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:47:05,915 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:47:05,915 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:05,996 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:06,000 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:06,001 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:06,006 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:47:06,011 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:06,011 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:47:06,011 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:06,011 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:06,012 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:47:06,020 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:06,023 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:06,025 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:06,027 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:06,030 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:06,032 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:06,034 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:06,037 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:06,040 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:06,041 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:06,044 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:06,052 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:06,052 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:47:06,057 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:47:06,057 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:47:06,061 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:06,061 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:47:06,070 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:06,070 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:47:06,070 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:06,084 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:06,089 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:47:06,093 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:47:06,093 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:06,093 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:06,093 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:06,094 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:06,094 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:06,094 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:47:06,094 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:06,095 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:47:06,095 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:06,096 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:47:06,096 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:47:06,097 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:06,097 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:47:06,097 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:06,097 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:06,097 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:06,097 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:47:06,098 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:47:06,098 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:47:06,098 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:47:06,098 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:47:06,098 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:47:06,098 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:47:06,099 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:47:06,099 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:47:06,099 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:47:06,099 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:47:06,099 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:47:06,099 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:06,100 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:47:06,100 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:06,100 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:06,100 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:06,100 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:47:06,100 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:47:06,101 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:47:06,101 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:47:06,103 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:47:06,103 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:06,104 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:06,104 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:06,105 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 111/400.
2025-08-04 20:47:06,206 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:06,206 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:06,207 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:47:06,207 - ClientAppLogger [Client 6] - INFO - [Client] Round 111: Training GAN with 22 samples (17 normal, 5 anomalous).
2025-08-04 20:47:06,207 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:47:06,232 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0808, Avg D Loss: 0.7844
2025-08-04 20:47:06,232 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0808, Avg D Loss: 0.7844
2025-08-04 20:47:06,233 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:47:06,240 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4887, Threshold=0.5262, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:47:06,240 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:47:06,240 - ClientAppLogger [Client 6] - INFO - Fit completed for round 111. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 111, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0807904481887816, 'd_loss': 0.7843732178211212, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13507294654846191, 'cpu_percent_fit': 10.8125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 22}
2025-08-04 20:47:06,241 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:47:14,512 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:14,512 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:14,512 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:14,512 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:47:14,512 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:47:14,512 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:14,815 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:14,816 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:14,899 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:47:14,945 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:47:14,945 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:15,079 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:15,086 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:15,086 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:15,092 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:47:15,098 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:15,099 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:47:15,099 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:15,099 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:15,099 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:47:15,108 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:15,111 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:15,113 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:15,115 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:15,118 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:15,121 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:15,124 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:15,126 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:15,129 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:15,132 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:15,135 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:15,145 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:15,145 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:47:15,150 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:47:15,150 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:47:15,155 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:15,155 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:47:15,163 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:15,164 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:47:15,164 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:15,180 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:15,185 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:47:15,195 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:47:15,195 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:15,195 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:15,195 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:15,195 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:15,196 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:15,196 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:47:15,196 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:15,196 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:47:15,196 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:15,198 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:47:15,198 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:47:15,198 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:15,198 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:47:15,198 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:15,198 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:15,199 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:15,199 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:47:15,199 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:47:15,199 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:47:15,199 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:47:15,199 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:47:15,199 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:47:15,200 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:47:15,200 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:47:15,200 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:47:15,200 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:47:15,200 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:47:15,200 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:47:15,201 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:15,201 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:47:15,201 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:15,201 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:15,201 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:15,201 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:47:15,202 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:47:15,202 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:47:15,202 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:47:15,208 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:47:15,208 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:15,209 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:15,210 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:15,211 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:15,211 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:15,212 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:15,213 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:15,221 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4929, Threshold=0.5234, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:47:15,222 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4929
2025-08-04 20:47:20,473 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:20,473 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:20,474 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:20,474 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:47:20,474 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:47:20,474 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:20,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:20,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:20,805 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:47:20,826 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:47:20,826 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:20,912 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:20,917 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:20,917 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:20,923 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:47:20,930 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:20,930 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:47:20,931 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:20,931 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:20,931 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:47:20,940 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:20,942 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:20,944 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:20,946 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:20,949 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:20,951 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:20,954 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:20,956 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:20,959 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:20,961 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:20,963 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:20,971 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:20,971 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:47:20,976 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:47:20,976 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:47:20,982 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:20,982 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:47:20,994 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:20,994 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:47:20,994 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:21,008 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:21,013 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:47:21,017 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:47:21,017 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:21,017 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:21,018 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:21,018 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:21,018 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:21,018 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:47:21,018 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:21,018 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:47:21,019 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:21,020 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:47:21,020 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:47:21,020 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:21,020 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:47:21,020 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:21,021 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:21,021 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:21,021 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:47:21,021 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:47:21,021 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:47:21,021 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:47:21,021 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:47:21,021 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:47:21,022 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:47:21,022 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:47:21,022 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:47:21,022 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:47:21,022 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:47:21,022 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:47:21,022 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:21,022 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:47:21,023 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:21,023 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:21,023 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:21,023 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:47:21,024 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:47:21,024 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:47:21,024 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:47:21,029 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:47:21,029 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:21,030 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:21,030 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:21,032 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 112/400.
2025-08-04 20:47:21,133 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:21,133 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:21,134 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:47:21,134 - ClientAppLogger [Client 6] - INFO - [Client] Round 112: Training GAN with 22 samples (17 normal, 5 anomalous).
2025-08-04 20:47:21,134 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:47:21,161 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0676, Avg D Loss: 0.7855
2025-08-04 20:47:21,161 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0676, Avg D Loss: 0.7855
2025-08-04 20:47:21,161 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:47:21,169 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4842, Threshold=0.5120, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:47:21,169 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:47:21,169 - ClientAppLogger [Client 6] - INFO - Fit completed for round 112. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 112, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.067595362663269, 'd_loss': 0.7854800343513488, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13723969459533691, 'cpu_percent_fit': 12.075, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 22}
2025-08-04 20:47:21,169 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:47:32,455 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:32,455 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:32,456 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:32,456 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:47:32,456 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:47:32,456 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:32,761 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:32,762 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:32,846 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:47:32,864 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:47:32,864 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:32,974 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:32,981 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:32,982 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:32,987 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:47:32,995 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:32,998 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:47:32,998 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:32,999 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:32,999 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:47:33,009 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:33,012 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:33,014 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:33,016 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:33,019 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:33,021 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:33,024 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:33,027 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:33,030 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:33,032 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:33,034 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:33,045 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:33,045 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:47:33,050 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:47:33,050 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:47:33,055 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:33,055 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:47:33,065 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:33,065 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:47:33,065 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:33,081 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:33,086 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:47:33,090 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:47:33,090 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:33,091 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:33,091 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:33,091 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:33,091 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:33,092 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:47:33,092 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:33,092 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:47:33,092 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:33,093 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:47:33,094 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:47:33,094 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:33,094 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:47:33,094 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:33,094 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:33,094 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:33,095 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:47:33,095 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:47:33,095 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:47:33,095 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:47:33,095 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:47:33,095 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:47:33,095 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:47:33,095 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:47:33,096 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:47:33,096 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:47:33,096 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:47:33,096 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:47:33,096 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:33,096 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:47:33,097 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:33,097 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:33,097 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:33,097 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:47:33,097 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:47:33,098 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:47:33,098 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:47:33,101 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:47:33,101 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:33,102 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:33,103 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:33,104 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:33,104 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:33,104 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:33,105 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:33,114 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4591, Threshold=0.4779, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:47:33,114 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4591
2025-08-04 20:47:38,371 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:38,371 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:38,371 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:38,371 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:47:38,372 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:47:38,372 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:38,650 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:38,650 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:38,733 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:47:38,779 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:47:38,779 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:38,897 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:38,902 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:38,902 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:38,907 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:47:38,912 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:38,912 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:47:38,913 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:38,913 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:38,913 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:47:38,921 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:38,924 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:38,926 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:38,928 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:38,931 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:38,933 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:38,935 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:38,938 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:38,940 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:38,942 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:38,948 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:38,958 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:38,958 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:47:38,963 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:47:38,963 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:47:38,968 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:38,968 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:47:38,976 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:38,976 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:47:38,976 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:38,991 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:38,996 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:47:39,002 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:47:39,002 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:39,002 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:39,003 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:39,003 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:39,003 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:39,003 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:47:39,004 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:39,004 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:47:39,004 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:39,005 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:47:39,005 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:47:39,006 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:39,006 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:47:39,006 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:39,006 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:39,006 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:39,006 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:47:39,006 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:47:39,007 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:47:39,007 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:47:39,007 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:47:39,007 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:47:39,007 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:47:39,007 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:47:39,008 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:47:39,008 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:47:39,008 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:47:39,008 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:47:39,008 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:39,008 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:47:39,009 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:39,009 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:39,009 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:39,009 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:47:39,009 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:47:39,010 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:47:39,010 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:47:39,017 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:47:39,017 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:39,018 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:39,018 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:39,020 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 113/400.
2025-08-04 20:47:39,121 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:39,121 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:39,122 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:47:39,122 - ClientAppLogger [Client 6] - INFO - [Client] Round 113: Training GAN with 22 samples (17 normal, 5 anomalous).
2025-08-04 20:47:39,122 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:47:39,149 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0774, Avg D Loss: 0.7845
2025-08-04 20:47:39,149 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0774, Avg D Loss: 0.7845
2025-08-04 20:47:39,149 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:47:39,156 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4853, Threshold=0.5122, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:47:39,156 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:47:39,157 - ClientAppLogger [Client 6] - INFO - Fit completed for round 113. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 113, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0774219274520873, 'd_loss': 0.78446524143219, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.13706493377685547, 'cpu_percent_fit': 12.1625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 22}
2025-08-04 20:47:39,157 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:47:44,437 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:44,437 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:44,437 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:44,437 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:47:44,437 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:47:44,437 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:44,654 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:44,655 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:44,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:47:44,774 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:47:44,774 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:44,862 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:44,868 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:44,868 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:44,874 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:47:44,882 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:44,882 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:47:44,883 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:44,883 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:44,883 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:47:44,891 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:44,894 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:44,897 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:44,899 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:44,901 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:44,903 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:44,906 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:44,908 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:44,911 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:44,913 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:44,916 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:44,925 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:44,925 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:47:44,930 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:47:44,930 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:47:44,936 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:44,936 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:47:44,949 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:44,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:47:44,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:44,965 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:44,970 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:47:44,976 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:47:44,976 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:44,976 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:44,976 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:44,977 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:44,977 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:44,977 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:47:44,977 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:44,977 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:47:44,977 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:44,979 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:47:44,979 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:47:44,979 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:44,980 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:47:44,980 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:44,980 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:44,980 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:44,980 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:47:44,980 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:47:44,980 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:47:44,980 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:47:44,981 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:47:44,981 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:47:44,981 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:47:44,981 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:47:44,982 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:47:44,982 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:47:44,982 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:47:44,982 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:47:44,982 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:44,982 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:47:44,982 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:44,983 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:44,983 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:44,983 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:47:44,983 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:47:44,983 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:47:44,983 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:47:44,990 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:47:44,990 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:44,992 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:44,992 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:44,994 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:47:44,994 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:44,994 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:44,995 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:47:45,003 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5069, Threshold=0.5445, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:47:45,003 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5069
2025-08-04 20:47:50,251 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:47:50,251 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:47:50,251 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:47:50,251 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:47:50,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:47:50,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:47:50,501 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:47:50,501 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:47:50,581 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:47:50,601 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:47:50,601 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:47:50,696 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:47:50,702 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:47:50,702 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:47:50,707 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:47:50,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:47:50,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:47:50,719 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:47:50,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:47:50,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:47:50,728 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:47:50,731 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:50,733 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:47:50,736 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:47:50,738 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:47:50,740 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:47:50,743 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:47:50,745 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:47:50,748 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:47:50,750 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:47:50,752 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:47:50,761 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:47:50,761 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:47:50,766 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:47:50,766 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:47:50,772 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:47:50,772 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:47:50,784 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:47:50,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:47:50,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:47:50,799 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:47:50,804 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:47:50,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:47:50,809 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:47:50,809 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:47:50,809 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:47:50,809 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:47:50,809 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:47:50,810 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:47:50,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:47:50,810 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:47:50,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:47:50,812 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:47:50,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:47:50,812 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:47:50,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:47:50,812 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:47:50,812 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:47:50,813 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:47:50,813 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:47:50,813 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:47:50,813 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:47:50,813 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:47:50,813 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:47:50,813 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:47:50,813 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:47:50,814 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:47:50,814 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:47:50,814 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:47:50,814 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:47:50,814 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:47:50,814 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:47:50,814 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:47:50,815 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:47:50,815 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:47:50,815 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:47:50,815 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:47:50,815 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:47:50,816 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:47:50,816 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:47:50,820 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:47:50,820 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:47:50,821 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:47:50,821 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:47:50,822 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 114/400.
2025-08-04 20:47:50,924 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:47:50,924 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:47:50,926 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:47:50,926 - ClientAppLogger [Client 6] - INFO - [Client] Round 114: Training GAN with 23 samples (18 normal, 5 anomalous).
2025-08-04 20:47:50,926 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:47:50,951 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0674, Avg D Loss: 0.7767
2025-08-04 20:47:50,951 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0674, Avg D Loss: 0.7767
2025-08-04 20:47:50,951 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:47:50,959 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4897, Threshold=0.5231, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:47:50,959 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:47:50,959 - ClientAppLogger [Client 6] - INFO - Fit completed for round 114. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 114, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0674172043800354, 'd_loss': 0.7767052233219147, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13663601875305176, 'cpu_percent_fit': 10.625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 23}
2025-08-04 20:47:50,959 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:48:02,241 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:02,241 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:02,242 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:02,242 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:48:02,242 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:48:02,242 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:02,516 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:02,516 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:02,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:48:02,643 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:48:02,643 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:02,770 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:02,778 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:02,778 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:02,785 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:48:02,793 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:02,793 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:48:02,794 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:02,794 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:02,794 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:48:02,803 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:02,806 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:02,808 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:02,810 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:02,813 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:02,815 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:02,817 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:02,820 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:02,823 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:02,824 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:02,827 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:02,837 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:02,838 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:48:02,843 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:48:02,843 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:48:02,847 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:02,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:48:02,857 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:02,857 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:48:02,857 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:02,875 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:02,881 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:48:02,888 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:48:02,888 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:02,888 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:02,888 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:02,889 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:02,889 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:02,889 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:48:02,889 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:02,890 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:48:02,890 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:02,891 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:48:02,892 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:48:02,892 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:02,892 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:48:02,892 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:02,892 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:02,893 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:02,893 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:48:02,893 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:48:02,893 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:48:02,893 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:48:02,893 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:48:02,893 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:48:02,894 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:48:02,894 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:48:02,894 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:48:02,894 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:48:02,894 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:48:02,894 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:48:02,895 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:02,895 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:48:02,895 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:02,895 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:02,895 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:02,895 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:48:02,896 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:48:02,896 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:48:02,896 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:48:02,899 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:48:02,899 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:02,900 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:02,901 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:02,902 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:02,903 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:02,903 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:02,903 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:02,911 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5415, Threshold=0.5835, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:48:02,911 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5415
2025-08-04 20:48:08,186 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:08,187 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:08,187 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:08,187 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:48:08,187 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:48:08,187 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:08,464 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:08,464 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:08,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:48:08,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:48:08,580 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:08,662 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:08,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:08,668 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:08,674 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:48:08,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:08,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:48:08,683 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:08,683 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:08,683 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:48:08,692 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:08,695 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:08,697 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:08,699 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:08,702 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:08,704 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:08,707 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:08,709 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:08,712 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:08,714 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:08,716 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:08,724 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:08,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:48:08,729 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:48:08,729 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:48:08,735 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:08,735 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:48:08,746 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:08,747 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:48:08,747 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:08,761 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:08,765 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:48:08,769 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:48:08,770 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:08,770 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:08,770 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:08,770 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:08,770 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:08,770 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:48:08,770 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:08,771 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:48:08,771 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:08,772 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:48:08,772 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:48:08,772 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:08,772 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:48:08,773 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:08,773 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:08,773 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:08,773 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:48:08,773 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:48:08,773 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:48:08,773 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:48:08,773 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:48:08,774 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:48:08,774 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:48:08,774 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:48:08,774 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:48:08,774 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:48:08,774 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:48:08,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:48:08,775 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:08,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:48:08,775 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:08,775 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:08,775 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:08,776 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:48:08,776 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:48:08,776 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:48:08,776 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:48:08,782 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:48:08,783 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:08,784 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:08,784 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:08,785 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 115/400.
2025-08-04 20:48:08,886 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:08,886 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:08,887 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:48:08,887 - ClientAppLogger [Client 6] - INFO - [Client] Round 115: Training GAN with 23 samples (18 normal, 5 anomalous).
2025-08-04 20:48:08,888 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:48:08,912 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0745, Avg D Loss: 0.7770
2025-08-04 20:48:08,912 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0745, Avg D Loss: 0.7770
2025-08-04 20:48:08,912 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:48:08,919 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4969, Threshold=0.5351, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:48:08,920 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:48:08,920 - ClientAppLogger [Client 6] - INFO - Fit completed for round 115. Duration: 0.13s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 115, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.074496793746948, 'd_loss': 0.776952612400055, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.13465356826782227, 'cpu_percent_fit': 12.89375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 23}
2025-08-04 20:48:08,920 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:48:14,184 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:14,184 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:14,184 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:14,185 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:48:14,185 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:48:14,185 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:14,457 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:14,457 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:14,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:48:14,589 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:48:14,589 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:14,712 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:14,718 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:14,718 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:14,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:48:14,730 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:14,731 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:48:14,731 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:14,732 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:14,732 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:48:14,741 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:14,744 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:14,746 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:14,748 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:14,751 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:14,753 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:14,756 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:14,758 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:14,761 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:14,763 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:14,766 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:14,777 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:14,777 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:48:14,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:48:14,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:48:14,787 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:14,787 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:48:14,800 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:14,800 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:48:14,800 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:14,817 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:14,822 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:48:14,828 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:48:14,829 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:14,829 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:14,829 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:14,829 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:14,829 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:14,830 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:48:14,830 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:14,830 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:48:14,830 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:14,832 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:48:14,832 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:48:14,833 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:14,833 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:48:14,833 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:14,833 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:14,833 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:14,833 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:48:14,834 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:48:14,834 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:48:14,834 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:48:14,834 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:48:14,834 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:48:14,834 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:48:14,835 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:48:14,835 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:48:14,835 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:48:14,835 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:48:14,835 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:48:14,835 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:14,835 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:48:14,836 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:14,836 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:14,836 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:14,836 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:48:14,836 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:48:14,837 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:48:14,837 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:48:14,842 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:48:14,843 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:14,844 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:14,844 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:14,846 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:14,846 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:14,846 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:14,846 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:14,855 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5778, Threshold=0.6217, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:48:14,855 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.5778
2025-08-04 20:48:20,102 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:20,103 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:20,103 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:20,103 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:48:20,103 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:48:20,103 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:20,356 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:20,356 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:20,437 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:48:20,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:48:20,479 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:20,591 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:20,595 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:20,596 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:20,600 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:48:20,607 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:20,607 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:48:20,608 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:20,608 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:20,608 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:48:20,616 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:20,619 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:20,622 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:20,624 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:20,628 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:20,630 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:20,633 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:20,636 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:20,638 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:20,640 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:20,642 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:20,651 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:20,651 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:48:20,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:48:20,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:48:20,660 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:20,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:48:20,669 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:20,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:48:20,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:20,684 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:20,688 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:48:20,693 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:48:20,694 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:20,694 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:20,694 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:20,694 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:20,695 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:20,695 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:48:20,695 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:20,695 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:48:20,695 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:20,697 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:48:20,697 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:48:20,697 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:20,697 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:48:20,698 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:20,698 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:20,698 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:20,698 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:48:20,698 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:48:20,698 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:48:20,698 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:48:20,698 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:48:20,698 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:48:20,699 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:48:20,699 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:48:20,699 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:48:20,699 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:48:20,699 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:48:20,699 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:48:20,699 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:20,699 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:48:20,700 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:20,700 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:20,700 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:20,700 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:48:20,700 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:48:20,700 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:48:20,701 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:48:20,708 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:48:20,708 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:20,709 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:20,709 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:20,710 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 116/400.
2025-08-04 20:48:20,811 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:20,811 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:20,812 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:48:20,812 - ClientAppLogger [Client 6] - INFO - [Client] Round 116: Training GAN with 23 samples (18 normal, 5 anomalous).
2025-08-04 20:48:20,812 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:48:20,837 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0749, Avg D Loss: 0.7790
2025-08-04 20:48:20,837 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0749, Avg D Loss: 0.7790
2025-08-04 20:48:20,837 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:48:20,844 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4925, Threshold=0.5310, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:48:20,844 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:48:20,845 - ClientAppLogger [Client 6] - INFO - Fit completed for round 116. Duration: 0.13s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 116, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.074881386756897, 'd_loss': 0.778990751504898, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13413596153259277, 'cpu_percent_fit': 11.1625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 23}
2025-08-04 20:48:20,845 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:48:26,101 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:26,101 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:26,101 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:26,101 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:48:26,101 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:48:26,102 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:26,369 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:26,369 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:26,458 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:48:26,494 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:48:26,494 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:26,606 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:26,613 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:26,613 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:26,622 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:48:26,628 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:26,628 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:48:26,629 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:26,629 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:26,629 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:48:26,637 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:26,640 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:26,642 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:26,644 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:26,647 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:26,649 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:26,651 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:26,654 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:26,656 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:26,658 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:26,660 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:26,671 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:26,671 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:48:26,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:48:26,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:48:26,681 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:26,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:48:26,691 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:26,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:48:26,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:26,707 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:26,712 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:48:26,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:48:26,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:26,719 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:26,719 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:26,720 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:26,720 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:26,720 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:48:26,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:26,720 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:48:26,721 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:26,722 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:48:26,722 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:48:26,723 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:26,723 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:48:26,723 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:26,723 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:26,723 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:26,723 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:48:26,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:48:26,724 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:48:26,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:48:26,724 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:48:26,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:48:26,724 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:48:26,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:48:26,725 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:48:26,725 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:48:26,725 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:48:26,725 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:48:26,725 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:26,725 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:48:26,726 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:26,726 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:26,726 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:26,726 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:48:26,726 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:48:26,726 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:48:26,727 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:48:26,732 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:48:26,732 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:26,733 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:26,733 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:26,734 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:26,734 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:26,734 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:26,735 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:26,743 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4808, Threshold=0.5155, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:48:26,743 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4808
2025-08-04 20:48:32,003 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:32,003 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:32,003 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:32,003 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:48:32,004 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:48:32,004 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:32,265 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:32,266 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:32,349 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:48:32,393 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:48:32,394 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:32,503 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:32,509 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:32,509 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:32,514 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:48:32,519 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:32,520 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:48:32,520 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:32,520 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:32,521 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:48:32,528 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:32,531 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:32,533 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:32,535 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:32,538 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:32,540 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:32,543 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:32,545 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:32,548 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:32,550 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:32,552 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:32,561 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:32,561 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:48:32,566 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:48:32,566 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:48:32,570 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:32,570 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:48:32,578 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:32,579 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:48:32,579 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:32,595 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:32,600 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:48:32,606 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:48:32,606 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:32,606 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:32,606 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:32,606 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:32,607 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:32,607 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:48:32,607 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:32,607 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:48:32,607 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:32,609 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:48:32,609 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:48:32,609 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:32,609 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:48:32,609 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:32,609 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:32,610 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:32,610 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:48:32,610 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:48:32,610 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:48:32,610 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:48:32,610 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:48:32,610 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:48:32,611 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:48:32,611 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:48:32,611 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:48:32,611 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:48:32,611 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:48:32,611 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:48:32,611 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:32,611 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:48:32,612 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:32,612 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:32,612 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:32,612 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:48:32,612 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:48:32,612 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:48:32,612 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:48:32,618 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:48:32,618 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:32,619 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:32,619 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:32,621 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 117/400.
2025-08-04 20:48:32,721 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:32,721 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:32,722 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:48:32,723 - ClientAppLogger [Client 6] - INFO - [Client] Round 117: Training GAN with 24 samples (19 normal, 5 anomalous).
2025-08-04 20:48:32,723 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:48:32,747 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0853, Avg D Loss: 0.7681
2025-08-04 20:48:32,747 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0853, Avg D Loss: 0.7681
2025-08-04 20:48:32,747 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:48:32,755 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4959, Threshold=0.5431, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:48:32,755 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:48:32,755 - ClientAppLogger [Client 6] - INFO - Fit completed for round 117. Duration: 0.13s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 117, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0853086948394775, 'd_loss': 0.7681317985057831, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13434052467346191, 'cpu_percent_fit': 11.05, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 24}
2025-08-04 20:48:32,755 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:48:41,017 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:41,017 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:41,017 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:41,017 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:48:41,018 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:48:41,018 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:41,293 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:41,293 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:41,382 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:48:41,426 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:48:41,426 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:41,552 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:41,559 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:41,560 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:41,566 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:48:41,593 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:41,593 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:48:41,594 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:41,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:41,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:48:41,603 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:41,606 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:41,608 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:41,610 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:41,613 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:41,615 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:41,617 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:41,620 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:41,622 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:41,624 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:41,627 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:41,636 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:41,636 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:48:41,641 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:48:41,641 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:48:41,648 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:41,648 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:48:41,660 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:41,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:48:41,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:41,676 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:41,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:48:41,688 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:48:41,688 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:41,688 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:41,688 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:41,689 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:41,689 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:41,689 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:48:41,689 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:41,690 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:48:41,690 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:41,691 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:48:41,691 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:48:41,692 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:41,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:48:41,692 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:41,692 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:41,692 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:41,692 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:48:41,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:48:41,693 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:48:41,693 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:48:41,693 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:48:41,693 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:48:41,693 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:48:41,693 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:48:41,694 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:48:41,694 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:48:41,694 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:48:41,694 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:48:41,694 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:41,694 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:48:41,694 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:41,695 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:41,695 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:41,695 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:48:41,695 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:48:41,695 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:48:41,696 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:48:41,706 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:48:41,706 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:41,708 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:41,708 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:41,709 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:41,709 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:41,710 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:41,710 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:41,719 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4999, Threshold=0.5339, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:48:41,719 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4999
2025-08-04 20:48:46,970 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:46,970 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:46,970 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:46,971 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:48:46,971 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:48:46,971 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:47,228 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:47,228 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:47,310 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:48:47,348 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:48:47,348 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:47,460 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:47,465 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:47,465 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:47,471 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:48:47,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:47,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:48:47,482 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:47,482 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:47,482 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:48:47,490 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:47,493 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:47,495 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:47,497 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:47,500 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:47,502 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:47,504 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:47,507 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:47,509 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:47,511 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:47,514 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:47,523 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:47,523 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:48:47,528 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:48:47,528 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:48:47,533 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:47,533 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:48:47,542 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:47,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:48:47,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:47,557 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:47,561 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:48:47,566 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:48:47,566 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:47,566 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:47,566 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:47,566 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:47,567 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:47,567 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:48:47,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:47,567 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:48:47,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:47,569 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:48:47,569 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:48:47,569 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:47,569 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:48:47,570 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:47,570 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:47,570 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:47,570 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:48:47,570 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:48:47,570 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:48:47,570 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:48:47,570 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:48:47,571 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:48:47,571 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:48:47,571 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:48:47,571 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:48:47,571 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:48:47,571 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:48:47,571 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:48:47,572 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:47,572 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:48:47,572 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:47,572 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:47,572 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:47,573 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:48:47,573 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:48:47,573 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:48:47,573 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:48:47,581 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:48:47,581 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:47,582 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:47,582 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:47,583 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 118/400.
2025-08-04 20:48:47,684 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:47,684 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:47,685 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:48:47,686 - ClientAppLogger [Client 6] - INFO - [Client] Round 118: Training GAN with 24 samples (19 normal, 5 anomalous).
2025-08-04 20:48:47,686 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:48:47,710 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0669, Avg D Loss: 0.7728
2025-08-04 20:48:47,711 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0669, Avg D Loss: 0.7728
2025-08-04 20:48:47,711 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:48:47,718 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4920, Threshold=0.5300, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:48:47,718 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:48:47,719 - ClientAppLogger [Client 6] - INFO - Fit completed for round 118. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 118, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.066878890991211, 'd_loss': 0.7727828085422516, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.13536453247070312, 'cpu_percent_fit': 10.84375, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 24}
2025-08-04 20:48:47,719 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:48:53,003 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:53,003 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:53,004 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:53,004 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:48:53,004 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:48:53,004 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:53,288 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:53,288 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:53,385 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:48:53,429 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:48:53,429 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:53,570 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:53,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:53,576 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:53,582 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:48:53,587 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:53,588 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:48:53,588 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:53,589 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:53,589 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:48:53,598 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:53,601 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:53,603 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:53,605 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:53,608 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:53,610 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:53,613 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:53,615 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:53,618 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:53,620 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:53,622 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:53,634 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:53,634 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:48:53,639 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:48:53,639 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:48:53,644 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:53,644 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:48:53,654 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:53,654 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:48:53,654 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:53,671 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:53,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:48:53,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:48:53,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:53,681 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:53,682 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:53,682 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:53,682 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:53,682 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:48:53,683 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:53,683 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:48:53,683 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:53,684 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:48:53,685 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:48:53,685 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:53,685 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:48:53,686 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:53,686 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:53,686 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:53,686 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:48:53,686 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:48:53,686 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:48:53,686 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:48:53,687 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:48:53,687 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:48:53,687 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:48:53,687 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:48:53,687 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:48:53,687 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:48:53,688 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:48:53,688 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:48:53,688 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:53,688 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:48:53,688 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:53,688 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:53,689 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:53,689 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:48:53,689 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:48:53,689 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:48:53,689 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:48:53,694 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:48:53,695 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:53,696 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:53,696 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:53,698 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:48:53,698 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:53,698 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:53,699 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:48:53,707 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5356, Threshold=0.5764, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:48:53,707 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.5356
2025-08-04 20:48:58,958 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:48:58,959 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:48:58,959 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:48:58,959 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:48:58,959 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:48:58,959 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:48:59,187 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:48:59,187 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:48:59,268 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:48:59,290 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:48:59,290 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:48:59,382 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:48:59,387 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:48:59,387 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:48:59,393 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:48:59,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:48:59,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:48:59,401 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:48:59,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:48:59,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:48:59,410 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:48:59,413 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:59,415 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:48:59,417 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:48:59,420 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:48:59,422 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:48:59,424 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:48:59,427 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:48:59,429 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:48:59,431 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:48:59,433 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:48:59,443 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:48:59,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:48:59,448 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:48:59,448 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:48:59,454 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:48:59,454 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:48:59,464 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:48:59,464 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:48:59,464 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:48:59,479 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:48:59,483 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:48:59,488 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:48:59,488 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:48:59,488 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:48:59,488 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:48:59,488 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:48:59,489 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:48:59,489 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:48:59,489 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:48:59,489 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:48:59,490 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:48:59,491 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:48:59,491 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:48:59,492 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:48:59,492 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:48:59,492 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:48:59,492 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:48:59,492 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:48:59,492 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:48:59,492 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:48:59,493 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:48:59,493 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:48:59,493 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:48:59,493 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:48:59,493 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:48:59,493 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:48:59,493 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:48:59,494 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:48:59,494 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:48:59,494 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:48:59,494 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:48:59,494 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:48:59,494 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:48:59,495 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:48:59,495 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:48:59,495 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:48:59,495 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:48:59,495 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:48:59,495 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:48:59,500 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:48:59,500 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:48:59,501 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:48:59,501 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:48:59,502 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 119/400.
2025-08-04 20:48:59,603 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:48:59,603 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:48:59,605 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:48:59,605 - ClientAppLogger [Client 6] - INFO - [Client] Round 119: Training GAN with 24 samples (19 normal, 5 anomalous).
2025-08-04 20:48:59,605 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:48:59,631 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0767, Avg D Loss: 0.7701
2025-08-04 20:48:59,631 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0767, Avg D Loss: 0.7701
2025-08-04 20:48:59,631 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:48:59,639 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4962, Threshold=0.5375, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:48:59,639 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:48:59,639 - ClientAppLogger [Client 6] - INFO - Fit completed for round 119. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 119, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.076668691635132, 'd_loss': 0.7701120138168335, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.13685965538024902, 'cpu_percent_fit': 12.03125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 24}
2025-08-04 20:48:59,640 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:49:04,898 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:04,898 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:04,898 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:04,898 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:49:04,898 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:49:04,899 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:05,137 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:05,137 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:05,224 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:49:05,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:49:05,252 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:05,356 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:05,363 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:05,363 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:05,369 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:49:05,379 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:05,379 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:49:05,380 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:05,380 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:05,380 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:49:05,389 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:05,391 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:05,394 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:05,396 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:05,399 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:05,401 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:05,403 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:05,406 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:05,409 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:05,411 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:05,413 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:05,423 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:05,423 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:49:05,427 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:49:05,428 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:49:05,433 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:05,433 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:49:05,444 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:05,444 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:49:05,444 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:05,460 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:05,465 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:49:05,470 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:49:05,470 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:05,470 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:05,470 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:05,471 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:05,471 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:05,471 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:49:05,471 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:05,472 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:49:05,472 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:05,473 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:49:05,473 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:49:05,474 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:05,474 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:49:05,474 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:05,474 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:05,475 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:05,475 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:49:05,475 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:49:05,475 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:49:05,475 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:49:05,476 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:49:05,476 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:49:05,476 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:49:05,476 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:49:05,476 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:49:05,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:49:05,477 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:49:05,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:49:05,477 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:05,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:49:05,477 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:05,478 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:05,478 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:05,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:49:05,478 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:49:05,478 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:49:05,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:49:05,483 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:49:05,483 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:05,485 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:05,485 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:05,486 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:05,486 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:05,486 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:05,487 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:05,495 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5105, Threshold=0.5490, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:49:05,495 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5105
2025-08-04 20:49:10,740 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:10,740 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:10,740 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:10,741 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:49:10,741 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:49:10,741 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:11,035 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:11,035 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:11,117 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:49:11,158 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:49:11,158 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:11,275 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:11,281 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:11,281 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:11,286 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:49:11,291 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:11,292 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:49:11,292 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:11,292 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:11,292 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:49:11,301 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:11,304 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:11,306 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:11,308 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:11,311 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:11,313 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:11,315 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:11,318 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:11,321 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:11,322 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:11,325 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:11,334 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:11,334 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:49:11,339 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:49:11,339 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:49:11,343 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:11,343 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:49:11,352 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:11,352 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:49:11,352 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:11,368 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:11,372 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:49:11,378 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:49:11,378 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:11,378 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:11,378 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:11,378 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:11,378 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:11,379 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:49:11,379 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:11,379 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:49:11,379 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:11,380 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:49:11,380 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:49:11,381 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:11,381 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:49:11,381 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:11,381 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:11,382 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:11,382 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:49:11,382 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:49:11,382 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:49:11,382 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:49:11,382 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:49:11,382 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:49:11,383 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:49:11,383 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:49:11,383 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:49:11,383 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:49:11,383 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:49:11,383 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:49:11,383 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:11,384 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:49:11,384 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:11,384 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:11,384 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:11,384 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:49:11,384 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:49:11,385 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:49:11,385 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:49:11,388 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:49:11,388 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:11,390 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:11,390 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:11,391 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 120/400.
2025-08-04 20:49:11,492 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:11,492 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:11,494 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 5 anomalous samples to GAN training data (target: 5).
2025-08-04 20:49:11,494 - ClientAppLogger [Client 6] - INFO - [Client] Round 120: Training GAN with 24 samples (19 normal, 5 anomalous).
2025-08-04 20:49:11,494 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:11,520 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0730, Avg D Loss: 0.7721
2025-08-04 20:49:11,520 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0730, Avg D Loss: 0.7721
2025-08-04 20:49:11,521 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:11,528 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4943, Threshold=0.5354, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:49:11,528 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:49:11,528 - ClientAppLogger [Client 6] - INFO - Fit completed for round 120. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 120, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0729506254196166, 'd_loss': 0.7721400678157806, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.13710379600524902, 'cpu_percent_fit': 12.06875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 24}
2025-08-04 20:49:11,529 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:49:22,789 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:22,789 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:22,789 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:22,789 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:49:22,790 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:49:22,790 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:23,067 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:23,067 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:23,156 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:49:23,199 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:49:23,200 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:23,316 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:23,323 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:23,323 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:23,329 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:49:23,336 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:23,336 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:49:23,336 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:23,337 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:23,337 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:49:23,345 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:23,349 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:23,351 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:23,353 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:23,356 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:23,358 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:23,361 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:23,364 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:23,367 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:23,369 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:23,371 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:23,382 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:23,382 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:49:23,387 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:49:23,387 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:49:23,392 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:23,393 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:49:23,401 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:23,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:49:23,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:23,418 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:23,422 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:49:23,439 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:49:23,439 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:23,439 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:23,439 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:23,440 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:23,440 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:23,440 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:49:23,440 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:23,441 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:49:23,441 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:23,442 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:49:23,442 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:49:23,443 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:23,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:49:23,443 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:23,443 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:23,443 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:23,444 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:49:23,444 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:49:23,444 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:49:23,444 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:49:23,444 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:49:23,444 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:49:23,444 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:49:23,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:49:23,445 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:49:23,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:49:23,445 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:49:23,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:49:23,445 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:23,446 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:49:23,446 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:23,446 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:23,446 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:23,446 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:49:23,446 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:49:23,447 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:49:23,447 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:49:23,453 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:49:23,453 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:23,454 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:23,454 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:23,456 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:23,456 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:23,456 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:23,457 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:23,465 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5302, Threshold=0.5678, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:49:23,465 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5302
2025-08-04 20:49:31,727 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:31,727 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:31,728 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:31,728 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:49:31,728 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:49:31,728 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:32,034 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:32,034 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:32,119 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:49:32,144 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:49:32,144 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:32,229 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:32,235 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:32,235 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:32,241 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:49:32,249 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:32,250 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:49:32,252 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:32,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:32,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:49:32,261 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:32,264 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:32,266 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:32,269 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:32,272 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:32,274 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:32,277 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:32,279 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:32,282 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:32,284 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:32,287 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:32,295 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:32,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:49:32,300 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:49:32,300 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:49:32,306 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:32,306 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:49:32,318 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:32,318 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:49:32,318 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:32,333 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:32,338 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:49:32,342 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:49:32,342 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:32,342 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:32,342 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:32,343 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:32,343 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:32,343 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:49:32,343 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:32,344 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:49:32,344 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:32,345 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:49:32,345 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:49:32,346 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:32,346 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:49:32,346 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:32,346 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:32,346 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:32,346 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:49:32,346 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:49:32,347 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:49:32,347 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:49:32,347 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:49:32,347 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:49:32,347 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:49:32,347 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:49:32,347 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:49:32,347 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:49:32,348 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:49:32,348 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:49:32,348 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:32,348 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:49:32,348 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:32,348 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:32,349 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:32,349 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:49:32,349 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:49:32,349 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:49:32,350 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:49:32,354 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:49:32,354 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:32,356 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:32,356 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:32,357 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 121/400.
2025-08-04 20:49:32,458 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:32,458 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:32,459 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:49:32,459 - ClientAppLogger [Client 6] - INFO - [Client] Round 121: Training GAN with 26 samples (20 normal, 6 anomalous).
2025-08-04 20:49:32,459 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:32,484 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0681, Avg D Loss: 0.7755
2025-08-04 20:49:32,484 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0681, Avg D Loss: 0.7755
2025-08-04 20:49:32,484 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:32,491 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5244, Threshold=0.5728, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:49:32,491 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:49:32,491 - ClientAppLogger [Client 6] - INFO - Fit completed for round 121. Duration: 0.13s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 121, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0681046724319456, 'd_loss': 0.775537633895874, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13395309448242188, 'cpu_percent_fit': 13.03125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 26}
2025-08-04 20:49:32,491 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:49:37,774 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:37,774 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:37,774 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:37,774 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:49:37,774 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:49:37,774 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:38,098 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:38,098 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:38,183 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:49:38,229 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:49:38,229 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:38,350 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:38,355 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:38,355 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:38,360 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:49:38,366 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:38,366 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:49:38,366 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:38,367 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:38,367 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:49:38,375 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:38,378 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:38,380 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:38,382 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:38,385 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:38,387 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:38,389 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:38,391 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:38,394 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:38,396 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:38,398 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:38,407 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:38,407 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:49:38,411 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:49:38,412 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:49:38,416 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:38,416 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:49:38,424 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:38,424 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:49:38,424 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:38,439 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:38,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:49:38,450 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:49:38,450 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:38,450 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:38,450 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:38,450 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:38,451 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:38,451 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:49:38,451 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:38,451 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:49:38,451 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:38,453 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:49:38,453 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:49:38,453 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:38,453 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:49:38,454 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:38,454 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:38,454 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:38,454 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:49:38,454 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:49:38,454 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:49:38,454 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:49:38,454 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:49:38,454 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:49:38,454 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:49:38,455 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:49:38,455 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:49:38,455 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:49:38,455 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:49:38,455 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:49:38,455 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:38,455 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:49:38,456 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:38,456 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:38,456 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:38,456 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:49:38,456 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:49:38,456 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:49:38,457 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:49:38,460 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:49:38,460 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:38,462 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:38,462 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:38,464 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:38,464 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:38,464 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:38,465 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:38,473 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4669, Threshold=0.4871, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:49:38,473 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4669
2025-08-04 20:49:43,749 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:43,750 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:43,750 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:43,750 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:49:43,750 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:49:43,750 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:44,016 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:44,016 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:44,101 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:49:44,145 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:49:44,145 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:44,255 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:44,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:44,261 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:44,265 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:49:44,270 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:44,271 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:49:44,271 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:44,271 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:44,271 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:49:44,280 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:44,283 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:44,285 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:44,287 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:44,290 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:44,292 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:44,294 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:44,297 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:44,300 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:44,302 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:44,304 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:44,312 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:44,313 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:49:44,317 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:49:44,318 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:49:44,322 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:44,322 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:49:44,331 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:44,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:49:44,332 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:44,347 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:44,351 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:49:44,356 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:49:44,356 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:44,357 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:44,357 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:44,357 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:44,358 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:44,358 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:49:44,358 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:44,358 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:49:44,358 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:44,360 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:49:44,360 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:49:44,360 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:44,360 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:49:44,360 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:44,361 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:44,361 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:44,361 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:49:44,361 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:49:44,361 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:49:44,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:49:44,362 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:49:44,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:49:44,362 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:49:44,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:49:44,362 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:49:44,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:49:44,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:49:44,363 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:49:44,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:44,363 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:49:44,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:44,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:44,363 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:44,363 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:49:44,364 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:49:44,364 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:49:44,364 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:49:44,372 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:49:44,372 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:44,373 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:44,373 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:44,375 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 122/400.
2025-08-04 20:49:44,476 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:44,476 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:44,477 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:49:44,477 - ClientAppLogger [Client 6] - INFO - [Client] Round 122: Training GAN with 26 samples (20 normal, 6 anomalous).
2025-08-04 20:49:44,477 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:49:44,502 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0764, Avg D Loss: 0.7759
2025-08-04 20:49:44,502 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0764, Avg D Loss: 0.7759
2025-08-04 20:49:44,502 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:49:44,509 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5181, Threshold=0.5657, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:49:44,510 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:49:44,510 - ClientAppLogger [Client 6] - INFO - Fit completed for round 122. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 122, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0763839960098265, 'd_loss': 0.775883024930954, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.13517332077026367, 'cpu_percent_fit': 12.81875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 26}
2025-08-04 20:49:44,510 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:49:49,807 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:49:49,807 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:49:49,807 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:49:49,807 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:49:49,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:49:49,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:49:50,156 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:49:50,156 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:49:50,247 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:49:50,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:49:50,285 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:49:50,371 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:49:50,377 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:49:50,378 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:49:50,384 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:49:50,391 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:49:50,391 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:49:50,392 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:49:50,392 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:49:50,392 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:49:50,400 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:49:50,403 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:50,405 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:49:50,407 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:49:50,410 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:49:50,412 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:49:50,415 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:49:50,417 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:49:50,420 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:49:50,422 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:49:50,424 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:49:50,432 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:49:50,432 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:49:50,437 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:49:50,437 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:49:50,443 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:49:50,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:49:50,454 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:49:50,454 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:49:50,455 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:49:50,469 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:49:50,473 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:49:50,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:49:50,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:49:50,478 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:49:50,478 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:49:50,478 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:49:50,479 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:49:50,479 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:49:50,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:49:50,479 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:49:50,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:49:50,481 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:49:50,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:49:50,481 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:49:50,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:49:50,481 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:49:50,481 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:49:50,481 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:49:50,482 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:49:50,482 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:49:50,482 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:49:50,482 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:49:50,482 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:49:50,482 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:49:50,482 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:49:50,483 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:49:50,483 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:49:50,483 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:49:50,483 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:49:50,483 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:49:50,483 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:49:50,483 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:49:50,484 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:49:50,484 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:49:50,484 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:49:50,484 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:49:50,484 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:49:50,485 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:49:50,485 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:49:50,491 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:49:50,491 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:49:50,492 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:49:50,492 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:49:50,493 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:49:50,494 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:49:50,494 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:49:50,494 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:49:50,503 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5455, Threshold=0.5969, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:49:50,503 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.5455
2025-08-04 20:50:04,779 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:04,779 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:04,779 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:04,780 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:50:04,780 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:50:04,780 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:05,109 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:05,110 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:05,202 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:50:05,228 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:50:05,228 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:05,347 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:05,355 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:05,355 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:05,361 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:50:05,372 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:05,372 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:50:05,373 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:05,373 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:05,373 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:50:05,382 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:05,385 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:05,387 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:05,389 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:05,392 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:05,394 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:05,396 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:05,399 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:05,402 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:05,404 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:05,406 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:05,416 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:05,416 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:50:05,421 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:50:05,421 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:50:05,427 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:05,428 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:50:05,442 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:05,442 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:50:05,442 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:05,459 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:05,465 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:50:05,475 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:50:05,476 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:05,476 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:05,476 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:05,477 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:05,477 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:05,477 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:50:05,477 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:05,478 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:50:05,478 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:05,479 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:50:05,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:50:05,480 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:05,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:50:05,480 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:05,481 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:05,481 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:05,481 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:50:05,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:50:05,481 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:50:05,481 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:50:05,482 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:50:05,482 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:50:05,482 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:50:05,483 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:50:05,483 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:50:05,483 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:50:05,483 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:50:05,483 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:50:05,483 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:05,484 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:50:05,484 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:05,484 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:05,484 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:05,485 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:50:05,485 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:50:05,485 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:50:05,485 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:50:05,492 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:50:05,492 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:05,493 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:05,494 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:05,495 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:05,495 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:05,496 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:05,496 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:05,505 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5608, Threshold=0.6127, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:50:05,505 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5608
2025-08-04 20:50:10,770 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:10,771 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:10,771 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:10,771 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:50:10,771 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:50:10,771 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:11,035 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:11,035 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:11,122 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:50:11,168 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:50:11,168 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:11,289 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:11,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:11,295 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:11,301 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:50:11,306 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:11,306 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:50:11,307 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:11,307 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:11,307 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:50:11,316 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:11,319 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:11,321 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:11,323 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:11,326 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:11,329 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:11,331 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:11,334 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:11,336 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:11,338 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:11,341 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:11,350 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:11,351 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:50:11,356 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:50:11,356 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:50:11,360 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:11,360 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:50:11,369 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:11,369 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:50:11,370 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:11,385 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:11,389 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:50:11,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:50:11,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:11,397 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:11,397 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:11,398 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:11,398 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:11,398 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:50:11,398 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:11,398 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:50:11,399 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:11,400 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:50:11,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:50:11,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:11,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:50:11,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:11,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:11,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:11,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:50:11,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:50:11,402 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:50:11,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:50:11,402 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:50:11,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:50:11,402 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:50:11,403 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:50:11,403 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:50:11,403 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:50:11,403 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:50:11,403 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:50:11,403 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:11,403 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:50:11,404 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:11,404 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:11,404 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:11,404 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:50:11,404 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:50:11,405 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:50:11,405 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:50:11,411 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:50:11,411 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:11,412 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:11,413 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:11,414 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 124/400.
2025-08-04 20:50:11,515 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:11,515 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:11,516 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:50:11,516 - ClientAppLogger [Client 6] - INFO - [Client] Round 124: Training GAN with 26 samples (20 normal, 6 anomalous).
2025-08-04 20:50:11,517 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:50:11,543 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0773, Avg D Loss: 0.7751
2025-08-04 20:50:11,544 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0773, Avg D Loss: 0.7751
2025-08-04 20:50:11,545 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:50:11,553 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5278, Threshold=0.5783, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:50:11,553 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:50:11,553 - ClientAppLogger [Client 6] - INFO - Fit completed for round 124. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 124, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.077318215370178, 'd_loss': 0.7751085221767425, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13924121856689453, 'cpu_percent_fit': 11.2875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 26}
2025-08-04 20:50:11,553 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:50:19,816 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:19,817 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:19,817 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:19,817 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:50:19,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:50:19,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:20,108 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:20,108 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:20,201 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:50:20,241 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:50:20,241 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:20,406 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:20,413 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:20,413 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:20,421 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:50:20,444 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:20,444 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:50:20,444 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:20,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:20,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:50:20,457 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:20,460 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:20,462 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:20,465 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:20,468 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:20,470 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:20,473 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:20,475 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:20,479 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:20,481 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:20,484 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:20,495 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:20,495 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:50:20,500 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:50:20,501 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:50:20,508 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:20,508 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:50:20,519 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:20,520 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:50:20,520 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:20,537 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:20,543 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:50:20,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:50:20,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:20,550 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:20,550 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:20,550 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:20,551 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:20,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:50:20,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:20,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:50:20,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:20,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:50:20,553 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:50:20,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:20,553 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:50:20,553 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:20,554 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:20,554 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:20,554 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:50:20,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:50:20,554 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:50:20,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:50:20,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:50:20,555 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:50:20,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:50:20,555 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:50:20,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:50:20,555 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:50:20,555 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:50:20,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:50:20,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:20,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:50:20,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:20,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:20,557 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:20,557 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:50:20,557 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:50:20,557 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:50:20,557 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:50:20,566 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:50:20,566 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:20,567 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:20,568 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:20,569 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:20,569 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:20,569 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:20,570 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:20,578 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5415, Threshold=0.5902, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:50:20,578 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.5415
2025-08-04 20:50:28,836 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:28,836 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:28,837 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:28,837 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:50:28,837 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:50:28,837 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:29,140 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:29,140 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:29,228 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:50:29,276 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:50:29,276 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:29,411 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:29,417 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:29,417 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:29,423 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:50:29,429 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:29,429 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:50:29,430 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:29,430 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:29,430 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:50:29,438 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:29,441 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:29,444 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:29,446 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:29,449 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:29,451 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:29,454 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:29,457 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:29,460 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:29,463 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:29,467 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:29,480 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:29,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:50:29,487 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:50:29,488 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:50:29,496 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:29,496 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:50:29,514 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:29,515 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:50:29,515 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:29,543 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:29,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:50:29,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:50:29,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:29,568 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:29,568 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:29,568 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:29,569 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:29,569 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:50:29,569 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:29,570 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:50:29,570 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:29,572 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:50:29,573 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:50:29,573 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:29,574 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:50:29,574 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:29,574 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:29,574 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:29,574 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:50:29,574 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:50:29,575 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:50:29,575 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:50:29,575 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:50:29,575 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:50:29,575 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:50:29,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:50:29,576 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:50:29,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:50:29,577 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:50:29,577 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:50:29,577 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:29,578 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:50:29,578 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:29,579 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:29,579 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:29,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:50:29,581 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:50:29,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:50:29,581 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:50:29,590 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:50:29,590 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:29,592 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:29,592 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:29,594 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 125/400.
2025-08-04 20:50:29,696 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:29,696 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:29,699 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:50:29,700 - ClientAppLogger [Client 6] - INFO - [Client] Round 125: Training GAN with 27 samples (21 normal, 6 anomalous).
2025-08-04 20:50:29,701 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:50:29,729 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0663, Avg D Loss: 0.7657
2025-08-04 20:50:29,729 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0663, Avg D Loss: 0.7657
2025-08-04 20:50:29,729 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:50:29,738 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5266, Threshold=0.5836, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:50:29,738 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:50:29,738 - ClientAppLogger [Client 6] - INFO - Fit completed for round 125. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 125, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.066341459751129, 'd_loss': 0.7656953573226929, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.14364290237426758, 'cpu_percent_fit': 11.6875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 27}
2025-08-04 20:50:29,738 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:50:38,002 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:38,002 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:38,002 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:38,003 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:50:38,003 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:50:38,003 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:38,361 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:38,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:38,454 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:50:38,497 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:50:38,497 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:38,603 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:38,610 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:38,610 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:38,617 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:50:38,626 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:38,626 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:50:38,627 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:38,627 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:38,627 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:50:38,637 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:38,640 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:38,642 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:38,644 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:38,647 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:38,649 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:38,652 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:38,654 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:38,657 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:38,659 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:38,662 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:38,672 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:38,672 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:50:38,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:50:38,678 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:50:38,685 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:38,686 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:50:38,702 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:38,702 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:50:38,702 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:38,720 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:38,726 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:50:38,733 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:50:38,733 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:38,734 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:38,734 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:38,734 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:38,734 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:38,735 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:50:38,735 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:38,735 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:50:38,735 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:38,736 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:50:38,737 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:50:38,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:38,737 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:50:38,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:38,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:38,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:38,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:50:38,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:50:38,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:50:38,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:50:38,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:50:38,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:50:38,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:50:38,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:50:38,739 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:50:38,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:50:38,739 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:50:38,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:50:38,739 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:38,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:50:38,740 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:38,740 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:38,740 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:38,740 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:50:38,740 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:50:38,740 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:50:38,741 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:50:38,748 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:50:38,748 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:38,749 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:38,749 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:38,751 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:38,751 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:38,751 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:38,752 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:38,760 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5453, Threshold=0.5909, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:50:38,761 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5453
2025-08-04 20:50:44,007 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:44,008 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:44,008 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:44,008 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:50:44,008 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:50:44,008 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:44,290 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:44,291 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:44,373 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:50:44,421 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:50:44,421 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:44,542 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:44,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:44,547 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:44,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:50:44,558 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:44,558 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:50:44,559 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:44,559 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:44,559 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:50:44,567 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:44,569 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:44,572 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:44,574 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:44,576 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:44,578 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:44,581 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:44,583 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:44,586 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:44,588 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:44,590 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:44,598 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:44,599 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:50:44,603 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:50:44,604 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:50:44,608 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:44,608 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:50:44,616 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:44,616 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:50:44,616 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:44,631 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:44,637 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:50:44,643 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:50:44,643 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:44,644 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:44,644 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:44,644 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:44,644 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:44,645 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:50:44,645 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:44,645 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:50:44,645 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:44,647 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:50:44,647 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:50:44,647 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:44,647 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:50:44,647 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:44,647 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:44,648 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:44,648 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:50:44,648 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:50:44,648 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:50:44,648 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:50:44,649 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:50:44,649 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:50:44,649 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:50:44,649 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:50:44,649 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:50:44,649 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:50:44,649 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:50:44,650 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:50:44,650 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:44,650 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:50:44,650 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:44,651 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:44,651 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:44,651 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:50:44,651 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:50:44,651 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:50:44,651 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:50:44,656 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:50:44,656 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:44,657 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:44,657 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:44,658 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 126/400.
2025-08-04 20:50:44,759 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:44,760 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:44,761 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:50:44,761 - ClientAppLogger [Client 6] - INFO - [Client] Round 126: Training GAN with 27 samples (21 normal, 6 anomalous).
2025-08-04 20:50:44,762 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:50:44,787 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0655, Avg D Loss: 0.7696
2025-08-04 20:50:44,787 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0655, Avg D Loss: 0.7696
2025-08-04 20:50:44,787 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:50:44,795 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5290, Threshold=0.5789, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:50:44,795 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:50:44,796 - ClientAppLogger [Client 6] - INFO - Fit completed for round 126. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 126, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.065472996234894, 'd_loss': 0.7695735394954681, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.13712048530578613, 'cpu_percent_fit': 10.40625, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 27}
2025-08-04 20:50:44,796 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:50:50,056 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:50,056 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:50,056 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:50,056 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:50:50,057 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:50:50,057 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:50,430 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:50,430 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:50,533 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:50:50,589 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:50:50,590 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:50,705 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:50,714 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:50,715 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:50,724 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:50:50,735 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:50,735 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:50:50,736 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:50,736 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:50,736 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:50:50,746 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:50,750 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:50,752 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:50,755 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:50,757 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:50,759 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:50,762 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:50,764 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:50,767 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:50,769 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:50,771 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:50,784 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:50,785 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:50:50,790 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:50:50,791 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:50:50,799 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:50,799 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:50:50,819 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:50,820 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:50:50,820 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:50,843 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:50,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:50:50,860 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:50:50,860 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:50,860 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:50,861 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:50,861 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:50,862 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:50,862 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:50:50,862 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:50,862 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:50:50,863 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:50,865 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:50:50,865 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:50:50,865 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:50,865 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:50:50,866 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:50,866 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:50,866 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:50,866 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:50:50,866 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:50:50,866 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:50:50,867 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:50:50,867 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:50:50,867 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:50:50,867 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:50:50,867 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:50:50,868 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:50:50,868 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:50:50,868 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:50:50,868 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:50:50,868 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:50,868 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:50:50,871 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:50,871 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:50,871 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:50,871 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:50:50,872 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:50:50,872 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:50:50,872 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:50:50,879 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:50:50,880 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:50,883 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:50,883 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:50,894 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:50:50,894 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:50,894 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:50,895 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:50:50,908 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5365, Threshold=0.5891, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:50:50,908 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5365
2025-08-04 20:50:59,174 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:50:59,175 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:50:59,175 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:50:59,175 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:50:59,175 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:50:59,175 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:50:59,431 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:50:59,432 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:50:59,517 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:50:59,565 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:50:59,566 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:50:59,690 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:50:59,697 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:50:59,697 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:50:59,703 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:50:59,708 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:50:59,708 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:50:59,709 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:50:59,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:50:59,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:50:59,718 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:50:59,721 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:59,724 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:50:59,726 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:50:59,729 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:50:59,731 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:50:59,733 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:50:59,736 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:50:59,739 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:50:59,741 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:50:59,743 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:50:59,754 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:50:59,755 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:50:59,759 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:50:59,760 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:50:59,765 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:50:59,765 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:50:59,774 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:50:59,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:50:59,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:50:59,793 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:50:59,798 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:50:59,809 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:50:59,809 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:50:59,809 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:50:59,809 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:50:59,810 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:50:59,810 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:50:59,810 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:50:59,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:50:59,810 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:50:59,811 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:50:59,812 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:50:59,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:50:59,812 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:50:59,813 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:50:59,813 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:50:59,813 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:50:59,813 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:50:59,813 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:50:59,813 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:50:59,813 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:50:59,814 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:50:59,814 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:50:59,814 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:50:59,814 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:50:59,814 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:50:59,815 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:50:59,815 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:50:59,815 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:50:59,815 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:50:59,815 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:50:59,815 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:50:59,816 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:50:59,816 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:50:59,816 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:50:59,816 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:50:59,816 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:50:59,817 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:50:59,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:50:59,821 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:50:59,821 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:50:59,822 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:50:59,823 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:50:59,824 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 127/400.
2025-08-04 20:50:59,926 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:50:59,926 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:50:59,927 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:50:59,928 - ClientAppLogger [Client 6] - INFO - [Client] Round 127: Training GAN with 27 samples (21 normal, 6 anomalous).
2025-08-04 20:50:59,928 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:50:59,956 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0756, Avg D Loss: 0.7668
2025-08-04 20:50:59,956 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0756, Avg D Loss: 0.7668
2025-08-04 20:50:59,957 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:50:59,967 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5288, Threshold=0.5832, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:50:59,968 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:50:59,968 - ClientAppLogger [Client 6] - INFO - Fit completed for round 127. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 127, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.075643014907837, 'd_loss': 0.7667944133281708, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.14364075660705566, 'cpu_percent_fit': 11.7875, 'ram_mb_fit': 1.7109375, 'accumulated_train_samples_this_round': 27}
2025-08-04 20:50:59,968 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:51:08,222 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:08,222 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:51:08,223 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:51:08,223 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:51:08,223 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:51:08,223 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:08,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:08,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:08,634 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:51:08,690 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:51:08,691 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:08,829 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:08,837 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:08,838 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:08,844 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:51:08,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:08,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:51:08,853 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:08,853 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:08,853 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:51:08,862 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:08,865 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:08,867 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:08,870 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:08,873 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:08,875 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:08,877 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:08,879 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:08,882 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:08,884 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:08,886 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:08,897 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:08,898 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:51:08,903 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:51:08,903 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:51:08,909 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:08,909 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:51:08,921 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:08,922 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:51:08,922 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:08,941 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:08,947 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:51:08,956 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:51:08,957 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:08,957 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:08,957 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:08,957 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:08,958 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:08,958 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:51:08,958 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:08,958 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:51:08,958 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:08,960 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:51:08,960 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:51:08,961 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:08,961 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:51:08,961 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:08,961 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:08,962 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:08,962 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:51:08,962 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:51:08,962 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:51:08,962 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:51:08,962 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:51:08,962 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:51:08,963 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:51:08,963 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:51:08,963 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:51:08,963 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:51:08,963 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:51:08,963 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:51:08,963 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:08,964 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:51:08,964 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:08,964 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:08,964 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:08,965 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:51:08,965 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:51:08,965 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:51:08,965 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:51:08,972 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:51:08,972 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:08,973 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:08,974 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:51:08,975 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:08,976 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:08,976 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:08,976 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:08,986 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5396, Threshold=0.5918, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:51:08,986 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5396
2025-08-04 20:51:23,261 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:23,262 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:51:23,262 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:51:23,262 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:51:23,262 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:51:23,262 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:23,534 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:23,535 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:23,620 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:51:23,648 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:51:23,648 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:23,784 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:23,793 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:23,793 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:23,800 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:51:23,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:23,809 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:51:23,809 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:23,809 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:23,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:51:23,819 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:23,822 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:23,824 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:23,827 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:23,830 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:23,832 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:23,834 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:23,837 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:23,840 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:23,842 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:23,844 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:23,856 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:23,857 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:51:23,862 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:51:23,862 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:51:23,868 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:23,868 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:51:23,881 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:23,882 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:51:23,882 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:23,899 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:23,904 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:51:23,911 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:51:23,911 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:23,911 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:23,911 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:23,912 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:23,912 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:23,912 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:51:23,912 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:23,913 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:51:23,913 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:23,914 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:51:23,915 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:51:23,915 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:23,915 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:51:23,915 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:23,915 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:23,916 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:23,916 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:51:23,916 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:51:23,916 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:51:23,916 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:51:23,916 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:51:23,917 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:51:23,917 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:51:23,917 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:51:23,917 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:51:23,917 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:51:23,917 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:51:23,917 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:51:23,918 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:23,918 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:51:23,918 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:23,918 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:23,918 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:23,919 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:51:23,919 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:51:23,919 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:51:23,919 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:51:23,925 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:51:23,925 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:23,926 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:23,926 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:51:23,928 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:23,928 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:23,928 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:23,929 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:23,937 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5322, Threshold=0.5776, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:51:23,937 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5322
2025-08-04 20:51:41,211 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:41,211 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:51:41,211 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:51:41,211 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:51:41,211 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:51:41,211 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:41,459 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:41,459 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:41,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:51:41,566 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:51:41,567 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:41,664 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:41,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:41,669 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:41,674 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:51:41,680 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:41,680 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:51:41,681 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:41,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:41,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:51:41,689 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:41,692 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:41,695 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:41,697 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:41,700 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:41,702 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:41,705 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:41,707 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:41,710 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:41,712 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:41,714 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:41,724 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:41,725 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:51:41,730 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:51:41,730 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:51:41,736 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:41,736 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:51:41,748 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:41,749 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:51:41,749 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:41,765 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:41,770 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:51:41,775 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:51:41,776 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:41,776 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:41,776 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:41,776 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:41,776 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:41,777 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:51:41,777 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:41,777 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:51:41,777 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:41,779 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:51:41,779 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:51:41,779 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:41,780 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:51:41,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:41,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:41,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:41,780 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:51:41,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:51:41,781 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:51:41,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:51:41,781 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:51:41,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:51:41,782 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:51:41,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:51:41,782 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:51:41,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:51:41,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:51:41,783 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:51:41,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:41,783 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:51:41,783 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:41,784 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:41,784 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:41,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:51:41,784 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:51:41,784 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:51:41,784 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:51:41,787 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:51:41,788 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:41,789 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:41,789 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:51:41,791 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:41,791 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:41,791 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:41,792 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:41,800 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5327, Threshold=0.5820, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:51:41,800 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5327
2025-08-04 20:51:47,052 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:47,052 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:51:47,052 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:51:47,053 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:51:47,053 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:51:47,053 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:47,314 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:47,315 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:47,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:51:47,439 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:51:47,439 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:47,551 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:47,557 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:47,557 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:47,563 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:51:47,568 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:47,568 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:51:47,569 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:47,569 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:47,569 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:51:47,577 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:47,580 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:47,583 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:47,585 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:47,588 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:47,590 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:47,593 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:47,596 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:47,598 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:47,600 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:47,602 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:47,611 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:47,612 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:51:47,617 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:51:47,617 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:51:47,621 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:47,621 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:51:47,630 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:47,630 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:51:47,630 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:47,645 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:47,650 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:51:47,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:51:47,657 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:47,657 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:47,657 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:47,657 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:47,658 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:47,658 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:51:47,658 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:47,658 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:51:47,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:47,660 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:51:47,660 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:51:47,660 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:47,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:51:47,661 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:47,661 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:47,661 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:47,661 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:51:47,662 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:51:47,662 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:51:47,662 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:51:47,662 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:51:47,662 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:51:47,662 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:51:47,662 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:51:47,663 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:51:47,663 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:51:47,663 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:51:47,663 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:51:47,663 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:47,663 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:51:47,663 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:47,664 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:47,664 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:47,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:51:47,664 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:51:47,664 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:51:47,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:51:47,671 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:51:47,671 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:47,672 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:47,672 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:51:47,673 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 130/400.
2025-08-04 20:51:47,775 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:47,775 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:47,777 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:51:47,777 - ClientAppLogger [Client 6] - INFO - [Client] Round 130: Training GAN with 27 samples (21 normal, 6 anomalous).
2025-08-04 20:51:47,777 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:51:47,803 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0823, Avg D Loss: 0.8008
2025-08-04 20:51:47,804 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0823, Avg D Loss: 0.8008
2025-08-04 20:51:47,804 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:51:47,812 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5267, Threshold=0.5747, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:51:47,812 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:51:47,812 - ClientAppLogger [Client 6] - INFO - Fit completed for round 130. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 130, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.082321548461914, 'd_loss': 0.800801682472229, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.13891005516052246, 'cpu_percent_fit': 11.6, 'ram_mb_fit': 3.45703125, 'accumulated_train_samples_this_round': 27}
2025-08-04 20:51:47,813 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:51:56,068 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:51:56,068 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:51:56,068 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:51:56,068 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:51:56,069 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:51:56,069 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:51:56,317 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:51:56,318 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:51:56,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:51:56,424 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:51:56,424 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:51:56,540 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:51:56,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:51:56,548 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:51:56,553 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:51:56,567 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:51:56,568 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:51:56,568 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:51:56,568 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:51:56,568 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:51:56,578 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:51:56,580 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:56,582 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:51:56,584 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:51:56,587 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:51:56,590 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:51:56,592 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:51:56,595 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:51:56,598 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:51:56,600 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:51:56,602 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:51:56,612 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:51:56,612 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:51:56,617 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:51:56,617 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:51:56,622 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:51:56,623 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:51:56,633 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:51:56,634 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:51:56,634 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:51:56,651 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:51:56,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:51:56,662 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:51:56,662 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:51:56,663 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:51:56,663 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:51:56,663 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:51:56,663 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:51:56,664 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:51:56,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:51:56,664 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:51:56,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:51:56,665 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:51:56,665 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:51:56,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:51:56,666 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:51:56,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:51:56,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:51:56,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:51:56,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:51:56,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:51:56,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:51:56,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:51:56,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:51:56,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:51:56,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:51:56,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:51:56,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:51:56,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:51:56,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:51:56,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:51:56,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:51:56,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:51:56,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:51:56,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:51:56,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:51:56,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:51:56,669 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:51:56,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:51:56,670 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:51:56,677 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:51:56,677 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:51:56,678 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:51:56,678 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:51:56,680 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:51:56,680 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:51:56,680 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:51:56,681 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:51:56,688 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5006, Threshold=0.5347, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:51:56,688 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5006
2025-08-04 20:52:07,952 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:07,952 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:07,952 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:07,952 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:52:07,952 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:52:07,952 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:08,190 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:08,190 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:08,274 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:52:08,320 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:52:08,320 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:08,438 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:08,445 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:08,445 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:08,451 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:52:08,456 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:08,457 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:52:08,457 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:08,457 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:08,457 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:52:08,466 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:08,469 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:08,471 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:08,473 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:08,476 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:08,478 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:08,481 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:08,483 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:08,486 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:08,488 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:08,490 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:08,500 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:08,500 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:52:08,505 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:52:08,505 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:52:08,510 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:08,510 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:52:08,520 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:08,520 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:52:08,520 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:08,536 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:08,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:52:08,555 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:52:08,555 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:08,555 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:08,555 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:08,556 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:08,556 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:08,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:52:08,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:08,557 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:52:08,557 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:08,558 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:52:08,558 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:52:08,559 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:08,559 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:52:08,559 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:08,559 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:08,559 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:08,560 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:52:08,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:52:08,560 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:52:08,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:52:08,560 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:52:08,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:52:08,560 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:52:08,561 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:52:08,561 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:52:08,561 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:52:08,561 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:52:08,561 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:52:08,561 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:08,561 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:52:08,562 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:08,562 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:08,562 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:08,562 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:52:08,563 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:52:08,563 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:52:08,563 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:52:08,569 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:52:08,569 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:08,571 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:08,571 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:08,572 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:08,572 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:08,572 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:08,573 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:08,581 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5295, Threshold=0.5746, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:52:08,581 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5295
2025-08-04 20:52:13,838 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:13,838 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:13,838 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:13,838 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:52:13,838 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:52:13,838 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:14,100 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:14,100 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:14,181 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:52:14,222 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:52:14,222 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:14,333 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:14,339 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:14,339 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:14,344 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:52:14,351 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:14,351 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:52:14,352 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:14,352 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:14,352 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:52:14,360 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:14,363 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:14,366 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:14,368 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:14,371 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:14,373 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:14,375 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:14,378 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:14,381 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:14,383 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:14,385 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:14,394 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:14,394 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:52:14,399 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:52:14,399 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:52:14,403 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:14,403 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:52:14,411 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:14,412 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:52:14,412 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:14,426 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:14,431 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:52:14,436 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:52:14,436 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:14,436 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:14,436 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:14,437 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:14,437 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:14,437 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:52:14,437 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:14,438 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:52:14,438 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:14,439 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:52:14,439 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:52:14,439 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:14,440 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:52:14,440 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:14,440 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:14,440 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:14,440 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:52:14,440 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:52:14,440 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:52:14,441 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:52:14,441 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:52:14,441 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:52:14,441 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:52:14,441 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:52:14,441 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:52:14,442 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:52:14,442 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:52:14,442 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:52:14,442 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:14,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:52:14,443 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:14,443 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:14,443 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:14,443 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:52:14,444 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:52:14,444 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:52:14,444 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:52:14,452 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:52:14,453 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:14,454 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:14,454 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:14,456 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 132/400.
2025-08-04 20:52:14,557 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:14,557 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:14,558 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:52:14,558 - ClientAppLogger [Client 6] - INFO - [Client] Round 132: Training GAN with 27 samples (21 normal, 6 anomalous).
2025-08-04 20:52:14,559 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:14,585 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0848, Avg D Loss: 0.8007
2025-08-04 20:52:14,585 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0848, Avg D Loss: 0.8007
2025-08-04 20:52:14,585 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:14,593 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5249, Threshold=0.5711, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:52:14,593 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:52:14,593 - ClientAppLogger [Client 6] - INFO - Fit completed for round 132. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 132, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0847584009170532, 'd_loss': 0.8006651103496552, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13768315315246582, 'cpu_percent_fit': 12.025, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 27}
2025-08-04 20:52:14,593 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:52:19,876 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:19,876 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:19,877 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:19,877 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:52:19,877 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:52:19,877 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:20,139 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:20,140 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:20,221 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:52:20,258 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:52:20,258 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:20,348 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:20,355 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:20,355 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:20,362 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:52:20,369 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:20,370 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:52:20,370 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:20,370 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:20,370 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:52:20,380 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:20,383 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:20,385 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:20,387 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:20,390 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:20,392 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:20,394 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:20,397 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:20,399 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:20,401 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:20,403 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:20,413 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:20,413 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:52:20,418 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:52:20,418 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:52:20,425 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:20,425 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:52:20,437 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:20,438 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:52:20,438 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:20,454 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:20,458 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:52:20,463 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:52:20,463 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:20,464 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:20,464 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:20,464 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:20,464 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:20,465 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:52:20,465 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:20,465 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:52:20,465 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:20,466 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:52:20,466 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:52:20,467 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:20,467 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:52:20,467 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:20,467 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:20,467 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:20,467 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:52:20,468 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:52:20,468 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:52:20,468 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:52:20,468 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:52:20,468 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:52:20,468 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:52:20,469 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:52:20,469 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:52:20,469 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:52:20,469 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:52:20,469 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:52:20,469 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:20,469 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:52:20,470 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:20,470 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:20,470 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:20,470 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:52:20,470 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:52:20,471 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:52:20,471 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:52:20,477 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:52:20,477 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:20,478 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:20,478 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:20,480 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:20,480 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:20,480 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:20,481 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:20,489 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5506, Threshold=0.5981, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:52:20,489 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5506
2025-08-04 20:52:25,744 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:25,744 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:25,744 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:25,744 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:52:25,745 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:52:25,745 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:25,996 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:25,997 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:26,077 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:52:26,099 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:52:26,099 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:26,185 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:26,191 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:26,191 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:26,197 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:52:26,207 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:26,207 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:52:26,208 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:26,208 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:26,208 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:52:26,216 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:26,219 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:26,221 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:26,223 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:26,226 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:26,228 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:26,231 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:26,233 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:26,236 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:26,238 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:26,241 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:26,251 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:26,251 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:52:26,256 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:52:26,256 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:52:26,261 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:26,261 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:52:26,272 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:26,272 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:52:26,272 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:26,287 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:26,291 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:52:26,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:52:26,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:26,296 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:26,296 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:26,296 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:26,296 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:26,296 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:52:26,297 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:26,297 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:52:26,297 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:26,298 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:52:26,298 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:52:26,299 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:26,299 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:52:26,299 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:26,299 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:26,299 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:26,299 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:52:26,300 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:52:26,300 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:52:26,300 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:52:26,300 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:52:26,300 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:52:26,300 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:52:26,300 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:52:26,301 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:52:26,301 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:52:26,301 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:52:26,301 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:52:26,301 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:26,301 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:52:26,302 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:26,302 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:26,302 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:26,302 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:52:26,302 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:52:26,303 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:52:26,303 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:52:26,308 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:52:26,308 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:26,309 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:26,309 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:26,310 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 133/400.
2025-08-04 20:52:26,411 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:26,411 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:26,412 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:52:26,412 - ClientAppLogger [Client 6] - INFO - [Client] Round 133: Training GAN with 28 samples (22 normal, 6 anomalous).
2025-08-04 20:52:26,413 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:26,438 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0744, Avg D Loss: 0.7995
2025-08-04 20:52:26,438 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0744, Avg D Loss: 0.7995
2025-08-04 20:52:26,438 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:26,447 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5227, Threshold=0.5689, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:52:26,447 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:52:26,447 - ClientAppLogger [Client 6] - INFO - Fit completed for round 133. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 133, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0744324207305906, 'd_loss': 0.7995412707328796, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.13651347160339355, 'cpu_percent_fit': 12.1125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 28}
2025-08-04 20:52:26,447 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:52:37,722 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:37,722 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:37,722 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:37,722 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:52:37,722 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:52:37,723 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:38,005 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:38,005 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:38,084 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:52:38,099 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:52:38,099 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:38,184 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:38,191 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:38,191 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:38,195 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:52:38,201 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:38,201 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:52:38,201 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:38,201 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:38,201 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:52:38,209 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:38,212 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:38,215 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:38,217 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:38,220 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:38,222 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:38,225 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:38,227 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:38,230 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:38,232 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:38,234 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:38,243 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:38,243 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:52:38,248 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:52:38,249 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:52:38,254 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:38,254 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:52:38,265 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:38,265 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:52:38,265 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:38,279 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:38,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:52:38,288 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:52:38,288 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:38,288 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:38,288 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:38,289 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:38,289 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:38,289 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:52:38,289 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:38,289 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:52:38,290 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:38,291 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:52:38,291 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:52:38,292 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:38,292 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:52:38,292 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:38,292 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:38,292 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:38,292 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:52:38,293 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:52:38,293 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:52:38,293 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:52:38,293 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:52:38,293 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:52:38,294 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:52:38,294 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:52:38,294 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:52:38,294 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:52:38,294 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:52:38,294 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:52:38,294 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:38,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:52:38,295 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:38,295 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:38,295 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:38,296 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:52:38,296 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:52:38,296 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:52:38,296 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:52:38,298 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:52:38,298 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:38,299 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:38,299 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:38,301 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:38,301 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:38,301 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:38,301 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:38,309 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5904, Threshold=0.6423, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:52:38,309 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5904
2025-08-04 20:52:49,614 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:49,614 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:49,614 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:49,614 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:52:49,614 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:52:49,615 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:49,944 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:49,944 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:50,031 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:52:50,074 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:52:50,075 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:50,208 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:50,214 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:50,214 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:50,219 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:52:50,225 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:50,225 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:52:50,226 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:50,226 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:50,226 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:52:50,235 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:50,238 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:50,240 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:50,242 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:50,245 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:50,248 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:50,250 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:50,253 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:50,256 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:50,258 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:50,260 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:50,271 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:50,271 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:52:50,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:52:50,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:52:50,284 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:50,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:52:50,293 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:50,293 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:52:50,294 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:50,310 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:50,315 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:52:50,320 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:52:50,320 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:50,321 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:50,321 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:50,321 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:50,321 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:50,322 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:52:50,322 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:50,322 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:52:50,322 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:50,324 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:52:50,324 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:52:50,325 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:50,325 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:52:50,325 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:50,325 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:50,326 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:50,326 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:52:50,326 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:52:50,327 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:52:50,327 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:52:50,327 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:52:50,327 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:52:50,327 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:52:50,328 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:52:50,328 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:52:50,329 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:52:50,329 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:52:50,329 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:52:50,329 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:50,329 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:52:50,330 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:50,330 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:50,330 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:50,330 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:52:50,331 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:52:50,331 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:52:50,331 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:52:50,337 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:52:50,337 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:50,338 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:50,338 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:50,339 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:52:50,340 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:50,340 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:50,340 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:52:50,349 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5245, Threshold=0.5608, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:52:50,350 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5245
2025-08-04 20:52:55,615 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:52:55,615 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:52:55,615 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:52:55,615 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:52:55,615 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:52:55,615 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:52:55,982 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:52:55,982 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:52:56,070 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:52:56,084 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:52:56,084 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:52:56,180 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:52:56,186 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:52:56,186 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:52:56,192 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:52:56,198 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:52:56,198 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:52:56,198 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:52:56,199 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:52:56,199 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:52:56,207 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:52:56,210 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:56,212 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:52:56,214 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:52:56,217 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:52:56,219 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:52:56,222 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:52:56,225 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:52:56,228 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:52:56,230 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:52:56,232 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:52:56,241 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:52:56,241 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:52:56,247 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:52:56,247 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:52:56,253 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:52:56,253 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:52:56,267 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:52:56,268 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:52:56,268 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:52:56,283 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:52:56,288 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:52:56,293 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:52:56,293 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:52:56,293 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:52:56,293 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:52:56,294 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:52:56,294 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:52:56,294 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:52:56,294 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:52:56,294 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:52:56,295 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:52:56,296 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:52:56,296 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:52:56,297 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:52:56,297 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:52:56,297 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:52:56,297 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:52:56,297 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:52:56,297 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:52:56,298 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:52:56,298 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:52:56,298 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:52:56,298 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:52:56,298 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:52:56,299 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:52:56,299 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:52:56,299 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:52:56,299 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:52:56,299 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:52:56,299 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:52:56,299 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:52:56,299 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:52:56,300 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:52:56,300 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:52:56,300 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:52:56,300 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:52:56,300 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:52:56,300 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:52:56,301 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:52:56,307 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:52:56,307 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:52:56,309 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:52:56,309 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:52:56,311 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 135/400.
2025-08-04 20:52:56,412 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:52:56,412 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:52:56,413 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:52:56,413 - ClientAppLogger [Client 6] - INFO - [Client] Round 135: Training GAN with 28 samples (22 normal, 6 anomalous).
2025-08-04 20:52:56,413 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:52:56,443 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0766, Avg D Loss: 0.7942
2025-08-04 20:52:56,443 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0766, Avg D Loss: 0.7942
2025-08-04 20:52:56,443 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:52:56,452 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5207, Threshold=0.5665, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:52:56,452 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:52:56,452 - ClientAppLogger [Client 6] - INFO - Fit completed for round 135. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 135, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.07663209438324, 'd_loss': 0.7941774487495422, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.14154744148254395, 'cpu_percent_fit': 12.325, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 28}
2025-08-04 20:52:56,452 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:53:01,734 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:01,734 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:01,735 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:01,735 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:53:01,735 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:53:01,735 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:02,101 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:02,102 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:02,192 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:53:02,245 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:53:02,245 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:02,403 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:02,413 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:02,414 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:02,423 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:53:02,434 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:02,434 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:53:02,434 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:02,435 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:02,435 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:53:02,444 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:02,447 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:02,449 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:02,452 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:02,455 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:02,457 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:02,459 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:02,462 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:02,465 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:02,467 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:02,470 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:02,482 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:02,482 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:53:02,488 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:53:02,489 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:53:02,497 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:02,497 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:53:02,510 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:02,510 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:53:02,510 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:02,528 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:02,534 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:53:02,539 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:53:02,539 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:02,539 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:02,539 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:02,540 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:02,540 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:02,540 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:53:02,540 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:02,541 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:53:02,541 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:02,543 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:53:02,544 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:53:02,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:02,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:53:02,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:02,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:02,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:02,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:53:02,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:53:02,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:53:02,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:53:02,548 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:53:02,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:53:02,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:53:02,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:53:02,550 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:53:02,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:53:02,550 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:53:02,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:53:02,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:02,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:53:02,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:02,551 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:02,552 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:02,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:53:02,552 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:53:02,552 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:53:02,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:53:02,561 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:53:02,561 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:02,562 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:02,563 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:02,564 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:02,564 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:02,564 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:02,565 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:02,573 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5331, Threshold=0.5808, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:53:02,574 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5331
2025-08-04 20:53:13,833 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:13,833 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:13,833 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:13,833 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:53:13,833 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:53:13,833 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:14,142 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:14,143 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:14,230 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:53:14,281 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:53:14,281 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:14,442 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:14,450 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:14,451 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:14,459 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:53:14,469 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:14,469 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:53:14,470 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:14,470 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:14,470 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:53:14,480 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:14,484 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:14,486 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:14,488 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:14,491 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:14,494 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:14,498 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:14,500 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:14,503 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:14,505 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:14,508 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:14,520 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:14,520 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:53:14,527 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:53:14,527 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:53:14,535 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:14,535 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:53:14,551 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:14,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:53:14,552 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:14,578 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:14,584 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:53:14,589 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:53:14,589 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:14,589 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:14,589 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:14,590 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:14,590 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:14,591 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:53:14,591 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:14,591 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:53:14,591 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:14,593 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:53:14,593 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:53:14,593 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:14,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:53:14,594 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:14,594 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:14,594 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:14,594 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:53:14,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:53:14,594 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:53:14,595 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:53:14,595 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:53:14,595 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:53:14,595 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:53:14,595 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:53:14,596 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:53:14,596 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:53:14,596 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:53:14,596 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:53:14,596 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:14,596 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:53:14,597 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:14,597 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:14,597 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:14,597 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:53:14,597 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:53:14,598 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:53:14,598 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:53:14,608 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:53:14,608 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:14,610 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:14,610 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:14,612 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:14,612 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:14,612 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:14,613 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:14,623 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5624, Threshold=0.6105, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:53:14,623 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5624
2025-08-04 20:53:19,875 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:19,875 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:19,875 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:19,875 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:53:19,875 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:53:19,875 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:20,128 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:20,128 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:20,208 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:53:20,247 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:53:20,247 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:20,356 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:20,361 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:20,362 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:20,367 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:53:20,374 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:20,374 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:53:20,375 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:20,375 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:20,375 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:53:20,383 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:20,386 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:20,388 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:20,391 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:20,393 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:20,395 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:20,398 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:20,400 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:20,403 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:20,405 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:20,407 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:20,415 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:20,415 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:53:20,420 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:53:20,420 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:53:20,424 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:20,425 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:53:20,433 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:20,433 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:53:20,434 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:20,447 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:20,452 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:53:20,456 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:53:20,456 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:20,456 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:20,456 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:20,457 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:20,457 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:20,457 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:53:20,457 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:20,458 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:53:20,458 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:20,459 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:53:20,459 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:53:20,460 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:20,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:53:20,460 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:20,460 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:20,460 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:20,460 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:53:20,461 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:53:20,461 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:53:20,461 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:53:20,461 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:53:20,461 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:53:20,461 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:53:20,461 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:53:20,461 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:53:20,462 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:53:20,462 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:53:20,462 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:53:20,462 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:20,462 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:53:20,462 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:20,462 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:20,463 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:20,463 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:53:20,463 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:53:20,463 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:53:20,463 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:53:20,470 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:53:20,471 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:20,472 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:20,472 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:20,473 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 137/400.
2025-08-04 20:53:20,574 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:20,574 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:20,575 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:53:20,576 - ClientAppLogger [Client 6] - INFO - [Client] Round 137: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:53:20,576 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:53:20,610 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0720, Avg D Loss: 0.7958
2025-08-04 20:53:20,610 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0720, Avg D Loss: 0.7958
2025-08-04 20:53:20,611 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:53:20,618 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5232, Threshold=0.5725, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:53:20,619 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:53:20,619 - ClientAppLogger [Client 6] - INFO - Fit completed for round 137. Duration: 0.15s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 137, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0720431804656982, 'd_loss': 0.7958344221115112, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.1456902027130127, 'cpu_percent_fit': 9.7125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:53:20,619 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:53:34,887 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:34,887 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:34,887 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:34,887 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:53:34,887 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:53:34,887 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:35,250 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:35,251 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:35,338 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:53:35,378 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:53:35,378 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:35,498 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:35,506 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:35,506 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:35,514 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:53:35,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:35,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:53:35,550 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:35,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:35,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:53:35,562 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:35,565 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:35,568 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:35,570 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:35,573 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:35,575 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:35,578 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:35,581 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:35,585 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:35,587 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:35,589 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:35,600 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:35,600 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:53:35,605 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:53:35,606 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:53:35,612 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:35,612 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:53:35,628 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:35,628 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:53:35,628 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:35,649 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:35,655 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:53:35,663 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:53:35,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:35,664 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:35,665 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:35,665 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:35,665 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:35,665 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:53:35,666 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:35,666 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:53:35,666 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:35,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:53:35,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:53:35,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:35,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:53:35,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:35,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:35,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:35,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:53:35,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:53:35,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:53:35,670 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:53:35,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:53:35,670 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:53:35,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:53:35,670 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:53:35,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:53:35,671 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:53:35,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:53:35,671 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:53:35,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:35,671 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:53:35,672 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:35,672 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:35,672 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:35,672 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:53:35,672 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:53:35,673 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:53:35,673 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:53:35,685 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:53:35,688 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:35,690 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:35,690 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:35,692 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:35,695 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:35,695 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:35,696 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:35,706 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5612, Threshold=0.6051, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:53:35,707 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5612
2025-08-04 20:53:55,993 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:53:55,993 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:53:55,993 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:53:55,993 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:53:55,993 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:53:55,993 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:53:56,267 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:53:56,267 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:53:56,351 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:53:56,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:53:56,401 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:53:56,543 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:53:56,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:53:56,552 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:53:56,558 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:53:56,565 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:53:56,565 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:53:56,566 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:53:56,566 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:53:56,566 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:53:56,575 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:53:56,578 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:56,580 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:53:56,582 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:53:56,585 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:53:56,587 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:53:56,590 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:53:56,592 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:53:56,595 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:53:56,597 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:53:56,599 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:53:56,612 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:53:56,612 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:53:56,617 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:53:56,618 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:53:56,624 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:53:56,624 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:53:56,639 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:53:56,640 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:53:56,640 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:53:56,659 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:53:56,665 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:53:56,675 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:53:56,676 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:53:56,676 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:53:56,676 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:53:56,676 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:53:56,677 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:53:56,677 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:53:56,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:53:56,677 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:53:56,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:53:56,679 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:53:56,679 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:53:56,679 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:53:56,679 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:53:56,679 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:53:56,680 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:53:56,680 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:53:56,680 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:53:56,680 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:53:56,680 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:53:56,680 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:53:56,681 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:53:56,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:53:56,681 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:53:56,681 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:53:56,682 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:53:56,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:53:56,682 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:53:56,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:53:56,682 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:53:56,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:53:56,683 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:53:56,683 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:53:56,683 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:53:56,683 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:53:56,683 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:53:56,684 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:53:56,684 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:53:56,688 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:53:56,688 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:53:56,689 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:53:56,690 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:53:56,691 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:53:56,691 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:53:56,691 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:53:56,693 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:53:56,701 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5510, Threshold=0.5998, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:53:56,701 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5510
2025-08-04 20:54:01,967 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:01,968 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:01,968 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:01,968 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:54:01,968 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:54:01,968 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:02,250 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:02,250 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:02,331 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:54:02,373 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:54:02,373 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:02,482 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:02,488 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:02,488 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:02,493 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:54:02,498 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:02,498 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:54:02,499 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:02,499 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:02,499 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:54:02,507 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:02,510 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:02,512 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:02,514 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:02,517 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:02,519 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:02,521 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:02,524 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:02,526 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:02,529 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:02,532 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:02,542 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:02,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:54:02,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:54:02,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:54:02,551 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:02,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:54:02,560 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:02,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:54:02,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:02,574 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:02,579 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:54:02,584 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:54:02,584 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:02,584 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:02,585 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:02,585 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:02,585 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:02,586 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:54:02,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:02,586 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:54:02,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:02,588 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:54:02,588 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:54:02,588 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:02,588 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:54:02,589 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:02,589 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:02,589 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:02,589 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:54:02,589 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:54:02,589 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:54:02,590 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:54:02,590 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:54:02,590 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:54:02,590 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:54:02,590 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:54:02,590 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:54:02,590 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:54:02,591 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:54:02,591 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:54:02,591 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:02,591 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:54:02,591 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:02,591 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:02,592 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:02,592 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:54:02,592 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:54:02,592 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:54:02,592 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:54:02,600 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:54:02,600 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:02,601 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:02,601 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:02,602 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 139/400.
2025-08-04 20:54:02,703 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:02,704 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:02,705 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 6 anomalous samples to GAN training data (target: 6).
2025-08-04 20:54:02,705 - ClientAppLogger [Client 6] - INFO - [Client] Round 139: Training GAN with 29 samples (23 normal, 6 anomalous).
2025-08-04 20:54:02,705 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:54:02,731 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0862, Avg D Loss: 0.7931
2025-08-04 20:54:02,731 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0862, Avg D Loss: 0.7931
2025-08-04 20:54:02,731 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:54:02,739 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5322, Threshold=0.5855, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:54:02,739 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:54:02,739 - ClientAppLogger [Client 6] - INFO - Fit completed for round 139. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 139, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.086157202720642, 'd_loss': 0.7930513083934784, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.13643121719360352, 'cpu_percent_fit': 12.3125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 29}
2025-08-04 20:54:02,739 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:54:14,028 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:14,028 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:14,028 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:14,028 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:54:14,029 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:54:14,029 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:14,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:14,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:14,488 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:54:14,535 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:54:14,535 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:14,752 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:14,763 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:14,763 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:14,770 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:54:14,790 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:14,791 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:54:14,791 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:14,792 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:14,792 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:54:14,803 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:14,806 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:14,809 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:14,812 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:14,815 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:14,818 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:14,821 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:14,823 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:14,826 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:14,828 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:14,832 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:14,849 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:14,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:54:14,857 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:54:14,858 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:54:14,870 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:14,870 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:54:14,897 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:14,898 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:54:14,898 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:14,922 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:14,930 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:54:14,940 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:54:14,940 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:14,940 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:14,940 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:14,941 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:14,941 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:14,941 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:54:14,942 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:14,942 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:54:14,942 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:14,944 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:54:14,944 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:54:14,945 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:14,945 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:54:14,946 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:14,946 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:14,946 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:14,946 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:54:14,946 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:54:14,947 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:54:14,947 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:54:14,947 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:54:14,947 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:54:14,948 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:54:14,948 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:54:14,948 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:54:14,948 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:54:14,948 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:54:14,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:54:14,949 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:14,949 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:54:14,950 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:14,950 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:14,950 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:14,951 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:54:14,951 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:54:14,951 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:54:14,952 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:54:14,967 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:54:14,968 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:14,970 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:14,970 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:14,972 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:14,973 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:14,973 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:14,975 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:14,985 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5894, Threshold=0.6462, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:54:14,986 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5894
2025-08-04 20:54:32,279 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:32,279 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:32,279 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:32,279 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:54:32,279 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:54:32,279 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:32,570 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:32,570 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:32,654 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:54:32,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:54:32,692 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:32,789 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:32,795 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:32,795 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:32,801 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:54:32,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:32,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:54:32,809 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:32,809 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:32,809 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:54:32,818 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:32,821 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:32,824 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:32,826 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:32,829 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:32,831 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:32,833 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:32,836 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:32,839 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:32,841 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:32,843 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:32,853 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:32,853 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:54:32,858 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:54:32,858 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:54:32,864 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:32,864 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:54:32,875 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:32,875 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:54:32,875 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:32,892 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:32,898 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:54:32,904 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:54:32,904 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:32,904 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:32,904 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:32,905 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:32,905 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:32,906 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:54:32,906 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:32,906 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:54:32,907 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:32,908 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:54:32,908 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:54:32,909 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:32,909 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:54:32,909 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:32,909 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:32,910 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:32,910 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:54:32,910 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:54:32,910 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:54:32,910 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:54:32,911 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:54:32,911 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:54:32,911 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:54:32,911 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:54:32,911 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:54:32,912 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:54:32,912 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:54:32,912 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:54:32,912 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:32,912 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:54:32,913 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:32,913 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:32,913 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:32,914 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:54:32,914 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:54:32,914 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:54:32,914 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:54:32,921 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:54:32,921 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:32,922 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:32,922 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:32,923 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:32,924 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:32,924 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:32,924 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:32,932 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5431, Threshold=0.5863, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:54:32,932 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5431
2025-08-04 20:54:38,198 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:38,198 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:38,199 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:38,200 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:54:38,200 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:54:38,200 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:38,502 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:38,503 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:38,584 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:54:38,626 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:54:38,626 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:38,739 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:38,745 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:38,745 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:38,751 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:54:38,756 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:38,756 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:54:38,757 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:38,757 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:38,757 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:54:38,765 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:38,768 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:38,770 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:38,772 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:38,775 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:38,777 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:38,780 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:38,782 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:38,785 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:38,787 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:38,789 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:38,799 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:38,799 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:54:38,804 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:54:38,804 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:54:38,808 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:38,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:54:38,817 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:38,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:54:38,817 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:38,832 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:38,837 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:54:38,842 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:54:38,843 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:38,843 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:38,843 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:38,843 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:38,843 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:38,844 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:54:38,844 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:38,844 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:54:38,844 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:38,845 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:54:38,846 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:54:38,846 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:38,846 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:54:38,846 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:38,846 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:38,846 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:38,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:54:38,847 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:54:38,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:54:38,847 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:54:38,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:54:38,847 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:54:38,847 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:54:38,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:54:38,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:54:38,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:54:38,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:54:38,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:54:38,848 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:38,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:54:38,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:38,849 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:38,850 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:38,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:54:38,850 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:54:38,850 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:54:38,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:54:38,854 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:54:38,854 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:38,855 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:38,856 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:38,857 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 141/400.
2025-08-04 20:54:38,958 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:38,958 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:38,961 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 20:54:38,962 - ClientAppLogger [Client 6] - INFO - [Client] Round 141: Training GAN with 31 samples (24 normal, 7 anomalous).
2025-08-04 20:54:38,962 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:54:38,996 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0785, Avg D Loss: 0.7877
2025-08-04 20:54:38,997 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0785, Avg D Loss: 0.7877
2025-08-04 20:54:38,997 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:54:39,005 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5488, Threshold=0.6056, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:54:39,005 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:54:39,006 - ClientAppLogger [Client 6] - INFO - Fit completed for round 141. Duration: 0.15s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 141, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0785281896591186, 'd_loss': 0.7876630485057831, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.14886021614074707, 'cpu_percent_fit': 11.7125, 'ram_mb_fit': 15.21875, 'accumulated_train_samples_this_round': 31}
2025-08-04 20:54:39,006 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:54:53,285 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:54:53,285 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:54:53,285 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:54:53,285 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:54:53,285 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:54:53,286 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:54:53,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:54:53,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:54:53,628 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:54:53,662 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:54:53,662 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:54:53,746 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:54:53,751 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:54:53,751 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:54:53,756 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:54:53,763 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:54:53,763 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:54:53,764 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:54:53,764 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:54:53,764 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:54:53,772 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:54:53,775 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:53,777 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:54:53,779 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:54:53,782 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:54:53,784 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:54:53,786 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:54:53,789 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:54:53,792 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:54:53,794 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:54:53,796 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:54:53,805 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:54:53,805 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:54:53,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:54:53,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:54:53,815 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:54:53,815 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:54:53,824 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:54:53,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:54:53,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:54:53,839 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:54:53,844 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:54:53,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:54:53,849 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:54:53,849 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:54:53,849 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:54:53,850 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:54:53,850 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:54:53,850 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:54:53,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:54:53,850 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:54:53,851 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:54:53,852 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:54:53,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:54:53,853 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:54:53,853 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:54:53,853 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:54:53,853 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:54:53,853 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:54:53,853 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:54:53,853 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:54:53,854 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:54:53,854 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:54:53,854 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:54:53,854 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:54:53,855 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:54:53,855 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:54:53,855 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:54:53,855 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:54:53,855 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:54:53,855 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:54:53,856 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:54:53,856 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:54:53,856 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:54:53,856 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:54:53,856 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:54:53,856 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:54:53,857 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:54:53,857 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:54:53,857 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:54:53,863 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:54:53,863 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:54:53,864 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:54:53,864 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:54:53,866 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:54:53,866 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:54:53,866 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:54:53,867 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:54:53,874 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5742, Threshold=0.6201, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:54:53,874 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5742
2025-08-04 20:55:14,156 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:14,156 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:55:14,157 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:55:14,157 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:55:14,157 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:55:14,157 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:14,436 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:14,437 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:14,517 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:55:14,551 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:55:14,552 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:14,638 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:14,643 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:14,643 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:14,649 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:55:14,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:14,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:55:14,656 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:14,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:14,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:55:14,665 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:14,668 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:14,670 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:14,673 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:14,675 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:14,678 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:14,680 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:14,683 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:14,685 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:14,687 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:14,689 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:14,699 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:14,699 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:55:14,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:55:14,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:55:14,710 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:14,710 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:55:14,719 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:14,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:55:14,719 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:14,735 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:14,740 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:55:14,746 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:55:14,746 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:14,746 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:14,746 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:14,747 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:14,747 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:14,747 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:55:14,747 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:14,748 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:55:14,748 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:14,749 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:55:14,749 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:55:14,750 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:14,750 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:55:14,750 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:14,750 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:14,751 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:14,751 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:55:14,751 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:55:14,751 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:55:14,751 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:55:14,751 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:55:14,752 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:55:14,752 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:55:14,752 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:55:14,752 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:55:14,752 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:55:14,752 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:55:14,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:55:14,753 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:14,753 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:55:14,753 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:14,754 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:14,754 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:14,754 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:55:14,754 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:55:14,754 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:55:14,754 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:55:14,758 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:55:14,758 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:14,759 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:14,760 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:55:14,761 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:14,761 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:14,761 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:14,762 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:14,770 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5582, Threshold=0.6040, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:55:14,771 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5582
2025-08-04 20:55:23,032 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:23,032 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:55:23,032 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:55:23,032 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:55:23,032 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:55:23,032 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:23,313 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:23,313 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:23,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:55:23,427 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:55:23,427 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:23,519 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:23,524 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:23,524 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:23,529 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:55:23,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:23,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:55:23,576 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:23,577 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:23,577 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:55:23,586 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:23,589 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:23,591 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:23,594 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:23,596 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:23,598 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:23,601 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:23,603 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:23,606 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:23,608 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:23,610 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:23,619 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:23,619 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:55:23,624 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:55:23,624 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:55:23,629 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:23,629 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:55:23,638 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:23,638 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:55:23,638 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:23,654 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:23,658 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:55:23,663 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:55:23,664 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:23,664 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:23,664 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:23,664 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:23,664 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:23,665 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:55:23,665 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:23,665 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:55:23,665 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:23,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:55:23,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:55:23,667 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:23,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:55:23,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:23,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:23,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:23,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:55:23,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:55:23,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:55:23,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:55:23,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:55:23,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:55:23,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:55:23,669 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:55:23,669 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:55:23,670 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:55:23,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:55:23,670 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:55:23,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:23,670 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:55:23,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:23,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:23,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:23,671 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:55:23,671 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:55:23,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:55:23,671 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:55:23,679 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:55:23,679 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:23,680 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:23,680 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:55:23,681 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 143/400.
2025-08-04 20:55:23,783 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:23,783 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:23,785 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 20:55:23,785 - ClientAppLogger [Client 6] - INFO - [Client] Round 143: Training GAN with 31 samples (24 normal, 7 anomalous).
2025-08-04 20:55:23,785 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:55:23,813 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0871, Avg D Loss: 0.7885
2025-08-04 20:55:23,813 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0871, Avg D Loss: 0.7885
2025-08-04 20:55:23,813 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:55:23,821 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5543, Threshold=0.6140, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:55:23,822 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:55:23,822 - ClientAppLogger [Client 6] - INFO - Fit completed for round 143. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 143, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0870952129364015, 'd_loss': 0.7885475099086762, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.14045000076293945, 'cpu_percent_fit': 11.14375, 'ram_mb_fit': 2.296875, 'accumulated_train_samples_this_round': 31}
2025-08-04 20:55:23,822 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:55:35,130 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:35,131 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:55:35,131 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:55:35,131 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:55:35,131 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:55:35,131 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:35,472 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:35,472 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:35,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:55:35,594 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:55:35,594 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:35,705 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:35,710 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:35,710 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:35,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:55:35,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:35,720 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:55:35,721 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:35,721 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:35,721 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:55:35,729 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:35,733 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:35,735 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:35,737 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:35,740 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:35,742 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:35,745 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:35,747 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:35,750 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:35,752 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:35,754 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:35,763 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:35,763 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:55:35,768 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:55:35,768 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:55:35,772 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:35,772 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:55:35,780 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:35,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:55:35,781 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:35,795 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:35,800 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:55:35,805 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:55:35,805 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:35,805 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:35,805 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:35,805 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:35,805 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:35,806 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:55:35,806 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:35,806 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:55:35,806 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:35,808 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:55:35,808 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:55:35,808 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:35,809 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:55:35,809 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:35,809 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:35,809 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:35,809 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:55:35,809 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:55:35,810 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:55:35,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:55:35,810 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:55:35,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:55:35,810 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:55:35,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:55:35,810 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:55:35,810 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:55:35,811 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:55:35,811 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:55:35,811 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:35,811 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:55:35,811 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:35,811 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:35,812 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:35,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:55:35,812 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:55:35,812 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:55:35,812 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:55:35,815 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:55:35,815 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:35,817 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:35,817 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:55:35,818 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:35,818 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:35,818 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:35,819 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:35,826 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4882, Threshold=0.5106, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:55:35,826 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4882
2025-08-04 20:55:56,182 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:55:56,182 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:55:56,182 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:55:56,182 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:55:56,183 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:55:56,183 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:55:56,544 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:55:56,544 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:55:56,638 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:55:56,682 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:55:56,683 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:55:56,817 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:55:56,824 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:55:56,824 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:55:56,830 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:55:56,836 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:55:56,836 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:55:56,837 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:55:56,837 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:55:56,837 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:55:56,846 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:55:56,849 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,851 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:55:56,854 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:55:56,856 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:55:56,858 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:55:56,860 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:55:56,863 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:55:56,866 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:55:56,867 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:55:56,870 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:55:56,878 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:55:56,879 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:55:56,883 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:55:56,884 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:55:56,888 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:55:56,888 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:55:56,896 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:55:56,896 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:55:56,896 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:55:56,912 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:55:56,916 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:55:56,921 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:55:56,921 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:55:56,922 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:55:56,922 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:55:56,922 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:55:56,922 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:55:56,923 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:55:56,923 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:55:56,923 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:55:56,923 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:55:56,924 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:55:56,924 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:55:56,925 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:55:56,925 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:55:56,925 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:55:56,925 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:55:56,925 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:55:56,926 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:55:56,926 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:55:56,926 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:55:56,926 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:55:56,926 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:55:56,926 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:55:56,927 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:55:56,927 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:55:56,927 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:55:56,927 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:55:56,927 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:55:56,927 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:55:56,927 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:55:56,927 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:55:56,928 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:55:56,928 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:55:56,928 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:55:56,928 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:55:56,928 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:55:56,928 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:55:56,928 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:55:56,937 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:55:56,937 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:55:56,938 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:55:56,938 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:55:56,940 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:55:56,940 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:55:56,940 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:55:56,940 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:55:56,948 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5947, Threshold=0.6513, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:55:56,948 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5947
2025-08-04 20:56:08,269 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:08,269 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:08,269 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:08,269 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:56:08,270 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:56:08,270 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:08,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:08,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:08,828 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:56:08,877 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:56:08,877 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:09,029 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:09,037 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:09,037 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:09,042 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:56:09,049 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:09,049 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:56:09,050 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:09,050 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:09,050 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:56:09,059 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:09,063 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:09,068 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:09,071 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:09,073 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:09,075 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:09,078 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:09,080 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:09,086 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:09,090 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:09,093 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:09,105 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:09,105 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:56:09,111 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:56:09,111 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:56:09,116 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:09,116 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:56:09,128 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:09,128 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:56:09,128 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:09,145 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:09,150 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:56:09,156 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:56:09,156 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:09,156 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:09,156 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:09,156 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:09,157 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:09,157 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:56:09,157 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:09,157 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:56:09,157 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:09,159 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:56:09,159 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:56:09,159 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:09,159 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:56:09,160 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:09,160 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:09,160 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:09,160 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:56:09,160 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:56:09,160 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:56:09,161 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:56:09,161 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:56:09,161 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:56:09,161 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:56:09,161 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:56:09,161 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:56:09,162 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:56:09,162 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:56:09,162 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:56:09,162 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:09,162 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:56:09,163 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:09,163 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:09,163 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:09,163 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:56:09,163 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:56:09,163 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:56:09,163 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:56:09,174 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:56:09,174 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:09,176 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:09,176 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:09,177 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:09,177 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:09,177 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:09,178 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:09,186 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5140, Threshold=0.5372, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:56:09,186 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5140
2025-08-04 20:56:14,452 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:14,452 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:14,452 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:14,452 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:56:14,452 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:56:14,452 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:14,802 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:14,802 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:14,888 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:56:14,928 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:56:14,928 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:15,072 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:15,078 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:15,078 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:15,085 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:56:15,103 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:15,103 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:56:15,104 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:15,104 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:15,104 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:56:15,113 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:15,116 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:15,118 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:15,121 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:15,124 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:15,126 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:15,129 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:15,131 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:15,134 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:15,136 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:15,138 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:15,148 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:15,148 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:56:15,153 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:56:15,153 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:56:15,158 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:15,158 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:56:15,167 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:15,167 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:56:15,167 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:15,182 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:15,187 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:56:15,191 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:56:15,191 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:15,191 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:15,191 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:15,192 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:15,192 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:15,192 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:56:15,192 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:15,192 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:56:15,192 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:15,194 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:56:15,194 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:56:15,194 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:15,194 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:56:15,194 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:15,195 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:15,195 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:15,195 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:56:15,195 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:56:15,195 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:56:15,195 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:56:15,195 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:56:15,195 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:56:15,195 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:56:15,196 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:56:15,196 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:56:15,196 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:56:15,196 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:56:15,196 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:56:15,196 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:15,196 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:56:15,197 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:15,197 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:15,197 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:15,197 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:56:15,197 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:56:15,197 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:56:15,197 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:56:15,208 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:56:15,208 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:15,210 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:15,210 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:15,211 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 146/400.
2025-08-04 20:56:15,312 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:15,312 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:15,313 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 20:56:15,314 - ClientAppLogger [Client 6] - INFO - [Client] Round 146: Training GAN with 32 samples (25 normal, 7 anomalous).
2025-08-04 20:56:15,314 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:56:15,341 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0808, Avg D Loss: 0.7917
2025-08-04 20:56:15,341 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0808, Avg D Loss: 0.7917
2025-08-04 20:56:15,341 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:56:15,351 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5477, Threshold=0.5980, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:56:15,351 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:56:15,352 - ClientAppLogger [Client 6] - INFO - Fit completed for round 146. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 146, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0807592391967775, 'd_loss': 0.791693365573883, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.14055228233337402, 'cpu_percent_fit': 10.9625, 'ram_mb_fit': 6.796875, 'accumulated_train_samples_this_round': 32}
2025-08-04 20:56:15,352 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:56:26,684 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:26,684 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:26,684 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:26,684 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:56:26,684 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:56:26,685 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:27,146 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:27,146 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:27,233 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:56:27,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:56:27,277 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:27,419 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:27,425 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:27,426 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:27,431 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:56:27,441 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:27,441 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:56:27,442 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:27,442 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:27,442 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:56:27,451 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:27,455 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:27,458 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:27,461 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:27,463 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:27,465 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:27,468 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:27,470 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:27,473 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:27,474 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:27,477 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:27,489 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:27,489 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:56:27,494 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:56:27,494 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:56:27,501 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:27,501 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:56:27,514 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:27,514 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:56:27,515 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:27,530 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:27,536 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:56:27,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:56:27,542 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:27,542 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:27,542 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:27,542 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:27,543 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:27,543 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:56:27,543 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:27,543 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:56:27,543 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:27,545 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:56:27,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:56:27,545 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:27,545 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:56:27,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:27,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:27,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:27,546 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:56:27,546 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:56:27,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:56:27,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:56:27,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:56:27,547 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:56:27,547 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:56:27,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:56:27,548 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:56:27,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:56:27,548 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:56:27,548 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:56:27,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:27,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:56:27,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:27,549 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:27,550 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:27,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:56:27,550 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:56:27,550 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:56:27,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:56:27,557 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:56:27,557 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:27,558 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:27,558 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:27,559 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:27,560 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:27,560 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:27,560 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:27,569 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5769, Threshold=0.6278, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:56:27,569 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5769
2025-08-04 20:56:32,836 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:32,836 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:32,836 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:32,836 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:56:32,836 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:56:32,836 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:33,234 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:33,234 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:33,320 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:56:33,358 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:56:33,358 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:33,479 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:33,486 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:33,486 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:33,490 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:56:33,495 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:33,495 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:56:33,496 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:33,496 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:33,496 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:56:33,504 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:33,507 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:33,509 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:33,511 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:33,514 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:33,516 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:33,519 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:33,521 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:33,524 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:33,526 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:33,528 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:33,538 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:33,538 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:56:33,543 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:56:33,543 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:56:33,548 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:33,549 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:56:33,559 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:33,559 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:56:33,559 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:33,574 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:33,579 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:56:33,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:56:33,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:33,583 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:33,583 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:33,584 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:33,584 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:33,584 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:56:33,584 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:33,585 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:56:33,585 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:33,586 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:56:33,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:56:33,587 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:33,587 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:56:33,587 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:33,587 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:33,587 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:33,587 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:56:33,587 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:56:33,587 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:56:33,588 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:56:33,588 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:56:33,588 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:56:33,588 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:56:33,588 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:56:33,588 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:56:33,589 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:56:33,589 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:56:33,589 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:56:33,589 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:33,589 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:56:33,589 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:33,590 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:33,590 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:33,590 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:56:33,590 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:56:33,590 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:56:33,590 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:56:33,599 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:56:33,599 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:33,600 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:33,600 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:33,602 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 147/400.
2025-08-04 20:56:33,703 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:33,703 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:33,705 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 20:56:33,705 - ClientAppLogger [Client 6] - INFO - [Client] Round 147: Training GAN with 32 samples (25 normal, 7 anomalous).
2025-08-04 20:56:33,705 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:56:33,731 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0728, Avg D Loss: 0.7867
2025-08-04 20:56:33,731 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0728, Avg D Loss: 0.7867
2025-08-04 20:56:33,731 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:56:33,739 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5594, Threshold=0.6211, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:56:33,739 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:56:33,739 - ClientAppLogger [Client 6] - INFO - Fit completed for round 147. Duration: 0.14s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 147, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0728207349777223, 'd_loss': 0.786725127696991, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.1375868320465088, 'cpu_percent_fit': 12.0625, 'ram_mb_fit': 0.14453125, 'accumulated_train_samples_this_round': 32}
2025-08-04 20:56:33,739 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:56:48,092 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:56:48,092 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:56:48,092 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:56:48,092 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:56:48,093 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:56:48,093 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:56:48,380 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:56:48,380 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:56:48,469 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:56:48,509 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:56:48,509 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:56:48,613 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:56:48,620 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:56:48,623 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:56:48,631 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:56:48,640 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:56:48,641 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:56:48,641 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:56:48,641 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:56:48,642 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:56:48,651 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:56:48,654 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:48,657 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:56:48,659 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:56:48,662 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:56:48,664 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:56:48,667 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:56:48,670 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:56:48,673 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:56:48,675 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:56:48,677 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:56:48,686 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:56:48,687 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:56:48,691 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:56:48,692 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:56:48,697 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:56:48,697 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:56:48,706 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:56:48,707 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:56:48,707 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:56:48,722 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:56:48,728 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:56:48,733 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:56:48,733 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:56:48,733 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:56:48,734 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:56:48,734 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:56:48,734 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:56:48,734 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:56:48,734 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:56:48,735 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:56:48,735 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:56:48,736 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:56:48,736 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:56:48,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:56:48,737 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:56:48,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:56:48,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:56:48,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:56:48,737 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:56:48,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:56:48,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:56:48,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:56:48,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:56:48,738 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:56:48,738 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:56:48,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:56:48,739 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:56:48,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:56:48,739 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:56:48,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:56:48,739 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:56:48,739 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:56:48,740 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:56:48,740 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:56:48,740 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:56:48,740 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:56:48,740 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:56:48,741 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:56:48,741 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:56:48,745 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:56:48,745 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:56:48,746 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:56:48,746 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:56:48,748 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:56:48,748 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:56:48,748 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:56:48,749 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:56:48,757 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4851, Threshold=0.5018, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:56:48,757 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4851
2025-08-04 20:57:06,103 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:06,103 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:06,103 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:06,104 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:57:06,104 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:57:06,104 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:06,491 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:06,491 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:06,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:57:06,622 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:57:06,624 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:06,784 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:06,790 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:06,791 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:06,797 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:57:06,803 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:06,803 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:57:06,804 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:06,804 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:06,804 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:57:06,814 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:06,817 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:06,820 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:06,822 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:06,825 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:06,827 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:06,829 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:06,832 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:06,835 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:06,837 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:06,840 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:06,850 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:06,850 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:57:06,855 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:57:06,856 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:57:06,865 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:06,865 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:57:06,877 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:06,877 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:57:06,877 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:06,893 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:06,899 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:57:06,905 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:57:06,905 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:06,905 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:06,905 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:06,906 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:06,906 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:06,906 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:57:06,906 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:06,906 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:57:06,907 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:06,908 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:57:06,908 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:57:06,909 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:06,909 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:57:06,909 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:06,909 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:06,909 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:06,910 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:57:06,910 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:57:06,912 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:57:06,912 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:57:06,912 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:57:06,912 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:57:06,913 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:57:06,913 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:57:06,913 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:57:06,913 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:57:06,913 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:57:06,913 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:57:06,914 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:06,914 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:57:06,914 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:06,914 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:06,916 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:06,916 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:57:06,916 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:57:06,916 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:57:06,916 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:57:06,923 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:57:06,923 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:06,924 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:06,925 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:06,926 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:06,926 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:06,926 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:06,927 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:06,935 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5443, Threshold=0.5814, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:57:06,936 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5443
2025-08-04 20:57:12,227 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:12,228 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:12,228 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:12,228 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:57:12,228 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:57:12,228 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:12,568 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:12,568 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:12,654 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:57:12,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:57:12,668 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:12,771 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:12,777 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:12,778 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:12,782 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:57:12,788 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:12,788 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:57:12,789 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:12,789 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:12,789 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:57:12,798 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:12,801 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:12,803 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:12,805 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:12,809 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:12,811 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:12,814 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:12,817 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:12,820 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:12,822 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:12,825 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:12,835 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:12,835 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:57:12,840 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:57:12,840 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:57:12,848 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:12,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:57:12,859 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:12,860 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:57:12,860 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:12,875 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:12,879 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:57:12,885 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:57:12,885 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:12,885 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:12,885 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:12,885 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:12,886 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:12,886 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:57:12,886 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:12,886 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:57:12,886 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:12,888 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:57:12,888 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:57:12,888 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:12,888 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:57:12,889 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:12,889 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:12,889 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:12,889 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:57:12,889 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:57:12,889 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:57:12,890 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:57:12,890 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:57:12,890 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:57:12,890 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:57:12,890 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:57:12,890 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:57:12,891 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:57:12,891 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:57:12,891 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:57:12,891 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:12,891 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:57:12,892 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:12,892 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:12,892 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:12,892 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:57:12,892 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:57:12,892 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:57:12,892 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:57:12,898 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:57:12,898 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:12,899 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:12,900 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:12,901 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 149/400.
2025-08-04 20:57:13,002 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:13,002 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:13,003 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 20:57:13,003 - ClientAppLogger [Client 6] - INFO - [Client] Round 149: Training GAN with 33 samples (26 normal, 7 anomalous).
2025-08-04 20:57:13,003 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:13,049 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0838, Avg D Loss: 0.7825
2025-08-04 20:57:13,049 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0838, Avg D Loss: 0.7825
2025-08-04 20:57:13,050 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:13,057 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5587, Threshold=0.6170, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:57:13,058 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:57:13,058 - ClientAppLogger [Client 6] - INFO - Fit completed for round 149. Duration: 0.16s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 149, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.0837818644263533, 'd_loss': 0.7824969701694721, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.15658140182495117, 'cpu_percent_fit': 12.275, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 33}
2025-08-04 20:57:13,058 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:57:27,391 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:27,391 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:27,391 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:27,391 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:57:27,392 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:57:27,392 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:27,913 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:27,914 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:28,026 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:57:28,084 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:57:28,084 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:28,250 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:28,259 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:28,259 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:28,268 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:57:28,275 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:28,276 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:57:28,276 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:28,276 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:28,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:57:28,286 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:28,289 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:28,292 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:28,294 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:28,297 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:28,299 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:28,302 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:28,305 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:28,309 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:28,311 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:28,313 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:28,325 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:28,325 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:57:28,331 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:57:28,331 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:57:28,340 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:28,340 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:57:28,360 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:28,361 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:57:28,361 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:28,381 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:28,386 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:57:28,395 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:57:28,395 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:28,395 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:28,395 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:28,396 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:28,396 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:28,396 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:57:28,396 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:28,397 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:57:28,397 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:28,398 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:57:28,399 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:57:28,399 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:28,399 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:57:28,399 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:28,399 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:28,399 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:28,400 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:57:28,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:57:28,400 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:57:28,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:57:28,400 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:57:28,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:57:28,400 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:57:28,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:57:28,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:57:28,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:57:28,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:57:28,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:57:28,401 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:28,401 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:57:28,402 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:28,402 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:28,402 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:28,402 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:57:28,402 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:57:28,403 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:57:28,403 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:57:28,411 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:57:28,412 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:28,413 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:28,413 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:28,415 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:28,415 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:28,415 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:28,416 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:28,427 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5520, Threshold=0.5910, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:57:28,427 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5520
2025-08-04 20:57:33,705 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:33,705 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:33,705 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:33,705 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:57:33,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:57:33,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:34,113 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:34,113 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:34,216 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:57:34,264 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:57:34,264 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:34,407 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:34,412 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:34,412 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:34,420 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:57:34,462 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:34,462 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:57:34,463 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:34,463 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:34,463 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:57:34,472 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:34,475 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:34,477 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:34,480 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:34,482 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:34,485 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:34,487 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:34,490 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:34,493 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:34,495 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:34,497 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:34,507 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:34,508 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:57:34,513 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:57:34,513 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:57:34,518 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:34,518 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:57:34,530 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:34,530 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:57:34,530 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:34,545 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:34,550 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:57:34,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:57:34,554 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:34,555 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:34,555 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:34,555 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:34,555 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:34,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:57:34,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:34,556 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:57:34,556 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:34,558 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:57:34,558 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:57:34,558 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:34,558 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:57:34,558 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:34,559 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:34,559 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:34,559 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:57:34,559 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:57:34,559 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:57:34,559 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:57:34,559 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:57:34,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:57:34,560 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:57:34,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:57:34,560 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:57:34,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:57:34,560 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:57:34,560 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:57:34,561 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:34,561 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:57:34,561 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:34,561 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:34,561 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:34,562 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:57:34,562 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:57:34,562 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:57:34,562 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:57:34,569 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:57:34,569 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:34,570 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:34,571 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:34,572 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 150/400.
2025-08-04 20:57:34,673 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:34,674 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:34,675 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 7 anomalous samples to GAN training data (target: 7).
2025-08-04 20:57:34,675 - ClientAppLogger [Client 6] - INFO - [Client] Round 150: Training GAN with 33 samples (26 normal, 7 anomalous).
2025-08-04 20:57:34,676 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:57:34,723 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0757, Avg D Loss: 0.7994
2025-08-04 20:57:34,724 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0757, Avg D Loss: 0.7994
2025-08-04 20:57:34,724 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:57:34,732 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.6932, Threshold=0.7775, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:57:34,732 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:57:34,733 - ClientAppLogger [Client 6] - INFO - Fit completed for round 150. Duration: 0.16s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 150, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.075663669904073, 'd_loss': 0.7994283892891624, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.16051292419433594, 'cpu_percent_fit': 11.5875, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 33}
2025-08-04 20:57:34,733 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:57:49,046 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:57:49,046 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:57:49,046 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:57:49,046 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:57:49,046 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:57:49,047 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:57:49,538 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:57:49,538 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:57:49,632 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:57:49,674 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:57:49,674 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:57:49,818 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:57:49,825 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:57:49,825 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:57:49,830 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:57:49,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:57:49,852 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:57:49,853 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:57:49,853 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:57:49,853 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:57:49,861 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:57:49,864 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:49,867 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:57:49,869 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:57:49,872 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:57:49,874 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:57:49,877 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:57:49,879 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:57:49,882 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:57:49,884 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:57:49,887 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:57:49,896 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:57:49,896 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:57:49,901 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:57:49,902 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:57:49,907 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:57:49,907 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:57:49,918 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:57:49,918 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:57:49,918 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:57:49,934 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:57:49,938 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:57:49,946 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:57:49,947 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:57:49,947 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:57:49,947 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:57:49,947 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:57:49,947 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:57:49,948 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:57:49,948 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:57:49,948 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:57:49,948 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:57:49,950 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:57:49,950 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:57:49,950 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:57:49,950 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:57:49,951 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:57:49,951 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:57:49,951 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:57:49,951 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:57:49,951 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:57:49,951 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:57:49,951 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:57:49,951 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:57:49,952 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:57:49,952 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:57:49,952 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:57:49,952 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:57:49,952 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:57:49,952 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:57:49,953 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:57:49,953 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:57:49,953 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:57:49,953 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:57:49,953 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:57:49,954 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:57:49,954 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:57:49,954 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:57:49,954 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:57:49,954 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:57:49,968 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:57:49,968 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:57:49,969 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:57:49,969 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:57:49,971 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:57:49,971 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:57:49,971 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:57:49,972 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:57:49,980 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5582, Threshold=0.6003, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:57:49,981 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5582
2025-08-04 20:58:07,305 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:07,305 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:58:07,306 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:58:07,306 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:58:07,306 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:58:07,306 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:07,721 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:07,721 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:07,819 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:58:07,857 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:58:07,857 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:07,968 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:07,975 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:07,975 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:07,980 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:58:07,989 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:07,989 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:58:07,989 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:07,989 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:07,990 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:58:07,998 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:08,001 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:08,003 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:08,005 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:08,008 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:08,010 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:08,012 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:08,015 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:08,017 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:08,019 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:08,022 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:08,031 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:08,031 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:58:08,036 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:58:08,036 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:58:08,042 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:08,042 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:58:08,054 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:08,055 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:58:08,055 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:08,071 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:08,076 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:58:08,083 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:58:08,083 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:08,083 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:08,084 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:08,084 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:08,084 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:08,084 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:58:08,084 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:08,085 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:58:08,085 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:08,086 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:58:08,086 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:58:08,087 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:08,087 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:58:08,087 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:08,087 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:08,087 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:08,087 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:58:08,088 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:58:08,088 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:58:08,088 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:58:08,088 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:58:08,088 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:58:08,088 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:58:08,088 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:58:08,089 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:58:08,089 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:58:08,089 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:58:08,089 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:58:08,089 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:08,089 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:58:08,090 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:08,090 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:08,090 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:08,090 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:58:08,090 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:58:08,090 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:58:08,090 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:58:08,099 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:58:08,099 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:08,100 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:08,101 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:58:08,102 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:08,102 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:08,102 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:08,103 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:08,110 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5327, Threshold=0.5699, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:58:08,110 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5327
2025-08-04 20:58:28,409 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:28,409 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:58:28,409 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:58:28,409 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:58:28,409 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:58:28,409 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:28,847 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:28,848 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:28,951 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:58:29,000 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:58:29,000 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:29,147 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:29,154 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:29,154 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:29,160 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:58:29,168 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:29,168 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:58:29,169 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:29,169 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:29,169 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:58:29,178 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:29,181 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:29,183 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:29,186 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:29,189 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:29,191 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:29,194 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:29,196 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:29,199 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:29,201 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:29,203 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:29,213 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:29,213 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:58:29,218 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:58:29,218 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:58:29,223 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:29,223 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:58:29,233 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:29,234 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:58:29,234 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:29,251 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:29,256 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:58:29,265 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:58:29,265 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:29,266 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:29,266 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:29,266 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:29,266 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:29,266 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:58:29,267 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:29,267 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:58:29,267 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:29,269 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:58:29,269 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:58:29,269 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:29,270 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:58:29,270 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:29,270 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:29,270 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:29,270 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:58:29,270 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:58:29,270 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:58:29,271 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:58:29,271 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:58:29,271 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:58:29,271 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:58:29,271 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:58:29,271 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:58:29,272 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:58:29,272 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:58:29,272 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:58:29,272 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:29,272 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:58:29,272 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:29,273 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:29,273 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:29,273 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:58:29,273 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:58:29,273 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:58:29,273 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:58:29,281 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:58:29,281 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:29,283 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:29,283 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:58:29,284 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:29,285 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:29,285 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:29,285 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:29,293 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5887, Threshold=0.6434, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:58:29,293 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5887
2025-08-04 20:58:34,543 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:34,544 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:58:34,544 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:58:34,544 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:58:34,544 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:58:34,544 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:34,879 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:34,879 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:34,969 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:58:35,011 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:58:35,011 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:35,130 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:35,136 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:35,136 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:35,142 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:58:35,188 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:35,188 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:58:35,189 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:35,189 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:35,189 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:58:35,198 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:35,201 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:35,203 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:35,205 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:35,208 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:35,210 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:35,213 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:35,215 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:35,218 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:35,220 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:35,222 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:35,231 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:35,231 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:58:35,236 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:58:35,236 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:58:35,242 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:35,242 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:58:35,252 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:35,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:58:35,252 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:35,268 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:35,272 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:58:35,277 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:58:35,278 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:35,278 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:35,278 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:35,278 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:35,279 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:35,279 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:58:35,279 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:35,279 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:58:35,279 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:35,281 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:58:35,281 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:58:35,281 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:35,281 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:58:35,281 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:35,281 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:35,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:35,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:58:35,282 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:58:35,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:58:35,282 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:58:35,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:58:35,282 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:58:35,282 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:58:35,283 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:58:35,283 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:58:35,283 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:58:35,283 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:58:35,283 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:58:35,283 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:35,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:58:35,284 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:35,284 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:35,284 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:35,284 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:58:35,284 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:58:35,285 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:58:35,285 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:58:35,292 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:58:35,292 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:35,293 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:35,293 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:58:35,295 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 153/400.
2025-08-04 20:58:35,396 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:35,396 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:35,397 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 20:58:35,397 - ClientAppLogger [Client 6] - INFO - [Client] Round 153: Training GAN with 35 samples (27 normal, 8 anomalous).
2025-08-04 20:58:35,397 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:58:35,446 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0794, Avg D Loss: 0.8087
2025-08-04 20:58:35,446 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0794, Avg D Loss: 0.8087
2025-08-04 20:58:35,447 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:58:35,454 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.3957, Threshold=0.3948, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:58:35,454 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7974
2025-08-04 20:58:35,455 - ClientAppLogger [Client 6] - INFO - Fit completed for round 153. Duration: 0.16s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 153, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.079423482077462, 'd_loss': 0.8086951160430909, 'post_fit_local_f1': 0.7973856209150327, 'fit_time_seconds': 0.159928560256958, 'cpu_percent_fit': 11.6625, 'ram_mb_fit': 0.1328125, 'accumulated_train_samples_this_round': 35}
2025-08-04 20:58:35,455 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:58:46,767 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:58:46,767 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:58:46,767 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:58:46,767 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:58:46,768 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:58:46,768 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:58:47,193 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:58:47,193 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:58:47,290 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:58:47,335 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:58:47,336 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:58:47,461 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:58:47,468 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:58:47,468 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:58:47,473 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:58:47,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:58:47,479 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:58:47,480 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:58:47,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:58:47,480 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:58:47,489 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:58:47,492 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:47,494 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:58:47,497 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:58:47,500 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:58:47,502 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:58:47,504 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:58:47,507 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:58:47,509 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:58:47,511 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:58:47,513 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:58:47,522 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:58:47,523 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:58:47,527 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:58:47,527 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:58:47,532 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:58:47,532 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:58:47,541 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:58:47,541 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:58:47,541 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:58:47,557 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:58:47,562 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:58:47,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:58:47,577 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:58:47,577 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:58:47,577 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:58:47,577 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:58:47,577 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:58:47,578 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:58:47,578 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:58:47,578 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:58:47,578 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:58:47,580 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:58:47,580 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:58:47,580 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:58:47,581 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:58:47,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:58:47,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:58:47,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:58:47,581 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:58:47,581 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:58:47,582 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:58:47,582 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:58:47,582 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:58:47,582 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:58:47,582 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:58:47,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:58:47,583 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:58:47,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:58:47,583 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:58:47,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:58:47,583 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:58:47,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:58:47,584 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:58:47,584 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:58:47,584 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:58:47,584 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:58:47,584 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:58:47,585 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:58:47,585 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:58:47,590 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:58:47,590 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:58:47,591 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:58:47,591 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:58:47,592 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:58:47,592 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:58:47,592 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:58:47,593 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:58:47,601 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.4865, Threshold=0.5108, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:58:47,601 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.4865
2025-08-04 20:59:07,897 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:07,898 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:07,898 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:07,898 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:59:07,898 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:59:07,898 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:08,304 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:08,304 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:08,400 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:59:08,446 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:59:08,447 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:08,573 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:08,579 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:08,580 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:08,586 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:59:08,609 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:08,610 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:59:08,610 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:08,610 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:08,610 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:59:08,619 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:08,622 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:08,624 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:08,627 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:08,629 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:08,632 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:08,634 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:08,638 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:08,640 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:08,642 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:08,645 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:08,656 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:08,656 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:59:08,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:59:08,661 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:59:08,666 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:08,666 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:59:08,676 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:08,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:59:08,677 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:08,694 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:08,699 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:59:08,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:59:08,705 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:08,705 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:08,705 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:08,705 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:08,706 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:08,706 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:59:08,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:08,706 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:59:08,706 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:08,708 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:59:08,708 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:59:08,709 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:08,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:59:08,709 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:08,709 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:08,710 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:08,710 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:59:08,710 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:59:08,710 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:59:08,711 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:59:08,712 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:59:08,712 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:59:08,712 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:59:08,712 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:59:08,714 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:59:08,714 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:59:08,714 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:59:08,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:59:08,715 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:08,715 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:59:08,716 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:08,716 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:08,716 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:08,716 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:59:08,716 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:59:08,716 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:59:08,717 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:59:08,728 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:59:08,728 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:08,729 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:08,729 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:08,731 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:08,731 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:08,731 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:08,732 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:08,739 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5483, Threshold=0.5910, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:59:08,739 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5483
2025-08-04 20:59:26,057 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:26,058 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:26,058 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:26,058 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:59:26,058 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:59:26,058 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:26,427 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:26,427 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:26,516 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:59:26,532 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:59:26,533 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:26,630 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:26,637 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:26,637 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:26,644 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:59:26,651 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:26,652 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:59:26,652 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:26,653 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:26,653 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:59:26,662 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:26,665 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:26,667 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:26,670 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:26,673 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:26,676 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:26,679 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:26,682 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:26,685 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:26,688 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:26,691 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:26,704 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:26,704 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:59:26,709 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:59:26,710 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:59:26,716 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:26,717 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:59:26,728 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:26,728 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:59:26,729 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:26,747 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:26,754 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:59:26,765 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:59:26,766 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:26,766 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:26,766 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:26,766 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:26,766 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:26,767 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:59:26,767 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:26,767 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:59:26,767 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:26,768 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:59:26,769 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:59:26,769 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:26,769 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:59:26,769 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:26,769 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:26,770 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:26,770 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:59:26,770 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:59:26,770 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:59:26,770 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:59:26,771 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:59:26,771 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:59:26,771 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:59:26,771 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:59:26,771 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:59:26,771 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:59:26,772 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:59:26,772 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:59:26,772 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:26,772 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:59:26,772 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:26,772 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:26,773 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:26,773 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:59:26,773 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:59:26,773 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:59:26,773 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:59:26,777 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:59:26,777 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:26,778 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:26,778 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:26,780 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:26,780 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:26,780 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:26,781 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:26,790 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5395, Threshold=0.5801, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:59:26,790 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5395
2025-08-04 20:59:32,039 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:32,039 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:32,040 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:32,040 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:59:32,040 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:59:32,040 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:32,336 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:32,336 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:32,418 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:59:32,460 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:59:32,460 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:32,566 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:32,571 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:32,572 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:32,576 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:59:32,581 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:32,582 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:59:32,582 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:32,582 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:32,583 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:59:32,591 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:32,593 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:32,595 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:32,597 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:32,600 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:32,602 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:32,604 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:32,607 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:32,609 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:32,611 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:32,613 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:32,622 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:32,622 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:59:32,627 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:59:32,627 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:59:32,631 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:32,631 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:59:32,639 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:32,639 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:59:32,640 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:32,655 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:32,659 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:59:32,666 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:59:32,667 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:32,667 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:32,667 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:32,667 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:32,668 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:32,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:59:32,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:32,668 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:59:32,668 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:32,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:59:32,670 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:59:32,670 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:32,671 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:59:32,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:32,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:32,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:32,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:59:32,671 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:59:32,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:59:32,671 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:59:32,671 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:59:32,672 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:59:32,672 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:59:32,672 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:59:32,672 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:59:32,672 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:59:32,672 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:59:32,672 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:59:32,672 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:32,672 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:59:32,673 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:32,673 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:32,673 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:32,673 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:59:32,673 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:59:32,673 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:59:32,673 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:59:32,680 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:59:32,680 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:32,681 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:32,681 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:32,682 - ClientAppLogger [Client 6] - INFO - [Client] Fit started for round 156/400.
2025-08-04 20:59:32,783 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:32,784 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:32,785 - ClientAppLogger [Client 6] - INFO - [Client] Semi-supervised: Added 8 anomalous samples to GAN training data (target: 8).
2025-08-04 20:59:32,785 - ClientAppLogger [Client 6] - INFO - [Client] Round 156: Training GAN with 36 samples (28 normal, 8 anomalous).
2025-08-04 20:59:32,785 - ClientAppLogger [Client 6] - INFO - [Client] Starting GAN training...
2025-08-04 20:59:32,833 - ClientAppLogger [Client 6] - INFO - Training finished. Avg G Loss over 10 epochs: 2.0826, Avg D Loss: 0.7954
2025-08-04 20:59:32,834 - ClientAppLogger [Client 6] - INFO - GAN Training completed. Avg G Loss: 2.0826, Avg D Loss: 0.7954
2025-08-04 20:59:32,834 - ClientAppLogger [Client 6] - INFO - [Client] Evaluating updated local model on local validation set...
2025-08-04 20:59:32,841 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5213, Threshold=0.5687, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:59:32,841 - ClientAppLogger [Client 6] - INFO - [Client] Post-fit local evaluation F1: 0.7843
2025-08-04 20:59:32,842 - ClientAppLogger [Client 6] - INFO - Fit completed for round 156. Duration: 0.16s. Metrics: {'cpu_cores_available': 2, 'client_cid_for_attributes': '6', 'server_round': 156, 'allocated_cores_for_pytorch': 2, 'profile_name': 'Low-End IoT', 'g_loss': 2.082586047384474, 'd_loss': 0.7954140464464825, 'post_fit_local_f1': 0.7843137254901961, 'fit_time_seconds': 0.15919208526611328, 'cpu_percent_fit': 11.8125, 'ram_mb_fit': 0.0, 'accumulated_train_samples_this_round': 36}
2025-08-04 20:59:32,842 - ClientAppLogger [Client 6] - INFO - [Client] get_parameters called
2025-08-04 20:59:38,121 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:38,121 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:38,121 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:38,122 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:59:38,122 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:59:38,122 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:38,645 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:38,645 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:38,742 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:59:38,789 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:59:38,789 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:38,948 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:38,955 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:38,955 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:38,961 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:59:38,968 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:38,969 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:59:38,969 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:38,969 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:38,969 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:59:38,980 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:38,983 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:38,985 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:38,987 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:38,990 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:38,992 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:38,995 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:38,998 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:39,001 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:39,003 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:39,006 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:39,017 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:39,017 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:59:39,022 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:59:39,022 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:59:39,027 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:39,027 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:59:39,037 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:39,038 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:59:39,038 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:39,055 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:39,060 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:59:39,066 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:59:39,066 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:39,066 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:39,066 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:39,067 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:39,067 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:39,067 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:59:39,067 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:39,068 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:59:39,068 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:39,069 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:59:39,070 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:59:39,070 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:39,070 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:59:39,070 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:39,071 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:39,071 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:39,071 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:59:39,071 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:59:39,071 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:59:39,071 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:59:39,072 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:59:39,072 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:59:39,072 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:59:39,072 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:59:39,072 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:59:39,072 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:59:39,073 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:59:39,073 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:59:39,073 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:39,073 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:59:39,073 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:39,073 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:39,073 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:39,074 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:59:39,074 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:59:39,074 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:59:39,074 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:59:39,084 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:59:39,084 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:39,086 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:39,086 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:39,088 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:39,088 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:39,088 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:39,089 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:39,098 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5213, Threshold=0.5687, Accuracy=0.6857, F1=0.7843, Precision=0.9524, Recall=0.6667
2025-08-04 20:59:39,098 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.6857, F1: 0.7843, Prec: 0.9524, Rec: 0.6667, Avg Anomaly Score: 0.5213
2025-08-04 20:59:53,392 - ClientAppLogger [Client 6] - INFO - ClientApp starting for partition_id: 6. Instance log dir: /app/logs/20250804_2030
2025-08-04 20:59:53,392 - ClientAppLogger [Client 6] - INFO - ALLOCATED_CORES='2' found. Setting PyTorch threads to 2.
2025-08-04 20:59:53,392 - ClientAppLogger [Client 6] - INFO - Called torch.set_num_threads(2). Current PyTorch intra-op threads: 2. Client will operate with 2 core(s).
2025-08-04 20:59:53,392 - ClientAppLogger [Client 6] - INFO - Loading data for partition 6/10...
2025-08-04 20:59:53,393 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting load_data function.
2025-08-04 20:59:53,393 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Attempting to read CSV from src/datasets/Train_Test_datasets/Train_Test_Network_dataset/train_test_network.csv with columns: ['src_port', 'dst_port', 'duration', 'src_bytes', 'dst_bytes', 'missed_bytes', 'src_pkts', 'src_ip_bytes', 'dst_pkts', 'dst_ip_bytes', 'dns_qclass', 'dns_qtype', 'dns_rcode', 'http_trans_depth', 'http_request_body_len', 'http_response_body_len', 'http_status_code', 'label', 'type']
2025-08-04 20:59:53,803 - ClientAppLogger [Client 6] - INFO - [LoadData 6] CSV read successfully. DataFrame shape: (211043, 19)
2025-08-04 20:59:53,803 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting '-' replacement and numeric conversion.
2025-08-04 20:59:53,894 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Numeric conversion completed.
2025-08-04 20:59:53,936 - ClientAppLogger [Client 6] - INFO - [LoadData 6] NA values filled.
2025-08-04 20:59:53,936 - ClientAppLogger [Client 6] - INFO - Splitting off 15.0% of data for global hold-out test set.
2025-08-04 20:59:54,100 - ClientAppLogger [Client 6] - INFO - Proceeding with federated dataset of size 179386.
2025-08-04 20:59:54,107 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X and y created. X shape: (179386, 17), y shape: (179386,)
2025-08-04 20:59:54,107 - ClientAppLogger [Client 6] - INFO - Fitting MinMaxScaler on X with shape (179386, 17)
2025-08-04 20:59:54,112 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Scaler fitting process completed.
2025-08-04 20:59:54,119 - ClientAppLogger [Client 6] - INFO - [LoadData 6] X_scaled successfully. Shape: (179386, 17)
2025-08-04 20:59:54,119 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting semi-supervised data splitting logic.
2025-08-04 20:59:54,120 - ClientAppLogger [Client 6] - INFO - Initial number of anomaly samples (positions in sampled data): 136886
2025-08-04 20:59:54,120 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Initial normal indices count: 42500, anomaly indices count: 136886
2025-08-04 20:59:54,120 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting anomaly reduction logic.
2025-08-04 20:59:54,129 - ClientAppLogger [Client 6] - INFO - Found attack types in initial sampled anomalies: ['scanning' 'injection' 'ransomware' 'password' 'ddos' 'xss' 'dos'
 'backdoor' 'mitm']
2025-08-04 20:59:54,133 - ClientAppLogger [Client 6] - INFO -   Attack type 'scanning': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:54,135 - ClientAppLogger [Client 6] - INFO -   Attack type 'injection': Had 17064 instances (in sampled), selected 5688 (target: 5688).
2025-08-04 20:59:54,138 - ClientAppLogger [Client 6] - INFO -   Attack type 'ransomware': Had 17091 instances (in sampled), selected 5697 (target: 5697).
2025-08-04 20:59:54,141 - ClientAppLogger [Client 6] - INFO -   Attack type 'password': Had 17013 instances (in sampled), selected 5671 (target: 5671).
2025-08-04 20:59:54,143 - ClientAppLogger [Client 6] - INFO -   Attack type 'ddos': Had 16995 instances (in sampled), selected 5665 (target: 5665).
2025-08-04 20:59:54,146 - ClientAppLogger [Client 6] - INFO -   Attack type 'xss': Had 16967 instances (in sampled), selected 5655 (target: 5655).
2025-08-04 20:59:54,149 - ClientAppLogger [Client 6] - INFO -   Attack type 'dos': Had 16938 instances (in sampled), selected 5646 (target: 5646).
2025-08-04 20:59:54,152 - ClientAppLogger [Client 6] - INFO -   Attack type 'backdoor': Had 16963 instances (in sampled), selected 5654 (target: 5654).
2025-08-04 20:59:54,154 - ClientAppLogger [Client 6] - INFO -   Attack type 'mitm': Had 888 instances (in sampled), selected 296 (target: 296).
2025-08-04 20:59:54,156 - ClientAppLogger [Client 6] - INFO - Total number of anomaly samples (positions) after reduction: 45627
2025-08-04 20:59:54,167 - ClientAppLogger [Client 6] - INFO -   Distribution of remaining attack types: 
type
ransomware    5697
injection     5688
password      5671
ddos          5665
scanning      5655
xss           5655
backdoor      5654
dos           5646
mitm           296
Name: count, dtype: int64
2025-08-04 20:59:54,167 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Anomaly reduction logic completed.
2025-08-04 20:59:54,174 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Normal and anomaly indices shuffled.
2025-08-04 20:59:54,174 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating unlabeled training base.
2025-08-04 20:59:54,180 - ClientAppLogger [Client 6] - INFO - Unlabeled normal data for AE training base: 34000 samples.
2025-08-04 20:59:54,180 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating labeled pool.
2025-08-04 20:59:54,193 - ClientAppLogger [Client 6] - INFO - Labeled Pool (for train augmentation, val, test): 54127 samples.
2025-08-04 20:59:54,193 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Labeled pool creation completed.
2025-08-04 20:59:54,193 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Splitting labeled pool for train_aug, val, test.
2025-08-04 20:59:54,211 - ClientAppLogger [Client 6] - INFO - Labeled data for AE training augmentation: 37888 samples.
2025-08-04 20:59:54,216 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Combining data for final AE training set.
2025-08-04 20:59:54,221 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Final AE training data combination completed.
2025-08-04 20:59:54,221 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Logging final dataset sizes and distributions pre-partitioning.
2025-08-04 20:59:54,221 - ClientAppLogger [Client 6] - INFO - Data Splitting Summary (Semi-Supervised AE):
2025-08-04 20:59:54,221 - ClientAppLogger [Client 6] - INFO -   AE Training (X_train_combined): 71888 samples.
2025-08-04 20:59:54,221 - ClientAppLogger [Client 6] - INFO -   Validation (X_val): 8119 samples.
2025-08-04 20:59:54,222 - ClientAppLogger [Client 6] - INFO -   Test (X_test_final): 8120 samples.
2025-08-04 20:59:54,222 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] START of partitioning block.
2025-08-04 20:59:54,222 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Starting Dirichlet-based partitioning with minimum sample guarantee.
2025-08-04 20:59:54,222 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 1: Full indices created.
2025-08-04 20:59:54,222 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full train/val/test indices created.
2025-08-04 20:59:54,224 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 2: Full indices shuffled.
2025-08-04 20:59:54,224 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Full indices shuffled.
2025-08-04 20:59:54,224 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5d: Counts calculated. Final sums: Train=71888, Val=8119, Test=8120
2025-08-04 20:59:54,224 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Remainder distribution completed.
2025-08-04 20:59:54,225 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5e: Final train_counts example: [117, 38174, 12359, 1183, 1086]
2025-08-04 20:59:54,225 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5f: Final val_counts example: [575, 417, 122, 132, 3018]
2025-08-04 20:59:54,225 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 5g: Final test_counts example: [161, 226, 392, 3433, 379]
2025-08-04 20:59:54,225 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 6: Start indices calculated. train_start=53088
2025-08-04 20:59:54,225 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Start indices calculated. Train_start=53088, Val_start=4884, Test_start=5190
2025-08-04 20:59:54,225 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 7: End indices calculated. train_end=53194
2025-08-04 20:59:54,225 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: End indices calculated. Train_end=53194, Val_end=4989, Test_end=5314
2025-08-04 20:59:54,225 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 8: Partition-specific indices extracted. Num train indices: 106
2025-08-04 20:59:54,226 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Specific indices extracted. Train idx: 106, Val idx: 105, Test idx: 124
2025-08-04 20:59:54,226 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9a: Train data sliced for partition. X_train_part_full shape: (106, 17)
2025-08-04 20:59:54,226 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Train data sliced. Shape: (106, 17)
2025-08-04 20:59:54,226 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9b: Validation data sliced for partition. X_val_part shape: (105, 17)
2025-08-04 20:59:54,226 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Validation data sliced. Shape: (105, 17)
2025-08-04 20:59:54,226 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 9c: Test data sliced for partition. X_test_part shape: (124, 17)
2025-08-04 20:59:54,227 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Partitioning: Test data sliced. Shape: (124, 17)
2025-08-04 20:59:54,227 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 10: Creating TonIoTDataset for train_dataset_full_potential.
2025-08-04 20:59:54,227 - ClientAppLogger [Client 6] - INFO - [LoadData 6] Creating TonIoTDataset objects.
2025-08-04 20:59:54,227 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 11: Creating TonIoTDataset for val_dataset_static.
2025-08-04 20:59:54,228 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 12: Creating TonIoTDataset for test_dataset_static.
2025-08-04 20:59:54,228 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] Step 13: All TonIoTDataset objects created.
2025-08-04 20:59:54,228 - ClientAppLogger [Client 6] - INFO - [LoadData 6] TonIoTDataset objects created.
2025-08-04 20:59:54,228 - ClientAppLogger [Client 6] - INFO - Partition 6 (Static Datasets): Train Potential 106, Val 105, Test 124
2025-08-04 20:59:54,228 - ClientAppLogger [Client 6] - INFO - [Partitioning Debug 6] END of partitioning block, returning datasets.
2025-08-04 20:59:54,229 - ClientAppLogger [Client 6] - INFO - [LoadData 6] load_data function completed.
2025-08-04 20:59:54,239 - ClientAppLogger [Client 6] - INFO - Data loaded for partition 6: Train samples: 106, Val samples: 105
2025-08-04 20:59:54,240 - ClientAppLogger [Client 6] - INFO - Instantiating GAN models: G(latent_dim=100, h1=128, h2=32), D(h1=128, h2=32)
2025-08-04 20:59:54,241 - ClientAppLogger [Client 6] - INFO - [Client] Generator model has 6 parameter tensors.
2025-08-04 20:59:54,241 - ClientAppLogger [Client 6] - INFO - [Client] Initialized. Device: cpu. Operating with 2 allocated core(s) for PyTorch tasks. Current PyTorch intra-op threads: 2.
2025-08-04 20:59:54,243 - ClientAppLogger [Client 6] - INFO - [Client] Evaluate method started for round -1 using Discriminator.
2025-08-04 20:59:54,243 - ClientAppLogger [Client 6] - INFO - [Client] set_parameters called with 12 total parameter tensors.
2025-08-04 20:59:54,243 - ClientAppLogger [Client 6] - INFO - [Client] Splitting parameters: 6 for G, 6 for D.
2025-08-04 20:59:54,244 - ClientAppLogger [Client 6] - INFO - [Client] Starting evaluation with Discriminator...
2025-08-04 20:59:54,253 - ClientAppLogger [Client 6] - INFO - [Task] Test Evaluation: Samples (valid for metrics)=105, Avg Anomaly Score (all samples)=0.5223, Threshold=0.5568, Accuracy=0.7048, F1=0.7974, Precision=0.9683, Recall=0.6778
2025-08-04 20:59:54,254 - ClientAppLogger [Client 6] - INFO - [Client] Evaluation finished. Samples: 105, Acc: 0.7048, F1: 0.7974, Prec: 0.9683, Rec: 0.6778, Avg Anomaly Score: 0.5223
